import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{R as H,r as f}from"./index.vDeobAm6.js";import{u as q}from"./index.D8A-VS5Y.js";import{a as F}from"./index.BSdFiPHn.js";import{u as D,a as M,b as P,c as V,H as W,d as Y,A as z,e as B,R as S,B as $}from"./ButtonLink.BYejWAHE.js";import{a as o}from"./utils.09jiQjc0.js";import{d as O}from"./proxy.DzZABkkb.js";import{b as G,c as K,d as U,e as X,f as J,g as Q,h as Z}from"./index.C34jsAOQ.js";import{_ as ee}from"./preload-helper.BlTxHScW.js";import"./_commonjsHelpers.CqkleIqs.js";import"./index.CDeUW-aT.js";var E=(t=>(t.HOME="home",t.POST="post",t.NONE="none",t))(E||{}),m=(t=>(t.INFO="info",t.DIRECTORY="directory",t.SERIES="series",t))(m||{});const j=F(m.INFO);F(E.HOME);const te=120;function se({defaultExpanded:t=!1,enableNumbering:s=!0,sourceHeadings:a}={}){const r=D(a),n=M({offsetTop:te}),{expandedIds:l,setExpandedIds:c}=P({headings:r,activeId:n,defaultExpanded:t}),u=V({headings:r,setExpandedIds:c});return r.length===0?null:e.jsx("nav",{className:`toc-container max-h-[90dvh] overflow-auto ${s?"":"toc-no-numbering"}`,"aria-label":"文章目录",children:e.jsx("div",{className:"space-y-1 pr-2",children:e.jsx(W,{headings:r,depth:0,activeId:n,expandedIds:l,onHeadingClick:u})})})}const A=({options:t,defaultValue:s,onChange:a,className:r,id:n,indicateClass:l,itemClass:c,value:u})=>{const[w,d]=f.useState(()=>u??s??t[0]?.value??""),x=Y(),N=f.useCallback(i=>{u===void 0&&d(i),a?.(i)},[a,u]),p=u??w,v=f.useCallback(i=>p===i,[p]);return e.jsx("div",{className:o("bg-muted flex w-fit cursor-pointer rounded-sm p-1 text-xs font-semibold backdrop-blur-lg select-none",r),children:t.map(i=>{if(!i)return null;const{label:h,value:g,icon:y}=i,b=v(g);return e.jsxs(O.div,{className:o("flex-center relative cursor-pointer gap-1.5 px-3 py-1 first:rounded-l-xs last:rounded-r-xs",{"text-primary-foreground":b},{"opacity-50":!b},c),onClick:()=>N(g),layout:!x,transition:x?{duration:0}:{type:"spring",stiffness:400,damping:30},children:[y&&e.jsx("span",{className:"flex-center shrink-0",children:H.createElement(y,{className:"w-4 h-4"})}),e.jsx(z,{initial:!1,mode:"wait",children:b&&h&&e.jsx(O.span,{initial:x?void 0:{width:0,opacity:0},animate:{width:"auto",opacity:1},exit:x?void 0:{width:0,opacity:0},transition:x?{duration:0}:{width:{duration:.2,ease:"easeInOut"},opacity:{duration:.15,ease:"easeInOut"}},className:"overflow-hidden whitespace-nowrap",children:h})}),b&&e.jsx(O.div,{layoutId:`segmented_selected_bg_${n??"default"}`,className:o("bg-gradient-shoka-button absolute inset-0 -z-10 rounded-sm",l),transition:x?{duration:0}:{type:"spring",stiffness:400,damping:30},style:{willChange:x?"auto":"transform"}})]},g)})})};H.memo(A);const _=({className:t,...s})=>{const a=[{label:"站点概览",value:m.INFO,icon:G},{label:"系列文章",value:m.SERIES,icon:K},{label:"文章目录",value:m.DIRECTORY,icon:U}];return e.jsx(A,{...s,options:a,className:o("flex w-fit cursor-pointer rounded-sm bg-black/8 p-1 text-xs font-semibold backdrop-blur-lg select-none",t),onChange:r=>j.set(r)})};_.displayName="HomeSiderSegmented";const ae=H.memo(_);function re({posts:t,currentPostSlug:s,className:a}){return t?.length?e.jsx("div",{className:o("flex flex-col gap-1",a),children:t.map(({post:r,href:n})=>{const l=r.data.link??r.id,c=l===s;return e.jsxs("a",{href:n,className:o("group relative flex items-start gap-3 rounded-md px-1 py-2 transition-colors","hover:bg-accent/50",c&&"text-primary font-medium"),children:[e.jsx("span",{className:o("mt-2 h-2 w-2 shrink-0 rounded-full transition-colors",c?"bg-primary":"bg-muted-foreground/40 group-hover:bg-muted-foreground/60")}),e.jsx("span",{className:o("line-clamp-2 flex-1 text-sm leading-relaxed transition-colors",c?"text-primary":"text-foreground group-hover:text-primary"),children:r.data.title})]},l)})}):e.jsx("div",{className:"text-muted-foreground py-8 text-center text-sm",children:"暂无系列文章"})}function ne({prevPost:t,nextPost:s,className:a}){if(!t&&!s)return null;const r="smooth";return e.jsxs("div",{className:o("border-border mt-4 flex flex-col gap-3 border-t pt-4 md:mt-0 md:pt-2",a),children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[t?e.jsxs("a",{href:t.href,className:o("group flex items-center gap-1.5 rounded-md px-2 py-1.5 transition-colors","hover:bg-accent text-muted-foreground hover:text-primary","max-w-[45%] min-w-0 flex-1"),title:t.post.data.title,suppressHydrationWarning:!0,children:[e.jsx(X,{className:"h-4 w-4 shrink-0"}),e.jsx("span",{className:"truncate text-xs",children:t.post.data.title})]}):e.jsx("div",{className:"max-w-[45%] flex-1"}),s?e.jsxs("a",{href:s.href,className:o("group flex items-center gap-1.5 rounded-md px-2 py-1.5 transition-colors","hover:bg-accent text-muted-foreground hover:text-primary","max-w-[45%] min-w-0 flex-1 justify-end text-right"),title:s.post.data.title,suppressHydrationWarning:!0,children:[e.jsx("span",{className:"truncate text-xs",children:s.post.data.title}),e.jsx(J,{className:"h-4 w-4 shrink-0"})]}):e.jsx("div",{className:"max-w-[45%] flex-1"})]}),e.jsxs("div",{className:"flex justify-center gap-2",children:[e.jsxs("button",{onClick:()=>window.scrollTo({top:0,behavior:r}),className:o("flex items-center justify-center gap-1.5 rounded-md px-3 py-1.5 transition-colors","hover:bg-accent text-muted-foreground hover:text-primary text-xs"),title:"回到顶部","aria-label":"回到顶部",suppressHydrationWarning:!0,children:[e.jsx(Q,{className:"h-4 w-4"}),"回到顶部"]}),e.jsxs("button",{onClick:()=>window.scrollTo({top:document.body.scrollHeight,behavior:r}),className:o("flex items-center justify-center gap-1.5 rounded-md px-3 py-1.5 transition-colors","hover:bg-accent text-muted-foreground hover:text-primary text-xs"),title:"滚到底部","aria-label":"滚到底部",suppressHydrationWarning:!0,children:[e.jsx(Z,{className:"h-4 w-4"}),"滚到底部"]})]})]})}function oe({className:t}){const s=f.useRef(null);return f.useEffect(()=>{let a=null;const r=()=>{const l=s.current;if(!l)return;const c=document.documentElement.scrollHeight-window.innerHeight,u=c>0?window.scrollY/c:0;l.style.transform=`scaleX(${u})`,a=null},n=()=>{a===null&&(a=window.requestAnimationFrame(r))};return r(),window.addEventListener("scroll",n,{passive:!0}),window.addEventListener("resize",n),()=>{a!==null&&window.cancelAnimationFrame(a),window.removeEventListener("scroll",n),window.removeEventListener("resize",n)}},[]),e.jsx("div",{className:t,children:e.jsx("div",{ref:s,className:"bg-primary h-1 origin-left rounded-full scale-x-0"})})}let T={};try{T=(await ee(()=>import("./lqips.P6KKDU4B.js"),[])).default}catch{}function le(t){return t.replace(/^\/img\//,"")}function ie(t){const s=le(t),a=T[s];if(a?.length!==18)return;const r=`#${a.slice(0,6)}`,n=`#${a.slice(6,12)}`,l=`#${a.slice(12,18)}`;return`linear-gradient(135deg, ${r} 0%, ${n} 50%, ${l} 100%)`}function de(){return e.jsx("div",{className:"mt-2 grid grid-cols-3 gap-2",children:Object.entries(B).map(([t,s])=>{const{url:a,label:r,iconClass:n,color:l}=s;return e.jsx("div",{children:e.jsxs("a",{className:o("social-link flex-center group relative overflow-hidden rounded-xl px-1.5 py-1 transition-all duration-300 group-hover:scale-105"),style:l?{"--link-color":l}:void 0,"data-platform":t,href:a,title:r,"data-tooltip-interactive":"false","data-tooltip-placement":"top","aria-label":r,suppressHydrationWarning:!0,children:[n&&e.jsx("i",{className:`${n} social-icon`,"aria-hidden":"true"}),e.jsx("span",{className:"absolute inset-0 -z-10 -translate-x-full translate-y-full rounded-xl transition-transform duration-300 group-hover:translate-x-0 group-hover:translate-y-0"})]})},t)})})}function ce({avatar:t,name:s,description:a,postCount:r,categoryCount:n,tagCount:l,routes:c,currentPath:u,className:w}){const d=f.useId(),[x,N]=f.useState({}),p=f.useMemo(()=>ie(t),[t]),v=i=>{N(h=>({...h,[i]:!h[i]}))};return e.jsxs("div",{className:o("flex flex-col items-center",w),children:[e.jsx("div",{className:"h-40 w-40 rounded-full",style:p?{backgroundImage:p}:void 0,children:e.jsx("img",{className:"shadow-card-darker hover:animate-shake h-full w-full rounded-full transition",src:t,alt:`${s??""} avatar`,loading:"eager",fetchPriority:"high"})}),e.jsx("p",{className:"mt-2",children:s}),e.jsx("p",{className:"text-muted-foreground mt-3 text-center",children:a}),e.jsx(de,{}),e.jsxs("div",{className:"text-muted-foreground mt-3 flex justify-center text-center text-sm/4 whitespace-nowrap select-none dark:text-white/80",children:[e.jsxs("a",{href:S.Home,className:"hover:text-blue flex cursor-pointer flex-col gap-2 p-1 transition",children:[e.jsx("span",{className:"text-lg/5 font-bold",children:r}),"文章"]}),e.jsx("div",{className:"bg-muted-foreground mx-3 w-px"}),e.jsx("a",{href:S.Categories,"aria-label":"分类",className:"hover:text-blue",children:e.jsxs("p",{className:"flex cursor-pointer flex-col gap-2 p-1 transition",children:[e.jsx("span",{className:"text-lg/5 font-bold",children:n}),"分类"]})}),e.jsx("div",{className:"bg-muted-foreground mx-3 w-px"}),e.jsxs("a",{href:S.Tags,className:"hover:text-blue flex cursor-pointer flex-col gap-2 p-1 transition",children:[e.jsx("span",{className:"text-lg/5 font-bold",children:l}),"标签"]})]}),e.jsx("div",{className:"mt-6 flex w-full flex-col items-center gap-2.5",children:c.map(({name:i,path:h,icon:g,children:y},b)=>{if(y?.length){const k=`${d}-collapse-${b}`,R=!!x[k];return e.jsxs("div",{className:"bg-foreground/10 flex w-40 flex-col rounded-xl opacity-75 transition-all duration-300 hover:opacity-100","data-collapsible":!0,children:[e.jsxs("button",{className:"flex-center hover:bg-foreground/5 h-12 w-full cursor-pointer rounded-xl transition-colors","aria-expanded":R,"aria-controls":k,"aria-label":`${i}菜单`,type:"button",onClick:()=>v(k),children:[g&&e.jsx("i",{className:`mr-1.5 ${g}`,"aria-hidden":"true"}),i,e.jsx("i",{className:o("fa-solid fa-caret-down ml-2 text-base transition-transform duration-300",R&&"rotate-180"),"aria-hidden":"true"})]}),e.jsx("div",{id:k,className:o("collapse-content",!R&&"collapse-hidden"),"data-collapse-content":!0,children:e.jsx("div",{className:"flex flex-col items-center",children:y.map(({name:C,path:I,icon:L})=>e.jsxs($,{url:I,label:C,variant:"gradient-shoka",className:o("shoka-button-shadow h-12 w-40 rounded-xl text-base tracking-wider",{"text-muted-foreground/80 hover:bg-muted-foreground/10 bg-none shadow-none hover:shadow-none":I!==u}),children:[L&&e.jsx("i",{className:`mr-1.5 ${L}`,"aria-hidden":"true"}),C]},I))})})]},k)}return e.jsxs($,{url:h,label:i,variant:"gradient-shoka",className:o("shoka-button-shadow h-12 w-40 rounded-xl text-base tracking-wider opacity-75 transition-all duration-300 hover:opacity-100",{"text-muted-foreground/80 hover:bg-muted-foreground/10 bg-none shadow-none hover:shadow-none":h!==u}),children:[g&&e.jsx("i",{className:`mr-1.5 ${g}`,"aria-hidden":"true"}),i]},h)})})]})}function Ne({type:t,defaultSegmentType:s,homeInfo:a,tocHeadings:r,tocNumbering:n=!0,seriesPostItems:l=[],currentPostSlug:c,prevPostItem:u,nextPostItem:w}){const d=t===E.POST,x=q(j),N=d?x:m.INFO;f.useEffect(()=>{d?j.set(s):j.set(m.INFO)},[s,d]),f.useEffect(()=>{d&&(j.set(m.INFO),requestAnimationFrame(()=>{requestAnimationFrame(()=>{j.set(m.DIRECTORY)})}))},[d]);const p=i=>o("sider-slot",{hidden:i!==N}),v=f.useMemo(()=>d?s:m.INFO,[s,d]);return e.jsxs(e.Fragment,{children:[d&&e.jsx(ae,{className:"my-4 flex w-full justify-between text-sm/6",itemClass:"grow",defaultValue:v,id:"inner-home-sider"}),e.jsxs("div",{className:"vertical-scrollbar pt-10 scroll-gutter-stable relative block w-full flex-1 min-h-0 overflow-x-hidden overflow-y-auto md:pt-4 md:pl-3","data-type":t,"data-default-type":v,children:[e.jsx("div",{className:p(m.INFO),"data-slot-type":"info",children:e.jsx(ce,{className:t===E.HOME?"pt-18 md:pt-0":"",...a})}),e.jsx("div",{className:p(m.DIRECTORY),"data-slot-type":"directory",children:d&&e.jsx(se,{enableNumbering:n,sourceHeadings:r})}),e.jsx("div",{className:p(m.SERIES),"data-slot-type":"series",children:d&&e.jsx(re,{posts:l,currentPostSlug:c})})]}),d&&e.jsx(ne,{prevPost:u??null,nextPost:w??null,className:"w-full px-2"}),e.jsx(oe,{className:"mt-auto w-full rounded-full pt-4 sticky bottom-0"})]})}export{Ne as default};
